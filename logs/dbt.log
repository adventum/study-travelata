

============================== 2023-09-27 09:56:14.819371 | da95eec8-f7f7-451f-90be-0fec5d743e3b ==============================
[0m09:56:14.819371 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:56:14.834996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:56:14.834996 [debug] [MainThread]: Tracking: tracking
[0m09:56:14.834996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8880>]}
[0m09:56:14.851015 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:56:14.851015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:14.851015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F88F8>]}
[0m09:56:16.954656 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m09:56:16.970297 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5DD8>]}
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>]}
[0m09:56:17.142684 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:56:17.142684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059E96A0>]}
[0m09:56:17.142684 [info ] [MainThread]: 
[0m09:56:17.142684 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:56:17.142684 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:56:17.158719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:27.915586 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE028>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m09:56:36.983601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:36.983601 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:56:36.983601 [debug] [MainThread]: On list_schemas: No close available on handle
[0m09:56:36.983601 [info ] [MainThread]: 
[0m09:56:36.983601 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 19.84 seconds (19.84s).
[0m09:56:36.983601 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE220>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D41CB8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FCFE340>]}
[0m09:56:36.983601 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:01:25.322824 | be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a ==============================
[0m10:01:25.322824 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:01:25.326846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:01:25.326846 [debug] [MainThread]: Tracking: tracking
[0m10:01:25.327845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767838>]}
[0m10:01:25.355300 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:26.191340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068446E8>]}
[0m10:01:26.202352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7658>]}
[0m10:01:26.202352 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:01:26.203351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7670>]}
[0m10:01:26.205345 [info ] [MainThread]: 
[0m10:01:26.208343 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:01:26.210343 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:01:26.229343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.989071 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845B20>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:01:47.061312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:47.061312 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:01:47.061312 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:01:47.061312 [info ] [MainThread]: 
[0m10:01:47.061312 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.85 seconds (20.85s).
[0m10:01:47.061312 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845D18>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D72C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F845E38>]}
[0m10:01:47.061312 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:02:16.338593 | 5af424ed-2a38-4297-bcd6-d46bd3e8e53e ==============================
[0m10:02:16.338593 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:02:16.338593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:02:16.338593 [debug] [MainThread]: Tracking: tracking
[0m10:02:16.338593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8868>]}
[0m10:02:16.360232 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:16.574192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ED4718>]}
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E65688>]}
[0m10:02:16.589833 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E656A0>]}
[0m10:02:16.589833 [info ] [MainThread]: 
[0m10:02:16.605456 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:02:16.605456 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:02:16.621081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:25.317650 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5B50>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:02:34.493743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:34.493743 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:02:34.493743 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:02:34.493743 [info ] [MainThread]: 
[0m10:02:34.493743 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 17.90 seconds (17.90s).
[0m10:02:34.493743 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5D48>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05581730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E652F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EED5E68>]}
[0m10:02:34.493743 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:15:00.923308 | ad1000d9-4990-4e47-a48a-334ef46d8e98 ==============================
[0m10:15:00.923308 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:15:00.938952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:15:00.938952 [debug] [MainThread]: Tracking: tracking
[0m10:15:00.938952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B597C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B59808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B598F8>]}
[0m10:15:00.970197 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:01.805363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064357A8>]}
[0m10:15:01.809880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8718>]}
[0m10:15:01.809880 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:15:01.821388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8730>]}
[0m10:15:01.821388 [info ] [MainThread]: 
[0m10:15:01.821388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:01.821388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:15:01.837031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.146370 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:15:05.209378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.215394 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:15:05.225413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.815665 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:15:05.878180 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.878180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x040BF3B8>]}
[0m10:15:05.893943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:05.893943 [info ] [MainThread]: 
[0m10:15:05.972519 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [info ] [Thread-1  ]: 1 of 2 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:15:05.972519 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:15:05.972519 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:15:05.988139 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-27 10:15:05.972519 => 2023-09-27 10:15:05.988139
[0m10:15:05.988139 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:15:06.019931 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:15:06.066716 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:15:06.679729 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:15:06.726995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.742635 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:15:06.789509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.805135 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:15:06.805135 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:15:06.868053 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:06.917963 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-27 10:15:05.988139 => 2023-09-27 10:15:06.914935
[0m10:15:06.917963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06422F70>]}
[0m10:15:06.917963 [info ] [Thread-1  ]: 1 of 2 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.95s]
[0m10:15:06.917963 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:15:06.917963 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:15:06.925504 [info ] [Thread-1  ]: 2 of 2 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:15:06.925504 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:15:06.925504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:15:06.925504 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:15:06.931030 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:15:06.931030 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-27 10:15:06.925504 => 2023-09-27 10:15:06.931030
[0m10:15:06.931030 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:15:06.962297 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:15:07.025191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:07.025191 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-27 10:15:06.931030 => 2023-09-27 10:15:07.025191
[0m10:15:07.025191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8538>]}
[0m10:15:07.025191 [info ] [Thread-1  ]: 2 of 2 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.10s]
[0m10:15:07.025191 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:15:07.025191 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:07.025191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_schemas: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_None_travelata: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:15:07.040830 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m10:15:07.040830 [debug] [MainThread]: Command end result
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.056454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:15:07.056454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065B02B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10DDE4D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0421B508>]}
[0m10:15:07.056454 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:04:49.891103 | e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0 ==============================
[0m10:04:49.891103 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:04:49.891103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:04:49.891103 [debug] [MainThread]: Tracking: tracking
[0m10:04:49.891103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298538>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298568>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298658>]}
[0m10:04:49.928844 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.832619 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.926797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075D72F8>]}
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364C40>]}
[0m10:04:50.942421 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364EF8>]}
[0m10:04:50.942421 [info ] [MainThread]: 
[0m10:04:50.942421 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:50.942421 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:04:50.958051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:54.461225 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:04:54.508521 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:54.524157 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:04:54.524157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:55.135028 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:04:55.197937 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.197937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075CDD78>]}
[0m10:04:55.197937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:55.197937 [info ] [MainThread]: 
[0m10:04:55.213577 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:04:55.213577 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:04:55.213577 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:04:55.213577 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:55.213577
[0m10:04:55.213577 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:04:55.257810 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:04:55.311853 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:04:55.902137 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:04:55.964649 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.980276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:04:56.048733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.056752 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:04:56.058277 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:04:56.126233 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.157486 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:56.157486
[0m10:04:56.157486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898F28>]}
[0m10:04:56.157486 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.94s]
[0m10:04:56.157486 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:04:56.157486 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.157486 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:04:56.157486 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:04:56.157486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:04:56.157486 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:04:56.173112 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.173112 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.173112
[0m10:04:56.173112 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:04:56.195742 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_installs
[0m10:04:56.217745 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.217745 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs 
  
  as (
    select *

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:04:56.272563 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:56.288193 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.288193
[0m10:04:56.288193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898AD8>]}
[0m10:04:56.288193 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.13s]
[0m10:04:56.288193 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.288193 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:04:56.288193 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:04:56.295704 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:04:56.295704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:04:56.295704 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:04:56.295704 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:04:56.295704 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.295704
[0m10:04:56.295704 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:04:56.304220 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:04:56.367035 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:56.371032 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.371032
[0m10:04:56.372026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11F59F58>]}
[0m10:04:56.373026 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.08s]
[0m10:04:56.374027 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:04:56.376030 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:56.377094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_schemas: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_None_travelata: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:04:56.377094 [info ] [MainThread]: 
[0m10:04:56.377094 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m10:04:56.377094 [debug] [MainThread]: Command end result
[0m10:04:56.392734 [info ] [MainThread]: 
[0m10:04:56.392734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:56.395753 [info ] [MainThread]: 
[0m10:04:56.395753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:04:56.395753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0626EB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x062862E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364DC0>]}
[0m10:04:56.395753 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:20:33.166185 | 822cc9da-952e-4a3b-90f4-fedd909cf552 ==============================
[0m10:20:33.166185 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:20:33.166185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:20:33.166185 [debug] [MainThread]: Tracking: tracking
[0m10:20:33.181825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9E50>]}
[0m10:20:33.197454 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:33.315122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550260D0>]}
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F859A0>]}
[0m10:20:33.330747 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85C10>]}
[0m10:20:33.346388 [info ] [MainThread]: 
[0m10:20:33.346388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:33.346388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:20:33.362414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.297249 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:20:35.360149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:35.375786 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:20:35.375786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.970774 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:20:36.033323 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.038317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D455044970>]}
[0m10:20:36.040322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:36.041320 [info ] [MainThread]: 
[0m10:20:36.049227 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:20:36.050233 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:20:36.051226 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:20:36.052233 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:20:36.057740 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:20:36.059757 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:20:36.053232 => 2023-09-28 10:20:36.058757
[0m10:20:36.059757 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:20:36.132760 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:20:36.721120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:20:36.774463 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:36.790017 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:20:36.852532 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.858551 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:20:36.858551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:20:36.899826 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:36.915456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:20:36.978358 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.009610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:20:37.058997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:20:36.060753 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4564118B0>]}
[0m10:20:37.072510 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m10:20:37.072510 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:20:37.072510 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:20:37.072510 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:20:37.072510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:20:37.072510 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:20:37.072510 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:20:37.120637 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.120637 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    select *

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:20:37.174686 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.190318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.308276 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.323905 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:20:37.496736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.496736 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:20:37.088152 => 2023-09-28 10:20:37.496736
[0m10:20:37.496736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D456468F40>]}
[0m10:20:37.496736 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.42s]
[0m10:20:37.496736 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.496736 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:20:37.496736 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:20:37.496736 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:20:37.496736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:20:37.496736 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:20:37.496736 => 2023-09-28 10:20:37.512368
[0m10:20:37.512368 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.675677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.685700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.769752 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.788311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:20:37.841558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.841558 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:20:37.512368 => 2023-09-28 10:20:37.841558
[0m10:20:37.841558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565232B0>]}
[0m10:20:37.841558 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.34s]
[0m10:20:37.857181 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:20:37.860193 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:37.860193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_schemas: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_None_travelata: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:20:37.860193 [info ] [MainThread]: 
[0m10:20:37.860193 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m10:20:37.860193 [debug] [MainThread]: Command end result
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:20:37.882067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565101C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550EC790>]}
[0m10:20:37.883085 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:33:18.958604 | d73870df-3ddc-4f46-b473-bd951638145c ==============================
[0m10:33:18.958604 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:33:18.960702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:33:18.961230 [debug] [MainThread]: Tracking: tracking
[0m10:33:18.973650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D790D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79E50>]}
[0m10:33:18.991176 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:33:19.097171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:19.098171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:19.107170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D0E60D0>]}
[0m10:33:19.117173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1A00>]}
[0m10:33:19.119172 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:33:19.120170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C70>]}
[0m10:33:19.122167 [info ] [MainThread]: 
[0m10:33:19.124172 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:19.126168 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:33:19.144173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:20.454170 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:33:20.504733 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:20.509736 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:33:20.518733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:21.124172 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:33:21.177043 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:21.182038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1049D0>]}
[0m10:33:21.183045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:21.184038 [info ] [MainThread]: 
[0m10:33:21.190101 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:33:21.191101 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:33:21.194107 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:33:21.195101 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:33:21.200101 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:33:21.201105 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:33:21.195101 => 2023-09-28 10:33:21.201105
[0m10:33:21.202106 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:33:21.276644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:21.874233 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:33:21.932024 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:21.945025 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:33:22.005208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.010200 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:33:22.012215 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:33:22.067290 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.075309 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:33:22.124819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.164816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:33:22.214637 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.216632 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:33:21.203106 => 2023-09-28 10:33:22.216632
[0m10:33:22.218637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E0910>]}
[0m10:33:22.220640 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.03s]
[0m10:33:22.223636 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:33:22.224633 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.225633 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:33:22.227635 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:33:22.227635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:33:22.228634 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:33:22.232632 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.233647 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:33:22.229639 => 2023-09-28 10:33:22.233647
[0m10:33:22.234635 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:33:22.275643 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.277644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )
  )...
[0m10:33:22.330770 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.340765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.394390 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.396384 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.454609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.458610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.514149 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.516153 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.564483 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.571479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:33:22.634556 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.636550 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:33:22.234635 => 2023-09-28 10:33:22.636550
[0m10:33:22.638550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4F9730>]}
[0m10:33:22.639558 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.41s]
[0m10:33:22.640550 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.641558 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:33:22.642556 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:33:22.644557 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:33:22.645554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:33:22.645554 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:33:22.649553 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:33:22.650553 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:33:22.646557 => 2023-09-28 10:33:22.650553
[0m10:33:22.651556 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:33:22.662553 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:33:22.664556 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:33:22.717590 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.721593 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.774256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.776265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.824160 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.829158 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.883801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.885791 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.944524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.951524 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:33:23.004774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:23.006777 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:33:22.651556 => 2023-09-28 10:33:23.006777
[0m10:33:23.007773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E04F0>]}
[0m10:33:23.008775 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m10:33:23.010770 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:33:23.012772 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:23.013770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:23.014773 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:33:23.014773 [debug] [MainThread]: On list_schemas: Close
[0m10:33:23.015772 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:33:23.015772 [debug] [MainThread]: On list_None_travelata: Close
[0m10:33:23.016772 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:33:23.017771 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:33:23.017771 [info ] [MainThread]: 
[0m10:33:23.018771 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m10:33:23.020774 [debug] [MainThread]: Command end result
[0m10:33:23.030773 [info ] [MainThread]: 
[0m10:33:23.032770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:23.033769 [info ] [MainThread]: 
[0m10:33:23.034772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:33:23.035771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E5E7EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1AC7F0>]}
[0m10:33:23.036777 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:21:50.550849 | ed8c38e2-03ed-40df-ab51-f0d7ea4729ab ==============================
[0m11:21:50.550849 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:21:50.552844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:21:50.553850 [debug] [MainThread]: Tracking: tracking
[0m11:21:50.567384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7E50>]}
[0m11:21:50.585389 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:50.706068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4370D0>]}
[0m11:21:50.716059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BA00>]}
[0m11:21:50.717060 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:21:50.719065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BC70>]}
[0m11:21:50.721059 [info ] [MainThread]: 
[0m11:21:50.724060 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:50.727069 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:21:50.742061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.096741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:21:52.146894 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.152916 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:21:52.163908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.776139 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:21:52.829300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.834293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4549D0>]}
[0m11:21:52.835287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:52.836290 [info ] [MainThread]: 
[0m11:21:52.843295 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:21:52.844290 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:21:52.846293 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:21:52.847298 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:21:52.852300 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:21:52.854319 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:21:52.847298 => 2023-09-28 11:21:52.854319
[0m11:21:52.855319 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:21:52.935345 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:21:53.537150 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:21:53.594678 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.606673 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:21:53.667696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.675767 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:21:53.678373 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:21:53.729108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.737124 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:21:53.786648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.826167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:21:53.876741 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.879755 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:21:52.856318 => 2023-09-28 11:21:53.879755
[0m11:21:53.881745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B830910>]}
[0m11:21:53.882739 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m11:21:53.885741 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:21:53.886737 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:21:53.889740 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:21:53.892740 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:21:53.893742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:21:53.894743 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:21:53.899747 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.903741 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:21:53.895745 => 2023-09-28 11:21:53.903741
[0m11:21:53.904739 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:21:53.961379 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.962382 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m11:21:54.016922 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )
[0m11:21:54.017910 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:21:53.905743 => 2023-09-28 11:21:54.017910
[0m11:21:54.027916 [debug] [Thread-1  ]: Database Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

  JSONExtractString(_airbyte_data, 'city') AS city,

  JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.028911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7E0A60>]}
[0m11:21:54.029917 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model travelata.normalize_sheet_default_installs  [[31mERROR[0m in 0.14s]
[0m11:21:54.030908 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:21:54.031914 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:21:54.032915 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:21:54.034913 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:21:54.034913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:21:54.035908 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:21:54.039904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:21:54.040910 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:21:54.035908 => 2023-09-28 11:21:54.040910
[0m11:21:54.041913 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:21:54.049916 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:21:54.051912 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:21:54.101447 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.118444 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.166231 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.167226 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.216882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.223881 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.285910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.287907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.336432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.342424 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:21:54.405954 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.408958 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:21:54.041913 => 2023-09-28 11:21:54.408958
[0m11:21:54.410954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B897040>]}
[0m11:21:54.411951 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m11:21:54.412950 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:21:54.414952 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:54.415958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:54.415958 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:21:54.416950 [debug] [MainThread]: On list_schemas: Close
[0m11:21:54.416950 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:21:54.417954 [debug] [MainThread]: On list_None_travelata: Close
[0m11:21:54.417954 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:21:54.418950 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:21:54.419951 [info ] [MainThread]: 
[0m11:21:54.420947 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m11:21:54.422953 [debug] [MainThread]: Command end result
[0m11:21:54.433955 [info ] [MainThread]: 
[0m11:21:54.434952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:21:54.435952 [info ] [MainThread]: 
[0m11:21:54.437956 [error] [MainThread]: [33mDatabase Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)[0m
[0m11:21:54.440952 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:21:54.441956 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

[0m11:21:54.443958 [error] [MainThread]:   JSONExtractString(_airbyte_data, 'city') AS city,

[0m11:21:54.444953 [error] [MainThread]:   JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m11:21:54.446955 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.447950 [info ] [MainThread]: 
[0m11:21:54.448951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:21:54.450957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4FB880>]}
[0m11:21:54.451953 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:22:30.162865 | 86ba7e4c-395b-498b-b462-45038a70680b ==============================
[0m11:22:30.162865 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:22:30.166881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:30.166881 [debug] [MainThread]: Tracking: tracking
[0m11:22:30.178882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9E50>]}
[0m11:22:30.198391 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:30.316132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C680D0>]}
[0m11:22:30.327136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4A30>]}
[0m11:22:30.328134 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:22:30.330132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4CA0>]}
[0m11:22:30.332129 [info ] [MainThread]: 
[0m11:22:30.336136 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:30.338140 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:22:30.359135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:31.726494 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:22:31.787087 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:31.791618 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:22:31.803138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:32.386061 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:22:32.449690 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:32.455692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C84A00>]}
[0m11:22:32.457688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:32.458684 [info ] [MainThread]: 
[0m11:22:32.466689 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:22:32.468702 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:22:32.469692 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:22:32.470688 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:22:32.475688 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:22:32.476690 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:22:32.471690 => 2023-09-28 11:22:32.476690
[0m11:22:32.477690 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:22:32.551223 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:22:33.136701 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:22:33.192584 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.205103 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:22:33.257579 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.263578 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:22:33.265088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:22:33.318905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.326903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:22:33.387051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.423575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:22:33.476133 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.478137 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:22:32.478694 => 2023-09-28 11:22:33.478137
[0m11:22:33.480134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F940>]}
[0m11:22:33.481136 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.01s]
[0m11:22:33.484146 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:22:33.485142 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.486147 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:22:33.489149 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:22:33.489149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:22:33.490160 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:22:33.493147 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.494146 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:22:33.491150 => 2023-09-28 11:22:33.494146
[0m11:22:33.495148 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:22:33.532665 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.534667 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m11:22:33.590861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.601392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.645458 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.647448 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.696429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.700674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.745841 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.747834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.796371 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.802903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m11:22:33.855899 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.858893 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:22:33.496149 => 2023-09-28 11:22:33.858893
[0m11:22:33.859900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C990D0>]}
[0m11:22:33.860893 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m11:22:33.862904 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.863902 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:22:33.864900 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:22:33.866904 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:22:33.867910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:22:33.869904 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:22:33.875904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:22:33.877906 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:22:33.869904 => 2023-09-28 11:22:33.877906
[0m11:22:33.878909 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:22:33.889921 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:22:33.892929 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:22:33.949455 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.954456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.015995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.018005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.066052 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.071051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.116599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.118604 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.175867 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.182877 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:22:34.235599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.238604 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:22:33.879906 => 2023-09-28 11:22:34.238604
[0m11:22:34.240602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F4F0>]}
[0m11:22:34.241601 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m11:22:34.242595 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:22:34.244598 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:34.245600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:34.246603 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:22:34.246603 [debug] [MainThread]: On list_schemas: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:22:34.247601 [debug] [MainThread]: On list_None_travelata: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:22:34.248601 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:22:34.249602 [info ] [MainThread]: 
[0m11:22:34.250599 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m11:22:34.252600 [debug] [MainThread]: Command end result
[0m11:22:34.261602 [info ] [MainThread]: 
[0m11:22:34.263600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:34.264602 [info ] [MainThread]: 
[0m11:22:34.266692 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:34.267600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015755168EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753D2C820>]}
[0m11:22:34.268599 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 14:51:49.527538 | 75a26bc2-a813-4200-8a93-68280085b930 ==============================
[0m14:51:49.527538 [info ] [MainThread]: Running with dbt=1.4.8
[0m14:51:49.531179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:49.531179 [debug] [MainThread]: Tracking: tracking
[0m14:51:49.546213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223814990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499E50>]}
[0m14:51:49.563728 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:49.685564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238480F0D0>]}
[0m14:51:49.698566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4FA0>]}
[0m14:51:49.699574 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:51:49.701565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>]}
[0m14:51:49.703562 [info ] [MainThread]: 
[0m14:51:49.706570 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:49.709585 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m14:51:49.732562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:51.711721 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m14:51:51.763292 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:51.767290 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m14:51:51.775812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.391811 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m14:51:52.445330 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:52.449346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4F10>]}
[0m14:51:52.451352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:52.452354 [info ] [MainThread]: 
[0m14:51:52.462351 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m14:51:52.463362 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m14:51:52.464901 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m14:51:52.465905 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m14:51:52.470899 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m14:51:52.473898 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 14:51:52.466904 => 2023-09-28 14:51:52.473898
[0m14:51:52.474898 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m14:51:52.551900 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:51:53.143858 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m14:51:53.206392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.224392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m14:51:53.277980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.285975 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m14:51:53.288976 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m14:51:53.347354 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.367779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m14:51:53.423818 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.467471 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m14:51:53.521623 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.524625 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 14:51:52.476918 => 2023-09-28 14:51:53.524625
[0m14:51:53.526626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C00D30>]}
[0m14:51:53.527627 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m14:51:53.530641 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m14:51:53.531614 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m14:51:53.532611 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m14:51:53.534616 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m14:51:53.535618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m14:51:53.536611 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m14:51:53.539617 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.541616 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-28 14:51:53.537613 => 2023-09-28 14:51:53.541616
[0m14:51:53.542620 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m14:51:53.567157 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_events
[0m14:51:53.584160 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.586156 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m14:51:53.638153 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.641154 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-28 14:51:53.543615 => 2023-09-28 14:51:53.641154
[0m14:51:53.642148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C16BB0>]}
[0m14:51:53.643157 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.11s]
[0m14:51:53.645152 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m14:51:53.646155 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m14:51:53.647154 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m14:51:53.648153 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m14:51:53.649154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m14:51:53.650165 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m14:51:53.652161 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.654165 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 14:51:53.650165 => 2023-09-28 14:51:53.653163
[0m14:51:53.654165 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m14:51:53.671321 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.674311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m14:51:53.729307 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.740306 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.792359 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.795359 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.843360 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.850367 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.901881 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.904528 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.953880 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.962897 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m14:51:54.011449 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.013463 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 14:51:53.655167 => 2023-09-28 14:51:54.013463
[0m14:51:54.015450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C279D0>]}
[0m14:51:54.016456 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m14:51:54.017445 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m14:51:54.018448 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m14:51:54.019445 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m14:51:54.021447 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m14:51:54.021447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m14:51:54.022450 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m14:51:54.027450 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m14:51:54.028448 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 14:51:54.023444 => 2023-09-28 14:51:54.028448
[0m14:51:54.030452 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m14:51:54.044441 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m14:51:54.048446 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m14:51:54.110492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.117485 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.172453 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.175453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.222451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.230450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.281976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.285973 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.331976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.341988 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m14:51:54.401540 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.404535 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 14:51:54.030452 => 2023-09-28 14:51:54.404535
[0m14:51:54.406533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385BB2520>]}
[0m14:51:54.407537 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m14:51:54.409537 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m14:51:54.412527 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:54.414526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:54.415530 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m14:51:54.416529 [debug] [MainThread]: On list_schemas: Close
[0m14:51:54.416529 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m14:51:54.417527 [debug] [MainThread]: On list_None_travelata: Close
[0m14:51:54.418828 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m14:51:54.419531 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m14:51:54.421531 [info ] [MainThread]: 
[0m14:51:54.423526 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m14:51:54.425528 [debug] [MainThread]: Command end result
[0m14:51:54.445047 [info ] [MainThread]: 
[0m14:51:54.448053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:54.451061 [info ] [MainThread]: 
[0m14:51:54.453065 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:51:54.456064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223848D3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381494E20>]}
[0m14:51:54.457068 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:05:45.764519 | e1ed8562-997b-46d2-a9b6-730dca8ec006 ==============================
[0m06:05:45.764519 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:05:45.764519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:45.764519 [debug] [MainThread]: Tracking: tracking
[0m06:05:45.784115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE590D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59E50>]}
[0m06:05:45.795527 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201EC0D0>]}
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2FD0>]}
[0m06:05:45.951682 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:05:45.951682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>]}
[0m06:05:45.951682 [info ] [MainThread]: 
[0m06:05:45.951682 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:45.951682 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:05:45.977927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:47.808761 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:05:47.871258 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:47.871258 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:05:47.879771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:48.499597 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:05:48.558875 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:48.558875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2F40>]}
[0m06:05:48.558875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:48.558875 [info ] [MainThread]: 
[0m06:05:48.576757 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:05:48.577755 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:05:48.579759 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:05:48.580760 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:05:48.584051 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:05:48.584051 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:05:48.581974 => 2023-09-29 06:05:48.584051
[0m06:05:48.584051 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:05:48.623316 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m06:05:48.671620 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:05:49.270961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:05:49.332163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.347792 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.395064 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:05:49.457583 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.489243 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:05:48.584051 => 2023-09-29 06:05:49.489243
[0m06:05:49.489243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCC40>]}
[0m06:05:49.489243 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.91s]
[0m06:05:49.504889 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:05:49.504889 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:05:49.504889 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:05:49.504889 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:05:49.510623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:05:49.511640 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:05:49.515999 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.515999 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:05:49.512640 => 2023-09-29 06:05:49.515999
[0m06:05:49.515999 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:05:49.610633 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.611633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:05:49.668625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.684665 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.715934 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:49.731555 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.778429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.781941 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.888124 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.903763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:05:49.951048 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.951048 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:05:49.515999 => 2023-09-29 06:05:49.951048
[0m06:05:49.951048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCB80>]}
[0m06:05:49.951048 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.45s]
[0m06:05:49.966671 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:05:49.966671 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:05:49.966671 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:05:49.966671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:05:49.966671 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.966671 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:49.966671
[0m06:05:49.966671 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.984608 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:05:50.045238 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.049235 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.159564 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.164564 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.195175 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:50.210804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.257679 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.273302 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:05:50.336211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.336211 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:50.336211
[0m06:05:50.336211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A821691430>]}
[0m06:05:50.336211 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m06:05:50.336211 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:05:50.336211 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:05:50.336211 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:05:50.336211 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:05:50.336211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:05:50.336211 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:05:50.356149 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:05:50.358149 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:05:50.351837 => 2023-09-29 06:05:50.358149
[0m06:05:50.359155 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:05:50.368396 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:05:50.370571 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:05:50.421163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.430519 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.479750 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.481908 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.541131 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.546447 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.600861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.603026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.650142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.650660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:05:50.697871 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.712886 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:05:50.360157 => 2023-09-29 06:05:50.712886
[0m06:05:50.712886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8216D5EB0>]}
[0m06:05:50.712886 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m06:05:50.712886 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:05:50.712886 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:50.712886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_schemas: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_None_travelata: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:05:50.712886 [info ] [MainThread]: 
[0m06:05:50.712886 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m06:05:50.727633 [debug] [MainThread]: Command end result
[0m06:05:50.738631 [info ] [MainThread]: 
[0m06:05:50.739630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:50.741679 [info ] [MainThread]: 
[0m06:05:50.741679 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:05:50.741679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8202B2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE4FF40>]}
[0m06:05:50.741679 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:12:14.089183 | 37f5e437-b126-421d-8955-7f629a98a9b6 ==============================
[0m06:12:14.089183 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:12:14.089183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:12:14.089183 [debug] [MainThread]: Tracking: tracking
[0m06:12:14.104801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388E80>]}
[0m06:12:14.130381 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:14.248827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46FE0D0>]}
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632220>]}
[0m06:12:14.256344 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632490>]}
[0m06:12:14.256344 [info ] [MainThread]: 
[0m06:12:14.256344 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:14.271988 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:12:14.289644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:15.610602 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:12:15.657878 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:15.673520 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:12:15.673520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:16.255651 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:12:16.318256 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:16.318256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4721040>]}
[0m06:12:16.318256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:12:16.333890 [info ] [MainThread]: 
[0m06:12:16.333890 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:12:16.333890 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:12:16.342982 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:12:16.342982 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:12:16.347995 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:12:16.349859 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:12:16.344005 => 2023-09-29 06:12:16.349002
[0m06:12:16.349859 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:12:16.424899 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:12:17.001575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:12:17.056291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.071940 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.118805 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:12:17.182191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.197825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:12:17.260758 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.292027 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:12:17.338902 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.352919 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:12:16.351375 => 2023-09-29 06:12:17.352919
[0m06:12:17.352919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5AE2BB0>]}
[0m06:12:17.354931 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:12:17.354931 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:12:17.354931 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:12:17.354931 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:12:17.363781 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:12:17.365256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:12:17.365256 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:12:17.365256 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.370882 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:12:17.365256 => 2023-09-29 06:12:17.370882
[0m06:12:17.370882 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:12:17.412039 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.412039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:12:17.466315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.481969 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.530531 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.544453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:12:17.759673 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.759673 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:12:17.370882 => 2023-09-29 06:12:17.759673
[0m06:12:17.759673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5BC8D00>]}
[0m06:12:17.759673 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.40s]
[0m06:12:17.759673 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:12:17.759673 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:12:17.759673 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:12:17.759673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:12:17.759673 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.775833 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:12:17.759673 => 2023-09-29 06:12:17.775833
[0m06:12:17.778497 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:12:17.786094 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.786094 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:12:17.853091 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:17.862210 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:12:18.139865 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.139865 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:12:17.778497 => 2023-09-29 06:12:18.139865
[0m06:12:18.139865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5C06FD0>]}
[0m06:12:18.139865 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.38s]
[0m06:12:18.139865 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:12:18.139865 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.139865 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheet_default_profiles ......... [RUN]
[0m06:12:18.139865 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_profiles'
[0m06:12:18.139865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_profiles)
[0m06:12:18.139865 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.153378 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.155885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (compile): 2023-09-29 06:12:18.139865 => 2023-09-29 06:12:18.155885
[0m06:12:18.157743 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.161764 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_profiles
[0m06:12:18.165214 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.165214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_profiles"} */


  create view travelata.normalize_sheet_default_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:12:18.224854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.227846 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (execute): 2023-09-29 06:12:18.158760 => 2023-09-29 06:12:18.227846
[0m06:12:18.228846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5A8FA00>]}
[0m06:12:18.230856 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheet_default_profiles .... [[32mOK[0m in 0.09s]
[0m06:12:18.231856 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.232854 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:12:18.233860 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:12:18.234862 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:12:18.235942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:12:18.235942 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.235942
[0m06:12:18.235942 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:12:18.304481 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:18.309481 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.353694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:18.361212 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:12:18.581618 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.584630 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.584630
[0m06:12:18.586629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46C3F40>]}
[0m06:12:18.588629 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.35s]
[0m06:12:18.590641 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:12:18.592629 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:18.593632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:18.593632 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:12:18.594627 [debug] [MainThread]: On list_schemas: Close
[0m06:12:18.594627 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:12:18.595628 [debug] [MainThread]: On list_None_travelata: Close
[0m06:12:18.595628 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:12:18.596631 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:12:18.597049 [info ] [MainThread]: 
[0m06:12:18.599050 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:12:18.600280 [debug] [MainThread]: Command end result
[0m06:12:18.613104 [info ] [MainThread]: 
[0m06:12:18.614748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:18.617267 [info ] [MainThread]: 
[0m06:12:18.617267 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:12:18.617267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B59E7D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F10>]}
[0m06:12:18.617267 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:01.573650 | 24d118a3-a5f0-4db8-89c9-757c0aebd5da ==============================
[0m06:20:01.573650 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:01.573650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:01.573650 [debug] [MainThread]: Tracking: tracking
[0m06:20:01.592026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9EE0>]}
[0m06:20:01.617475 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_events.sql
[0m06:20:01.727497 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_profiles.sql
[0m06:20:01.743127 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.771769 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.774945 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.790478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C70D0>]}
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950E700>]}
[0m06:20:01.806116 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950EB50>]}
[0m06:20:01.806116 [info ] [MainThread]: 
[0m06:20:01.806116 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:01.806116 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:01.828405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.097984 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:20:03.150930 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:03.154928 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:20:03.160338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.756928 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:20:03.812076 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:03.812076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C22E0>]}
[0m06:20:03.812076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:20:03.820593 [info ] [MainThread]: 
[0m06:20:03.820593 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:20:03.820593 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:20:03.831617 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:20:03.832650 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:20:03.836650 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:20:03.837731 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:20:03.832650 => 2023-09-29 06:20:03.837731
[0m06:20:03.840067 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:20:03.922096 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:20:04.519776 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:20:04.575694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.588209 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.635097 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:20:04.747040 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.794414 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:20:04.841315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.841315 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:20:03.841099 => 2023-09-29 06:20:04.841315
[0m06:20:04.841315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B700>]}
[0m06:20:04.841315 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:20:04.856928 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:20:04.856928 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.856928 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:20:04.862598 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:20:04.863614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:20:04.864617 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.868611 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.870612 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:20:04.865609 => 2023-09-29 06:20:04.869611
[0m06:20:04.871492 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.881026 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.894651 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.894651 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:20:04.965166 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:04.970156 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:20:04.871492 => 2023-09-29 06:20:04.970156
[0m06:20:04.971159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B190>]}
[0m06:20:04.972157 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.11s]
[0m06:20:04.974270 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.974270 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:20:04.976283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:20:04.976283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:20:04.976283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.976283 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:04.976283
[0m06:20:04.976283 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.989805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:20:05.043935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.047937 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:05.047937
[0m06:20:05.048932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DD9CC70>]}
[0m06:20:05.049932 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.07s]
[0m06:20:05.051938 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:05.051938 [debug] [Thread-1  ]: Began running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.052937 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalizesheets_default_travelataappmetrica_events  [RUN]
[0m06:20:05.054946 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalizesheets_default_travelataappmetrica_events'
[0m06:20:05.055939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalizesheets_default_travelataappmetrica_events)
[0m06:20:05.055939 [debug] [Thread-1  ]: Began compiling node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.057934 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.059945 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (compile): 2023-09-29 06:20:05.055939 => 2023-09-29 06:20:05.059945
[0m06:20:05.060943 [debug] [Thread-1  ]: Began executing node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.064954 [debug] [Thread-1  ]: Creating new relation normalizesheets_default_travelataappmetrica_events
[0m06:20:05.066998 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.069008 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalizesheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalizesheets_default_travelataappmetrica_events"} */


  create view travelata.normalizesheets_default_travelataappmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:20:05.135182 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:05.139173 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (execute): 2023-09-29 06:20:05.060943 => 2023-09-29 06:20:05.139173
[0m06:20:05.140180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DCAB280>]}
[0m06:20:05.142172 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalizesheets_default_travelataappmetrica_events  [[32mOK[0m in 0.09s]
[0m06:20:05.143177 [debug] [Thread-1  ]: Finished running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.144179 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:20:05.145172 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:20:05.147254 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:20:05.147254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:20:05.147254 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:20:05.147254 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:20:05.147254 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.147254
[0m06:20:05.147254 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:20:05.176501 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:20:05.178950 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:20:05.233421 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.240492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.327224 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.342856 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:20:05.515727 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.515727 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.515727
[0m06:20:05.515727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDC6FD0>]}
[0m06:20:05.515727 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m06:20:05.525737 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:20:05.525737 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:05.525737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:05.525737 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:20:05.531248 [debug] [MainThread]: On list_schemas: Close
[0m06:20:05.532468 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:20:05.533478 [debug] [MainThread]: On list_None_travelata: Close
[0m06:20:05.534868 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:20:05.534868 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:20:05.534868 [info ] [MainThread]: 
[0m06:20:05.534868 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m06:20:05.534868 [debug] [MainThread]: Command end result
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:20:05.548006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDD05E0>]}
[0m06:20:05.548006 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:59.136590 | 61eaa5ff-5532-422e-ae05-1c5de141be29 ==============================
[0m06:20:59.136590 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:59.151604 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:59.152613 [debug] [MainThread]: Tracking: tracking
[0m06:20:59.152613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089F70>]}
[0m06:20:59.181517 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:59.329445 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.361106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104900D0>]}
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D790>]}
[0m06:20:59.376752 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>]}
[0m06:20:59.376752 [info ] [MainThread]: 
[0m06:20:59.376752 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:59.376752 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:59.404171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:00.753260 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:21:00.809378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:00.809378 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:21:00.825016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:01.417937 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:21:01.470455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:01.488109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104938B0>]}
[0m06:21:01.488109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:21:01.488109 [info ] [MainThread]: 
[0m06:21:01.488109 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:21:01.488109 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:21:01.502126 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:21:01.503064 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:21:01.508080 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:21:01.510082 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:21:01.504089 => 2023-09-29 06:21:01.510082
[0m06:21:01.511079 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:21:01.594986 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:21:02.183613 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:21:02.257792 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.261807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:21:02.308696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.324323 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:21:02.324323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:21:02.371607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.387244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:21:02.434108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.465763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:21:02.528283 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.528283 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:21:01.512883 => 2023-09-29 06:21:02.528283
[0m06:21:02.528283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822EB0>]}
[0m06:21:02.528283 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m06:21:02.528283 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:21:02.528283 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.528283 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [RUN]
[0m06:21:02.528283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_events'
[0m06:21:02.528283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_events)
[0m06:21:02.528283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.545351 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.547366 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (compile): 2023-09-29 06:21:02.528283 => 2023-09-29 06:21:02.547366
[0m06:21:02.548366 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.563432 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.576819 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.576819 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_events"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:21:02.634392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.637386 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (execute): 2023-09-29 06:21:02.549364 => 2023-09-29 06:21:02.637386
[0m06:21:02.639392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711855C10>]}
[0m06:21:02.640399 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [[32mOK[0m in 0.11s]
[0m06:21:02.641401 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.643404 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.645404 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:21:02.647413 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:21:02.648411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:21:02.649411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.651413 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.653411 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:21:02.649411 => 2023-09-29 06:21:02.653411
[0m06:21:02.653411 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.657244 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.657244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install to travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.935292 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.954947 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  ...
[0m06:21:02.998244 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:02.998244 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:21:02.653411 => 2023-09-29 06:21:02.998244
[0m06:21:03.013885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822DF0>]}
[0m06:21:03.013885 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.35s]
[0m06:21:03.013885 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:03.013885 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:21:03.013885 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:21:03.013885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:21:03.013885 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.013885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.013885
[0m06:21:03.013885 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.032730 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.034740 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:21:03.084524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.088517 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.126787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.142418 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles to travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.290441 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.302267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  ...
[0m06:21:03.355718 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.362401 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.362401
[0m06:21:03.362911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271187E520>]}
[0m06:21:03.362911 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.35s]
[0m06:21:03.362911 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.362911 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:21:03.362911 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:21:03.362911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:21:03.362911 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:21:03.362911 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:21:03.362911 => 2023-09-29 06:21:03.362911
[0m06:21:03.377925 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:21:03.384823 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:21:03.386821 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:21:03.452811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:03.457914 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.556008 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.564030 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.610248 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.612013 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:21:03.705092 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.720719 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:21:03.377925 => 2023-09-29 06:21:03.720719
[0m06:21:03.720719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227118E5550>]}
[0m06:21:03.720719 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m06:21:03.720719 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:21:03.720719 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:21:03.720719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_schemas: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_None_travelata: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:21:03.720719 [info ] [MainThread]: 
[0m06:21:03.720719 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:21:03.738083 [debug] [MainThread]: Command end result
[0m06:21:03.749063 [info ] [MainThread]: 
[0m06:21:03.750081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:21:03.751074 [info ] [MainThread]: 
[0m06:21:03.751074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:21:03.751074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022710451820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711921700>]}
[0m06:21:03.756097 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 08:55:59.908704 | 89ed6b51-4414-4516-b3a5-577d4f313ffa ==============================
[0m08:55:59.908704 [info ] [MainThread]: Running with dbt=1.4.8
[0m08:55:59.915248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:59.916276 [debug] [MainThread]: Tracking: tracking
[0m08:55:59.916276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A868>]}
[0m08:55:59.949068 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\schema.yml
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_second_dbt_model.sql
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_first_dbt_model.sql
[0m08:56:01.042760 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m08:56:01.073884 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m08:56:01.192798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068572F8>]}
[0m08:56:01.205803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x023E7D78>]}
[0m08:56:01.205803 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:56:01.206795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C3D0>]}
[0m08:56:01.209802 [info ] [MainThread]: 
[0m08:56:01.211794 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:01.214796 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m08:56:01.234796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:04.740276 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m08:56:04.799389 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:04.804387 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m08:56:04.816381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:05.438440 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m08:56:05.496222 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:05.503220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>]}
[0m08:56:05.504223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:05.505216 [info ] [MainThread]: 
[0m08:56:05.514008 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m08:56:05.515007 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m08:56:05.516010 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m08:56:05.517012 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m08:56:05.522008 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m08:56:05.523008 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 08:56:05.517012 => 2023-10-02 08:56:05.523008
[0m08:56:05.523008 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m08:56:05.609065 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:56:06.208834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m08:56:06.277959 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.292958 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:56:06.340418 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.350434 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m08:56:06.352430 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m08:56:06.401396 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.411416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m08:56:06.458666 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.510451 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m08:56:06.569078 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:06.572073 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 08:56:05.524009 => 2023-10-02 08:56:06.572073
[0m08:56:06.573075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B192B0>]}
[0m08:56:06.574081 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m08:56:06.577076 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m08:56:06.578077 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.579074 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m08:56:06.580073 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m08:56:06.580073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m08:56:06.581072 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.582077 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.582077 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 08:56:06.581072 => 2023-10-02 08:56:06.582077
[0m08:56:06.582077 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.611113 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m08:56:06.623455 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.625457 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m08:56:06.699397 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.704928 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 08:56:06.582077 => 2023-10-02 08:56:06.704928
[0m08:56:06.706931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B31808>]}
[0m08:56:06.708933 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.13s]
[0m08:56:06.733347 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.733347 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.733347 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m08:56:06.733347 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m08:56:06.733347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m08:56:06.733347 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 08:56:06.733347 => 2023-10-02 08:56:06.743882
[0m08:56:06.743882 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m08:56:06.813155 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.817158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 08:56:06.743882 => 2023-10-02 08:56:06.817158
[0m08:56:06.818158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CF8E08>]}
[0m08:56:06.819159 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.08s]
[0m08:56:06.820160 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.821157 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.822153 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m08:56:06.823154 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m08:56:06.824159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m08:56:06.824159 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.827157 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.829158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 08:56:06.824159 => 2023-10-02 08:56:06.829158
[0m08:56:06.829158 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.834159 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m08:56:06.836241 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.836241 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m08:56:06.902197 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.906206 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 08:56:06.830161 => 2023-10-02 08:56:06.905207
[0m08:56:06.907208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8DF0>]}
[0m08:56:06.907208 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m08:56:06.909207 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.909207 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m08:56:06.910204 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m08:56:06.911207 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m08:56:06.911207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m08:56:06.912204 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m08:56:06.916214 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m08:56:06.918206 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 08:56:06.912204 => 2023-10-02 08:56:06.917209
[0m08:56:06.918206 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m08:56:06.933773 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m08:56:06.935366 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m08:56:06.983504 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.006441 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.108601 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.114116 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.209710 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:07.225339 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m08:56:07.272611 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.272611 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 08:56:06.918206 => 2023-10-02 08:56:07.272611
[0m08:56:07.272611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8430>]}
[0m08:56:07.272611 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m08:56:07.272611 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m08:56:07.272611 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:07.288249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_schemas: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_None_travelata: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m08:56:07.288249 [info ] [MainThread]: 
[0m08:56:07.288249 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m08:56:07.288249 [debug] [MainThread]: Command end result
[0m08:56:07.306805 [info ] [MainThread]: 
[0m08:56:07.307808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:07.309813 [info ] [MainThread]: 
[0m08:56:07.310807 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:56:07.312810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06743BE0>]}
[0m08:56:07.312810 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:03:56.005710 | 6bedf390-12b6-4656-9e10-e3fc488ef5de ==============================
[0m09:03:56.005710 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:03:56.005710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:03:56.005710 [debug] [MainThread]: Tracking: tracking
[0m09:03:56.005710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79820>]}
[0m09:03:56.028780 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.310342 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.328477 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.342262 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.413394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071BBE80>]}
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CDC0>]}
[0m09:03:56.428409 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CCA0>]}
[0m09:03:56.428409 [info ] [MainThread]: 
[0m09:03:56.428409 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:56.445386 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:03:56.466484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:57.702537 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:03:57.749735 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:57.749735 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:03:57.765364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:58.365403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:03:58.428314 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:58.431824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ECA220>]}
[0m09:03:58.431824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:58.431824 [info ] [MainThread]: 
[0m09:03:58.444334 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:03:58.445495 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:03:58.447515 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:03:58.447515 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:03:58.453279 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:03:58.454304 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:03:58.448504 => 2023-10-02 09:03:58.454304
[0m09:03:58.455292 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:03:58.567389 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:03:59.147735 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:03:59.210256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.225883 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.273183 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:03:59.336093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.351733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:03:59.414303 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.461603 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:03:59.508477 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.508477 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:03:58.455292 => 2023-10-02 09:03:59.508477
[0m09:03:59.508477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B24CB8>]}
[0m09:03:59.508477 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m09:03:59.524098 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:03:59.524098 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.524098 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:03:59.524098 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:03:59.524098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:03:59.529691 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.532777 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.533229 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:03:59.529691 => 2023-10-02 09:03:59.533229
[0m09:03:59.535286 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.562544 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:03:59.575644 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.575644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name

from travelata.sheets_appmetrica_travelata_events

)
  )...
[0m09:03:59.628430 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name

from travelata.sheets_appmetrica_travelata_events

)
  )
[0m09:03:59.628430 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:03:59.535286 => 2023-10-02 09:03:59.628430
[0m09:03:59.732898 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.732898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B363D0>]}
[0m09:03:59.732898 [error] [Thread-1  ]: 2 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.21s]
[0m09:03:59.732898 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.732898 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.732898 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:03:59.739411 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:03:59.739411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:03:59.739411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.739411
[0m09:03:59.739411 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name

from travelata.sheets_appmetrica_travelata_install

)
  )...
[0m09:03:59.802684 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name

from travelata.sheets_appmetrica_travelata_install

)
  )
[0m09:03:59.802684 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.802684
[0m09:03:59.802684 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.802684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36340>]}
[0m09:03:59.802684 [error] [Thread-1  ]: 3 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.07s]
[0m09:03:59.802684 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.813336 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:03:59.814452 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:03:59.814452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:03:59.814452 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.814452 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.814452
[0m09:03:59.814452 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:03:59.826722 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.828736 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name

from travelata.sheets_appmetrica_travelata_profiles

)
  )...
[0m09:03:59.869362 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name

from travelata.sheets_appmetrica_travelata_profiles

)
  )
[0m09:03:59.869362 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.869362
[0m09:03:59.869362 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.869362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36298>]}
[0m09:03:59.880043 [error] [Thread-1  ]: 4 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.05s]
[0m09:03:59.881061 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.882058 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:03:59.882058 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:03:59.884057 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:03:59.884057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:03:59.885050 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:03:59.889054 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:03:59.891054 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:03:59.885050 => 2023-10-02 09:03:59.890051
[0m09:03:59.891054 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:03:59.895051 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m09:03:59.897051 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:03:59.898051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:03:59.949205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.949205 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:03:59.891054 => 2023-10-02 09:03:59.949205
[0m09:03:59.949205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11C153B8>]}
[0m09:03:59.949205 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m09:03:59.949205 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:03:59.949205 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:59.959962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:59.960974 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:03:59.960974 [debug] [MainThread]: On list_schemas: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:03:59.961969 [debug] [MainThread]: On list_None_travelata: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:03:59.962969 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:03:59.962969 [info ] [MainThread]: 
[0m09:03:59.963974 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m09:03:59.965981 [debug] [MainThread]: Command end result
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m09:03:59.975019 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.975019 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.975019 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.986687 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m09:03:59.987707 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.988701 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.989707 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.990708 [info ] [MainThread]: 
[0m09:03:59.991712 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m09:03:59.993704 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.994702 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.995703 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.997712 [info ] [MainThread]: 
[0m09:04:00.000112 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m09:04:00.002128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F45D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8730>]}
[0m09:04:00.003129 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:05:24.720227 | e3bc7e59-e164-41c1-b7b2-62b05fcc5990 ==============================
[0m09:05:24.720227 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:05:24.720227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:05:24.720227 [debug] [MainThread]: Tracking: tracking
[0m09:05:24.720227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A7F0>]}
[0m09:05:24.739215 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:05:24.986962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.034261 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.112540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0716AE50>]}
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BFB8>]}
[0m09:05:25.128182 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BF88>]}
[0m09:05:25.143804 [info ] [MainThread]: 
[0m09:05:25.143804 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:25.143804 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:05:25.166444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:26.415062 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:05:26.463294 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:26.478917 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:05:26.478917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:27.065312 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:05:27.117386 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:27.117386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>]}
[0m09:05:27.117386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:05:27.117386 [info ] [MainThread]: 
[0m09:05:27.135249 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:05:27.136251 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:05:27.138250 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:05:27.139262 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:05:27.139588 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:05:27.139588 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:27.139588
[0m09:05:27.139588 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:05:27.243860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:05:27.828996 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:05:27.891509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.915168 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:05:27.970201 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.980213 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:05:27.980213 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:05:28.094660 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.144214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:05:28.188517 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:05:28.188517 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:28.188517
[0m09:05:28.188517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660868>]}
[0m09:05:28.188517 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.05s]
[0m09:05:28.188517 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:05:28.188517 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.204151 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:05:28.204151 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:05:28.204151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:05:28.206612 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.209739 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.210745 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:05:28.206612 => 2023-10-02 09:05:28.210745
[0m09:05:28.211706 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.237026 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:05:28.246140 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.246140 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m09:05:28.315341 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:05:28.315341 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:05:28.212696 => 2023-10-02 09:05:28.315341
[0m09:05:28.315341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660580>]}
[0m09:05:28.315341 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.11s]
[0m09:05:28.315341 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.315341 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.315341 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:05:28.328850 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:05:28.328850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:05:28.328850 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.328850
[0m09:05:28.328850 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m09:05:28.391074 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.391074 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.391074
[0m09:05:28.391074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10B05CA0>]}
[0m09:05:28.403602 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.06s]
[0m09:05:28.404847 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.404847 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:05:28.404847 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:05:28.404847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:05:28.404847 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.404847 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:05:28.404847 => 2023-10-02 09:05:28.404847
[0m09:05:28.415365 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.419832 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:05:28.421838 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.422834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m09:05:28.479065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.482057 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:05:28.415365 => 2023-10-02 09:05:28.482057
[0m09:05:28.483063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660418>]}
[0m09:05:28.484066 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m09:05:28.485067 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.485067 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:05:28.486065 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:05:28.488068 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:05:28.488068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:05:28.489069 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:05:28.494063 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:05:28.495058 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:05:28.489069 => 2023-10-02 09:05:28.495058
[0m09:05:28.496066 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:05:28.511015 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:05:28.512576 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:05:28.565809 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.584907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.635416 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.637039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.685767 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.691674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.746055 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.748167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.804927 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.812379 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m09:05:28.874979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.877136 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:05:28.496066 => 2023-10-02 09:05:28.876598
[0m09:05:28.877676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B9DD18>]}
[0m09:05:28.878756 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m09:05:28.879826 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:05:28.882104 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:28.883162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:28.883709 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:05:28.884448 [debug] [MainThread]: On list_schemas: Close
[0m09:05:28.884958 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:05:28.884958 [debug] [MainThread]: On list_None_travelata: Close
[0m09:05:28.885490 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:05:28.886016 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:05:28.886535 [info ] [MainThread]: 
[0m09:05:28.887581 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:05:28.889517 [debug] [MainThread]: Command end result
[0m09:05:28.903568 [info ] [MainThread]: 
[0m09:05:28.904666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:28.906285 [info ] [MainThread]: 
[0m09:05:28.906818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:05:28.907878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05EF6D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA0670>]}
[0m09:05:28.908400 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 15:46:40.667670 | 5571fcad-f526-4b89-8a77-edc2beab3e93 ==============================
[0m15:46:40.667670 [info ] [MainThread]: Running with dbt=1.4.8
[0m15:46:40.667670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:46:40.667670 [debug] [MainThread]: Tracking: tracking
[0m15:46:40.683297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60731250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F3AE50>]}
[0m15:46:40.698922 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m15:46:40.740177 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:46:40.741123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612090D0>]}
[0m15:46:41.400692 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\test.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m15:46:41.439846 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m15:46:41.484541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F81C50>]}
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D61290350>]}
[0m15:46:41.500164 [info ] [MainThread]: Found 7 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A6D1D0>]}
[0m15:46:41.500164 [info ] [MainThread]: 
[0m15:46:41.500164 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:41.500164 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m15:46:41.515794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.168111 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m15:46:42.217327 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:42.217327 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m15:46:42.223835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.787185 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m15:46:42.865284 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:46:42.865284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60929B90>]}
[0m15:46:42.865284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:42.865284 [info ] [MainThread]: 
[0m15:46:42.865284 [debug] [Thread-1 (]: Began running node model.travelata.my_first_dbt_model
[0m15:46:42.865284 [info ] [Thread-1 (]: 1 of 6 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m15:46:42.880911 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m15:46:42.880911 [debug] [Thread-1 (]: Began compiling node model.travelata.my_first_dbt_model
[0m15:46:42.880911 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m15:46:42.880911 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:42.880911
[0m15:46:42.880911 [debug] [Thread-1 (]: Began executing node model.travelata.my_first_dbt_model
[0m15:46:42.898564 [debug] [Thread-1 (]: Creating new relation my_first_dbt_model
[0m15:46:42.926827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:43.576851 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m15:46:43.623777 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.639343 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.686353 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m15:46:43.748964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED4D90>]}
[0m15:46:43.764627 [info ] [Thread-1 (]: 1 of 6 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.88s]
[0m15:46:43.764627 [debug] [Thread-1 (]: Finished running node model.travelata.my_first_dbt_model
[0m15:46:43.764627 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [info ] [Thread-1 (]: 2 of 6 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m15:46:43.764627 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m15:46:43.764627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m15:46:43.764627 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.780245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m15:46:43.861813 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )
[0m15:46:43.867840 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.867840
[0m15:46:43.938380 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:43.954020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A08690>]}
[0m15:46:43.954020 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.17s]
[0m15:46:43.954020 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.954020 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [info ] [Thread-1 (]: 3 of 6 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m15:46:43.954020 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m15:46:43.954020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m15:46:43.954020 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:43.954020
[0m15:46:43.954020 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m15:46:44.007655 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )
[0m15:46:44.008654 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:44.008654
[0m15:46:44.010653 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.011654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D611D6710>]}
[0m15:46:44.011654 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.06s]
[0m15:46:44.012656 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:44.012656 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.012656 [info ] [Thread-1 (]: 4 of 6 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m15:46:44.013736 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m15:46:44.013736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m15:46:44.014745 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 15:46:44.014745 => 2023-10-02 15:46:44.015746
[0m15:46:44.015746 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m15:46:44.065746 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )
[0m15:46:44.065746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 15:46:44.015746 => 2023-10-02 15:46:44.065746
[0m15:46:44.072486 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.072486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CFB50>]}
[0m15:46:44.072486 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.06s]
[0m15:46:44.072486 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.072486 [debug] [Thread-1 (]: Began running node model.travelata.test
[0m15:46:44.072486 [info ] [Thread-1 (]: 5 of 6 START sql view model travelata.test ..................................... [RUN]
[0m15:46:44.072486 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.test'
[0m15:46:44.072486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.test)
[0m15:46:44.078285 [debug] [Thread-1 (]: Began compiling node model.travelata.test
[0m15:46:44.079293 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.test"
[0m15:46:44.080294 [debug] [Thread-1 (]: Timing info for model.travelata.test (compile): 2023-10-02 15:46:44.078285 => 2023-10-02 15:46:44.080294
[0m15:46:44.081291 [debug] [Thread-1 (]: Began executing node model.travelata.test
[0m15:46:44.083290 [debug] [Thread-1 (]: Creating new relation test
[0m15:46:44.084290 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.test"
[0m15:46:44.085291 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.test: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )...
[0m15:46:44.150497 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.test (execute): 2023-10-02 15:46:44.081291 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Database Error in model test (models\1_normalize\test.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.150497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CED50>]}
[0m15:46:44.150497 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model travelata.test ............................ [[31mERROR[0m in 0.08s]
[0m15:46:44.150497 [debug] [Thread-1 (]: Finished running node model.travelata.test
[0m15:46:44.150497 [debug] [Thread-1 (]: Began running node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [info ] [Thread-1 (]: 6 of 6 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m15:46:44.150497 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m15:46:44.150497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m15:46:44.150497 [debug] [Thread-1 (]: Began compiling node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Began executing node model.travelata.my_second_dbt_model
[0m15:46:44.168083 [debug] [Thread-1 (]: Creating new relation my_second_dbt_model
[0m15:46:44.169084 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m15:46:44.170083 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m15:46:44.221437 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:44.223435 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.223435
[0m15:46:44.223435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6179E250>]}
[0m15:46:44.224437 [info ] [Thread-1 (]: 6 of 6 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m15:46:44.224437 [debug] [Thread-1 (]: Finished running node model.travelata.my_second_dbt_model
[0m15:46:44.224437 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:44.224437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_schemas: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_None_travelata: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m15:46:44.224437 [info ] [MainThread]: 
[0m15:46:44.224437 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m15:46:44.230343 [debug] [MainThread]: Command end result
[0m15:46:44.239494 [info ] [MainThread]: 
[0m15:46:44.240498 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:46:44.241494 [info ] [MainThread]: 
[0m15:46:44.241494 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m15:46:44.243264 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.243829 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.243829 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:44.244876 [info ] [MainThread]: 
[0m15:46:44.245885 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m15:46:44.246882 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.247881 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.247881 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.248883 [info ] [MainThread]: 
[0m15:46:44.249419 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m15:46:44.249419 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.249419 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.251897 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.252908 [info ] [MainThread]: 
[0m15:46:44.253906 [error] [MainThread]: [33mDatabase Error in model test (models\1_normalize\test.sql)[0m
[0m15:46:44.253906 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m15:46:44.254904 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m15:46:44.255904 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.255904 [info ] [MainThread]: 
[0m15:46:44.256904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m15:46:44.257906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60EB5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FEC50>]}
[0m15:46:44.257906 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 17:43:11.025652 | 15314e20-88fc-404d-affd-afb093f1cadb ==============================
[0m17:43:11.025652 [info ] [MainThread]: Running with dbt=1.4.8
[0m17:43:11.028654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:43:11.029652 [debug] [MainThread]: Tracking: tracking
[0m17:43:11.044653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8DB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA65AAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9224950>]}
[0m17:43:11.058655 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m17:43:11.209655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m17:43:11.210653 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m17:43:11.211655 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m17:43:11.212651 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m17:43:11.213656 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:11.230658 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m17:43:11.249235 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m17:43:11.253241 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m17:43:11.257247 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:11.282268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8B30C10>]}
[0m17:43:11.289233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8D2EDD0>]}
[0m17:43:11.289233 [info ] [MainThread]: Found 10 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:43:11.290234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA28C9B10>]}
[0m17:43:11.291233 [info ] [MainThread]: 
[0m17:43:11.293237 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:43:11.296233 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m17:43:11.306234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:11.930206 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m17:43:11.980217 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:11.983209 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m17:43:11.987205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:12.568930 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m17:43:12.629229 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:12.633227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9695350>]}
[0m17:43:12.634228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:12.635234 [info ] [MainThread]: 
[0m17:43:12.641249 [debug] [Thread-1 (]: Began running node model.travelata.my_first_dbt_model
[0m17:43:12.641249 [info ] [Thread-1 (]: 1 of 10 START sql table model travelata.my_first_dbt_model ..................... [RUN]
[0m17:43:12.642247 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m17:43:12.642247 [debug] [Thread-1 (]: Began compiling node model.travelata.my_first_dbt_model
[0m17:43:12.645228 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m17:43:12.646227 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 17:43:12.643236 => 2023-10-02 17:43:12.646227
[0m17:43:12.647228 [debug] [Thread-1 (]: Began executing node model.travelata.my_first_dbt_model
[0m17:43:12.699228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:13.289280 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m17:43:13.354972 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:13.361970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m17:43:13.422517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:13.425517 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m17:43:13.426517 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m17:43:13.472106 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.477113 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m17:43:13.530099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.554099 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m17:43:13.598763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:13.600762 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 17:43:12.647228 => 2023-10-02 17:43:13.600762
[0m17:43:13.600762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA950D310>]}
[0m17:43:13.601761 [info ] [Thread-1 (]: 1 of 10 OK created sql table model travelata.my_first_dbt_model ................ [[32mOK[0m in 0.96s]
[0m17:43:13.602763 [debug] [Thread-1 (]: Finished running node model.travelata.my_first_dbt_model
[0m17:43:13.603762 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.603762 [info ] [Thread-1 (]: 2 of 10 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m17:43:13.604763 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m17:43:13.605762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m17:43:13.605762 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.606762 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m17:43:13.607762 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 17:43:13.605762 => 2023-10-02 17:43:13.607762
[0m17:43:13.608762 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.619762 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_events
[0m17:43:13.624762 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m17:43:13.625763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m17:43:13.671696 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )
[0m17:43:13.671696 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 17:43:13.608762 => 2023-10-02 17:43:13.671696
[0m17:43:13.680698 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m17:43:13.680698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8DB67D0>]}
[0m17:43:13.681843 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.08s]
[0m17:43:13.682347 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.682897 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.683419 [info ] [Thread-1 (]: 3 of 10 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m17:43:13.683934 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m17:43:13.684461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m17:43:13.684977 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.686545 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m17:43:13.687586 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 17:43:13.684977 => 2023-10-02 17:43:13.687586
[0m17:43:13.688119 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.690091 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_install
[0m17:43:13.691125 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m17:43:13.692321 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m17:43:13.739663 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )
[0m17:43:13.740184 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 17:43:13.688119 => 2023-10-02 17:43:13.740184
[0m17:43:13.742775 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m17:43:13.743363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9B7AED0>]}
[0m17:43:13.743867 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.06s]
[0m17:43:13.744388 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.744915 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.745435 [info ] [Thread-1 (]: 4 of 10 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m17:43:13.745961 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m17:43:13.746478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m17:43:13.746478 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.748032 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m17:43:13.749066 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 17:43:13.746997 => 2023-10-02 17:43:13.749066
[0m17:43:13.749066 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.751715 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_profiles
[0m17:43:13.753834 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m17:43:13.754894 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m17:43:13.809502 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )
[0m17:43:13.810022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 17:43:13.749584 => 2023-10-02 17:43:13.810022
[0m17:43:13.812101 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m17:43:13.812620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9AE10D0>]}
[0m17:43:13.813138 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.07s]
[0m17:43:13.813671 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.814190 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.814190 [info ] [Thread-1 (]: 5 of 10 START sql view model travelata.normalized_sheets_utmcraft_utmresult .... [RUN]
[0m17:43:13.815232 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m17:43:13.815232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m17:43:13.815755 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.816798 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m17:43:13.817314 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-02 17:43:13.815755 => 2023-10-02 17:43:13.817314
[0m17:43:13.818320 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.821984 [debug] [Thread-1 (]: Creating new relation normalized_sheets_utmcraft_utmresult
[0m17:43:13.823038 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m17:43:13.824091 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult 
  
  as (
    select

	JSONExtractString(_airbyte_data, 'id') as id,

	JSONExtractString(_airbyte_data, 'created_at') as created_at,

	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	JSONExtractString(_airbyte_data, 'data') as data,

	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,

	JSONExtractString(_airbyte_data, 'form_id') as form_id,

	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,

	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata._airbyte_raw_sheets_default_travelatautmcraft_normalize_utmcraft_utmresult' as __table_name 

	from travelata.`_airbyte_raw_normalize_utmcraft_utmresult`) x
  )...
[0m17:43:13.878409 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult 
  
  as (
    select

	JSONExtractString(_airbyte_data, 'id') as id,

	JSONExtractString(_airbyte_data, 'created_at') as created_at,

	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	JSONExtractString(_airbyte_data, 'data') as data,

	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,

	JSONExtractString(_airbyte_data, 'form_id') as form_id,

	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,

	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata._airbyte_raw_sheets_default_travelatautmcraft_normalize_utmcraft_utmresult' as __table_name 

	from travelata.`_airbyte_raw_normalize_utmcraft_utmresult`) x
  )
[0m17:43:13.878959 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-02 17:43:13.818320 => 2023-10-02 17:43:13.878959
[0m17:43:13.880518 [debug] [Thread-1 (]: Database Error in model normalized_sheets_utmcraft_utmresult (models\1_normalize\normalized_sheets_utmcraft_utmresult.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 44. DB::Exception: Cannot add column utm_hashcode: column with this name already exists. (ILLEGAL_COLUMN) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:13.881517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C42810>]}
[0m17:43:13.881517 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model travelata.normalized_sheets_utmcraft_utmresult  [[31mERROR[0m in 0.07s]
[0m17:43:13.883113 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.883665 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.884192 [info ] [Thread-1 (]: 6 of 10 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m17:43:13.885244 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m17:43:13.885244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m17:43:13.885767 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.886809 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m17:43:13.888359 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-02 17:43:13.885767 => 2023-10-02 17:43:13.887844
[0m17:43:13.888359 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.890459 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.891499 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m17:43:13.892529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_ad_groups_statistics`' as __table_name 

	from travelata.`_airbyte_raw_ad_groups_statistics`) x
  )...
[0m17:43:13.942695 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.944694 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-02 17:43:13.888885 => 2023-10-02 17:43:13.944694
[0m17:43:13.945694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C32E10>]}
[0m17:43:13.945694 [info ] [Thread-1 (]: 6 of 10 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.06s]
[0m17:43:13.946695 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.946695 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.947694 [info ] [Thread-1 (]: 7 of 10 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m17:43:13.947694 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m17:43:13.948694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m17:43:13.948694 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.949695 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m17:43:13.951695 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-02 17:43:13.948694 => 2023-10-02 17:43:13.950694
[0m17:43:13.951695 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.953694 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_adplansstatistics
[0m17:43:13.954694 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m17:43:13.955694 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_ad_plans_statistics`' as __table_name 

	from travelata.`_airbyte_raw_ad_plans_statistics`) x
  )...
[0m17:43:14.001072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.003071 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-02 17:43:13.951695 => 2023-10-02 17:43:14.003071
[0m17:43:14.004071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9B7BA90>]}
[0m17:43:14.004071 [info ] [Thread-1 (]: 7 of 10 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.06s]
[0m17:43:14.005072 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:14.005072 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.006073 [info ] [Thread-1 (]: 8 of 10 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m17:43:14.006073 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m17:43:14.007073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m17:43:14.007073 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.008072 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m17:43:14.010072 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-02 17:43:14.007073 => 2023-10-02 17:43:14.010072
[0m17:43:14.010072 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.012073 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_bannersstatistics
[0m17:43:14.013071 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m17:43:14.015075 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_banners_statistics``' as __table_name 

	from travelata.`_airbyte_raw_banners_statistics`) x
  )...
[0m17:43:14.062269 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.063579 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-02 17:43:14.010072 => 2023-10-02 17:43:14.063579
[0m17:43:14.064303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8D12890>]}
[0m17:43:14.065302 [info ] [Thread-1 (]: 8 of 10 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.06s]
[0m17:43:14.065302 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.066268 [debug] [Thread-1 (]: Began running node model.travelata.test
[0m17:43:14.066268 [info ] [Thread-1 (]: 9 of 10 START sql view model travelata.test .................................... [RUN]
[0m17:43:14.067268 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.test'
[0m17:43:14.067268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.test)
[0m17:43:14.067268 [debug] [Thread-1 (]: Began compiling node model.travelata.test
[0m17:43:14.069269 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.test"
[0m17:43:14.070269 [debug] [Thread-1 (]: Timing info for model.travelata.test (compile): 2023-10-02 17:43:14.068269 => 2023-10-02 17:43:14.070269
[0m17:43:14.070269 [debug] [Thread-1 (]: Began executing node model.travelata.test
[0m17:43:14.072774 [debug] [Thread-1 (]: Creating new relation test
[0m17:43:14.073779 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.test"
[0m17:43:14.074779 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.test: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )...
[0m17:43:14.119795 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )
[0m17:43:14.120795 [debug] [Thread-1 (]: Timing info for model.travelata.test (execute): 2023-10-02 17:43:14.071268 => 2023-10-02 17:43:14.120795
[0m17:43:14.122794 [debug] [Thread-1 (]: Database Error in model test (models\1_normalize\test.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m17:43:14.123759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9AE1890>]}
[0m17:43:14.123759 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model travelata.test ........................... [[31mERROR[0m in 0.06s]
[0m17:43:14.123759 [debug] [Thread-1 (]: Finished running node model.travelata.test
[0m17:43:14.124796 [debug] [Thread-1 (]: Began running node model.travelata.my_second_dbt_model
[0m17:43:14.124796 [info ] [Thread-1 (]: 10 of 10 START sql view model travelata.my_second_dbt_model .................... [RUN]
[0m17:43:14.125795 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m17:43:14.125795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m17:43:14.126795 [debug] [Thread-1 (]: Began compiling node model.travelata.my_second_dbt_model
[0m17:43:14.128795 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m17:43:14.129795 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 17:43:14.126795 => 2023-10-02 17:43:14.129795
[0m17:43:14.129795 [debug] [Thread-1 (]: Began executing node model.travelata.my_second_dbt_model
[0m17:43:14.138912 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m17:43:14.139918 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m17:43:14.191849 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.199358 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m17:43:14.249061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.250062 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m17:43:14.300131 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.302131 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m17:43:14.348969 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.349970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m17:43:14.399735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.403737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m17:43:14.449339 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:14.451340 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 17:43:14.129795 => 2023-10-02 17:43:14.451340
[0m17:43:14.451340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C8FFD0>]}
[0m17:43:14.452340 [info ] [Thread-1 (]: 10 of 10 OK created sql view model travelata.my_second_dbt_model ............... [[32mOK[0m in 0.33s]
[0m17:43:14.452340 [debug] [Thread-1 (]: Finished running node model.travelata.my_second_dbt_model
[0m17:43:14.454340 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:43:14.454340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:14.455340 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m17:43:14.455340 [debug] [MainThread]: On list_schemas: Close
[0m17:43:14.455340 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m17:43:14.456341 [debug] [MainThread]: On list_None_travelata: Close
[0m17:43:14.456341 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m17:43:14.456341 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m17:43:14.457339 [info ] [MainThread]: 
[0m17:43:14.457339 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m17:43:14.458341 [debug] [MainThread]: Command end result
[0m17:43:14.464342 [info ] [MainThread]: 
[0m17:43:14.465341 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:43:14.466340 [info ] [MainThread]: 
[0m17:43:14.467342 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m17:43:14.467342 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.468342 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.468342 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m17:43:14.469343 [info ] [MainThread]: 
[0m17:43:14.470344 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m17:43:14.470344 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.471345 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.472342 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m17:43:14.473344 [info ] [MainThread]: 
[0m17:43:14.473344 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m17:43:14.474344 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.475343 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.475343 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m17:43:14.476343 [info ] [MainThread]: 
[0m17:43:14.477343 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_utmcraft_utmresult (models\1_normalize\normalized_sheets_utmcraft_utmresult.sql)[0m
[0m17:43:14.477343 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m17:43:14.478344 [error] [MainThread]:    Code: 44. DB::Exception: Cannot add column utm_hashcode: column with this name already exists. (ILLEGAL_COLUMN) (version 23.3.13.6 (official build))
[0m17:43:14.479341 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:14.480341 [info ] [MainThread]: 
[0m17:43:14.481355 [error] [MainThread]: [33mDatabase Error in model test (models\1_normalize\test.sql)[0m
[0m17:43:14.482343 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m17:43:14.483344 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m17:43:14.484345 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m17:43:14.486347 [info ] [MainThread]: 
[0m17:43:14.487348 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=5 SKIP=0 TOTAL=10
[0m17:43:14.490348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8CFCD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8E05610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8A5E710>]}
[0m17:43:14.491342 [debug] [MainThread]: Flushing usage events


============================== 2023-10-04 10:57:13.532790 | 3342ba5a-f8eb-427e-9749-fffbdde5af3e ==============================
[0m10:57:13.532790 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:57:13.532790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:57:13.532790 [debug] [MainThread]: Tracking: tracking
[0m10:57:13.548409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9EE0>]}
[0m10:57:13.564965 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:57:13.673615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:13.673615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:13.673615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m10:57:13.673615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC5A6DEE0>]}
[0m10:57:13.701087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC59B2B20>]}
[0m10:57:13.701087 [info ] [MainThread]: Found 16 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:57:13.704603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC59B2D90>]}
[0m10:57:13.704603 [info ] [MainThread]: 
[0m10:57:13.710583 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:57:13.710583 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:57:13.724326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:23.005668 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000025DC6D4F940>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:57:32.113061 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:57:32.113061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:32.113061 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:57:32.113061 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:57:32.113061 [info ] [MainThread]: 
[0m10:57:32.113061 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 18.40 seconds (18.40s).
[0m10:57:32.121049 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000025DC6D4FD30>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:57:32.124066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC5981130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6D4FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6D4FF10>]}
[0m10:57:32.124066 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:51:33.451056 | 84e9acef-1223-43c1-bd0f-8fc7e4ed9539 ==============================
[0m06:51:33.451056 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:51:33.453058 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:51:33.454057 [debug] [MainThread]: Tracking: tracking
[0m06:51:33.466059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9EE0>]}
[0m06:51:33.483056 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:51:33.590001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:33.590001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:33.592019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:51:33.602012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127013EFD0>]}
[0m06:51:33.614012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127010B0D0>]}
[0m06:51:33.615016 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:51:33.616018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127010B1C0>]}
[0m06:51:33.618008 [info ] [MainThread]: 
[0m06:51:33.621015 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:51:33.624029 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:51:33.644555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:35.656470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:51:35.707009 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:51:35.713008 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:51:35.721015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:36.316804 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:51:36.373474 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:51:36.385472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212701582E0>]}
[0m06:51:36.386470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:51:36.387471 [info ] [MainThread]: 
[0m06:51:36.395054 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.395054 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:51:36.397051 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:51:36.397051 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.402049 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:51:36.404055 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:51:36.398055 => 2023-10-05 06:51:36.403053
[0m06:51:36.404055 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.507923 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:51:37.137074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y')) AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:51:37.189195 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y')) AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:51:37.190200 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:51:36.405052 => 2023-10-05 06:51:37.190200
[0m06:51:37.201510 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 533 (')') (line 21, col 5): )
          . Unmatched parentheses: ). (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m06:51:37.202512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127142FC40>]}
[0m06:51:37.203515 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.81s]
[0m06:51:37.206512 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:37.209510 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:51:37.210509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:37.210509 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:51:37.211509 [debug] [MainThread]: On list_schemas: Close
[0m06:51:37.211509 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:51:37.211509 [debug] [MainThread]: On list_None_travelata: Close
[0m06:51:37.212512 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:51:37.212512 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:51:37.213511 [info ] [MainThread]: 
[0m06:51:37.213511 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m06:51:37.214512 [debug] [MainThread]: Command end result
[0m06:51:37.224514 [info ] [MainThread]: 
[0m06:51:37.225515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:51:37.226515 [info ] [MainThread]: 
[0m06:51:37.227515 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:51:37.228512 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m06:51:37.229513 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 533 (')') (line 21, col 5): )
[0m06:51:37.230512 [error] [MainThread]:           . Unmatched parentheses: ). (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m06:51:37.231513 [info ] [MainThread]: 
[0m06:51:37.231513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:51:37.233525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212701582E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212714C13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127012D910>]}
[0m06:51:37.234511 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:52:01.824682 | 0f428723-f7f1-43c6-942a-ea298885d33a ==============================
[0m06:52:01.824682 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:52:01.827557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:52:01.827557 [debug] [MainThread]: Tracking: tracking
[0m06:52:01.843119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79F70>]}
[0m06:52:01.870684 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:52:01.996037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:52:01.997026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:52:01.999025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:52:02.012035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF30E0D0>]}
[0m06:52:02.025026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2DB100>]}
[0m06:52:02.026029 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:52:02.028024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2DB1F0>]}
[0m06:52:02.030019 [info ] [MainThread]: 
[0m06:52:02.033030 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:52:02.034034 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:52:02.053023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:03.457041 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:52:03.507914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:52:03.512914 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:52:03.521914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:04.126789 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:52:04.189149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:52:04.198679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF328310>]}
[0m06:52:04.200679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:52:04.201676 [info ] [MainThread]: 
[0m06:52:04.211227 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.213226 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:52:04.216226 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:52:04.217229 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.224923 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:52:04.227928 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:52:04.218225 => 2023-10-05 06:52:04.227928
[0m06:52:04.229919 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.372271 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:52:04.956663 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:52:05.023590 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:52:05.024586 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:52:04.231442 => 2023-10-05 06:52:05.024586
[0m06:52:05.034118 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:52:05.035119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E805EFEB0>]}
[0m06:52:05.036117 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.82s]
[0m06:52:05.039116 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:05.040663 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:52:05.041676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:52:05.042676 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:52:05.043677 [debug] [MainThread]: On list_schemas: Close
[0m06:52:05.043677 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:52:05.044671 [debug] [MainThread]: On list_None_travelata: Close
[0m06:52:05.044671 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:52:05.045674 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:52:05.046675 [info ] [MainThread]: 
[0m06:52:05.048679 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m06:52:05.050675 [debug] [MainThread]: Command end result
[0m06:52:05.061945 [info ] [MainThread]: 
[0m06:52:05.062953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:52:05.064946 [info ] [MainThread]: 
[0m06:52:05.066946 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:52:05.067944 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m06:52:05.069950 [error] [MainThread]:    Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:52:05.071971 [info ] [MainThread]: 
[0m06:52:05.074016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:52:05.075029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2FDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF328310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E806EDFA0>]}
[0m06:52:05.076028 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:53:46.109938 | 9a1c51fc-24dc-4cdc-917b-9da3e0a875eb ==============================
[0m06:53:46.109938 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:53:46.111942 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['incremental_sheets_appmetrica_events'], 'which': 'test', 'rpc_method': 'test'}
[0m06:53:46.111942 [debug] [MainThread]: Tracking: tracking
[0m06:53:46.127279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCC4DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCC4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCD45B0>]}
[0m06:53:46.148781 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:53:46.285321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:46.285321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:46.287310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:53:46.296307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89CDE0D0>]}
[0m06:53:46.309317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A250>]}
[0m06:53:46.310315 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:53:46.311311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A4C0>]}
[0m06:53:46.312313 [info ] [MainThread]: 
[0m06:53:46.314317 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:53:46.316312 [debug] [MainThread]: Command end result
[0m06:53:46.330332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A1C0>]}
[0m06:53:46.331331 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:53:56.364768 | 59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc ==============================
[0m06:53:56.364768 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:53:56.366765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:53:56.367766 [debug] [MainThread]: Tracking: tracking
[0m06:53:56.378765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559EE0>]}
[0m06:53:56.396770 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:53:56.504160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:56.505160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:56.506158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:53:56.518155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218DEFD0>]}
[0m06:53:56.530159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218080D0>]}
[0m06:53:56.531168 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:53:56.532164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218081C0>]}
[0m06:53:56.535162 [info ] [MainThread]: 
[0m06:53:56.539178 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:53:56.541180 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:53:56.557706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:57.827035 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:53:57.877592 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:53:57.882596 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:53:57.891589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:58.486948 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:53:58.540085 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:53:58.552080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218F92E0>]}
[0m06:53:58.553594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:58.554126 [info ] [MainThread]: 
[0m06:53:58.561162 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.561162 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:53:58.563156 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:53:58.564153 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.569162 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:53:58.570159 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:53:58.564153 => 2023-10-05 06:53:58.570159
[0m06:53:58.571151 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.690868 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:53:59.316242 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:53:59.377543 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:53:59.378541 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:53:58.572163 => 2023-10-05 06:53:59.378541
[0m06:53:59.385192 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:53:59.386211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122D0C9A0>]}
[0m06:53:59.387210 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.82s]
[0m06:53:59.390205 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:59.393211 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:53:59.394205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:59.395218 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:53:59.396210 [debug] [MainThread]: On list_schemas: Close
[0m06:53:59.396210 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:53:59.397213 [debug] [MainThread]: On list_None_travelata: Close
[0m06:53:59.398212 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:53:59.399210 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:53:59.399210 [info ] [MainThread]: 
[0m06:53:59.401209 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m06:53:59.403219 [debug] [MainThread]: Command end result
[0m06:53:59.412210 [info ] [MainThread]: 
[0m06:53:59.414212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:53:59.416213 [info ] [MainThread]: 
[0m06:53:59.417208 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:53:59.418209 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m06:53:59.419216 [error] [MainThread]:    Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:53:59.421211 [info ] [MainThread]: 
[0m06:53:59.423209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:53:59.424209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122C80880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218A2F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218CD910>]}
[0m06:53:59.424209 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:57:31.627371 | c6770c30-dfd0-48f3-8ecd-922446683774 ==============================
[0m06:57:31.627371 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:57:31.630366 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:57:31.631372 [debug] [MainThread]: Tracking: tracking
[0m06:57:31.643383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219E80>]}
[0m06:57:31.660895 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:57:31.771737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:57:31.771737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:57:31.772744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:57:31.783258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E859EFA0>]}
[0m06:57:31.795265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E856B0A0>]}
[0m06:57:31.796277 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:57:31.798265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E856B190>]}
[0m06:57:31.804268 [info ] [MainThread]: 
[0m06:57:31.809797 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:57:31.813886 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:57:31.829928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:33.136265 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:57:33.187860 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:33.192861 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:57:33.201867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:33.786500 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:57:33.839300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:33.851806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E85B84C0>]}
[0m06:57:33.852810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:57:33.853809 [info ] [MainThread]: 
[0m06:57:33.861066 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.861066 [info ] [Thread-1  ]: 1 of 17 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m06:57:33.863067 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m06:57:33.864071 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.866064 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m06:57:33.868075 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 06:57:33.864071 => 2023-10-05 06:57:33.867063
[0m06:57:33.868075 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.925076 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m06:57:33.926081 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:57:34.506253 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m06:57:34.566419 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:34.577578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m06:57:34.626378 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.628378 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m06:57:34.676751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.681752 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m06:57:34.735872 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.737874 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m06:57:34.786459 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.826025 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m06:57:34.876208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.878216 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 06:57:33.869068 => 2023-10-05 06:57:34.878216
[0m06:57:34.880211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3EB0>]}
[0m06:57:34.881212 [info ] [Thread-1  ]: 1 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m06:57:34.884210 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:34.885219 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.886207 [info ] [Thread-1  ]: 2 of 17 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m06:57:34.888203 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m06:57:34.889207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m06:57:34.889207 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.892749 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m06:57:34.894750 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 06:57:34.890207 => 2023-10-05 06:57:34.894750
[0m06:57:34.895753 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.902866 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m06:57:34.904749 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m06:57:34.963428 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:34.968432 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m06:57:35.015990 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.018002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m06:57:35.065979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.070502 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m06:57:35.126572 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.127567 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m06:57:35.186132 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.193646 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m06:57:35.246706 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.249265 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 06:57:34.895753 => 2023-10-05 06:57:35.249265
[0m06:57:35.251289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3DF0>]}
[0m06:57:35.252283 [info ] [Thread-1  ]: 2 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m06:57:35.254288 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:35.255286 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.256302 [info ] [Thread-1  ]: 3 of 17 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m06:57:35.258291 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m06:57:35.259294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m06:57:35.260287 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.263306 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m06:57:35.266280 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 06:57:35.260287 => 2023-10-05 06:57:35.265285
[0m06:57:35.267297 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.278844 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m06:57:35.281838 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m06:57:35.344435 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.350060 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m06:57:35.397090 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.399099 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m06:57:35.456736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.462304 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m06:57:35.527273 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.529274 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m06:57:35.577056 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.588646 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m06:57:35.636446 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.639449 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 06:57:35.268290 => 2023-10-05 06:57:35.639449
[0m06:57:35.641456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3EB0>]}
[0m06:57:35.642450 [info ] [Thread-1  ]: 3 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.38s]
[0m06:57:35.644450 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.645449 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.646448 [info ] [Thread-1  ]: 4 of 17 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m06:57:35.648453 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m06:57:35.650135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m06:57:35.650999 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.654998 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m06:57:35.656566 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 06:57:35.650999 => 2023-10-05 06:57:35.656566
[0m06:57:35.657544 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.669549 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m06:57:35.671543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m06:57:35.732724 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.738731 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m06:57:35.796555 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.798557 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m06:57:35.847151 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.852689 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m06:57:35.906012 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.908005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m06:57:35.956290 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.964287 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m06:57:36.016375 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.018375 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 06:57:35.658545 => 2023-10-05 06:57:36.018375
[0m06:57:36.020378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AAC850>]}
[0m06:57:36.021375 [info ] [Thread-1  ]: 4 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.37s]
[0m06:57:36.022377 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:36.023372 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.024372 [info ] [Thread-1  ]: 5 of 17 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m06:57:36.026380 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m06:57:36.026380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m06:57:36.027370 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.030370 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m06:57:36.032372 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 06:57:36.027370 => 2023-10-05 06:57:36.032372
[0m06:57:36.032372 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.038381 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m06:57:36.040389 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m06:57:36.101201 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.105051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m06:57:36.166235 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.169236 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m06:57:36.216328 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.222323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m06:57:36.276261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.278263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m06:57:36.325868 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.332855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m06:57:36.387084 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.389080 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 06:57:36.033375 => 2023-10-05 06:57:36.389080
[0m06:57:36.390088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AE0A90>]}
[0m06:57:36.391089 [info ] [Thread-1  ]: 5 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m06:57:36.393086 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.393086 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.394084 [info ] [Thread-1  ]: 6 of 17 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m06:57:36.396081 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m06:57:36.397084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m06:57:36.397084 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.400090 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m06:57:36.401081 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 06:57:36.398087 => 2023-10-05 06:57:36.401081
[0m06:57:36.402082 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.409083 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m06:57:36.411089 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m06:57:36.459648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.465653 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m06:57:36.526262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.528263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m06:57:36.576138 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.581127 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m06:57:36.626223 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:36.628217 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m06:57:36.687158 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.695171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m06:57:36.746692 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.748686 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 06:57:36.402082 => 2023-10-05 06:57:36.748686
[0m06:57:36.750199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3D60>]}
[0m06:57:36.751208 [info ] [Thread-1  ]: 6 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.35s]
[0m06:57:36.752212 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.753216 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.754460 [info ] [Thread-1  ]: 7 of 17 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m06:57:36.756215 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m06:57:36.756215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m06:57:36.757210 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.759207 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m06:57:36.760211 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 06:57:36.757210 => 2023-10-05 06:57:36.760211
[0m06:57:36.761220 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.766734 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m06:57:36.767733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m06:57:36.819581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.825585 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m06:57:36.876244 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.878244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m06:57:36.926420 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.931415 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m06:57:36.976787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:36.978785 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m06:57:37.036012 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.043003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m06:57:37.096124 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.099115 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 06:57:36.761220 => 2023-10-05 06:57:37.099115
[0m06:57:37.100122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9A91310>]}
[0m06:57:37.101116 [info ] [Thread-1  ]: 7 of 17 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.34s]
[0m06:57:37.103126 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:37.104125 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.105122 [info ] [Thread-1  ]: 8 of 17 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m06:57:37.107121 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m06:57:37.108120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m06:57:37.108120 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.111123 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m06:57:37.112118 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 06:57:37.109123 => 2023-10-05 06:57:37.112118
[0m06:57:37.113121 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.123120 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m06:57:37.125641 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m06:57:37.181786 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.186777 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m06:57:37.236952 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.238952 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m06:57:37.287112 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.292109 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m06:57:37.336723 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:37.337718 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m06:57:37.386271 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.393266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m06:57:37.447257 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.449251 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 06:57:37.113121 => 2023-10-05 06:57:37.449251
[0m06:57:37.450256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9A26370>]}
[0m06:57:37.451322 [info ] [Thread-1  ]: 8 of 17 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.34s]
[0m06:57:37.453325 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.453325 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.454318 [info ] [Thread-1  ]: 9 of 17 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m06:57:37.456323 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m06:57:37.457323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m06:57:37.457323 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.460321 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m06:57:37.462323 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 06:57:37.458323 => 2023-10-05 06:57:37.461320
[0m06:57:37.462323 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.469327 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m06:57:37.471322 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m06:57:37.531063 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.536074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m06:57:37.596001 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.598001 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m06:57:37.646147 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.650647 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m06:57:37.705593 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.707601 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m06:57:37.756715 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.763711 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m06:57:37.816867 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.818857 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 06:57:37.463332 => 2023-10-05 06:57:37.818857
[0m06:57:37.821376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9ACBBB0>]}
[0m06:57:37.821376 [info ] [Thread-1  ]: 9 of 17 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.36s]
[0m06:57:37.823379 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.824378 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.825375 [info ] [Thread-1  ]: 10 of 17 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m06:57:37.827377 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m06:57:37.827377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m06:57:37.828371 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.830372 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m06:57:37.831377 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 06:57:37.828371 => 2023-10-05 06:57:37.831377
[0m06:57:37.832375 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.839378 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m06:57:37.840385 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m06:57:37.891896 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.895895 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m06:57:37.946409 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.947404 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m06:57:38.005916 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.010915 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m06:57:38.056453 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:38.058452 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m06:57:38.106118 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.113116 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m06:57:38.166633 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.168632 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 06:57:37.832375 => 2023-10-05 06:57:38.168632
[0m06:57:38.170635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AEDF70>]}
[0m06:57:38.171633 [info ] [Thread-1  ]: 10 of 17 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.34s]
[0m06:57:38.172630 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:38.173633 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.174627 [info ] [Thread-1  ]: 11 of 17 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m06:57:38.176631 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m06:57:38.176631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m06:57:38.177627 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.179628 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m06:57:38.181630 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 06:57:38.177627 => 2023-10-05 06:57:38.181630
[0m06:57:38.181630 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.188636 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m06:57:38.189628 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m06:57:38.242524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.246533 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m06:57:38.296080 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.299070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m06:57:38.346193 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.351690 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m06:57:38.395740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:38.397729 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m06:57:38.445677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.453194 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m06:57:38.507261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.509256 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 06:57:38.182632 => 2023-10-05 06:57:38.509256
[0m06:57:38.511265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B1A8E0>]}
[0m06:57:38.512263 [info ] [Thread-1  ]: 11 of 17 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.34s]
[0m06:57:38.513258 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.514257 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.515263 [info ] [Thread-1  ]: 12 of 17 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m06:57:38.517264 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m06:57:38.517264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m06:57:38.518262 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.521256 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m06:57:38.523260 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 06:57:38.518262 => 2023-10-05 06:57:38.523260
[0m06:57:38.523260 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.531264 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m06:57:38.532262 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m06:57:38.603294 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:57:38.608291 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m06:57:38.666411 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.668412 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m06:57:38.725857 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.731852 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m06:57:38.796262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.798260 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m06:57:38.846402 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.852924 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m06:57:38.915935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.918944 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 06:57:38.524263 => 2023-10-05 06:57:38.918944
[0m06:57:38.919940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AD85E0>]}
[0m06:57:38.920939 [info ] [Thread-1  ]: 12 of 17 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.40s]
[0m06:57:38.921937 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.922942 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.923939 [info ] [Thread-1  ]: 13 of 17 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m06:57:38.925940 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m06:57:38.926938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m06:57:38.926938 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.929945 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m06:57:38.930955 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 06:57:38.927939 => 2023-10-05 06:57:38.930955
[0m06:57:38.931952 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.938971 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m06:57:38.940972 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m06:57:39.004020 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.008015 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m06:57:39.056545 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.058546 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m06:57:39.106607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.111600 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m06:57:39.155962 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.157951 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m06:57:39.216831 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.222830 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m06:57:39.276274 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.279266 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 06:57:38.931952 => 2023-10-05 06:57:39.278270
[0m06:57:39.280268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B25610>]}
[0m06:57:39.281270 [info ] [Thread-1  ]: 13 of 17 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.36s]
[0m06:57:39.282264 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:39.283268 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.284264 [info ] [Thread-1  ]: 14 of 17 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m06:57:39.286268 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m06:57:39.286268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m06:57:39.287265 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.289263 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m06:57:39.290265 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 06:57:39.287265 => 2023-10-05 06:57:39.290265
[0m06:57:39.291268 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.302274 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m06:57:39.304267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m06:57:39.361386 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.366384 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m06:57:39.426042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.428042 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m06:57:39.476028 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.481681 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m06:57:39.525821 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.527820 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m06:57:39.576607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.583605 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m06:57:39.635997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.639001 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 06:57:39.291268 => 2023-10-05 06:57:39.639001
[0m06:57:39.640009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B255B0>]}
[0m06:57:39.641008 [info ] [Thread-1  ]: 14 of 17 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m06:57:39.643008 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.644008 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.644008 [info ] [Thread-1  ]: 15 of 17 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m06:57:39.646008 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m06:57:39.647006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m06:57:39.647006 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.650006 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m06:57:39.652009 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 06:57:39.648005 => 2023-10-05 06:57:39.652009
[0m06:57:39.652526 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.660545 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m06:57:39.662542 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m06:57:39.731108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:57:39.737099 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m06:57:39.796296 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.798295 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m06:57:39.856123 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.861122 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m06:57:39.906269 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.908261 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m06:57:39.966557 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.972552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m06:57:40.026019 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.029020 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 06:57:39.653547 => 2023-10-05 06:57:40.029020
[0m06:57:40.030026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EAB496D0>]}
[0m06:57:40.031024 [info ] [Thread-1  ]: 15 of 17 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.38s]
[0m06:57:40.033021 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:40.033021 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.034019 [info ] [Thread-1  ]: 16 of 17 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m06:57:40.036014 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m06:57:40.037012 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m06:57:40.037012 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.040020 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m06:57:40.041024 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 06:57:40.038020 => 2023-10-05 06:57:40.041024
[0m06:57:40.042025 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.049027 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m06:57:40.052026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m06:57:40.100877 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.105879 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m06:57:40.166471 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.168471 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m06:57:40.216785 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.221779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m06:57:40.276265 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.278265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m06:57:40.326275 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.333273 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m06:57:40.386685 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.388680 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 06:57:40.043026 => 2023-10-05 06:57:40.388680
[0m06:57:40.389685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99DD7C0>]}
[0m06:57:40.390686 [info ] [Thread-1  ]: 16 of 17 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.35s]
[0m06:57:40.392677 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.393677 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.394676 [info ] [Thread-1  ]: 17 of 17 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m06:57:40.395675 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m06:57:40.396677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m06:57:40.397676 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.402681 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m06:57:40.404675 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 06:57:40.397676 => 2023-10-05 06:57:40.404675
[0m06:57:40.404675 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.485860 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m06:57:40.546569 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.559090 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:57:40.607490 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.614485 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m06:57:40.616492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
    ...
[0m06:57:40.676108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.684812 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 06:57:40.405688 => 2023-10-05 06:57:40.684812
[0m06:57:40.685825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AF3A00>]}
[0m06:57:40.686825 [info ] [Thread-1  ]: 17 of 17 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.29s]
[0m06:57:40.688824 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.690992 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:57:40.692063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:57:40.692604 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:57:40.693144 [debug] [MainThread]: On list_schemas: Close
[0m06:57:40.693699 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:57:40.694243 [debug] [MainThread]: On list_None_travelata: Close
[0m06:57:40.694779 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_install' was left open.
[0m06:57:40.695313 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_install: Close
[0m06:57:40.695849 [info ] [MainThread]: 
[0m06:57:40.697719 [info ] [MainThread]: Finished running 16 view models, 1 incremental model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m06:57:40.699941 [debug] [MainThread]: Command end result
[0m06:57:40.710802 [info ] [MainThread]: 
[0m06:57:40.711803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:57:40.713812 [info ] [MainThread]: 
[0m06:57:40.714805 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m06:57:40.717171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99416D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9941670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B04FD0>]}
[0m06:57:40.718278 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 07:00:40.302289 | f1f6ed44-9c69-4572-a09e-c15a3eb298c3 ==============================
[0m07:00:40.302289 [info ] [MainThread]: Running with dbt=1.4.8
[0m07:00:40.304293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:00:40.305294 [debug] [MainThread]: Tracking: tracking
[0m07:00:40.316294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7EE0>]}
[0m07:00:40.334291 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m07:00:40.444134 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:00:40.445135 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.445135 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\2_incremental\incremental.sql
[0m07:00:40.474141 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.498216 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.507218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m07:00:40.516217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200882FB0D0>]}
[0m07:00:40.529233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200881C9670>]}
[0m07:00:40.530224 [info ] [MainThread]: Found 18 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:00:40.531223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020088222D00>]}
[0m07:00:40.534225 [info ] [MainThread]: 
[0m07:00:40.539216 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:00:40.542215 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m07:00:40.559221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:41.885217 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m07:00:41.937181 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:41.942165 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m07:00:41.950167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:42.535904 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m07:00:42.588621 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:42.600623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200882F0370>]}
[0m07:00:42.601632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:42.602629 [info ] [MainThread]: 
[0m07:00:42.620616 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.621619 [info ] [Thread-1  ]: 1 of 18 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m07:00:42.624629 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m07:00:42.625622 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.630628 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:00:42.632628 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 07:00:42.626625 => 2023-10-05 07:00:42.632628
[0m07:00:42.633628 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.698708 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:00:42.699715 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:00:43.265889 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m07:00:43.320492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.331491 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:00:43.376882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.378885 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:00:43.426279 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:43.431276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:00:43.485753 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.487752 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:00:43.535364 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.573883 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m07:00:43.636138 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:43.638131 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 07:00:42.634621 => 2023-10-05 07:00:43.638131
[0m07:00:43.639135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008971AAC0>]}
[0m07:00:43.639135 [info ] [Thread-1  ]: 1 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m07:00:43.643137 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:43.644137 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.645136 [info ] [Thread-1  ]: 2 of 18 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m07:00:43.646136 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m07:00:43.647142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m07:00:43.648140 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.650652 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:00:43.651666 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 07:00:43.648140 => 2023-10-05 07:00:43.651666
[0m07:00:43.652664 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.662664 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:00:43.663660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m07:00:43.730293 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:43.735289 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:00:43.786502 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.788496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:00:43.835772 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.841765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:00:43.895768 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.898770 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:00:43.945768 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.953765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m07:00:44.006211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.008212 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 07:00:43.653664 => 2023-10-05 07:00:44.008212
[0m07:00:44.010213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089715BE0>]}
[0m07:00:44.010213 [info ] [Thread-1  ]: 2 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m07:00:44.012161 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:44.013178 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.013178 [info ] [Thread-1  ]: 3 of 18 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m07:00:44.016174 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m07:00:44.016174 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m07:00:44.017172 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.019169 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:00:44.020170 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 07:00:44.017172 => 2023-10-05 07:00:44.020170
[0m07:00:44.021172 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.027172 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:00:44.029186 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m07:00:44.083262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.087266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:00:44.135609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.137609 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:00:44.185444 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.191432 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:00:44.255707 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.258713 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:00:44.316382 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.323377 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m07:00:44.386365 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.388355 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 07:00:44.021172 => 2023-10-05 07:00:44.388355
[0m07:00:44.389361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089688EB0>]}
[0m07:00:44.390360 [info ] [Thread-1  ]: 3 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.37s]
[0m07:00:44.392358 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.393360 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.394360 [info ] [Thread-1  ]: 4 of 18 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m07:00:44.395361 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m07:00:44.396360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m07:00:44.397515 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.399376 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:00:44.401364 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 07:00:44.397515 => 2023-10-05 07:00:44.401364
[0m07:00:44.402364 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.409901 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:00:44.411900 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m07:00:44.469863 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.475863 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:00:44.525810 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.527797 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:00:44.576202 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.582804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:00:44.635977 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.637980 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:00:44.695629 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.702617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m07:00:44.756021 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.758023 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 07:00:44.403364 => 2023-10-05 07:00:44.758023
[0m07:00:44.759017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089794820>]}
[0m07:00:44.760018 [info ] [Thread-1  ]: 4 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.36s]
[0m07:00:44.761018 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.762022 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.763023 [info ] [Thread-1  ]: 5 of 18 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m07:00:44.764019 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m07:00:44.765536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m07:00:44.765536 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.768545 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:00:44.769545 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 07:00:44.766549 => 2023-10-05 07:00:44.769545
[0m07:00:44.770549 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.779551 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:00:44.781065 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m07:00:44.830777 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.836780 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:00:44.885142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.888133 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:00:44.936218 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.941213 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:00:44.995296 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.997293 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:00:45.055320 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.062316 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m07:00:45.118451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.120450 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 07:00:44.771558 => 2023-10-05 07:00:45.120450
[0m07:00:45.121451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895B18B0>]}
[0m07:00:45.122451 [info ] [Thread-1  ]: 5 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m07:00:45.124454 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:45.124454 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.125449 [info ] [Thread-1  ]: 6 of 18 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m07:00:45.127454 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m07:00:45.128451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m07:00:45.128451 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.131459 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:00:45.133469 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 07:00:45.129450 => 2023-10-05 07:00:45.133469
[0m07:00:45.135452 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.145445 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:00:45.146449 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m07:00:45.199765 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.204767 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:00:45.256030 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.258024 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:00:45.305727 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.310721 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:00:45.355836 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:45.357829 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:00:45.405892 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.413890 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m07:00:45.466056 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.468063 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 07:00:45.135452 => 2023-10-05 07:00:45.468063
[0m07:00:45.470069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200897D2340>]}
[0m07:00:45.470069 [info ] [Thread-1  ]: 6 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.34s]
[0m07:00:45.472067 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.472067 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.473067 [info ] [Thread-1  ]: 7 of 18 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m07:00:45.475070 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m07:00:45.476067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m07:00:45.477071 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.481575 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:00:45.482587 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 07:00:45.477071 => 2023-10-05 07:00:45.482587
[0m07:00:45.482587 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.489101 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:00:45.490104 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m07:00:45.542274 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.546265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:00:45.596792 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.598788 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:00:45.645866 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.650865 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:00:45.705558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.707554 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:00:45.765632 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.772147 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m07:00:45.835653 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.838647 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 07:00:45.483590 => 2023-10-05 07:00:45.838647
[0m07:00:45.839651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200897A7FD0>]}
[0m07:00:45.840654 [info ] [Thread-1  ]: 7 of 18 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.36s]
[0m07:00:45.842655 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.843654 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.844652 [info ] [Thread-1  ]: 8 of 18 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m07:00:45.845654 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m07:00:45.846648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m07:00:45.847651 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.849648 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:00:45.851652 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 07:00:45.847651 => 2023-10-05 07:00:45.851652
[0m07:00:45.851652 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.858661 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:00:45.860660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m07:00:45.920086 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.924082 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:00:45.976168 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.978166 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:00:46.035441 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.040435 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:00:46.096042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.098035 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:00:46.156049 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.165042 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m07:00:46.215569 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.217582 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 07:00:45.852652 => 2023-10-05 07:00:46.217582
[0m07:00:46.219575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008966BDF0>]}
[0m07:00:46.219575 [info ] [Thread-1  ]: 8 of 18 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.37s]
[0m07:00:46.221574 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:46.222575 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.222575 [info ] [Thread-1  ]: 9 of 18 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m07:00:46.224570 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m07:00:46.225572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m07:00:46.225572 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.228572 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:00:46.229571 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 07:00:46.226574 => 2023-10-05 07:00:46.229571
[0m07:00:46.230570 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.236568 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:00:46.238570 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m07:00:46.290095 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.294096 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:00:46.346300 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.348298 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:00:46.395523 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.400520 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:00:46.445407 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:46.447403 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:00:46.505264 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.513267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m07:00:46.575756 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.577751 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 07:00:46.230570 => 2023-10-05 07:00:46.577751
[0m07:00:46.579756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008966BF70>]}
[0m07:00:46.579756 [info ] [Thread-1  ]: 9 of 18 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.36s]
[0m07:00:46.582285 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.582801 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.583809 [info ] [Thread-1  ]: 10 of 18 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m07:00:46.585815 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m07:00:46.585815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m07:00:46.586809 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.589824 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:00:46.591820 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 07:00:46.587812 => 2023-10-05 07:00:46.590821
[0m07:00:46.591820 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.598813 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:00:46.600816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m07:00:46.651258 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.657261 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:00:46.705404 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.707402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:00:46.755426 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.760409 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:00:46.806446 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.808445 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:00:46.856511 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.862499 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m07:00:46.915725 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.917720 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 07:00:46.592818 => 2023-10-05 07:00:46.917720
[0m07:00:46.919727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089812E80>]}
[0m07:00:46.919727 [info ] [Thread-1  ]: 10 of 18 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.33s]
[0m07:00:46.921723 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.922725 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.922725 [info ] [Thread-1  ]: 11 of 18 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m07:00:46.924732 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m07:00:46.925727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m07:00:46.926724 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.929720 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:00:46.930728 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 07:00:46.926724 => 2023-10-05 07:00:46.930728
[0m07:00:46.930728 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.940719 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:00:46.943728 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m07:00:47.010540 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:47.015537 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:00:47.065541 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.067539 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:00:47.125155 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.130158 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:00:47.185751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.187744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:00:47.236794 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.249796 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m07:00:47.306348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.309349 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 07:00:46.931723 => 2023-10-05 07:00:47.309349
[0m07:00:47.311364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008974B2B0>]}
[0m07:00:47.313357 [info ] [Thread-1  ]: 11 of 18 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.39s]
[0m07:00:47.315353 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:47.316358 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.317356 [info ] [Thread-1  ]: 12 of 18 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m07:00:47.320346 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m07:00:47.321352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m07:00:47.322356 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.326365 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:00:47.328354 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 07:00:47.323362 => 2023-10-05 07:00:47.327353
[0m07:00:47.328354 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.343988 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:00:47.345006 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m07:00:47.401825 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.408831 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:00:47.465829 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.466825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:00:47.515936 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.520937 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:00:47.575526 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.578026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:00:47.625642 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.633632 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m07:00:47.696888 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.699875 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 07:00:47.329358 => 2023-10-05 07:00:47.699875
[0m07:00:47.701881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089772F40>]}
[0m07:00:47.701881 [info ] [Thread-1  ]: 12 of 18 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.38s]
[0m07:00:47.703882 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.704882 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.705881 [info ] [Thread-1  ]: 13 of 18 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m07:00:47.706884 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m07:00:47.707878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m07:00:47.708881 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.711885 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:00:47.712886 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 07:00:47.709883 => 2023-10-05 07:00:47.712886
[0m07:00:47.713880 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.719874 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:00:47.721875 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m07:00:47.781808 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.786322 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:00:47.835941 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.837940 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:00:47.886076 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.891074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:00:47.935082 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:47.937070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:00:47.995935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.002928 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m07:00:48.055534 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.057531 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 07:00:47.714880 => 2023-10-05 07:00:48.057531
[0m07:00:48.059533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089825790>]}
[0m07:00:48.060531 [info ] [Thread-1  ]: 13 of 18 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.35s]
[0m07:00:48.062537 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:48.062537 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.063531 [info ] [Thread-1  ]: 14 of 18 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m07:00:48.065539 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m07:00:48.066534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m07:00:48.067535 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.070547 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:00:48.071541 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 07:00:48.067535 => 2023-10-05 07:00:48.071541
[0m07:00:48.072547 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.149077 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:00:48.151074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m07:00:48.200136 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.206129 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:00:48.265655 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.267649 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:00:48.316191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.320188 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:00:48.366193 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:48.368188 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:00:48.415523 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.422516 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m07:00:48.475817 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.478823 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 07:00:48.073548 => 2023-10-05 07:00:48.477822
[0m07:00:48.479822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008982B490>]}
[0m07:00:48.480819 [info ] [Thread-1  ]: 14 of 18 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.41s]
[0m07:00:48.482816 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.482816 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.484326 [info ] [Thread-1  ]: 15 of 18 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m07:00:48.485337 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m07:00:48.486651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m07:00:48.486651 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.489647 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:00:48.490653 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 07:00:48.487652 => 2023-10-05 07:00:48.490653
[0m07:00:48.491654 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.498659 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:00:48.500654 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m07:00:48.549616 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.554617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:00:48.606002 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.607999 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:00:48.656100 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.660097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:00:48.705576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:48.707570 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:00:48.755882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.763737 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m07:00:48.815814 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.818814 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 07:00:48.492655 => 2023-10-05 07:00:48.818814
[0m07:00:48.819812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008979E7F0>]}
[0m07:00:48.820816 [info ] [Thread-1  ]: 15 of 18 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.33s]
[0m07:00:48.822819 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.822819 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.823816 [info ] [Thread-1  ]: 16 of 18 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m07:00:48.825819 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m07:00:48.825819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m07:00:48.826812 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.828814 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:00:48.829810 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 07:00:48.826812 => 2023-10-05 07:00:48.829810
[0m07:00:48.830815 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.838818 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:00:48.840825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m07:00:48.905142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.912143 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:00:48.966134 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.969145 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:00:49.015694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.022693 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:00:49.075702 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.077699 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:00:49.126226 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.141223 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m07:00:49.195472 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.198477 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 07:00:48.830815 => 2023-10-05 07:00:49.198477
[0m07:00:49.199474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008979EEB0>]}
[0m07:00:49.200473 [info ] [Thread-1  ]: 16 of 18 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.37s]
[0m07:00:49.202474 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m07:00:49.203475 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.204472 [info ] [Thread-1  ]: 17 of 18 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m07:00:49.206472 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m07:00:49.206472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m07:00:49.207474 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.211469 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:00:49.213472 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 07:00:49.207474 => 2023-10-05 07:00:49.213472
[0m07:00:49.213472 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.303748 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m07:00:49.365518 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.377518 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.426759 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.432756 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:00:49.435671 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
    ...
[0m07:00:49.496126 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.504121 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 07:00:49.214472 => 2023-10-05 07:00:49.504121
[0m07:00:49.505119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008967EAF0>]}
[0m07:00:49.506125 [info ] [Thread-1  ]: 17 of 18 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.30s]
[0m07:00:49.508133 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.508133 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.509132 [info ] [Thread-1  ]: 18 of 18 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m07:00:49.511120 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m07:00:49.512124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m07:00:49.512124 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.517125 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:00:49.519125 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 07:00:49.513121 => 2023-10-05 07:00:49.519125
[0m07:00:49.519125 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.540122 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 
  ...
[0m07:00:49.595970 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.598967 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m07:00:49.655472 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.660465 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.707629 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.710623 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:00:49.711625 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m07:00:49.773609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.775606 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3);
    ...
[0m07:00:49.842908 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:49.846912 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.897740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.900739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3
    ...
[0m07:00:49.971015 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:49.976531 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 
  ...
[0m07:00:50.025205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:50.030197 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m07:00:50.075999 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:50.080003 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 07:00:49.520123 => 2023-10-05 07:00:50.080003
[0m07:00:50.081000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089752A60>]}
[0m07:00:50.082001 [info ] [Thread-1  ]: 18 of 18 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.57s]
[0m07:00:50.084005 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:50.085009 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:00:50.086522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:50.087536 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m07:00:50.087536 [debug] [MainThread]: On list_schemas: Close
[0m07:00:50.088535 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m07:00:50.088535 [debug] [MainThread]: On list_None_travelata: Close
[0m07:00:50.088535 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_install' was left open.
[0m07:00:50.089533 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_install: Close
[0m07:00:50.090532 [info ] [MainThread]: 
[0m07:00:50.091534 [info ] [MainThread]: Finished running 16 view models, 2 incremental models in 0 hours 0 minutes and 9.55 seconds (9.55s).
[0m07:00:50.093545 [debug] [MainThread]: Command end result
[0m07:00:50.104533 [info ] [MainThread]: 
[0m07:00:50.105536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:50.106536 [info ] [MainThread]: 
[0m07:00:50.107538 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m07:00:50.109540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200881C95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895EBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895B1970>]}
[0m07:00:50.110534 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 07:02:29.483062 | e61ab7fe-9fdd-485e-a10a-fc6279de8ba4 ==============================
[0m07:02:29.483062 [info ] [MainThread]: Running with dbt=1.4.8
[0m07:02:29.485067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:02:29.486575 [debug] [MainThread]: Tracking: tracking
[0m07:02:29.498111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412A160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412A130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412AEE0>]}
[0m07:02:29.517122 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m07:02:29.632260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:29.632260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:29.634262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m07:02:29.646255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166874AE0D0>]}
[0m07:02:29.658261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166873F66D0>]}
[0m07:02:29.659260 [info ] [MainThread]: Found 19 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:02:29.661260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166873F6940>]}
[0m07:02:29.664262 [info ] [MainThread]: 
[0m07:02:29.667260 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:02:29.671256 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m07:02:29.687794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:30.955773 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m07:02:31.006711 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:31.014557 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m07:02:31.025638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:31.636789 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m07:02:31.699098 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:31.709093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166874C6AC0>]}
[0m07:02:31.710090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:02:31.711090 [info ] [MainThread]: 
[0m07:02:31.718092 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.719097 [info ] [Thread-1  ]: 1 of 19 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m07:02:31.721096 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m07:02:31.722100 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.725094 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:02:31.726099 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 07:02:31.723105 => 2023-10-05 07:02:31.726099
[0m07:02:31.727098 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.782616 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:02:31.784632 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:02:32.396370 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m07:02:32.462215 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.472206 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:02:32.525763 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.527873 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:02:32.575422 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.580855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:02:32.626028 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:32.627033 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:02:32.675038 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.712551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m07:02:32.775760 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.777761 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 07:02:31.728101 => 2023-10-05 07:02:32.777761
[0m07:02:32.779754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166888BDCA0>]}
[0m07:02:32.780758 [info ] [Thread-1  ]: 1 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.06s]
[0m07:02:32.783754 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:32.784754 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.785765 [info ] [Thread-1  ]: 2 of 19 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m07:02:32.787770 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m07:02:32.787770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m07:02:32.789289 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.791304 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:02:32.793303 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 07:02:32.789289 => 2023-10-05 07:02:32.793303
[0m07:02:32.794306 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.801302 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:02:32.802302 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m07:02:32.859978 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.864965 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:02:32.915237 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.917238 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:02:32.965757 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.971751 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:02:33.016344 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:33.018337 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:02:33.066065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.072061 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m07:02:33.125442 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.128437 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 07:02:32.795306 => 2023-10-05 07:02:33.128437
[0m07:02:33.129445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166888F1E50>]}
[0m07:02:33.130442 [info ] [Thread-1  ]: 2 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.34s]
[0m07:02:33.132440 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:33.133437 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.133437 [info ] [Thread-1  ]: 3 of 19 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m07:02:33.135441 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m07:02:33.136439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m07:02:33.136439 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.139433 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:02:33.140446 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 07:02:33.137443 => 2023-10-05 07:02:33.140446
[0m07:02:33.141447 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.151435 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:02:33.153439 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m07:02:33.213083 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.217083 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:02:33.275222 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.278222 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:02:33.335878 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.341868 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:02:33.395541 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.397543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:02:33.445539 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.454552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m07:02:33.505705 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.507709 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 07:02:33.142445 => 2023-10-05 07:02:33.507709
[0m07:02:33.508700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889CEFD0>]}
[0m07:02:33.509707 [info ] [Thread-1  ]: 3 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.37s]
[0m07:02:33.510702 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.511703 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.512704 [info ] [Thread-1  ]: 4 of 19 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m07:02:33.514710 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m07:02:33.514710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m07:02:33.515703 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.517701 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:02:33.519704 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 07:02:33.515703 => 2023-10-05 07:02:33.519704
[0m07:02:33.520710 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.529704 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:02:33.530705 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m07:02:33.582581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.586328 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:02:33.636389 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.638380 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:02:33.685865 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.690371 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:02:33.735900 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.737895 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:02:33.786755 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.795263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m07:02:33.846272 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.848264 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 07:02:33.521706 => 2023-10-05 07:02:33.848264
[0m07:02:33.849270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F3670>]}
[0m07:02:33.850266 [info ] [Thread-1  ]: 4 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.34s]
[0m07:02:33.852269 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.852269 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.853265 [info ] [Thread-1  ]: 5 of 19 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m07:02:33.856271 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m07:02:33.856271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m07:02:33.857269 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.859265 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:02:33.861275 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 07:02:33.857269 => 2023-10-05 07:02:33.861275
[0m07:02:33.861275 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.867264 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:02:33.868264 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m07:02:33.921096 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.925094 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:02:33.975805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.978798 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:02:34.036848 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.040840 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:02:34.085932 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:34.087928 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:02:34.145828 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.152825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m07:02:34.205677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.208672 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 07:02:33.862269 => 2023-10-05 07:02:34.207668
[0m07:02:34.209669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889E9310>]}
[0m07:02:34.210667 [info ] [Thread-1  ]: 5 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.35s]
[0m07:02:34.212675 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:34.212675 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.213676 [info ] [Thread-1  ]: 6 of 19 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m07:02:34.215676 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m07:02:34.215676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m07:02:34.216673 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.218673 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:02:34.220671 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 07:02:34.216673 => 2023-10-05 07:02:34.220671
[0m07:02:34.220671 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.227668 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:02:34.228677 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m07:02:34.281069 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.285070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:02:34.345261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.347266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:02:34.395574 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.401578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:02:34.455179 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.457184 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:02:34.506281 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.513276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m07:02:34.565410 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.568405 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 07:02:34.221673 => 2023-10-05 07:02:34.568405
[0m07:02:34.569408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668891EE50>]}
[0m07:02:34.570406 [info ] [Thread-1  ]: 6 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.35s]
[0m07:02:34.572405 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.572405 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.573999 [info ] [Thread-1  ]: 7 of 19 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m07:02:34.576025 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m07:02:34.576739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m07:02:34.577892 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.581143 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:02:34.583289 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 07:02:34.578511 => 2023-10-05 07:02:34.582748
[0m07:02:34.583840 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.591153 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:02:34.593148 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m07:02:34.651870 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.656872 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:02:34.705320 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.707314 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:02:34.766163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.770665 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:02:34.815093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:34.817088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:02:34.866236 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.874236 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m07:02:34.925454 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.928445 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 07:02:34.584384 => 2023-10-05 07:02:34.928445
[0m07:02:34.929444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A18C70>]}
[0m07:02:34.930446 [info ] [Thread-1  ]: 7 of 19 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.35s]
[0m07:02:34.933447 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.934451 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.935445 [info ] [Thread-1  ]: 8 of 19 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m07:02:34.937449 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m07:02:34.937449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m07:02:34.937449 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.940440 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:02:34.941442 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 07:02:34.938451 => 2023-10-05 07:02:34.941442
[0m07:02:34.942443 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.953451 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:02:34.954450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m07:02:35.012834 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.016833 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:02:35.065326 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.067330 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:02:35.115505 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.120499 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:02:35.176190 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.178187 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:02:35.235754 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.242747 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m07:02:35.295866 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.297860 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 07:02:34.942443 => 2023-10-05 07:02:35.297860
[0m07:02:35.298856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A18B20>]}
[0m07:02:35.299863 [info ] [Thread-1  ]: 8 of 19 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.36s]
[0m07:02:35.302292 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:35.302292 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.303289 [info ] [Thread-1  ]: 9 of 19 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m07:02:35.305294 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m07:02:35.306294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m07:02:35.306294 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.309294 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:02:35.310297 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 07:02:35.306294 => 2023-10-05 07:02:35.310297
[0m07:02:35.311295 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.319291 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:02:35.320295 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m07:02:35.379447 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.384446 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:02:35.435845 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.437839 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:02:35.495816 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.500813 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:02:35.555849 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.557847 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:02:35.605662 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.612655 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m07:02:35.675939 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.677949 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 07:02:35.312293 => 2023-10-05 07:02:35.677949
[0m07:02:35.678953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A56790>]}
[0m07:02:35.679949 [info ] [Thread-1  ]: 9 of 19 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.37s]
[0m07:02:35.681637 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.681637 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.682631 [info ] [Thread-1  ]: 10 of 19 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m07:02:35.684637 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m07:02:35.685631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m07:02:35.685631 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.689633 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:02:35.692152 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 07:02:35.686634 => 2023-10-05 07:02:35.692152
[0m07:02:35.692152 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.698147 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:02:35.700151 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m07:02:35.761522 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.765462 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:02:35.825507 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.828496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:02:35.885285 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.891276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:02:35.945795 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.947802 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:02:35.996126 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.003120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m07:02:36.065593 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.068598 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 07:02:35.693152 => 2023-10-05 07:02:36.067599
[0m07:02:36.069604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A71700>]}
[0m07:02:36.070602 [info ] [Thread-1  ]: 10 of 19 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.39s]
[0m07:02:36.072595 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:36.072595 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.073592 [info ] [Thread-1  ]: 11 of 19 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m07:02:36.075595 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m07:02:36.076601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m07:02:36.076601 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.079621 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:02:36.080621 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 07:02:36.077604 => 2023-10-05 07:02:36.080621
[0m07:02:36.081618 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.088606 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:02:36.089617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m07:02:36.149905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.154904 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:02:36.215432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.218425 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:02:36.266425 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.270418 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:02:36.315749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:36.317744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:02:36.365780 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.373779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m07:02:36.425409 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.428405 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 07:02:36.081618 => 2023-10-05 07:02:36.428405
[0m07:02:36.429412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F0D30>]}
[0m07:02:36.430405 [info ] [Thread-1  ]: 11 of 19 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.35s]
[0m07:02:36.431406 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.432419 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.433412 [info ] [Thread-1  ]: 12 of 19 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m07:02:36.434407 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m07:02:36.435413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m07:02:36.436409 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.439409 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:02:36.440411 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 07:02:36.436409 => 2023-10-05 07:02:36.440411
[0m07:02:36.441411 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.449418 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:02:36.450405 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m07:02:36.500854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.504852 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:02:36.566369 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.568368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:02:36.615485 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.620479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:02:36.666609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:36.668601 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:02:36.716648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.723647 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m07:02:36.786173 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.788170 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 07:02:36.442414 => 2023-10-05 07:02:36.788170
[0m07:02:36.789169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A2CA60>]}
[0m07:02:36.790169 [info ] [Thread-1  ]: 12 of 19 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.35s]
[0m07:02:36.792691 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.793692 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.793692 [info ] [Thread-1  ]: 13 of 19 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m07:02:36.795696 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m07:02:36.796692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m07:02:36.796692 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.800706 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:02:36.802700 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 07:02:36.797690 => 2023-10-05 07:02:36.801702
[0m07:02:36.803691 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.811693 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:02:36.812691 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m07:02:36.881054 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:02:36.888055 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:02:36.945576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.947576 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:02:36.995698 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.000700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:02:37.045002 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:37.047002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:02:37.095595 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.101591 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m07:02:37.165725 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.167729 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 07:02:36.803691 => 2023-10-05 07:02:37.167729
[0m07:02:37.168727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668897A130>]}
[0m07:02:37.169727 [info ] [Thread-1  ]: 13 of 19 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m07:02:37.171729 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:37.172726 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.172726 [info ] [Thread-1  ]: 14 of 19 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m07:02:37.174727 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m07:02:37.175721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m07:02:37.175721 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.177734 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:02:37.179730 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 07:02:37.176724 => 2023-10-05 07:02:37.179730
[0m07:02:37.179730 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.187751 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:02:37.189741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m07:02:37.240362 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.246362 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:02:37.295219 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.297216 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:02:37.355740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.359741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:02:37.405910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.407909 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:02:37.455596 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.461592 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m07:02:37.525430 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.527428 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 07:02:37.180736 => 2023-10-05 07:02:37.527428
[0m07:02:37.529430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016689A66F10>]}
[0m07:02:37.530428 [info ] [Thread-1  ]: 14 of 19 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m07:02:37.531426 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.532432 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.533430 [info ] [Thread-1  ]: 15 of 19 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m07:02:37.535431 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m07:02:37.536424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m07:02:37.537428 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.540441 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:02:37.541435 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 07:02:37.537428 => 2023-10-05 07:02:37.541435
[0m07:02:37.542437 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.551423 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:02:37.552433 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m07:02:37.610236 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.678240 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:02:37.726173 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.728163 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:02:37.786527 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.790531 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:02:37.855748 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.857749 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:02:37.905678 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.912678 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m07:02:37.966319 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.968315 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 07:02:37.543438 => 2023-10-05 07:02:37.968315
[0m07:02:37.969829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889E8FA0>]}
[0m07:02:37.970842 [info ] [Thread-1  ]: 15 of 19 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.44s]
[0m07:02:37.971837 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.972846 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.973844 [info ] [Thread-1  ]: 16 of 19 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m07:02:37.975846 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m07:02:37.976843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m07:02:37.976843 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.979854 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:02:37.981854 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 07:02:37.977862 => 2023-10-05 07:02:37.981854
[0m07:02:37.981854 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.988850 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:02:37.989849 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m07:02:38.046094 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.051090 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:02:38.095628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:38.097623 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:02:38.155450 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.159973 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:02:38.215793 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.216794 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:02:38.265969 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.271967 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m07:02:38.336213 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.338209 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 07:02:37.982854 => 2023-10-05 07:02:38.338209
[0m07:02:38.340206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889B6F10>]}
[0m07:02:38.341201 [info ] [Thread-1  ]: 16 of 19 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.36s]
[0m07:02:38.343144 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m07:02:38.344142 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.345142 [info ] [Thread-1  ]: 17 of 19 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m07:02:38.346639 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m07:02:38.347639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m07:02:38.348641 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.355655 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:02:38.356641 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 07:02:38.349640 => 2023-10-05 07:02:38.356641
[0m07:02:38.357638 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.421772 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:38.475801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.511002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m07:02:38.567079 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.578084 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:38.627751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.633745 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:02:38.634757 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m07:02:38.695383 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.697377 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4);
    ...
[0m07:02:38.777596 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m07:02:38.782109 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:38.837637 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.839633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
    ...
[0m07:02:38.889467 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.892969 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:38.945749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.952741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m07:02:39.005997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.008997 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 07:02:38.357638 => 2023-10-05 07:02:39.008997
[0m07:02:39.010999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A1FE80>]}
[0m07:02:39.010999 [info ] [Thread-1  ]: 17 of 19 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.66s]
[0m07:02:39.012998 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:39.013998 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.015002 [info ] [Thread-1  ]: 18 of 19 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m07:02:39.016993 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m07:02:39.017991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m07:02:39.017991 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.022991 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:02:39.023996 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 07:02:39.019000 => 2023-10-05 07:02:39.023996
[0m07:02:39.025004 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.032996 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:39.085137 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.090138 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m07:02:39.146808 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.150802 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.197451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.200451 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:02:39.203454 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m07:02:39.264334 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.266336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4);
    ...
[0m07:02:39.331896 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:02:39.335892 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.397350 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.400343 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
    ...
[0m07:02:39.450051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.455048 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:39.505414 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.510416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m07:02:39.565625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.569619 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 07:02:39.025004 => 2023-10-05 07:02:39.569619
[0m07:02:39.571629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F6B20>]}
[0m07:02:39.571629 [info ] [Thread-1  ]: 18 of 19 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.55s]
[0m07:02:39.573623 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.574629 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.575624 [info ] [Thread-1  ]: 19 of 19 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m07:02:39.576621 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m07:02:39.577639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m07:02:39.578655 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.583840 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m07:02:39.585461 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-05 07:02:39.579658 => 2023-10-05 07:02:39.585461
[0m07:02:39.586549 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.610850 [debug] [Thread-1  ]: Creating new relation incremental_sheets_appmetrica_profiles
[0m07:02:39.612845 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m07:02:39.676065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.680070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.727033 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.730024 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m07:02:39.732030 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m07:02:39.790573 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.794083 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-05 07:02:39.587093 => 2023-10-05 07:02:39.794083
[0m07:02:39.796103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688842AC0>]}
[0m07:02:39.796103 [info ] [Thread-1  ]: 19 of 19 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.22s]
[0m07:02:39.798104 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.800097 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:02:39.801096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:02:39.802097 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m07:02:39.802097 [debug] [MainThread]: On list_schemas: Close
[0m07:02:39.803097 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m07:02:39.804102 [debug] [MainThread]: On list_None_travelata: Close
[0m07:02:39.804102 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_profiles' was left open.
[0m07:02:39.805094 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_profiles: Close
[0m07:02:39.805094 [info ] [MainThread]: 
[0m07:02:39.807102 [info ] [MainThread]: Finished running 16 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m07:02:39.812098 [debug] [MainThread]: Command end result
[0m07:02:39.824100 [info ] [MainThread]: 
[0m07:02:39.825103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:02:39.827101 [info ] [MainThread]: 
[0m07:02:39.828095 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m07:02:39.830105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889241F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688924160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688842AC0>]}
[0m07:02:39.830105 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 10:41:16.639264 | 43836007-cec9-4eee-af28-148fe2e2283a ==============================
[0m10:41:16.639264 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:41:16.641258 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:41:16.641258 [debug] [MainThread]: Tracking: tracking
[0m10:41:16.653774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF3FFE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF46E7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF3F42D50>]}
[0m10:41:16.669816 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:41:16.716004 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:41:16.718004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4A15450>]}
[0m10:41:17.839950 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_deeplinks.sql
[0m10:41:17.862025 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m10:41:17.866532 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m10:41:17.873068 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m10:41:17.880603 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_screenview.sql
[0m10:41:17.899221 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_sessionstart.sql
[0m10:41:17.905743 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m10:41:17.919811 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m10:41:17.926219 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m10:41:17.940272 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m10:41:17.947285 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m10:41:17.954637 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m10:41:17.960149 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m10:41:17.965148 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yandexdisk_mediaplans.sql
[0m10:41:17.970670 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yandexdisk_othercosts.sql
[0m10:41:17.982215 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yd_customreport.sql
[0m10:41:17.990733 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_ymvisits_visits.sql
[0m10:41:17.996733 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m10:41:18.003250 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m10:41:18.008248 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_install.sql
[0m10:41:18.025016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_install.sql
[0m10:41:18.026528 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_profiles.sql
[0m10:41:18.036051 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_profiles.sql
[0m10:41:18.038567 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m10:41:18.046573 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m10:41:18.050088 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m10:41:18.062440 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m10:41:18.065432 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m10:41:18.072955 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m10:41:18.164717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m10:41:18.175252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF478FE10>]}
[0m10:41:18.200890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF3F3D450>]}
[0m10:41:18.201890 [info ] [MainThread]: Found 23 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:41:18.202891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4758D50>]}
[0m10:41:18.204894 [info ] [MainThread]: 
[0m10:41:18.208459 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:41:18.216423 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:41:18.235071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:18.987338 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:41:19.037010 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:19.042527 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:41:19.048073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:19.617322 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:41:19.671466 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:19.676466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4B030D0>]}
[0m10:41:19.678978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:41:19.679982 [info ] [MainThread]: 
[0m10:41:19.690050 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:41:19.692068 [info ] [Thread-1 (]: 1 of 23 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m10:41:19.695068 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m10:41:19.696069 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:41:19.699576 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m10:41:19.701585 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 10:41:19.697062 => 2023-10-05 10:41:19.701585
[0m10:41:19.702591 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:41:19.771506 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m10:41:19.774022 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:20.346155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m10:41:20.400813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.410959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m10:41:20.456879 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.459400 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m10:41:20.508368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.511883 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m10:41:20.555970 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:20.557973 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m10:41:20.606440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.636666 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m10:41:20.688045 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.691061 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 10:41:19.703587 => 2023-10-05 10:41:20.690053
[0m10:41:20.692062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF47B4D90>]}
[0m10:41:20.694063 [info ] [Thread-1 (]: 1 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.00s]
[0m10:41:20.696063 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:41:20.697061 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m10:41:20.698061 [info ] [Thread-1 (]: 2 of 23 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m10:41:20.699435 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m10:41:20.699435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m10:41:20.700442 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m10:41:20.701441 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m10:41:20.703440 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 10:41:20.700442 => 2023-10-05 10:41:20.703440
[0m10:41:20.703440 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m10:41:20.708955 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m10:41:20.709953 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m10:41:20.769402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:20.772408 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m10:41:20.816252 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:20.818835 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m10:41:20.865744 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.869258 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m10:41:20.916204 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.918209 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m10:41:20.967152 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:20.972323 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m10:41:21.017243 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:21.018765 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 10:41:20.704442 => 2023-10-05 10:41:21.018765
[0m10:41:21.019770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4783C50>]}
[0m10:41:21.022072 [info ] [Thread-1 (]: 2 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.32s]
[0m10:41:21.023728 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m10:41:21.024261 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m10:41:21.025341 [info ] [Thread-1 (]: 3 of 23 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m10:41:21.027009 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m10:41:21.027578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m10:41:21.028095 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m10:41:21.030803 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m10:41:21.032440 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 10:41:21.028659 => 2023-10-05 10:41:21.032440
[0m10:41:21.032947 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m10:41:21.039465 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m10:41:21.040465 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m10:41:21.089985 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.092991 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m10:41:21.136762 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:21.141301 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m10:41:21.186170 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:21.189347 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m10:41:21.236115 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.238149 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m10:41:21.287433 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.298700 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m10:41:21.347376 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.350757 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 10:41:21.032947 => 2023-10-05 10:41:21.350757
[0m10:41:21.352309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4A03E50>]}
[0m10:41:21.354297 [info ] [Thread-1 (]: 3 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.33s]
[0m10:41:21.355291 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m10:41:21.356291 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:41:21.357293 [info ] [Thread-1 (]: 4 of 23 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m10:41:21.358294 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m10:41:21.359485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m10:41:21.359485 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:41:21.361996 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m10:41:21.363997 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 10:41:21.360482 => 2023-10-05 10:41:21.363997
[0m10:41:21.365005 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:41:21.376543 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m10:41:21.380068 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m10:41:21.430250 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.436260 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m10:41:21.486525 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.490096 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m10:41:21.536630 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.542719 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m10:41:21.587085 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:21.588085 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m10:41:21.635711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.639188 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m10:41:21.686488 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.688032 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 10:41:21.367008 => 2023-10-05 10:41:21.688032
[0m10:41:21.689039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF5025B10>]}
[0m10:41:21.690038 [info ] [Thread-1 (]: 4 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.33s]
[0m10:41:21.691039 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:41:21.692039 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:41:21.692039 [info ] [Thread-1 (]: 5 of 23 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m10:41:21.694039 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m10:41:21.694039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m10:41:21.694039 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:41:21.696043 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m10:41:21.698043 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 10:41:21.695043 => 2023-10-05 10:41:21.697042
[0m10:41:21.698043 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:41:21.702716 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m10:41:21.703716 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m10:41:21.761558 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:21.766088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m10:41:21.817249 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.819797 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m10:41:21.866665 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.869180 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m10:41:21.916323 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.918320 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m10:41:21.968166 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:21.979233 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m10:41:22.027360 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.030224 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 10:41:21.698555 => 2023-10-05 10:41:22.030224
[0m10:41:22.031959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF501D650>]}
[0m10:41:22.032699 [info ] [Thread-1 (]: 5 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.34s]
[0m10:41:22.033746 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:41:22.034279 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:41:22.034833 [info ] [Thread-1 (]: 6 of 23 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m10:41:22.035843 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m10:41:22.036846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m10:41:22.036846 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:41:22.039370 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m10:41:22.041387 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 10:41:22.036846 => 2023-10-05 10:41:22.041387
[0m10:41:22.042385 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:41:22.051420 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m10:41:22.053940 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m10:41:22.111349 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:22.115352 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m10:41:22.166992 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.170016 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m10:41:22.218154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.222415 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m10:41:22.266276 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:22.268277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m10:41:22.315939 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.321470 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m10:41:22.366769 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:22.370300 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 10:41:22.042385 => 2023-10-05 10:41:22.370300
[0m10:41:22.372821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF49F8050>]}
[0m10:41:22.373821 [info ] [Thread-1 (]: 6 of 23 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.34s]
[0m10:41:22.376334 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:41:22.376924 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:41:22.377461 [info ] [Thread-1 (]: 7 of 23 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m10:41:22.379016 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m10:41:22.380015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m10:41:22.380015 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:41:22.385069 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m10:41:22.386643 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 10:41:22.381013 => 2023-10-05 10:41:22.386643
[0m10:41:22.387182 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:41:22.394560 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m10:41:22.396656 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m10:41:22.462500 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:22.470368 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m10:41:22.516720 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:22.518823 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m10:41:22.577478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:22.582666 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m10:41:22.626771 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:22.628350 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m10:41:22.677140 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.681367 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m10:41:22.747836 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:22.750414 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 10:41:22.387711 => 2023-10-05 10:41:22.750414
[0m10:41:22.756469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF46A6E50>]}
[0m10:41:22.758993 [info ] [Thread-1 (]: 7 of 23 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.38s]
[0m10:41:22.762004 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:41:22.762004 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:41:22.763008 [info ] [Thread-1 (]: 8 of 23 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m10:41:22.764511 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m10:41:22.764511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m10:41:22.765522 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:41:22.768034 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m10:41:22.769566 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 10:41:22.765522 => 2023-10-05 10:41:22.769566
[0m10:41:22.770076 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:41:22.778135 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m10:41:22.790777 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m10:41:22.842686 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.846685 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m10:41:22.896397 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.898932 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m10:41:22.946331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:22.951289 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m10:41:22.996017 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:22.998017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m10:41:23.046234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.051272 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m10:41:23.096971 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.098481 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 10:41:22.770076 => 2023-10-05 10:41:23.098481
[0m10:41:23.099497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4FAFE90>]}
[0m10:41:23.101503 [info ] [Thread-1 (]: 8 of 23 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.34s]
[0m10:41:23.104505 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:41:23.106504 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:41:23.106504 [info ] [Thread-1 (]: 9 of 23 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m10:41:23.111087 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m10:41:23.112086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m10:41:23.112086 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:41:23.117085 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m10:41:23.118600 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 10:41:23.113085 => 2023-10-05 10:41:23.118600
[0m10:41:23.119616 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:41:23.125622 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m10:41:23.128141 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m10:41:23.180609 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.188256 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m10:41:23.235888 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.236890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m10:41:23.287208 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.292840 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m10:41:23.346718 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.351776 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m10:41:23.396471 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:23.401024 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m10:41:23.447198 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.448706 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 10:41:23.119616 => 2023-10-05 10:41:23.448706
[0m10:41:23.449716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4FFCD90>]}
[0m10:41:23.450724 [info ] [Thread-1 (]: 9 of 23 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.34s]
[0m10:41:23.451726 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:41:23.451726 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:41:23.452726 [info ] [Thread-1 (]: 10 of 23 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m10:41:23.453723 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m10:41:23.453723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m10:41:23.454723 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:41:23.456727 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m10:41:23.460248 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 10:41:23.454723 => 2023-10-05 10:41:23.460248
[0m10:41:23.461256 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:41:23.466260 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m10:41:23.468259 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m10:41:23.531376 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:23.544471 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m10:41:23.596377 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.597375 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m10:41:23.646921 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.649938 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m10:41:23.696325 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.698323 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m10:41:23.746246 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.753070 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m10:41:23.806785 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.808291 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 10:41:23.461256 => 2023-10-05 10:41:23.808291
[0m10:41:23.809301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF5008090>]}
[0m10:41:23.809301 [info ] [Thread-1 (]: 10 of 23 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.36s]
[0m10:41:23.811312 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:41:23.812312 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:41:23.813314 [info ] [Thread-1 (]: 11 of 23 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m10:41:23.816306 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m10:41:23.817307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m10:41:23.818315 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:41:23.822369 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m10:41:23.823372 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 10:41:23.819346 => 2023-10-05 10:41:23.823372
[0m10:41:23.824369 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:41:23.832393 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m10:41:23.833397 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m10:41:23.893772 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:23.901823 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m10:41:23.948763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:23.951796 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m10:41:23.996210 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:23.999519 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m10:41:24.047232 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.049805 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m10:41:24.096524 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.103049 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m10:41:24.149259 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.152256 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 10:41:23.825367 => 2023-10-05 10:41:24.152256
[0m10:41:24.153257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4FEB4D0>]}
[0m10:41:24.154261 [info ] [Thread-1 (]: 11 of 23 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.34s]
[0m10:41:24.155257 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:41:24.155257 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:41:24.156256 [info ] [Thread-1 (]: 12 of 23 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m10:41:24.157254 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m10:41:24.158259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m10:41:24.158259 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:41:24.160504 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m10:41:24.161499 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 10:41:24.159505 => 2023-10-05 10:41:24.161499
[0m10:41:24.162616 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:41:24.170672 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m10:41:24.173226 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m10:41:24.235197 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:24.244459 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m10:41:24.296582 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.299102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m10:41:24.346329 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.349845 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m10:41:24.396688 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.398231 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m10:41:24.446606 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.451161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m10:41:24.496334 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:24.500017 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 10:41:24.162616 => 2023-10-05 10:41:24.500017
[0m10:41:24.502023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF50B9350>]}
[0m10:41:24.503017 [info ] [Thread-1 (]: 12 of 23 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.34s]
[0m10:41:24.505017 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:41:24.506016 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:41:24.507016 [info ] [Thread-1 (]: 13 of 23 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m10:41:24.508015 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m10:41:24.508015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m10:41:24.509490 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:41:24.511492 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m10:41:24.513489 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 10:41:24.509490 => 2023-10-05 10:41:24.513489
[0m10:41:24.513489 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:41:24.521426 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m10:41:24.523427 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m10:41:24.594901 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:24.599753 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m10:41:24.646614 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.648121 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m10:41:24.696874 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.700388 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m10:41:24.746575 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:24.746575 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m10:41:24.796121 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.800629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m10:41:24.846969 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.848469 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 10:41:24.514489 => 2023-10-05 10:41:24.848469
[0m10:41:24.849479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4F88F10>]}
[0m10:41:24.850476 [info ] [Thread-1 (]: 13 of 23 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.34s]
[0m10:41:24.851479 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:41:24.851479 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:41:24.851479 [info ] [Thread-1 (]: 14 of 23 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m10:41:24.853999 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m10:41:24.853999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m10:41:24.853999 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:41:24.855999 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m10:41:24.858000 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 10:41:24.854999 => 2023-10-05 10:41:24.858000
[0m10:41:24.858000 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:41:24.866084 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m10:41:24.868590 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m10:41:24.942399 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:24.948420 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m10:41:24.996120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:24.997125 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m10:41:25.046135 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.049657 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m10:41:25.096903 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.098412 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m10:41:25.146344 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.150914 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m10:41:25.196974 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.197973 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 10:41:24.859079 => 2023-10-05 10:41:25.197973
[0m10:41:25.199184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4FD0650>]}
[0m10:41:25.200187 [info ] [Thread-1 (]: 14 of 23 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m10:41:25.201195 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:41:25.202195 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:41:25.203194 [info ] [Thread-1 (]: 15 of 23 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m10:41:25.204193 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m10:41:25.205193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m10:41:25.205193 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:41:25.210254 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m10:41:25.213262 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 10:41:25.205193 => 2023-10-05 10:41:25.213262
[0m10:41:25.214264 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:41:25.220289 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m10:41:25.222288 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m10:41:25.275566 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.282388 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m10:41:25.338279 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.341198 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m10:41:25.386919 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.390446 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m10:41:25.435763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.436765 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m10:41:25.487178 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.493767 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m10:41:25.546425 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.547983 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 10:41:25.214264 => 2023-10-05 10:41:25.547983
[0m10:41:25.548940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF5008E50>]}
[0m10:41:25.549939 [info ] [Thread-1 (]: 15 of 23 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.34s]
[0m10:41:25.549939 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:41:25.551426 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m10:41:25.551426 [info ] [Thread-1 (]: 16 of 23 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m10:41:25.552428 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m10:41:25.553428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m10:41:25.553428 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m10:41:25.555425 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m10:41:25.556424 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 10:41:25.554425 => 2023-10-05 10:41:25.556424
[0m10:41:25.557930 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m10:41:25.561940 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m10:41:25.565953 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m10:41:25.626569 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:25.632217 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m10:41:25.676792 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:25.678307 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m10:41:25.727083 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.731900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m10:41:25.776872 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:41:25.778379 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m10:41:25.826099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.830653 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m10:41:25.877359 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:25.878875 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 10:41:25.557930 => 2023-10-05 10:41:25.878875
[0m10:41:25.879883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4743550>]}
[0m10:41:25.880886 [info ] [Thread-1 (]: 16 of 23 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.33s]
[0m10:41:25.881887 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m10:41:25.882884 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m10:41:25.882884 [info ] [Thread-1 (]: 17 of 23 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m10:41:25.883886 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m10:41:25.884885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m10:41:25.885887 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m10:41:25.889414 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m10:41:25.891409 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-05 10:41:25.886888 => 2023-10-05 10:41:25.891409
[0m10:41:25.892410 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m10:41:25.896409 [debug] [Thread-1 (]: Creating new relation normalized_sheets_ymvisits_visits
[0m10:41:25.897409 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m10:41:25.899718 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m10:41:25.958241 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:25.961758 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-05 10:41:25.893409 => 2023-10-05 10:41:25.961758
[0m10:41:25.963270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4718450>]}
[0m10:41:25.964281 [info ] [Thread-1 (]: 17 of 23 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.08s]
[0m10:41:25.966290 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m10:41:25.968281 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m10:41:25.968281 [info ] [Thread-1 (]: 18 of 23 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m10:41:25.971633 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m10:41:25.973633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m10:41:25.975622 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m10:41:25.986439 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m10:41:25.988982 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 10:41:25.975622 => 2023-10-05 10:41:25.988982
[0m10:41:25.989982 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m10:41:26.110744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m10:41:26.163516 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:26.182744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:26.237392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:26.243919 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m10:41:26.244921 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
    ...
[0m10:41:26.313496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:26.322534 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 10:41:25.990994 => 2023-10-05 10:41:26.322534
[0m10:41:26.324545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF50ABED0>]}
[0m10:41:26.326056 [info ] [Thread-1 (]: 18 of 23 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.35s]
[0m10:41:26.328075 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m10:41:26.329598 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m10:41:26.330617 [info ] [Thread-1 (]: 19 of 23 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m10:41:26.333121 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m10:41:26.334130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m10:41:26.335128 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m10:41:26.342157 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m10:41:26.344712 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 10:41:26.335128 => 2023-10-05 10:41:26.343702
[0m10:41:26.345709 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m10:41:26.359342 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m10:41:26.412368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:26.418063 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:26.469025 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:26.473023 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m10:41:26.474022 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
    ...
[0m10:41:26.536477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:26.539990 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 10:41:26.346695 => 2023-10-05 10:41:26.539990
[0m10:41:26.540995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF50AAE10>]}
[0m10:41:26.541996 [info ] [Thread-1 (]: 19 of 23 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.21s]
[0m10:41:26.542997 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m10:41:26.543997 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:41:26.543997 [info ] [Thread-1 (]: 20 of 23 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m10:41:26.545504 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m10:41:26.546516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m10:41:26.546516 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:41:26.550034 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m10:41:26.551033 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-05 10:41:26.546516 => 2023-10-05 10:41:26.551033
[0m10:41:26.551033 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:41:26.578149 [debug] [Thread-1 (]: Creating new relation incremental_sheets_appmetrica_profiles
[0m10:41:26.587044 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m10:41:26.716082 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.13 seconds
[0m10:41:26.719115 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:26.723122 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:41:26.730150 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m10:41:26.733175 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m10:41:26.790410 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:26.792932 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-05 10:41:26.552032 => 2023-10-05 10:41:26.792932
[0m10:41:26.793934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF49F8B10>]}
[0m10:41:26.794937 [info ] [Thread-1 (]: 20 of 23 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.25s]
[0m10:41:26.795935 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:41:26.796936 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:41:26.797935 [info ] [Thread-1 (]: 21 of 23 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m10:41:26.799042 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m10:41:26.800047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m10:41:26.801038 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:41:26.806042 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m10:41:26.807041 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 10:41:26.801038 => 2023-10-05 10:41:26.807041
[0m10:41:26.808041 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:41:26.812703 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m10:41:26.868400 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:26.877192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:26.938218 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:41:26.942540 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m10:41:26.944526 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
    ...
[0m10:41:27.012404 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:27.014402 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 10:41:26.808692 => 2023-10-05 10:41:27.014402
[0m10:41:27.015913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF5129DD0>]}
[0m10:41:27.016925 [info ] [Thread-1 (]: 21 of 23 OK created sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.22s]
[0m10:41:27.018177 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:41:27.020190 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:41:27.021184 [info ] [Thread-1 (]: 22 of 23 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m10:41:27.023189 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m10:41:27.024186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m10:41:27.024186 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:41:27.030260 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m10:41:27.032209 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-05 10:41:27.025185 => 2023-10-05 10:41:27.032209
[0m10:41:27.032209 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:41:27.043284 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m10:41:27.094691 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:27.100871 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:27.152199 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:27.158198 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m10:41:27.160260 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
    ...
[0m10:41:27.240232 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:41:27.243233 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-05 10:41:27.033241 => 2023-10-05 10:41:27.243233
[0m10:41:27.243233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4AB9250>]}
[0m10:41:27.244750 [info ] [Thread-1 (]: 22 of 23 OK created sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.22s]
[0m10:41:27.246761 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:41:27.246761 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:41:27.246761 [info ] [Thread-1 (]: 23 of 23 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m10:41:27.249285 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m10:41:27.249285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m10:41:27.250285 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:41:27.253279 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m10:41:27.255284 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-05 10:41:27.250285 => 2023-10-05 10:41:27.255284
[0m10:41:27.256285 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:41:27.265806 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m10:41:27.339779 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:41:27.344013 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:41:27.398112 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:41:27.402701 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m10:41:27.405331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
    ...
[0m10:41:27.498013 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m10:41:27.500942 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-05 10:41:27.256285 => 2023-10-05 10:41:27.500942
[0m10:41:27.501947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43836007-cec9-4eee-af28-148fe2e2283a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF46E7750>]}
[0m10:41:27.502949 [info ] [Thread-1 (]: 23 of 23 OK created sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[32mOK[0m in 0.25s]
[0m10:41:27.503938 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:41:27.504936 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:41:27.505936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:27.506935 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:41:27.506935 [debug] [MainThread]: On list_schemas: Close
[0m10:41:27.506935 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:41:27.507936 [debug] [MainThread]: On list_None_travelata: Close
[0m10:41:27.507936 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics' was left open.
[0m10:41:27.507936 [debug] [MainThread]: On model.travelata.incremental_sheets_vkads_bannerssstatistics: Close
[0m10:41:27.509083 [info ] [MainThread]: 
[0m10:41:27.510077 [info ] [MainThread]: Finished running 17 view models, 5 incremental models, 1 table model in 0 hours 0 minutes and 9.30 seconds (9.30s).
[0m10:41:27.511078 [debug] [MainThread]: Command end result
[0m10:41:27.521602 [info ] [MainThread]: 
[0m10:41:27.522594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:41:27.523594 [info ] [MainThread]: 
[0m10:41:27.524594 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m10:41:27.526593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF3FC9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4781350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FF4782990>]}
[0m10:41:28.583852 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 08:09:31.563501 | 22c1a6f9-3fa1-4dd5-b95b-e734ad746446 ==============================
[0m08:09:31.563501 [info ] [MainThread]: Running with dbt=1.4.8
[0m08:09:31.565671 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:09:31.565671 [debug] [MainThread]: Tracking: tracking
[0m08:09:31.569751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218149E5B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218149C9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021814F19690>]}
[0m08:09:31.585377 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m08:09:32.192409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m08:09:32.192409 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:32.192409 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:32.192409 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:32.192409 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:32.211457 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:32.222687 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:32.222687 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:32.222687 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:32.222687 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:32.232732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:32.237775 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:32.240026 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:32.240026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181529D590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181529F090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021814EEC5D0>]}
[0m08:09:32.240026 [debug] [MainThread]: Flushing usage events
[0m08:09:33.223143 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.travelata.incremental_sheets_utmcraft_utmresult' (models\2_incremental\incremental_sheets_utmcraft_utmresult.sql) depends on a node named 'normalize_sheets_utmcraft_utmresult' which was not found


============================== 2023-10-06 08:09:58.187458 | 5843dfe8-0017-47b5-8995-03ed085f5a60 ==============================
[0m08:09:58.187458 [info ] [MainThread]: Running with dbt=1.4.8
[0m08:09:58.200004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:09:58.200004 [debug] [MainThread]: Tracking: tracking
[0m08:09:58.212531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A490C03390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4933A42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493AB0410>]}
[0m08:09:58.215462 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m08:09:58.304386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m08:09:58.304386 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:58.304386 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:58.304386 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:58.304386 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:58.320019 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:58.335679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m08:09:58.335679 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:58.335679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:09:58.335679 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:58.335679 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m08:09:58.351303 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:58.351303 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m08:09:58.371608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m08:09:58.371608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4936378D0>]}
[0m08:09:58.371608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493B17AD0>]}
[0m08:09:58.371608 [info ] [MainThread]: Found 27 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:09:58.371608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493409310>]}
[0m08:09:58.387302 [info ] [MainThread]: 
[0m08:09:58.387302 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:09:58.387302 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m08:09:58.399843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:59.149746 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m08:09:59.213203 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:09:59.228839 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m08:09:59.228839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:59.830427 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m08:09:59.913584 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:09:59.913584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4933A43D0>]}
[0m08:09:59.925094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:09:59.925094 [info ] [MainThread]: 
[0m08:09:59.925094 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m08:09:59.925094 [info ] [Thread-1 (]: 1 of 27 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m08:09:59.925094 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m08:09:59.925094 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m08:09:59.925094 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m08:09:59.925094 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 08:09:59.925094 => 2023-10-06 08:09:59.925094
[0m08:09:59.940785 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m08:09:59.972957 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m08:09:59.972957 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:10:00.552442 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m08:10:00.630983 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:00.630983 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m08:10:00.678194 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:00.678194 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m08:10:00.741421 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:00.756940 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m08:10:00.805030 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:00.805030 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m08:10:00.861416 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:00.892707 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m08:10:00.940876 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:00.940876 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 08:09:59.940785 => 2023-10-06 08:10:00.940876
[0m08:10:00.940876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493F6B310>]}
[0m08:10:00.940876 [info ] [Thread-1 (]: 1 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m08:10:00.940876 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m08:10:00.940876 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m08:10:00.940876 [info ] [Thread-1 (]: 2 of 27 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m08:10:00.940876 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m08:10:00.940876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m08:10:00.940876 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m08:10:00.940876 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:10:00.940876 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 08:10:00.940876 => 2023-10-06 08:10:00.940876
[0m08:10:00.956382 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m08:10:00.956382 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:10:00.956382 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m08:10:01.008539 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:01.010539 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m08:10:01.045694 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:10:01.045694 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m08:10:01.109513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:01.109513 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m08:10:01.172277 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:01.172277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m08:10:01.235424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:01.250952 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m08:10:01.314092 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:01.314092 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 08:10:00.956382 => 2023-10-06 08:10:01.314092
[0m08:10:01.314092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4940B1790>]}
[0m08:10:01.314092 [info ] [Thread-1 (]: 2 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.37s]
[0m08:10:01.314092 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m08:10:01.314092 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m08:10:01.314092 [info ] [Thread-1 (]: 3 of 27 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m08:10:01.314092 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m08:10:01.314092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m08:10:01.314092 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m08:10:01.329770 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:10:01.329770 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 08:10:01.314092 => 2023-10-06 08:10:01.329770
[0m08:10:01.329770 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m08:10:01.329770 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:10:01.329770 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m08:10:01.397678 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:01.400673 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m08:10:01.441591 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:01.441591 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m08:10:01.506182 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:01.506182 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m08:10:01.567087 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:01.567087 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m08:10:01.614181 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:01.621191 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m08:10:01.662529 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:01.677820 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 08:10:01.329770 => 2023-10-06 08:10:01.677820
[0m08:10:01.677820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49403EDD0>]}
[0m08:10:01.677820 [info ] [Thread-1 (]: 3 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.36s]
[0m08:10:01.677820 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m08:10:01.677820 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:10:01.677820 [info ] [Thread-1 (]: 4 of 27 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m08:10:01.677820 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m08:10:01.677820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m08:10:01.677820 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:10:01.677820 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:10:01.677820 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 08:10:01.677820 => 2023-10-06 08:10:01.677820
[0m08:10:01.677820 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:10:01.677820 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:10:01.677820 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m08:10:01.743061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:01.746056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m08:10:01.797995 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:01.797995 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m08:10:01.845488 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:01.845488 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m08:10:01.917881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:01.924248 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m08:10:01.978897 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:01.978897 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m08:10:02.042049 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:02.042049 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 08:10:01.677820 => 2023-10-06 08:10:02.042049
[0m08:10:02.042049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A494502750>]}
[0m08:10:02.042049 [info ] [Thread-1 (]: 4 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.36s]
[0m08:10:02.058095 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:10:02.058095 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m08:10:02.058095 [info ] [Thread-1 (]: 5 of 27 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m08:10:02.058095 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m08:10:02.058095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m08:10:02.058095 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m08:10:02.058095 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m08:10:02.058095 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 08:10:02.058095 => 2023-10-06 08:10:02.058095
[0m08:10:02.073117 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m08:10:02.073117 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m08:10:02.073117 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m08:10:02.134657 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:02.150152 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m08:10:02.196978 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.196978 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m08:10:02.244499 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:02.259922 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m08:10:02.306792 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.307837 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m08:10:02.354626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.370056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m08:10:02.417280 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.417280 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 08:10:02.073117 => 2023-10-06 08:10:02.417280
[0m08:10:02.417280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4944E7990>]}
[0m08:10:02.417280 [info ] [Thread-1 (]: 5 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m08:10:02.417280 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m08:10:02.417280 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m08:10:02.417280 [info ] [Thread-1 (]: 6 of 27 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m08:10:02.417280 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m08:10:02.417280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m08:10:02.417280 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m08:10:02.417280 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m08:10:02.432923 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 08:10:02.417280 => 2023-10-06 08:10:02.432923
[0m08:10:02.432923 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m08:10:02.432923 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m08:10:02.432923 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m08:10:02.480440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.480440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m08:10:02.543645 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:02.543645 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m08:10:02.590508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.606138 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m08:10:02.662884 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.662884 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m08:10:02.714615 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.716626 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m08:10:02.763509 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.763509 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 08:10:02.432923 => 2023-10-06 08:10:02.763509
[0m08:10:02.763509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A494523F10>]}
[0m08:10:02.763509 [info ] [Thread-1 (]: 6 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.35s]
[0m08:10:02.763509 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m08:10:02.763509 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m08:10:02.763509 [info ] [Thread-1 (]: 7 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m08:10:02.763509 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m08:10:02.763509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m08:10:02.763509 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m08:10:02.763509 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m08:10:02.763509 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 08:10:02.763509 => 2023-10-06 08:10:02.763509
[0m08:10:02.763509 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m08:10:02.779132 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m08:10:02.779132 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m08:10:02.826621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.826621 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m08:10:02.873818 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.873818 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m08:10:02.928360 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:02.928360 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m08:10:02.986895 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:02.986895 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m08:10:03.034312 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.034312 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m08:10:03.097053 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:03.097053 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 08:10:02.763509 => 2023-10-06 08:10:03.097053
[0m08:10:03.097053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49401AE10>]}
[0m08:10:03.097053 [info ] [Thread-1 (]: 7 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.33s]
[0m08:10:03.097053 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m08:10:03.097053 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m08:10:03.097053 [info ] [Thread-1 (]: 8 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m08:10:03.097053 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m08:10:03.097053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m08:10:03.097053 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m08:10:03.109580 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m08:10:03.109580 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 08:10:03.097053 => 2023-10-06 08:10:03.109580
[0m08:10:03.109580 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m08:10:03.113086 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m08:10:03.113086 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m08:10:03.169282 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:03.184357 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m08:10:03.232421 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.232421 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m08:10:03.294659 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:03.310815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m08:10:03.357786 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.374334 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m08:10:03.421402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.421402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m08:10:03.468541 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.468541 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 08:10:03.109580 => 2023-10-06 08:10:03.468541
[0m08:10:03.483973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A494535F50>]}
[0m08:10:03.483973 [info ] [Thread-1 (]: 8 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.39s]
[0m08:10:03.483973 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m08:10:03.483973 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m08:10:03.483973 [info ] [Thread-1 (]: 9 of 27 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m08:10:03.483973 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m08:10:03.483973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m08:10:03.483973 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m08:10:03.501724 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m08:10:03.501724 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 08:10:03.483973 => 2023-10-06 08:10:03.501724
[0m08:10:03.501724 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m08:10:03.512926 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m08:10:03.514231 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m08:10:03.564663 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.585928 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m08:10:03.642832 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:03.642832 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m08:10:03.706055 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:03.706055 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m08:10:03.753161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.753161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m08:10:03.805756 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.811268 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m08:10:03.855336 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:03.856337 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 08:10:03.501724 => 2023-10-06 08:10:03.856337
[0m08:10:03.857336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493B94C90>]}
[0m08:10:03.858337 [info ] [Thread-1 (]: 9 of 27 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.37s]
[0m08:10:03.858337 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m08:10:03.859337 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m08:10:03.859337 [info ] [Thread-1 (]: 10 of 27 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m08:10:03.860335 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m08:10:03.860335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m08:10:03.861339 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m08:10:03.862486 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m08:10:03.862486 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 08:10:03.861339 => 2023-10-06 08:10:03.862486
[0m08:10:03.862486 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m08:10:03.925081 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m08:10:03.927081 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m08:10:03.978807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:03.981425 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m08:10:04.025580 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:04.027658 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m08:10:04.085696 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.087765 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m08:10:04.145920 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.146950 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m08:10:04.195726 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.199648 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m08:10:04.245938 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.246964 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 08:10:03.862486 => 2023-10-06 08:10:04.246964
[0m08:10:04.248006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493B47E10>]}
[0m08:10:04.248525 [info ] [Thread-1 (]: 10 of 27 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.39s]
[0m08:10:04.249044 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m08:10:04.249044 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m08:10:04.249561 [info ] [Thread-1 (]: 11 of 27 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m08:10:04.250575 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m08:10:04.250575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m08:10:04.251094 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m08:10:04.252650 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m08:10:04.253165 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 08:10:04.251614 => 2023-10-06 08:10:04.253165
[0m08:10:04.253681 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m08:10:04.257500 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m08:10:04.258506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m08:10:04.318846 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.319489 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m08:10:04.362616 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:04.362616 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m08:10:04.419886 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.424186 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m08:10:04.470974 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.470974 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m08:10:04.518406 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.534044 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m08:10:04.577331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:04.592396 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 08:10:04.254195 => 2023-10-06 08:10:04.592396
[0m08:10:04.592396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493E21DD0>]}
[0m08:10:04.592396 [info ] [Thread-1 (]: 11 of 27 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.34s]
[0m08:10:04.592396 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m08:10:04.592396 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m08:10:04.592396 [info ] [Thread-1 (]: 12 of 27 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m08:10:04.592396 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m08:10:04.592396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m08:10:04.608044 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m08:10:04.608044 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m08:10:04.612057 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 08:10:04.608044 => 2023-10-06 08:10:04.612057
[0m08:10:04.612057 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m08:10:04.612057 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m08:10:04.612057 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m08:10:04.683236 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:04.683236 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m08:10:04.746835 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.746835 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m08:10:04.794005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:04.812354 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m08:10:04.872676 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.872676 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m08:10:04.935388 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:04.951705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m08:10:05.013915 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:05.013915 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 08:10:04.612057 => 2023-10-06 08:10:05.013915
[0m08:10:05.013915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493AF3090>]}
[0m08:10:05.013915 [info ] [Thread-1 (]: 12 of 27 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.42s]
[0m08:10:05.013915 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m08:10:05.013915 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m08:10:05.013915 [info ] [Thread-1 (]: 13 of 27 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m08:10:05.013915 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m08:10:05.013915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m08:10:05.013915 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m08:10:05.013915 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m08:10:05.013915 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 08:10:05.013915 => 2023-10-06 08:10:05.013915
[0m08:10:05.013915 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m08:10:05.013915 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m08:10:05.013915 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m08:10:05.081901 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:05.086227 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m08:10:05.137699 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.146752 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m08:10:05.190019 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:05.190019 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m08:10:05.242700 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.246733 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m08:10:05.294021 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.297535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m08:10:05.343940 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.343940 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 08:10:05.013915 => 2023-10-06 08:10:05.343940
[0m08:10:05.343940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493EE8450>]}
[0m08:10:05.343940 [info ] [Thread-1 (]: 13 of 27 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.33s]
[0m08:10:05.343940 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m08:10:05.343940 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m08:10:05.343940 [info ] [Thread-1 (]: 14 of 27 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m08:10:05.343940 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m08:10:05.352448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m08:10:05.352448 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m08:10:05.352448 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m08:10:05.352448 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 08:10:05.352448 => 2023-10-06 08:10:05.352448
[0m08:10:05.352448 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m08:10:05.360022 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m08:10:05.362162 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m08:10:05.409499 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.410503 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m08:10:05.451105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:05.451105 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m08:10:05.490386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:05.507534 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m08:10:05.555140 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.555140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m08:10:05.601684 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.601684 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m08:10:05.647250 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.647250 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 08:10:05.352448 => 2023-10-06 08:10:05.647250
[0m08:10:05.647250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493AF0A50>]}
[0m08:10:05.647250 [info ] [Thread-1 (]: 14 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.30s]
[0m08:10:05.647250 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m08:10:05.647250 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m08:10:05.647250 [info ] [Thread-1 (]: 15 of 27 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m08:10:05.647250 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m08:10:05.647250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m08:10:05.647250 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m08:10:05.662883 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m08:10:05.664392 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 08:10:05.647250 => 2023-10-06 08:10:05.664392
[0m08:10:05.664392 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m08:10:05.664392 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m08:10:05.664392 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m08:10:05.717431 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.722876 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m08:10:05.775392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.775392 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m08:10:05.834115 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:05.839120 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m08:10:05.870894 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:10:05.887597 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m08:10:05.934750 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.934750 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m08:10:05.984121 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:05.984121 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 08:10:05.664392 => 2023-10-06 08:10:05.984121
[0m08:10:05.984121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4940BCC90>]}
[0m08:10:05.984121 [info ] [Thread-1 (]: 15 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.34s]
[0m08:10:05.984121 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m08:10:05.984121 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m08:10:05.984121 [info ] [Thread-1 (]: 16 of 27 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m08:10:05.984121 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m08:10:05.984121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m08:10:05.984121 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m08:10:05.984121 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m08:10:05.984121 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 08:10:05.984121 => 2023-10-06 08:10:05.984121
[0m08:10:05.984121 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m08:10:05.998627 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m08:10:06.000769 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m08:10:06.082234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:06.087365 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m08:10:06.134365 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.134365 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m08:10:06.184245 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.184245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m08:10:06.233784 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.233784 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m08:10:06.294436 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:06.294436 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m08:10:06.350870 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:06.350870 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 08:10:05.984121 => 2023-10-06 08:10:06.350870
[0m08:10:06.350870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4940388D0>]}
[0m08:10:06.350870 [info ] [Thread-1 (]: 16 of 27 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.37s]
[0m08:10:06.350870 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m08:10:06.350870 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m08:10:06.350870 [info ] [Thread-1 (]: 17 of 27 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m08:10:06.350870 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m08:10:06.350870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m08:10:06.350870 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m08:10:06.350870 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m08:10:06.350870 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 08:10:06.350870 => 2023-10-06 08:10:06.350870
[0m08:10:06.365375 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m08:10:06.369562 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m08:10:06.371069 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m08:10:06.419306 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.422304 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m08:10:06.457900 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:10:06.466910 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m08:10:06.514166 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.514166 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m08:10:06.564437 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.564437 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m08:10:06.614496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.616512 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m08:10:06.664366 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.664366 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 08:10:06.365375 => 2023-10-06 08:10:06.664366
[0m08:10:06.664366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49456E610>]}
[0m08:10:06.669124 [info ] [Thread-1 (]: 17 of 27 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.31s]
[0m08:10:06.669124 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m08:10:06.669124 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m08:10:06.669124 [info ] [Thread-1 (]: 18 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m08:10:06.669124 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m08:10:06.669124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m08:10:06.669124 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m08:10:06.669124 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m08:10:06.669124 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 08:10:06.669124 => 2023-10-06 08:10:06.669124
[0m08:10:06.669124 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m08:10:06.732962 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:06.782985 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.803763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m08:10:06.860214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:06.873225 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:06.924954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.924954 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m08:10:06.924954 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m08:10:06.973204 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:06.973204 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60);
    ...
[0m08:10:07.049221 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:07.065395 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:07.115967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.115967 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
    ...
[0m08:10:07.162143 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.162143 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:07.215814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.218823 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m08:10:07.258668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:07.258668 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 08:10:06.669124 => 2023-10-06 08:10:07.258668
[0m08:10:07.258668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493FD64D0>]}
[0m08:10:07.269174 [info ] [Thread-1 (]: 18 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.59s]
[0m08:10:07.269174 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m08:10:07.269174 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m08:10:07.269174 [info ] [Thread-1 (]: 19 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m08:10:07.269174 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m08:10:07.269174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m08:10:07.269174 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m08:10:07.269174 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m08:10:07.275718 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 08:10:07.269174 => 2023-10-06 08:10:07.275718
[0m08:10:07.275718 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m08:10:07.275718 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:07.321264 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.328444 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m08:10:07.375722 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.375722 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:07.428907 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.439451 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m08:10:07.439451 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m08:10:07.490047 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.490047 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60);
    ...
[0m08:10:07.535324 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.535324 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:07.587588 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.587588 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
    ...
[0m08:10:07.647601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:07.647601 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:07.695158 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.695158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m08:10:07.745663 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.748231 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 08:10:07.275718 => 2023-10-06 08:10:07.748231
[0m08:10:07.749273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49451F390>]}
[0m08:10:07.750240 [info ] [Thread-1 (]: 19 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.48s]
[0m08:10:07.750528 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m08:10:07.751529 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m08:10:07.751529 [info ] [Thread-1 (]: 20 of 27 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m08:10:07.752528 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m08:10:07.753564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m08:10:07.753564 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m08:10:07.756563 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m08:10:07.758533 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 08:10:07.753564 => 2023-10-06 08:10:07.757528
[0m08:10:07.758533 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m08:10:07.782032 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m08:10:07.830662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.844671 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:07.892911 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.892911 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m08:10:07.892911 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m08:10:07.941550 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:07.958607 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m08:10:08.004899 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.004899 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m08:10:08.056139 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.056139 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 08:10:07.759531 => 2023-10-06 08:10:08.056139
[0m08:10:08.056139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49456E750>]}
[0m08:10:08.056139 [info ] [Thread-1 (]: 20 of 27 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.30s]
[0m08:10:08.056139 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m08:10:08.056139 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m08:10:08.056139 [info ] [Thread-1 (]: 21 of 27 START sql table model travelata.incremental_sheets_mytarget_banners ... [RUN]
[0m08:10:08.056139 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners'
[0m08:10:08.056139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners)
[0m08:10:08.056139 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners
[0m08:10:08.056139 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners"
[0m08:10:08.069839 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (compile): 2023-10-06 08:10:08.056139 => 2023-10-06 08:10:08.069839
[0m08:10:08.070852 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners
[0m08:10:08.073852 [debug] [Thread-1 (]: Creating new relation incremental_sheets_mytarget_banners
[0m08:10:08.076403 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
    )
        ...
[0m08:10:08.131099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.134137 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:08.188181 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.190492 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners"
[0m08:10:08.191551 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners ("campagin_id", "id", "textblocks", "urls", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
  ...
[0m08:10:08.234847 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:08.234847 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (execute): 2023-10-06 08:10:08.070852 => 2023-10-06 08:10:08.234847
[0m08:10:08.234847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493FD1990>]}
[0m08:10:08.234847 [info ] [Thread-1 (]: 21 of 27 OK created sql table model travelata.incremental_sheets_mytarget_banners  [[32mOK[0m in 0.18s]
[0m08:10:08.234847 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m08:10:08.234847 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m08:10:08.234847 [info ] [Thread-1 (]: 22 of 27 START sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [RUN]
[0m08:10:08.250192 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners_statistics'
[0m08:10:08.250192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners_statistics)
[0m08:10:08.250192 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m08:10:08.250192 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m08:10:08.250192 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (compile): 2023-10-06 08:10:08.250192 => 2023-10-06 08:10:08.250192
[0m08:10:08.250192 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m08:10:08.250192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners_statistics
        
  
        
  engine = MergeTree()
        order by (toDate(_date),table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
    )
        ...
[0m08:10:08.321593 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:08.325606 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners_statistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:08.374442 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.374442 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m08:10:08.374442 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
    ...
[0m08:10:08.468786 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
    
[0m08:10:08.468786 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (execute): 2023-10-06 08:10:08.250192 => 2023-10-06 08:10:08.468786
[0m08:10:08.547415 [debug] [Thread-1 (]: Database Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:10:08.547415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49458A350>]}
[0m08:10:08.547415 [error] [Thread-1 (]: 22 of 27 ERROR creating sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [[31mERROR[0m in 0.30s]
[0m08:10:08.547415 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m08:10:08.547415 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m08:10:08.547415 [info ] [Thread-1 (]: 23 of 27 START sql table model travelata.incremental_sheets_mytarget_compagins . [RUN]
[0m08:10:08.547415 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_compagins'
[0m08:10:08.547415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_compagins)
[0m08:10:08.563006 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_compagins
[0m08:10:08.563006 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m08:10:08.563006 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (compile): 2023-10-06 08:10:08.563006 => 2023-10-06 08:10:08.563006
[0m08:10:08.563006 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_compagins
[0m08:10:08.563006 [debug] [Thread-1 (]: Creating new relation incremental_sheets_mytarget_compagins
[0m08:10:08.563006 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

            

    
        create table travelata.incremental_sheets_mytarget_compagins
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
    )
        ...
[0m08:10:08.621415 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:08.625419 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_compagins'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:08.680053 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.680053 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m08:10:08.680053 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_compagins ("id", "name", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
  ...
[0m08:10:08.727670 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.743306 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (execute): 2023-10-06 08:10:08.563006 => 2023-10-06 08:10:08.743306
[0m08:10:08.743306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49452AFD0>]}
[0m08:10:08.743306 [info ] [Thread-1 (]: 23 of 27 OK created sql table model travelata.incremental_sheets_mytarget_compagins  [[32mOK[0m in 0.20s]
[0m08:10:08.743306 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m08:10:08.743306 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m08:10:08.743306 [info ] [Thread-1 (]: 24 of 27 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m08:10:08.743306 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m08:10:08.743306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m08:10:08.743306 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m08:10:08.743306 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m08:10:08.743306 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 08:10:08.743306 => 2023-10-06 08:10:08.743306
[0m08:10:08.743306 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m08:10:08.743306 [debug] [Thread-1 (]: Creating new relation incremental_sheets_utmcraft_utmresult
[0m08:10:08.743306 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m08:10:08.806175 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:08.813535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:08.866659 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:08.866659 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m08:10:08.866659 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m08:10:08.947273 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:08.960847 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 08:10:08.743306 => 2023-10-06 08:10:08.960847
[0m08:10:08.960847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493B9C450>]}
[0m08:10:08.960847 [info ] [Thread-1 (]: 24 of 27 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.22s]
[0m08:10:08.960847 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m08:10:08.960847 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m08:10:08.960847 [info ] [Thread-1 (]: 25 of 27 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m08:10:08.960847 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m08:10:08.960847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m08:10:08.960847 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m08:10:08.960847 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m08:10:08.960847 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 08:10:08.960847 => 2023-10-06 08:10:08.960847
[0m08:10:08.960847 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m08:10:08.979428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:09.025851 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:09.028861 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m08:10:09.082185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:09.082185 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:09.129708 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:09.129708 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m08:10:09.129708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m08:10:09.209542 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:09.209542 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

      delete from travelata.incremental_sheets_vkads_adgroupsstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60);
    ...
[0m08:10:09.286102 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:09.286102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:09.342909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:09.350934 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
    ...
[0m08:10:09.419330 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:10:09.419330 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:09.464497 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:09.479928 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_distributed_new_data 
  ...
[0m08:10:09.526890 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:09.526890 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 08:10:08.960847 => 2023-10-06 08:10:09.526890
[0m08:10:09.526890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4945F5D10>]}
[0m08:10:10.812729 [info ] [Thread-1 (]: 25 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.57s]
[0m08:10:10.813730 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m08:10:10.813730 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m08:10:10.814731 [info ] [Thread-1 (]: 26 of 27 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m08:10:10.815733 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m08:10:10.815733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m08:10:10.816729 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m08:10:10.819733 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m08:10:10.820731 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 08:10:10.816729 => 2023-10-06 08:10:10.820731
[0m08:10:10.821731 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m08:10:10.828406 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:10.876157 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:10.878157 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m08:10:10.931630 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:10.934629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:10.984352 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:10.984352 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m08:10:10.984352 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m08:10:11.062522 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:11.063528 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

      delete from travelata.incremental_sheets_vkads_adplansstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60);
    ...
[0m08:10:11.123915 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:11.123915 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:11.170698 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.186359 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
    ...
[0m08:10:11.233729 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.249412 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:11.296246 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.296246 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_distributed_new_data 
  ...
[0m08:10:11.343885 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.343885 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 08:10:10.821731 => 2023-10-06 08:10:11.343885
[0m08:10:11.343885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A491796B90>]}
[0m08:10:11.359521 [info ] [Thread-1 (]: 26 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.53s]
[0m08:10:11.361466 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m08:10:11.362465 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m08:10:11.363462 [info ] [Thread-1 (]: 27 of 27 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m08:10:11.366503 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m08:10:11.366503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m08:10:11.367495 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m08:10:11.368636 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m08:10:11.368636 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 08:10:11.367495 => 2023-10-06 08:10:11.368636
[0m08:10:11.368636 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m08:10:11.379693 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:11.435910 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:11.438867 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m08:10:11.488020 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.488020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:11.535668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.535668 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m08:10:11.551338 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m08:10:11.631917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m08:10:11.631917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

      delete from travelata.incremental_sheets_vkads_bannerssstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60);
    ...
[0m08:10:11.656618 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:10:11.658617 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:10:11.715322 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:10:11.715322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60
    ...
[0m08:10:11.762568 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.778202 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_5843dfe8_0017_47b5_8995_03ed085f5a60 
  ...
[0m08:10:11.825451 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:10:11.825451 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_distributed_new_data 
  ...
[0m08:10:11.868065 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:10:11.868065 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 08:10:11.368636 => 2023-10-06 08:10:11.868065
[0m08:10:11.868065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5843dfe8-0017-47b5-8995-03ed085f5a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A49458B010>]}
[0m08:10:11.868065 [info ] [Thread-1 (]: 27 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[32mOK[0m in 0.50s]
[0m08:10:11.868065 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m08:10:11.868065 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:10:11.868065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:11.868065 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m08:10:11.868065 [debug] [MainThread]: On list_schemas: Close
[0m08:10:11.883693 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m08:10:11.883693 [debug] [MainThread]: On list_None_travelata: Close
[0m08:10:11.883693 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics' was left open.
[0m08:10:11.883693 [debug] [MainThread]: On model.travelata.incremental_sheets_vkads_bannerssstatistics: Close
[0m08:10:11.883693 [info ] [MainThread]: 
[0m08:10:11.883693 [info ] [MainThread]: Finished running 17 view models, 6 incremental models, 4 table models in 0 hours 0 minutes and 13.50 seconds (13.50s).
[0m08:10:11.887805 [debug] [MainThread]: Command end result
[0m08:10:11.899441 [info ] [MainThread]: 
[0m08:10:11.899441 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:10:11.902747 [info ] [MainThread]: 
[0m08:10:11.903765 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)[0m
[0m08:10:11.905522 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m08:10:11.905522 [error] [MainThread]:    Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
[0m08:10:11.905522 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m08:10:11.905522 [info ] [MainThread]: 
[0m08:10:11.909717 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=1 SKIP=0 TOTAL=27
[0m08:10:11.910726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A494522610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493BABD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A493E47010>]}
[0m08:10:11.911729 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 09:14:40.327499 | b8a9e0c9-e779-46a5-9240-aa766b9b58ca ==============================
[0m09:14:40.327499 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:14:40.327499 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:14:40.327499 [debug] [MainThread]: Tracking: tracking
[0m09:14:40.349817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F615910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F62AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F62ADD0>]}
[0m09:14:40.358945 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:14:40.461762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:14:40.461762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:14:40.461762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m09:14:40.461762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F5B4550>]}
[0m09:14:40.482087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F5F6390>]}
[0m09:14:40.483305 [info ] [MainThread]: Found 27 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:14:40.484317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409EDF51D0>]}
[0m09:14:40.487434 [info ] [MainThread]: 
[0m09:14:40.490334 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:14:40.492268 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:14:40.501070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:41.085968 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:14:41.133260 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:41.148901 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:14:41.148901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:41.751596 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:14:41.813868 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:41.829958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F963ED0>]}
[0m09:14:41.829958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:14:41.829958 [info ] [MainThread]: 
[0m09:14:41.829958 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:14:41.829958 [info ] [Thread-1 (]: 1 of 27 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m09:14:41.840535 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m09:14:41.840535 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:14:41.842543 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:14:41.844456 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 09:14:41.840535 => 2023-10-06 09:14:41.843542
[0m09:14:41.844456 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:14:41.886212 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:14:41.886212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:14:42.475714 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m09:14:42.538199 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:42.539553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:14:42.585687 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:42.585687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:14:42.632928 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:42.648594 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:14:42.695699 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:42.695699 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:14:42.743181 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:42.790079 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m09:14:42.853346 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:42.853346 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 09:14:41.845469 => 2023-10-06 09:14:42.853346
[0m09:14:42.853346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FE8E8D0>]}
[0m09:14:42.853346 [info ] [Thread-1 (]: 1 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m09:14:42.853346 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:14:42.853346 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:14:42.853346 [info ] [Thread-1 (]: 2 of 27 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m09:14:42.853346 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:14:42.853346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:14:42.853346 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:14:42.853346 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:14:42.853346 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 09:14:42.853346 => 2023-10-06 09:14:42.853346
[0m09:14:42.853346 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:14:42.853346 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:14:42.868970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m09:14:42.917424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:42.920423 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:14:42.956437 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:42.972155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:14:43.019215 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.030247 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:14:43.082642 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.082642 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:14:43.130579 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.146126 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m09:14:43.193022 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.193022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 09:14:42.853346 => 2023-10-06 09:14:43.193022
[0m09:14:43.193022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FEC1650>]}
[0m09:14:43.193022 [info ] [Thread-1 (]: 2 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.34s]
[0m09:14:43.193022 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:14:43.193022 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:14:43.193022 [info ] [Thread-1 (]: 3 of 27 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m09:14:43.193022 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:14:43.193022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:14:43.193022 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:14:43.193022 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:14:43.193022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 09:14:43.193022 => 2023-10-06 09:14:43.193022
[0m09:14:43.193022 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:14:43.212511 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:14:43.213984 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m09:14:43.278205 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:43.293818 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:14:43.341218 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.341218 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:14:43.388772 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.404414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:14:43.451640 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.469736 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:14:43.533081 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:43.533081 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m09:14:43.594088 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:43.595092 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 09:14:43.208635 => 2023-10-06 09:14:43.595092
[0m09:14:43.596090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FF13F90>]}
[0m09:14:43.597093 [info ] [Thread-1 (]: 3 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.40s]
[0m09:14:43.598095 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:14:43.599089 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:14:43.599089 [info ] [Thread-1 (]: 4 of 27 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m09:14:43.600091 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:14:43.600091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:14:43.601089 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:14:43.602090 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:14:43.603088 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 09:14:43.601089 => 2023-10-06 09:14:43.603088
[0m09:14:43.603088 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:14:43.608089 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:14:43.609089 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m09:14:43.650648 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:43.657973 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:14:43.703610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.704612 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:14:43.753375 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.756380 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:14:43.812807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:43.813805 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:14:43.863161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.867158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:14:43.923967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:43.924966 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 09:14:43.604088 => 2023-10-06 09:14:43.924966
[0m09:14:43.925964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FF655D0>]}
[0m09:14:43.925964 [info ] [Thread-1 (]: 4 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.33s]
[0m09:14:43.926965 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:14:43.926965 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:14:43.927964 [info ] [Thread-1 (]: 5 of 27 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m09:14:43.927964 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m09:14:43.929002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m09:14:43.929002 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:14:43.929997 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:14:43.930967 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 09:14:43.929002 => 2023-10-06 09:14:43.930967
[0m09:14:43.931968 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:14:43.934785 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:14:43.934785 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m09:14:43.985817 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:43.988818 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:14:44.032037 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:44.032037 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:14:44.071389 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:44.071389 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:14:44.132306 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:44.134312 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:14:44.181392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.181392 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m09:14:44.232657 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.232657 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 09:14:43.931968 => 2023-10-06 09:14:44.232657
[0m09:14:44.232657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FF1A950>]}
[0m09:14:44.232657 [info ] [Thread-1 (]: 5 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.30s]
[0m09:14:44.232657 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:14:44.232657 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:14:44.232657 [info ] [Thread-1 (]: 6 of 27 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m09:14:44.232657 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m09:14:44.232657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m09:14:44.232657 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:14:44.244164 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:14:44.245181 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 09:14:44.232657 => 2023-10-06 09:14:44.245181
[0m09:14:44.245181 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:14:44.249585 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:14:44.249585 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m09:14:44.318904 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:14:44.335036 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:14:44.381942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.381942 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:14:44.433338 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.444846 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:14:44.493047 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.495046 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:14:44.543749 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.547748 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m09:14:44.603514 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.604514 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 09:14:44.246222 => 2023-10-06 09:14:44.604514
[0m09:14:44.605514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FE3B750>]}
[0m09:14:44.605514 [info ] [Thread-1 (]: 6 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.37s]
[0m09:14:44.606514 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:14:44.606514 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:14:44.607517 [info ] [Thread-1 (]: 7 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m09:14:44.607517 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m09:14:44.608516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m09:14:44.608516 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:14:44.610517 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:14:44.611514 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 09:14:44.608516 => 2023-10-06 09:14:44.611514
[0m09:14:44.611514 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:14:44.616515 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:14:44.617513 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m09:14:44.665479 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.668479 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:14:44.709230 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:44.709230 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:14:44.777742 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:14:44.790288 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:14:44.843570 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.844502 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:14:44.893456 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.896454 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m09:14:44.943392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:44.944390 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 09:14:44.612517 => 2023-10-06 09:14:44.944390
[0m09:14:44.945390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FEF7150>]}
[0m09:14:44.945390 [info ] [Thread-1 (]: 7 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.34s]
[0m09:14:44.946392 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:14:44.946392 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:14:44.947391 [info ] [Thread-1 (]: 8 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m09:14:44.948392 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m09:14:44.948392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m09:14:44.948392 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:14:44.950391 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:14:44.951391 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 09:14:44.949391 => 2023-10-06 09:14:44.951391
[0m09:14:44.951391 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:14:44.955473 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:14:44.955473 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m09:14:45.011236 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.011236 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:14:45.063122 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.064132 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:14:45.107353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:45.122799 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:14:45.186423 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.190425 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:14:45.246439 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.262135 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m09:14:45.309244 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.309244 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 09:14:44.951391 => 2023-10-06 09:14:45.309244
[0m09:14:45.309244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F618150>]}
[0m09:14:45.309244 [info ] [Thread-1 (]: 8 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.36s]
[0m09:14:45.309244 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:14:45.309244 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:14:45.309244 [info ] [Thread-1 (]: 9 of 27 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m09:14:45.309244 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m09:14:45.309244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m09:14:45.309244 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:14:45.309244 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:14:45.309244 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 09:14:45.309244 => 2023-10-06 09:14:45.309244
[0m09:14:45.324584 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:14:45.328426 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:14:45.328426 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m09:14:45.395079 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.395079 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:14:45.442665 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.442665 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:14:45.505185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.505185 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:14:45.552632 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.568190 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:14:45.626121 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.634146 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m09:14:45.674099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:45.674099 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 09:14:45.324584 => 2023-10-06 09:14:45.674099
[0m09:14:45.674099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FFBCC90>]}
[0m09:14:45.674099 [info ] [Thread-1 (]: 9 of 27 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.36s]
[0m09:14:45.674099 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:14:45.674099 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:14:45.674099 [info ] [Thread-1 (]: 10 of 27 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m09:14:45.689530 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m09:14:45.689530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m09:14:45.689530 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:14:45.689530 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:14:45.689530 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 09:14:45.689530 => 2023-10-06 09:14:45.689530
[0m09:14:45.689530 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:14:45.689530 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:14:45.689530 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m09:14:45.747002 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:45.749533 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:14:45.790743 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:45.790743 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:14:45.838081 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.838081 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:14:45.885626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.885626 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:14:45.935622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.944752 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:14:45.992298 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:45.992298 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 09:14:45.689530 => 2023-10-06 09:14:45.992298
[0m09:14:45.995977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FF237D0>]}
[0m09:14:45.995977 [info ] [Thread-1 (]: 10 of 27 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.32s]
[0m09:14:45.995977 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:14:45.995977 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:14:45.995977 [info ] [Thread-1 (]: 11 of 27 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:14:45.995977 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m09:14:45.995977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m09:14:45.995977 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:14:45.995977 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:14:45.995977 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:14:45.995977 => 2023-10-06 09:14:45.995977
[0m09:14:45.995977 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:14:46.006021 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:14:46.008027 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m09:14:46.067693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:46.067693 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:14:46.099265 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:14:46.114934 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:14:46.152508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:46.167811 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:14:46.214651 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.214651 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:14:46.262279 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.262279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m09:14:46.309132 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.309132 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:14:45.995977 => 2023-10-06 09:14:46.309132
[0m09:14:46.309132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FEF76D0>]}
[0m09:14:46.309132 [info ] [Thread-1 (]: 11 of 27 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.31s]
[0m09:14:46.309132 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:14:46.309132 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:14:46.309132 [info ] [Thread-1 (]: 12 of 27 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m09:14:46.324547 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m09:14:46.324547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m09:14:46.324547 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:14:46.324547 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:14:46.324547 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:14:46.324547 => 2023-10-06 09:14:46.324547
[0m09:14:46.324547 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:14:46.341943 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:14:46.343957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m09:14:46.394868 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.436636 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:14:46.473719 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:46.473719 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:14:46.520703 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.536596 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:14:46.583821 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.599257 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:14:46.657625 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:46.657625 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m09:14:46.721280 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:46.721280 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:14:46.324547 => 2023-10-06 09:14:46.721280
[0m09:14:46.721280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F5F5E90>]}
[0m09:14:46.721280 [info ] [Thread-1 (]: 12 of 27 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.40s]
[0m09:14:46.721280 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:14:46.721280 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:14:46.721280 [info ] [Thread-1 (]: 13 of 27 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m09:14:46.721280 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m09:14:46.721280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m09:14:46.721280 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:14:46.721280 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:14:46.721280 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 09:14:46.721280 => 2023-10-06 09:14:46.721280
[0m09:14:46.721280 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:14:46.736795 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:14:46.738688 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m09:14:46.787468 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.790470 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:14:46.843123 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.858810 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:14:46.921379 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:46.921379 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:14:46.969747 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:46.969747 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:14:47.016592 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.038116 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m09:14:47.080472 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:47.096151 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 09:14:46.721280 => 2023-10-06 09:14:47.096151
[0m09:14:47.096151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F8DD310>]}
[0m09:14:47.096151 [info ] [Thread-1 (]: 13 of 27 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m09:14:47.096151 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:14:47.096151 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:14:47.096151 [info ] [Thread-1 (]: 14 of 27 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m09:14:47.096151 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m09:14:47.096151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m09:14:47.096151 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:14:47.096151 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:14:47.096151 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 09:14:47.096151 => 2023-10-06 09:14:47.096151
[0m09:14:47.096151 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:14:47.113534 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:14:47.114535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m09:14:47.173534 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:47.182145 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:14:47.231429 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.238494 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:14:47.294469 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:47.294469 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:14:47.364475 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.366053 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:14:47.413883 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.418120 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m09:14:47.473820 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:47.475923 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 09:14:47.096151 => 2023-10-06 09:14:47.475923
[0m09:14:47.477079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F601250>]}
[0m09:14:47.478238 [info ] [Thread-1 (]: 14 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.38s]
[0m09:14:47.479319 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:14:47.479848 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:14:47.480517 [info ] [Thread-1 (]: 15 of 27 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m09:14:47.481552 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m09:14:47.482073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m09:14:47.482598 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:14:47.485620 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:14:47.487173 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 09:14:47.483475 => 2023-10-06 09:14:47.487173
[0m09:14:47.487694 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:14:47.493949 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:14:47.495629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m09:14:47.546900 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.551515 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:14:47.603508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.604550 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:14:47.652315 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.656633 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:14:47.704278 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.705561 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:14:47.752884 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.752884 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m09:14:47.791800 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:47.791800 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 09:14:47.487694 => 2023-10-06 09:14:47.791800
[0m09:14:47.791800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FEFE410>]}
[0m09:14:47.791800 [info ] [Thread-1 (]: 15 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.31s]
[0m09:14:47.807431 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:14:47.807431 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m09:14:47.807431 [info ] [Thread-1 (]: 16 of 27 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m09:14:47.807431 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m09:14:47.807431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m09:14:47.807431 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m09:14:47.811436 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:14:47.811436 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 09:14:47.811436 => 2023-10-06 09:14:47.811436
[0m09:14:47.811436 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m09:14:47.811436 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:14:47.811436 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m09:14:47.867296 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:47.869295 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:14:47.912664 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:47.912664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:14:47.959557 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:47.959557 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:14:48.018985 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:48.018985 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:14:48.062622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.077662 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m09:14:48.114672 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.114672 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 09:14:47.811436 => 2023-10-06 09:14:48.114672
[0m09:14:48.125712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FF85B50>]}
[0m09:14:48.125712 [info ] [Thread-1 (]: 16 of 27 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.32s]
[0m09:14:48.125712 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m09:14:48.127241 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:14:48.127241 [info ] [Thread-1 (]: 17 of 27 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m09:14:48.127241 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m09:14:48.127241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m09:14:48.127241 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m09:14:48.127241 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:14:48.127241 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 09:14:48.127241 => 2023-10-06 09:14:48.127241
[0m09:14:48.127241 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m09:14:48.135747 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:14:48.135747 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m09:14:48.188495 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:48.188495 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:14:48.247263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:48.254268 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:14:48.293815 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.293815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:14:48.352120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:48.352120 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:14:48.391851 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.405548 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m09:14:48.452862 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:48.452862 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 09:14:48.127241 => 2023-10-06 09:14:48.452862
[0m09:14:48.452862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F59E810>]}
[0m09:14:48.452862 [info ] [Thread-1 (]: 17 of 27 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.33s]
[0m09:14:48.452862 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:14:48.452862 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m09:14:48.452862 [info ] [Thread-1 (]: 18 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m09:14:48.452862 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m09:14:48.452862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m09:14:48.452862 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m09:14:48.471072 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:14:48.473086 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 09:14:48.452862 => 2023-10-06 09:14:48.473086
[0m09:14:48.473600 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m09:14:48.539392 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:48.583505 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.602671 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m09:14:48.667590 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:48.677100 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:48.716315 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:48.716315 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:14:48.729359 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m09:14:48.775042 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:48.775042 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca);
    ...
[0m09:14:48.843945 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:14:48.843945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:48.901853 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:48.901853 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
    ...
[0m09:14:48.951370 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:48.951370 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:48.997416 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.006431 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m09:14:49.045377 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:49.045377 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 09:14:48.473600 => 2023-10-06 09:14:49.045377
[0m09:14:49.045377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FE78D90>]}
[0m09:14:49.045377 [info ] [Thread-1 (]: 18 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.59s]
[0m09:14:49.045377 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m09:14:49.045377 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m09:14:49.045377 [info ] [Thread-1 (]: 19 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m09:14:49.045377 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m09:14:49.061048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m09:14:49.061555 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m09:14:49.061555 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:14:49.061555 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 09:14:49.061555 => 2023-10-06 09:14:49.061555
[0m09:14:49.061555 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m09:14:49.061555 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:49.111182 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.117574 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m09:14:49.168622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.168622 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:49.216868 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.216868 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:14:49.226874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m09:14:49.278626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.280168 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca);
    ...
[0m09:14:49.341898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:49.341898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:49.388502 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.388502 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
    ...
[0m09:14:49.444705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:49.444705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:49.488094 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:49.488094 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m09:14:49.542381 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.542381 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 09:14:49.061555 => 2023-10-06 09:14:49.542381
[0m09:14:49.542381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FEFEE50>]}
[0m09:14:49.547892 [info ] [Thread-1 (]: 19 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.50s]
[0m09:14:49.549205 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m09:14:49.550045 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:14:49.550553 [info ] [Thread-1 (]: 20 of 27 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m09:14:49.552307 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m09:14:49.553448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m09:14:49.553952 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:14:49.559412 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:14:49.560986 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 09:14:49.554490 => 2023-10-06 09:14:49.560986
[0m09:14:49.561656 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:14:49.590613 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m09:14:49.638174 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.638174 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:49.670438 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:14:49.685978 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:14:49.685978 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m09:14:49.733748 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.733748 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m09:14:49.782786 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.797297 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:14:49.843350 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.845390 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 09:14:49.562178 => 2023-10-06 09:14:49.845390
[0m09:14:49.845522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409FA1B450>]}
[0m09:14:49.845522 [info ] [Thread-1 (]: 20 of 27 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.29s]
[0m09:14:49.845522 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:14:49.845522 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m09:14:49.845522 [info ] [Thread-1 (]: 21 of 27 START sql table model travelata.incremental_sheets_mytarget_banners ... [RUN]
[0m09:14:49.845522 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners'
[0m09:14:49.849862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners)
[0m09:14:49.849862 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners
[0m09:14:49.849862 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:14:49.849862 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (compile): 2023-10-06 09:14:49.849862 => 2023-10-06 09:14:49.849862
[0m09:14:49.849862 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners
[0m09:14:49.849862 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
    )
        ...
[0m09:14:49.910303 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:49.913386 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:49.962944 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:49.962944 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:14:49.967695 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners__dbt_backup ("campagin_id", "id", "textblocks", "urls", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
  ...
[0m09:14:50.015464 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.015464 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_banners__dbt_backup AND travelata.incremental_sheets_mytarget_banners 
  
  ...
[0m09:14:50.062898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.062898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
drop table if exists travelata.incremental_sheets_mytarget_banners__dbt_backup 
  ...
[0m09:14:50.113740 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.115909 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (execute): 2023-10-06 09:14:49.849862 => 2023-10-06 09:14:50.115377
[0m09:14:50.116973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F63D810>]}
[0m09:14:50.117511 [info ] [Thread-1 (]: 21 of 27 OK created sql table model travelata.incremental_sheets_mytarget_banners  [[32mOK[0m in 0.27s]
[0m09:14:50.118577 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m09:14:50.118577 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:14:50.119110 [info ] [Thread-1 (]: 22 of 27 START sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [RUN]
[0m09:14:50.120350 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners_statistics'
[0m09:14:50.120350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners_statistics)
[0m09:14:50.120350 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:14:50.121865 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:14:50.121865 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (compile): 2023-10-06 09:14:50.120350 => 2023-10-06 09:14:50.121865
[0m09:14:50.128874 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:14:50.128874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */
drop table if exists travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:50.183329 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.185390 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(_date),table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
    )
        ...
[0m09:14:50.233010 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.233010 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners_statistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:50.290528 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.297725 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:14:50.297725 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      ...
[0m09:14:50.345705 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      
[0m09:14:50.345705 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (execute): 2023-10-06 09:14:50.128874 => 2023-10-06 09:14:50.345705
[0m09:14:50.345705 [debug] [Thread-1 (]: Database Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:14:50.345705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F9CCE50>]}
[0m09:14:50.345705 [error] [Thread-1 (]: 22 of 27 ERROR creating sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [[31mERROR[0m in 0.23s]
[0m09:14:50.345705 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:14:50.345705 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:14:50.361159 [info ] [Thread-1 (]: 23 of 27 START sql table model travelata.incremental_sheets_mytarget_compagins . [RUN]
[0m09:14:50.361655 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_compagins'
[0m09:14:50.363162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_compagins)
[0m09:14:50.363162 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_compagins
[0m09:14:50.367422 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:14:50.369387 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (compile): 2023-10-06 09:14:50.363162 => 2023-10-06 09:14:50.369387
[0m09:14:50.369387 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_compagins
[0m09:14:50.375729 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

            

    
        create table travelata.incremental_sheets_mytarget_compagins__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
    )
        ...
[0m09:14:50.431746 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.434710 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_compagins__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:50.483598 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.483598 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:14:50.483598 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_compagins__dbt_backup ("id", "name", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
  ...
[0m09:14:50.545763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:50.545763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_compagins__dbt_backup AND travelata.incremental_sheets_mytarget_compagins 
  
  ...
[0m09:14:50.592985 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.597537 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
drop table if exists travelata.incremental_sheets_mytarget_compagins__dbt_backup 
  ...
[0m09:14:50.646072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.646072 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (execute): 2023-10-06 09:14:50.370389 => 2023-10-06 09:14:50.646072
[0m09:14:50.646072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C9E8A50>]}
[0m09:14:50.657118 [info ] [Thread-1 (]: 23 of 27 OK created sql table model travelata.incremental_sheets_mytarget_compagins  [[32mOK[0m in 0.28s]
[0m09:14:50.657118 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:14:50.657118 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:14:50.657118 [info ] [Thread-1 (]: 24 of 27 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m09:14:50.657118 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m09:14:50.657118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m09:14:50.657118 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:14:50.657118 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:14:50.657118 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 09:14:50.657118 => 2023-10-06 09:14:50.657118
[0m09:14:50.657118 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:14:50.657118 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m09:14:50.719518 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:50.719518 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:50.782604 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:50.782604 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:14:50.782604 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult__dbt_backup ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m09:14:50.846093 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:50.846093 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
EXCHANGE TABLES travelata.incremental_sheets_utmcraft_utmresult__dbt_backup AND travelata.incremental_sheets_utmcraft_utmresult 
  
  ...
[0m09:14:50.894193 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:50.894193 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
drop table if exists travelata.incremental_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:14:50.944284 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:50.944284 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 09:14:50.657118 => 2023-10-06 09:14:50.944284
[0m09:14:50.944284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F9565D0>]}
[0m09:14:50.944284 [info ] [Thread-1 (]: 24 of 27 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.29s]
[0m09:14:50.944284 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:14:50.944284 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:14:50.944284 [info ] [Thread-1 (]: 25 of 27 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:14:50.944284 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m09:14:50.944284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m09:14:50.954791 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:14:50.954791 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:14:50.954791 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:14:50.954791 => 2023-10-06 09:14:50.954791
[0m09:14:50.954791 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:14:50.954791 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:51.014146 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:51.016112 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m09:14:51.064917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:51.064917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:51.111940 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:51.111940 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:14:51.127326 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m09:14:51.193224 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:14:51.206264 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

      delete from travelata.incremental_sheets_vkads_adgroupsstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca);
    ...
[0m09:14:51.253856 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:51.253856 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:51.316426 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:51.316426 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
    ...
[0m09:14:51.402015 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m09:14:51.402015 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:51.452050 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:51.452050 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_distributed_new_data 
  ...
[0m09:14:51.490280 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:51.505786 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:14:50.954791 => 2023-10-06 09:14:51.505786
[0m09:14:51.505786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F910910>]}
[0m09:14:52.636461 [info ] [Thread-1 (]: 25 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.56s]
[0m09:14:52.636461 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:14:52.648499 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:14:52.648499 [info ] [Thread-1 (]: 26 of 27 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m09:14:52.654998 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m09:14:52.656019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m09:14:52.657849 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:14:52.665909 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:14:52.667902 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:14:52.657849 => 2023-10-06 09:14:52.667902
[0m09:14:52.668903 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:14:52.679900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:52.723022 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:52.726019 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m09:14:52.779030 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:52.783546 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:52.834588 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:52.836588 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:14:52.837343 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m09:14:52.898611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:52.899648 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

      delete from travelata.incremental_sheets_vkads_adplansstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca);
    ...
[0m09:14:52.950183 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:52.950183 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:53.004124 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.006126 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
    ...
[0m09:14:53.056267 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.056267 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:53.103278 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.118754 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_distributed_new_data 
  ...
[0m09:14:53.166728 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.182108 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:14:52.669902 => 2023-10-06 09:14:53.182108
[0m09:14:53.182108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C758FD0>]}
[0m09:14:53.182108 [info ] [Thread-1 (]: 26 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.53s]
[0m09:14:53.182108 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:14:53.182108 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:14:53.182108 [info ] [Thread-1 (]: 27 of 27 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m09:14:53.182108 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m09:14:53.182108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m09:14:53.182108 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:14:53.200933 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:14:53.201933 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 09:14:53.182108 => 2023-10-06 09:14:53.201933
[0m09:14:53.202931 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:14:53.208955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:53.254096 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.254096 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m09:14:53.321314 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:14:53.324314 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:53.378880 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:14:53.378880 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:14:53.378880 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m09:14:53.441108 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:53.441108 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

      delete from travelata.incremental_sheets_vkads_bannerssstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca);
    ...
[0m09:14:53.504084 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:53.504084 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:14:53.561815 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:53.561815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca
    ...
[0m09:14:53.625567 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:53.633096 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_b8a9e0c9_e779_46a5_9240_aa766b9b58ca 
  ...
[0m09:14:53.672310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:14:53.672310 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_distributed_new_data 
  ...
[0m09:14:53.734621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:14:53.734621 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 09:14:53.202931 => 2023-10-06 09:14:53.734621
[0m09:14:53.750178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8a9e0c9-e779-46a5-9240-aa766b9b58ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F618ED0>]}
[0m09:14:53.750178 [info ] [Thread-1 (]: 27 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[32mOK[0m in 0.55s]
[0m09:14:53.750178 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:14:53.750178 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:14:53.750178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:53.750178 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:14:53.750178 [debug] [MainThread]: On list_schemas: Close
[0m09:14:53.750178 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:14:53.750178 [debug] [MainThread]: On list_None_travelata: Close
[0m09:14:53.750178 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics' was left open.
[0m09:14:53.750178 [debug] [MainThread]: On model.travelata.incremental_sheets_vkads_bannerssstatistics: Close
[0m09:14:53.750178 [info ] [MainThread]: 
[0m09:14:53.765816 [info ] [MainThread]: Finished running 17 view models, 6 incremental models, 4 table models in 0 hours 0 minutes and 13.26 seconds (13.26s).
[0m09:14:53.769227 [debug] [MainThread]: Command end result
[0m09:14:53.781958 [info ] [MainThread]: 
[0m09:14:53.783966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:14:53.784968 [info ] [MainThread]: 
[0m09:14:53.785966 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)[0m
[0m09:14:53.786969 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m09:14:53.787347 [error] [MainThread]:    Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
[0m09:14:53.788793 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:14:53.788793 [info ] [MainThread]: 
[0m09:14:53.789803 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=1 SKIP=0 TOTAL=27
[0m09:14:53.790801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F8CD2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F5B51D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409F66FC10>]}
[0m09:14:53.791807 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 09:23:29.984812 | 7de46e80-34ec-40a6-96c4-fbdb293da6b5 ==============================
[0m09:23:29.984812 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:23:29.986873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:23:29.986873 [debug] [MainThread]: Tracking: tracking
[0m09:23:29.988058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939ECBBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939E6C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939E803D0>]}
[0m09:23:30.003067 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:23:30.107863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:23:30.107863 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m09:23:30.107863 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m09:23:30.107863 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m09:23:30.123495 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m09:23:30.139114 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m09:23:30.139114 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m09:23:30.154740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m09:23:30.165283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229396C5250>]}
[0m09:23:30.170824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A12C210>]}
[0m09:23:30.170824 [info ] [MainThread]: Found 27 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:23:30.170824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939A0C4D0>]}
[0m09:23:30.170824 [info ] [MainThread]: 
[0m09:23:30.170824 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:23:30.170824 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:23:30.186492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:30.797675 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:23:30.867815 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:30.883479 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:23:30.901607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:31.493519 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:23:31.537714 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:31.553378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939965810>]}
[0m09:23:31.557897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:23:31.557897 [info ] [MainThread]: 
[0m09:23:31.557897 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:23:31.557897 [info ] [Thread-1 (]: 1 of 27 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m09:23:31.557897 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m09:23:31.557897 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:23:31.557897 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:23:31.567912 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 09:23:31.557897 => 2023-10-06 09:23:31.567912
[0m09:23:31.567912 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:23:31.603069 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:23:31.605037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:23:32.169186 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m09:23:32.212523 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:32.212523 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:23:32.275610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.275610 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:23:32.322653 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.338152 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:23:32.385408 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.385408 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:23:32.442372 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.489639 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m09:23:32.536832 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.536832 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 09:23:31.567912 => 2023-10-06 09:23:32.536832
[0m09:23:32.536832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939EE9690>]}
[0m09:23:32.536832 [info ] [Thread-1 (]: 1 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 0.98s]
[0m09:23:32.536832 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:23:32.536832 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:23:32.536832 [info ] [Thread-1 (]: 2 of 27 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m09:23:32.536832 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:23:32.536832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:23:32.536832 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:23:32.536832 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:23:32.536832 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 09:23:32.536832 => 2023-10-06 09:23:32.536832
[0m09:23:32.536832 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:23:32.552139 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:23:32.552139 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m09:23:32.607196 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.607196 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:23:32.654251 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.654251 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:23:32.717234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.732857 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:23:32.780423 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.780423 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:23:32.842954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.858588 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m09:23:32.906008 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:32.906008 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 09:23:32.536832 => 2023-10-06 09:23:32.906008
[0m09:23:32.906008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229396AE510>]}
[0m09:23:32.921635 [info ] [Thread-1 (]: 2 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.37s]
[0m09:23:32.921635 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:23:32.921635 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:23:32.921635 [info ] [Thread-1 (]: 3 of 27 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m09:23:32.921635 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:23:32.921635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:23:32.921635 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:23:32.921635 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:23:32.921635 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 09:23:32.921635 => 2023-10-06 09:23:32.921635
[0m09:23:32.921635 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:23:32.921635 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:23:32.921635 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m09:23:32.981079 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:32.981079 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:23:33.028258 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.028258 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:23:33.075543 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.084875 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:23:33.122729 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:33.122729 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:23:33.171893 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.171893 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m09:23:33.216660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:33.216660 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 09:23:32.921635 => 2023-10-06 09:23:33.216660
[0m09:23:33.232323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939E64F90>]}
[0m09:23:33.232323 [info ] [Thread-1 (]: 3 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.31s]
[0m09:23:33.232323 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:23:33.232323 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:23:33.232323 [info ] [Thread-1 (]: 4 of 27 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m09:23:33.232323 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:23:33.232323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:23:33.232323 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:23:33.232323 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:23:33.232323 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 09:23:33.232323 => 2023-10-06 09:23:33.232323
[0m09:23:33.232323 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:23:33.232323 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:23:33.232323 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m09:23:33.301145 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:33.301145 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:23:33.348043 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.348043 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:23:33.411241 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:33.411241 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:23:33.467435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:33.467435 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:23:33.514506 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.514506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:23:33.577231 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:33.577231 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 09:23:33.232323 => 2023-10-06 09:23:33.577231
[0m09:23:33.577231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A853790>]}
[0m09:23:33.577231 [info ] [Thread-1 (]: 4 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.34s]
[0m09:23:33.592893 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:23:33.592893 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:23:33.592893 [info ] [Thread-1 (]: 5 of 27 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m09:23:33.592893 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m09:23:33.592893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m09:23:33.592893 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:23:33.592893 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:23:33.592893 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 09:23:33.592893 => 2023-10-06 09:23:33.592893
[0m09:23:33.592893 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:23:33.608533 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:23:33.608533 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m09:23:33.662920 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.672926 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:23:33.709987 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:33.709987 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:23:33.772263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.772826 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:23:33.819591 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.819591 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:23:33.873019 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.882568 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m09:23:33.929454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:33.929454 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 09:23:33.592893 => 2023-10-06 09:23:33.929454
[0m09:23:33.929454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939DFD8D0>]}
[0m09:23:33.929454 [info ] [Thread-1 (]: 5 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.34s]
[0m09:23:33.929454 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:23:33.929454 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:23:33.929454 [info ] [Thread-1 (]: 6 of 27 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m09:23:33.929454 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m09:23:33.929454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m09:23:33.929454 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:23:33.945636 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:23:33.945636 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 09:23:33.929454 => 2023-10-06 09:23:33.945636
[0m09:23:33.945636 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:23:33.945636 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:23:33.945636 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m09:23:34.013061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:34.021566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:23:34.058003 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:34.058003 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:23:34.120846 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.120846 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:23:34.174075 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.174075 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:23:34.230705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.230705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m09:23:34.293959 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.293959 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 09:23:33.945636 => 2023-10-06 09:23:34.293959
[0m09:23:34.293959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A748810>]}
[0m09:23:34.293959 [info ] [Thread-1 (]: 6 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.36s]
[0m09:23:34.293959 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:23:34.293959 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:23:34.293959 [info ] [Thread-1 (]: 7 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m09:23:34.293959 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m09:23:34.293959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m09:23:34.293959 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:23:34.293959 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:23:34.293959 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 09:23:34.293959 => 2023-10-06 09:23:34.293959
[0m09:23:34.293959 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:23:34.309464 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:23:34.309464 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m09:23:34.366109 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.370104 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:23:34.413140 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:34.413140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:23:34.460252 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.476302 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:23:34.537963 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.537963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:23:34.601128 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:34.601128 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m09:23:34.679773 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:23:34.679773 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 09:23:34.293959 => 2023-10-06 09:23:34.679773
[0m09:23:34.679773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A21C250>]}
[0m09:23:34.679773 [info ] [Thread-1 (]: 7 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.39s]
[0m09:23:34.679773 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:23:34.695420 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:23:34.695420 [info ] [Thread-1 (]: 8 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m09:23:34.695420 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m09:23:34.695420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m09:23:34.695420 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:23:34.695420 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:23:34.695420 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 09:23:34.695420 => 2023-10-06 09:23:34.695420
[0m09:23:34.695420 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:23:34.711075 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:23:34.711075 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m09:23:34.763237 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.778338 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:23:34.825304 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.825304 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:23:34.874821 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.888342 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:23:34.935240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:34.939753 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:23:34.983628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:34.983628 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m09:23:35.031034 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.031034 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 09:23:34.695420 => 2023-10-06 09:23:35.031034
[0m09:23:35.031034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A795010>]}
[0m09:23:35.031034 [info ] [Thread-1 (]: 8 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.34s]
[0m09:23:35.031034 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:23:35.031034 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:23:35.031034 [info ] [Thread-1 (]: 9 of 27 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m09:23:35.031034 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m09:23:35.031034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m09:23:35.031034 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:23:35.031034 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:23:35.031034 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 09:23:35.031034 => 2023-10-06 09:23:35.031034
[0m09:23:35.046984 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:23:35.050562 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:23:35.051568 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m09:23:35.100493 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.100493 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:23:35.147393 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.147393 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:23:35.195146 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.210513 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:23:35.257446 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.275042 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:23:35.320341 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.320341 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m09:23:35.375226 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.375226 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 09:23:35.047571 => 2023-10-06 09:23:35.375226
[0m09:23:35.375226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A2F6810>]}
[0m09:23:35.375226 [info ] [Thread-1 (]: 9 of 27 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.34s]
[0m09:23:35.375226 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:23:35.375226 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:23:35.375226 [info ] [Thread-1 (]: 10 of 27 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m09:23:35.375226 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m09:23:35.375226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m09:23:35.383230 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:23:35.383230 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:23:35.383230 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 09:23:35.383230 => 2023-10-06 09:23:35.383230
[0m09:23:35.383230 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:23:35.383230 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:23:35.383230 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m09:23:35.439331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:35.475200 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:23:35.518503 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:35.533919 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:23:35.592155 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:35.592842 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:23:35.639310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.639310 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:23:35.686933 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.702567 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:23:35.749449 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.749449 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 09:23:35.383230 => 2023-10-06 09:23:35.749449
[0m09:23:35.749449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022938AA46D0>]}
[0m09:23:35.749449 [info ] [Thread-1 (]: 10 of 27 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.37s]
[0m09:23:35.749449 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:23:35.749449 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:23:35.749449 [info ] [Thread-1 (]: 11 of 27 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:23:35.749449 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m09:23:35.749449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m09:23:35.749449 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:23:35.749449 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:23:35.749449 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:23:35.749449 => 2023-10-06 09:23:35.749449
[0m09:23:35.749449 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:23:35.765073 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:23:35.765073 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m09:23:35.831013 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:35.831013 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:23:35.878634 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.878634 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:23:35.941937 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:35.941937 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:23:35.988961 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:35.988961 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:23:36.036126 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.051758 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m09:23:36.098916 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.098916 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:23:35.749449 => 2023-10-06 09:23:36.098916
[0m09:23:36.098916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A1AFD50>]}
[0m09:23:36.098916 [info ] [Thread-1 (]: 11 of 27 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.35s]
[0m09:23:36.098916 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:23:36.098916 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:23:36.098916 [info ] [Thread-1 (]: 12 of 27 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m09:23:36.098916 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m09:23:36.098916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m09:23:36.098916 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:23:36.098916 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:23:36.098916 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:23:36.098916 => 2023-10-06 09:23:36.098916
[0m09:23:36.098916 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:23:36.098916 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:23:36.098916 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m09:23:36.160613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:36.163616 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:23:36.200608 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:36.216275 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:23:36.263336 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.279496 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:23:36.326398 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.326398 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:23:36.389622 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:36.405279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m09:23:36.452399 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.452399 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:23:36.098916 => 2023-10-06 09:23:36.452399
[0m09:23:36.467851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939ED7C90>]}
[0m09:23:36.467851 [info ] [Thread-1 (]: 12 of 27 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.37s]
[0m09:23:36.467851 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:23:36.467851 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:23:36.467851 [info ] [Thread-1 (]: 13 of 27 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m09:23:36.477365 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m09:23:36.477365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m09:23:36.477365 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:23:36.477365 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:23:36.483886 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 09:23:36.477365 => 2023-10-06 09:23:36.477365
[0m09:23:36.483886 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:23:36.483886 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:23:36.483886 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m09:23:36.537038 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.552658 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:23:36.584331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:23:36.600006 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:23:36.647129 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.647129 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:23:36.684462 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:23:36.700094 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:23:36.747158 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.762664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m09:23:36.824748 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:36.824748 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 09:23:36.483886 => 2023-10-06 09:23:36.824748
[0m09:23:36.824748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A7D2890>]}
[0m09:23:36.840428 [info ] [Thread-1 (]: 13 of 27 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.36s]
[0m09:23:36.840428 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:23:36.840428 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:23:36.840428 [info ] [Thread-1 (]: 14 of 27 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m09:23:36.840428 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m09:23:36.840428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m09:23:36.840428 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:23:36.856006 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:23:36.856006 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 09:23:36.856006 => 2023-10-06 09:23:36.856006
[0m09:23:36.856006 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:23:36.856006 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:23:36.871653 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m09:23:36.929391 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:36.929391 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:23:36.978285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:36.978285 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:23:37.039896 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:37.039896 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:23:37.087550 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.104029 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:23:37.150428 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.150428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m09:23:37.206282 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:37.206282 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 09:23:36.856006 => 2023-10-06 09:23:37.206282
[0m09:23:37.206282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A7B0610>]}
[0m09:23:37.206282 [info ] [Thread-1 (]: 14 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.37s]
[0m09:23:37.221850 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:23:37.221850 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:23:37.221850 [info ] [Thread-1 (]: 15 of 27 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m09:23:37.221850 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m09:23:37.221850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m09:23:37.221850 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:23:37.221850 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:23:37.221850 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 09:23:37.221850 => 2023-10-06 09:23:37.221850
[0m09:23:37.221850 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:23:37.221850 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:23:37.221850 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m09:23:37.281504 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:37.284502 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:23:37.318087 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:23:37.318087 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:23:37.378506 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:37.381029 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:23:37.427917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.427917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:23:37.478867 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.490879 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m09:23:37.537770 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.537770 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 09:23:37.221850 => 2023-10-06 09:23:37.537770
[0m09:23:37.537770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939F2DB10>]}
[0m09:23:37.537770 [info ] [Thread-1 (]: 15 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.32s]
[0m09:23:37.537770 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:23:37.537770 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m09:23:37.537770 [info ] [Thread-1 (]: 16 of 27 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m09:23:37.537770 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m09:23:37.537770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m09:23:37.537770 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m09:23:37.537770 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:23:37.537770 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 09:23:37.537770 => 2023-10-06 09:23:37.537770
[0m09:23:37.537770 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m09:23:37.553394 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:23:37.553394 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m09:23:37.599794 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.599794 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:23:37.646882 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.646882 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:23:37.710965 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:37.718540 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:23:37.755835 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:37.755835 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:23:37.818069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.821182 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m09:23:37.867979 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.869542 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 09:23:37.537770 => 2023-10-06 09:23:37.869542
[0m09:23:37.870580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939EC0650>]}
[0m09:23:37.871105 [info ] [Thread-1 (]: 16 of 27 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.33s]
[0m09:23:37.871621 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m09:23:37.872138 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:23:37.872646 [info ] [Thread-1 (]: 17 of 27 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m09:23:37.873177 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m09:23:37.873692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m09:23:37.874201 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m09:23:37.876304 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:23:37.877862 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 09:23:37.874201 => 2023-10-06 09:23:37.877862
[0m09:23:37.878390 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m09:23:37.882431 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:23:37.882431 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m09:23:37.931582 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:37.934194 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:23:37.978212 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:37.979309 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:23:38.038109 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:38.039145 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:23:38.079470 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:38.079470 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:23:38.137502 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.153679 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m09:23:38.200581 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.208843 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 09:23:37.878908 => 2023-10-06 09:23:38.208843
[0m09:23:38.208843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A1859D0>]}
[0m09:23:38.208843 [info ] [Thread-1 (]: 17 of 27 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.34s]
[0m09:23:38.208843 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:23:38.208843 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m09:23:38.208843 [info ] [Thread-1 (]: 18 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m09:23:38.208843 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m09:23:38.208843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m09:23:38.208843 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m09:23:38.216349 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:23:38.216349 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 09:23:38.208843 => 2023-10-06 09:23:38.216349
[0m09:23:38.216349 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m09:23:38.264675 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:38.308524 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:38.329237 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m09:23:38.379809 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.389828 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:38.437509 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.437509 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:23:38.437509 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m09:23:38.485443 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.485443 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5);
    ...
[0m09:23:38.549129 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:38.551390 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:38.596094 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:38.596094 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    ...
[0m09:23:38.642863 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.658545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:38.706440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.706440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m09:23:38.753258 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.753258 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 09:23:38.216349 => 2023-10-06 09:23:38.753258
[0m09:23:38.753258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939ECB510>]}
[0m09:23:38.769526 [info ] [Thread-1 (]: 18 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.54s]
[0m09:23:38.770554 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m09:23:38.772957 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m09:23:38.774027 [info ] [Thread-1 (]: 19 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m09:23:38.777038 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m09:23:38.778023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m09:23:38.779141 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m09:23:38.782149 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:23:38.787747 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 09:23:38.779755 => 2023-10-06 09:23:38.787747
[0m09:23:38.788709 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m09:23:38.795524 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:38.844237 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.859933 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m09:23:38.912354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:38.913903 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:38.954346 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:38.969869 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:23:38.969869 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m09:23:39.049147 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:23:39.049147 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5);
    ...
[0m09:23:39.112240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:39.112240 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:39.179562 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:39.181669 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    ...
[0m09:23:39.222592 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:39.222592 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:39.286480 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:39.286480 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m09:23:39.342813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:39.342813 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 09:23:38.788709 => 2023-10-06 09:23:39.342813
[0m09:23:39.342813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A82A2D0>]}
[0m09:23:39.342813 [info ] [Thread-1 (]: 19 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.57s]
[0m09:23:39.342813 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m09:23:39.342813 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:23:39.342813 [info ] [Thread-1 (]: 20 of 27 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m09:23:39.342813 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m09:23:39.342813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m09:23:39.342813 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:23:39.355320 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:23:39.355320 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 09:23:39.355320 => 2023-10-06 09:23:39.355320
[0m09:23:39.355320 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:23:39.371361 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m09:23:39.420477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.420477 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:39.468035 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.468035 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:23:39.468035 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m09:23:39.527155 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:39.532196 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m09:23:39.563871 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:23:39.581915 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:23:39.627016 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.627016 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 09:23:39.355320 => 2023-10-06 09:23:39.627016
[0m09:23:39.627016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A7B7550>]}
[0m09:23:39.627016 [info ] [Thread-1 (]: 20 of 27 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.28s]
[0m09:23:39.627016 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:23:39.627016 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m09:23:39.627016 [info ] [Thread-1 (]: 21 of 27 START sql table model travelata.incremental_sheets_mytarget_banners ... [RUN]
[0m09:23:39.627016 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners'
[0m09:23:39.627016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners)
[0m09:23:39.627016 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners
[0m09:23:39.627016 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:23:39.627016 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (compile): 2023-10-06 09:23:39.627016 => 2023-10-06 09:23:39.627016
[0m09:23:39.627016 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners
[0m09:23:39.642678 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
    )
        ...
[0m09:23:39.692986 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.694984 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:39.731144 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:39.740156 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:23:39.740156 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners__dbt_backup ("campagin_id", "id", "textblocks", "urls", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
  ...
[0m09:23:39.785944 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.792956 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_banners__dbt_backup AND travelata.incremental_sheets_mytarget_banners 
  
  ...
[0m09:23:39.835315 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:39.842077 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
drop table if exists travelata.incremental_sheets_mytarget_banners__dbt_backup 
  ...
[0m09:23:39.882377 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:39.882377 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (execute): 2023-10-06 09:23:39.627016 => 2023-10-06 09:23:39.882377
[0m09:23:39.890394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A880110>]}
[0m09:23:39.890394 [info ] [Thread-1 (]: 21 of 27 OK created sql table model travelata.incremental_sheets_mytarget_banners  [[32mOK[0m in 0.26s]
[0m09:23:39.890394 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m09:23:39.890394 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:23:39.890394 [info ] [Thread-1 (]: 22 of 27 START sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [RUN]
[0m09:23:39.890394 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners_statistics'
[0m09:23:39.890394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners_statistics)
[0m09:23:39.890394 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:23:39.897905 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:23:39.897905 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (compile): 2023-10-06 09:23:39.890394 => 2023-10-06 09:23:39.897905
[0m09:23:39.899228 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:23:39.906732 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */
drop table if exists travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:39.957447 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:39.960132 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(_date),table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
    )
        ...
[0m09:23:40.006551 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.006551 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners_statistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:40.070497 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:40.070497 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:23:40.070497 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      ...
[0m09:23:40.133736 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      
[0m09:23:40.133736 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (execute): 2023-10-06 09:23:39.899228 => 2023-10-06 09:23:40.133736
[0m09:23:40.144246 [debug] [Thread-1 (]: Database Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:23:40.144246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A895A90>]}
[0m09:23:40.144246 [error] [Thread-1 (]: 22 of 27 ERROR creating sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [[31mERROR[0m in 0.25s]
[0m09:23:40.144246 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:23:40.144246 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:23:40.144246 [info ] [Thread-1 (]: 23 of 27 START sql table model travelata.incremental_sheets_mytarget_compagins . [RUN]
[0m09:23:40.149767 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_compagins'
[0m09:23:40.149767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_compagins)
[0m09:23:40.149767 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_compagins
[0m09:23:40.149767 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:23:40.149767 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (compile): 2023-10-06 09:23:40.149767 => 2023-10-06 09:23:40.149767
[0m09:23:40.149767 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_compagins
[0m09:23:40.149767 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

            

    
        create table travelata.incremental_sheets_mytarget_compagins__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
    )
        ...
[0m09:23:40.244381 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m09:23:40.244381 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_compagins__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:40.308486 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:40.310010 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:23:40.311520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_compagins__dbt_backup ("id", "name", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
  ...
[0m09:23:40.361086 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.362087 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_compagins__dbt_backup AND travelata.incremental_sheets_mytarget_compagins 
  
  ...
[0m09:23:40.400693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:40.411340 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
drop table if exists travelata.incremental_sheets_mytarget_compagins__dbt_backup 
  ...
[0m09:23:40.458536 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.460906 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (execute): 2023-10-06 09:23:40.149767 => 2023-10-06 09:23:40.460400
[0m09:23:40.462023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A1BB850>]}
[0m09:23:40.462694 [info ] [Thread-1 (]: 23 of 27 OK created sql table model travelata.incremental_sheets_mytarget_compagins  [[32mOK[0m in 0.31s]
[0m09:23:40.463854 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:23:40.464377 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:23:40.464930 [info ] [Thread-1 (]: 24 of 27 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m09:23:40.465978 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m09:23:40.465978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m09:23:40.466491 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:23:40.468569 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:23:40.469604 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 09:23:40.466491 => 2023-10-06 09:23:40.469604
[0m09:23:40.470125 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:23:40.475614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m09:23:40.529751 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.534760 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:40.583005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.583005 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:23:40.592557 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult__dbt_backup ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m09:23:40.642936 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.642936 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
EXCHANGE TABLES travelata.incremental_sheets_utmcraft_utmresult__dbt_backup AND travelata.incremental_sheets_utmcraft_utmresult 
  
  ...
[0m09:23:40.687813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:40.687813 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
drop table if exists travelata.incremental_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:23:40.745997 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:40.745997 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 09:23:40.470650 => 2023-10-06 09:23:40.745997
[0m09:23:40.745997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A2F40D0>]}
[0m09:23:40.745997 [info ] [Thread-1 (]: 24 of 27 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.28s]
[0m09:23:40.751506 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:23:40.752913 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:23:40.752913 [info ] [Thread-1 (]: 25 of 27 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:23:40.752913 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m09:23:40.752913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m09:23:40.752913 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:23:40.752913 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:23:40.752913 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:23:40.752913 => 2023-10-06 09:23:40.752913
[0m09:23:40.752913 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:23:40.752913 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:40.808508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:40.811505 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m09:23:40.861432 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.864037 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:40.918310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.921823 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:23:40.921823 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("__datetime", "tps", "spent", "shows", "clicks", "base", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m09:23:40.976176 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:40.976176 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

      delete from travelata.incremental_sheets_vkads_adgroupsstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5);
    ...
[0m09:23:41.036171 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:41.036171 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:41.083872 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:41.083872 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    ...
[0m09:23:41.143630 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    
[0m09:23:41.143630 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:23:40.752913 => 2023-10-06 09:23:41.143630
[0m09:23:41.143630 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m09:23:41.143630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A151D90>]}
[0m09:23:42.200473 [error] [Thread-1 (]: 25 of 27 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[31mERROR[0m in 0.39s]
[0m09:23:42.200473 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:23:42.200473 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:23:42.200473 [info ] [Thread-1 (]: 26 of 27 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m09:23:42.200473 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m09:23:42.200473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m09:23:42.200473 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:23:42.200473 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:23:42.213980 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:23:42.200473 => 2023-10-06 09:23:42.213980
[0m09:23:42.214992 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:23:42.219170 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:42.266942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:42.270951 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m09:23:42.328255 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:42.333479 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:42.377364 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:42.377364 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:23:42.377364 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("__datetime", "tps", "spent", "shows", "clicks", "base", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m09:23:42.446676 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:42.446676 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

      delete from travelata.incremental_sheets_vkads_adplansstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5);
    ...
[0m09:23:42.509461 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:42.516324 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:42.565210 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:42.565210 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    ...
[0m09:23:42.619929 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    
[0m09:23:42.620467 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:23:42.214992 => 2023-10-06 09:23:42.620467
[0m09:23:42.620467 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m09:23:42.620467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229370F8210>]}
[0m09:23:42.620467 [error] [Thread-1 (]: 26 of 27 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[31mERROR[0m in 0.42s]
[0m09:23:42.620467 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:23:42.620467 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:23:42.620467 [info ] [Thread-1 (]: 27 of 27 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m09:23:42.626768 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m09:23:42.627376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m09:23:42.627376 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:23:42.627376 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:23:42.627376 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 09:23:42.627376 => 2023-10-06 09:23:42.627376
[0m09:23:42.627376 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:23:42.634189 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 
  ...
[0m09:23:42.686972 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:42.689963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m09:23:42.744668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:42.748666 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:42.799442 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:23:42.799442 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:23:42.815102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5 ("__datetime", "tps", "spent", "shows", "clicks", "base", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m09:23:42.901912 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:23:42.901912 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

      delete from travelata.incremental_sheets_vkads_bannerssstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5);
    ...
[0m09:23:42.964929 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:23:42.964929 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:23:43.009292 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:23:43.009292 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    ...
[0m09:23:43.057030 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5
    
[0m09:23:43.057030 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 09:23:42.627376 => 2023-10-06 09:23:43.057030
[0m09:23:43.072544 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m09:23:43.072544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de46e80-34ec-40a6-96c4-fbdb293da6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A7462D0>]}
[0m09:23:43.072544 [error] [Thread-1 (]: 27 of 27 ERROR creating sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[31mERROR[0m in 0.45s]
[0m09:23:43.072544 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:23:43.072544 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:23:43.072544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:43.072544 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:23:43.072544 [debug] [MainThread]: On list_schemas: Close
[0m09:23:43.072544 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:23:43.072544 [debug] [MainThread]: On list_None_travelata: Close
[0m09:23:43.072544 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics' was left open.
[0m09:23:43.072544 [debug] [MainThread]: On model.travelata.incremental_sheets_vkads_bannerssstatistics: Close
[0m09:23:43.072544 [info ] [MainThread]: 
[0m09:23:43.072544 [info ] [MainThread]: Finished running 17 view models, 6 incremental models, 4 table models in 0 hours 0 minutes and 12.90 seconds (12.90s).
[0m09:23:43.088043 [debug] [MainThread]: Command end result
[0m09:23:43.099015 [info ] [MainThread]: 
[0m09:23:43.099015 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:23:43.100058 [info ] [MainThread]: 
[0m09:23:43.101023 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)[0m
[0m09:23:43.102024 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m09:23:43.102024 [error] [MainThread]:    Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
[0m09:23:43.103022 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:23:43.103022 [info ] [MainThread]: 
[0m09:23:43.103022 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)[0m
[0m09:23:43.103022 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:23:43.105953 [error] [MainThread]:    Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
[0m09:23:43.106959 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m09:23:43.107964 [info ] [MainThread]: 
[0m09:23:43.108966 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)[0m
[0m09:23:43.109963 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:23:43.110967 [error] [MainThread]:    Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
[0m09:23:43.111962 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m09:23:43.112964 [info ] [MainThread]: 
[0m09:23:43.112964 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)[0m
[0m09:23:43.114381 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:23:43.114381 [error] [MainThread]:    Code: 47. DB::Exception: Missing columns: 'date' while processing query: 'SELECT __datetime, tps, spent, shows, clicks, base, date, moat, romi, video, events, uniques, carousel, playable, ad_group_id, custom_event, uniques_video, _airbyte_ab_id, load_date, _normalized_at, __table_name, __emitted_at, __normalized_at FROM travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_7de46e80_34ec_40a6_96c4_fbdb293da6b5', required columns: 'spent' 'shows' 'tps' 'moat' '__normalized_at' 'base' 'romi' 'playable' 'load_date' 'date' 'ad_group_id' 'uniques_video' 'video' '__datetime' 'clicks' 'uniques' 'events' '_normalized_at' 'custom_event' 'carousel' '_airbyte_ab_id' '__table_name' '__emitted_at', maybe you meant: 'spent', 'shows', 'tps', 'moat', '__normalized_at', 'base', 'romi', 'playable', 'load_date', 'ad_group_id', 'uniques_video', 'video', '__datetime', 'clicks', 'uniques', 'events', '_normalized_at', 'custom_event', 'carousel', '_airbyte_ab_id', '__table_name' or '__emitted_at'. (UNKNOWN_IDENTIFIER) (version 23.3.13.6 (official build))
[0m09:23:43.114381 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m09:23:43.114381 [info ] [MainThread]: 
[0m09:23:43.114381 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=4 SKIP=0 TOTAL=27
[0m09:23:43.114381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939A61450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293A2053D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022939EC2F50>]}
[0m09:23:43.114381 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 09:24:25.038977 | 27507677-df52-48e5-b21d-3796cd30f088 ==============================
[0m09:24:25.038977 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:24:25.038977 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:24:25.038977 [debug] [MainThread]: Tracking: tracking
[0m09:24:25.055325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7910410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF71B3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF71B5110>]}
[0m09:24:25.055842 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:24:25.162011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:24:25.162011 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m09:24:25.162011 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m09:24:25.162011 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m09:24:25.177634 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m09:24:25.177634 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m09:24:25.193233 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m09:24:25.208855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m09:24:25.208855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF71A6A50>]}
[0m09:24:25.224511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7A1F190>]}
[0m09:24:25.224511 [info ] [MainThread]: Found 27 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:24:25.224511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF753CA90>]}
[0m09:24:25.224511 [info ] [MainThread]: 
[0m09:24:25.224511 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:24:25.224511 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:24:25.240558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:25.809398 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:24:25.856671 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:25.872354 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:24:25.880362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:26.516879 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:24:26.579963 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:26.595658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7989850>]}
[0m09:24:26.595658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:24:26.595658 [info ] [MainThread]: 
[0m09:24:26.611230 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:24:26.611230 [info ] [Thread-1 (]: 1 of 27 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m09:24:26.611230 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m09:24:26.611230 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:24:26.611230 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:24:26.611230 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 09:24:26.611230 => 2023-10-06 09:24:26.611230
[0m09:24:26.611230 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:24:26.658475 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m09:24:26.660457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:24:27.297460 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m09:24:27.346968 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.346968 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:24:27.399154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:27.409161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m09:24:27.457578 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.457578 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:24:27.523986 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:27.523986 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m09:24:27.584126 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:27.610017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m09:24:27.660662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.660662 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 09:24:26.611230 => 2023-10-06 09:24:27.660662
[0m09:24:27.660662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF74537D0>]}
[0m09:24:27.660662 [info ] [Thread-1 (]: 1 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.05s]
[0m09:24:27.676362 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m09:24:27.676362 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:24:27.676362 [info ] [Thread-1 (]: 2 of 27 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m09:24:27.676362 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:24:27.676362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:24:27.676362 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:24:27.676362 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:24:27.676362 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 09:24:27.676362 => 2023-10-06 09:24:27.676362
[0m09:24:27.676362 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:24:27.691967 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:24:27.691967 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m09:24:27.746435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.746435 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:24:27.793317 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.793317 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m09:24:27.848149 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.850327 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:24:27.897692 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.898730 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m09:24:27.947517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.951745 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m09:24:27.997990 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:27.999539 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 09:24:27.676362 => 2023-10-06 09:24:27.999539
[0m09:24:28.000571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7490610>]}
[0m09:24:28.001086 [info ] [Thread-1 (]: 2 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.32s]
[0m09:24:28.001602 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:24:28.002125 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:24:28.002639 [info ] [Thread-1 (]: 3 of 27 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m09:24:28.003154 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:24:28.003678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:24:28.003678 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:24:28.005222 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:24:28.006251 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 09:24:28.004192 => 2023-10-06 09:24:28.006251
[0m09:24:28.006251 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:24:28.007916 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:24:28.011501 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m09:24:28.057708 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.057708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:24:28.121842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:28.126366 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m09:24:28.178020 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.178020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:24:28.240561 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:28.240561 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m09:24:28.288137 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.303799 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m09:24:28.351042 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.366934 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 09:24:28.006767 => 2023-10-06 09:24:28.366934
[0m09:24:28.367496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF823E9D0>]}
[0m09:24:28.367496 [info ] [Thread-1 (]: 3 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.36s]
[0m09:24:28.367496 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:24:28.367496 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:24:28.367496 [info ] [Thread-1 (]: 4 of 27 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m09:24:28.367496 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:24:28.382527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:24:28.382527 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:24:28.382527 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:24:28.382527 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 09:24:28.382527 => 2023-10-06 09:24:28.382527
[0m09:24:28.382527 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:24:28.399560 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:24:28.402570 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m09:24:28.448356 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:28.448356 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:24:28.510881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:28.510881 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m09:24:28.558390 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.574056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:24:28.621111 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.621111 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m09:24:28.681954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:28.698644 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:24:28.747243 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.747243 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 09:24:28.382527 => 2023-10-06 09:24:28.747243
[0m09:24:28.747243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF83431D0>]}
[0m09:24:28.747243 [info ] [Thread-1 (]: 4 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.38s]
[0m09:24:28.747243 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:24:28.747243 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:24:28.747243 [info ] [Thread-1 (]: 5 of 27 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m09:24:28.747243 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m09:24:28.747243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m09:24:28.747243 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:24:28.747243 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:24:28.747243 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 09:24:28.747243 => 2023-10-06 09:24:28.747243
[0m09:24:28.747243 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:24:28.761749 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m09:24:28.761749 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m09:24:28.814519 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.814519 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:24:28.862178 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:28.862178 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m09:24:28.927909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:28.930497 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:24:28.972674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:28.972674 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m09:24:29.027075 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.027075 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m09:24:29.068592 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:29.068592 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 09:24:28.747243 => 2023-10-06 09:24:29.068592
[0m09:24:29.068592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF8339C50>]}
[0m09:24:29.068592 [info ] [Thread-1 (]: 5 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.32s]
[0m09:24:29.068592 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m09:24:29.068592 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:24:29.068592 [info ] [Thread-1 (]: 6 of 27 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m09:24:29.084098 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m09:24:29.084098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m09:24:29.084098 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:24:29.084098 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:24:29.084098 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 09:24:29.084098 => 2023-10-06 09:24:29.084098
[0m09:24:29.084098 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:24:29.084098 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m09:24:29.084098 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m09:24:29.145234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.149868 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:24:29.202579 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.205121 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m09:24:29.248937 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:29.264594 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:24:29.327095 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.327095 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m09:24:29.390026 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.390026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m09:24:29.449704 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.453221 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 09:24:29.084098 => 2023-10-06 09:24:29.453221
[0m09:24:29.453221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF8344910>]}
[0m09:24:29.453221 [info ] [Thread-1 (]: 6 of 27 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.38s]
[0m09:24:29.453221 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m09:24:29.453221 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:24:29.453221 [info ] [Thread-1 (]: 7 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m09:24:29.453221 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m09:24:29.453221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m09:24:29.453221 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:24:29.468864 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:24:29.468864 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 09:24:29.453221 => 2023-10-06 09:24:29.468864
[0m09:24:29.468864 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:24:29.468864 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m09:24:29.468864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m09:24:29.549910 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:24:29.549910 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:24:29.595986 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.611355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m09:24:29.658623 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.674273 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:24:29.728009 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.730017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m09:24:29.778716 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:29.778716 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m09:24:29.841223 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.841223 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 09:24:29.468864 => 2023-10-06 09:24:29.841223
[0m09:24:29.841223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF83329D0>]}
[0m09:24:29.850748 [info ] [Thread-1 (]: 7 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.39s]
[0m09:24:29.850748 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m09:24:29.850748 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:24:29.850748 [info ] [Thread-1 (]: 8 of 27 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m09:24:29.857263 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m09:24:29.857263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m09:24:29.857263 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:24:29.857263 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:24:29.857263 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 09:24:29.857263 => 2023-10-06 09:24:29.857263
[0m09:24:29.857263 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:24:29.857263 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m09:24:29.872903 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m09:24:29.931184 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:29.934887 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:24:29.971386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:29.971386 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m09:24:30.027864 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:30.030578 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:24:30.067486 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:30.067486 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m09:24:30.115590 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.131290 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m09:24:30.178554 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.178554 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 09:24:29.857263 => 2023-10-06 09:24:30.178554
[0m09:24:30.178554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF82922D0>]}
[0m09:24:30.178554 [info ] [Thread-1 (]: 8 of 27 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.32s]
[0m09:24:30.178554 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m09:24:30.178554 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:24:30.178554 [info ] [Thread-1 (]: 9 of 27 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m09:24:30.178554 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m09:24:30.178554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m09:24:30.194128 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:24:30.194128 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:24:30.194128 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 09:24:30.194128 => 2023-10-06 09:24:30.194128
[0m09:24:30.194128 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:24:30.194128 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m09:24:30.194128 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m09:24:30.250662 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:30.252287 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:24:30.297029 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:30.297029 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m09:24:30.359839 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:30.359839 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:24:30.414355 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.414355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m09:24:30.467740 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.471342 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m09:24:30.517403 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.517403 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 09:24:30.194128 => 2023-10-06 09:24:30.517403
[0m09:24:30.517403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF8366910>]}
[0m09:24:30.517403 [info ] [Thread-1 (]: 9 of 27 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.34s]
[0m09:24:30.517403 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m09:24:30.517403 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:24:30.517403 [info ] [Thread-1 (]: 10 of 27 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m09:24:30.517403 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m09:24:30.517403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m09:24:30.517403 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:24:30.517403 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:24:30.517403 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 09:24:30.517403 => 2023-10-06 09:24:30.517403
[0m09:24:30.517403 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:24:30.533007 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m09:24:30.533007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m09:24:30.585621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.616874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:24:30.664118 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.679752 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m09:24:30.726874 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.726874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:24:30.774020 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:24:30.774020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m09:24:30.831553 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:30.831553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:24:30.878901 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:30.894306 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 09:24:30.517403 => 2023-10-06 09:24:30.894306
[0m09:24:30.894306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7257090>]}
[0m09:24:30.894306 [info ] [Thread-1 (]: 10 of 27 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.38s]
[0m09:24:30.894306 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m09:24:30.894306 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:24:30.894306 [info ] [Thread-1 (]: 11 of 27 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:24:30.894306 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m09:24:30.894306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m09:24:30.894306 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:24:30.909923 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:24:30.909923 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:24:30.894306 => 2023-10-06 09:24:30.909923
[0m09:24:30.909923 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:24:30.909923 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m09:24:30.909923 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m09:24:30.969567 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:30.985182 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:24:31.033011 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.033011 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m09:24:31.095553 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.095553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:24:31.158018 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.158018 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m09:24:31.220552 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.220552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m09:24:31.299253 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.299253 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:24:30.909923 => 2023-10-06 09:24:31.299253
[0m09:24:31.299253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF8347110>]}
[0m09:24:31.299253 [info ] [Thread-1 (]: 11 of 27 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.40s]
[0m09:24:31.299253 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m09:24:31.299253 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:24:31.299253 [info ] [Thread-1 (]: 12 of 27 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m09:24:31.299253 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m09:24:31.299253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m09:24:31.299253 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:24:31.299253 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:24:31.299253 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:24:31.299253 => 2023-10-06 09:24:31.299253
[0m09:24:31.299253 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:24:31.315669 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m09:24:31.315669 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m09:24:31.377342 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.383559 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:24:31.430983 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.430983 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m09:24:31.478515 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.478515 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:24:31.541066 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.541066 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m09:24:31.604267 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:31.604267 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m09:24:31.655176 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.655176 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:24:31.299253 => 2023-10-06 09:24:31.655176
[0m09:24:31.655176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF79BE490>]}
[0m09:24:31.655176 [info ] [Thread-1 (]: 12 of 27 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.36s]
[0m09:24:31.655176 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m09:24:31.655176 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:24:31.655176 [info ] [Thread-1 (]: 13 of 27 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m09:24:31.655176 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m09:24:31.655176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m09:24:31.655176 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:24:31.655176 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:24:31.655176 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 09:24:31.655176 => 2023-10-06 09:24:31.655176
[0m09:24:31.667184 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:24:31.667184 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m09:24:31.667184 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m09:24:31.720517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.723516 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:24:31.755270 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:24:31.769811 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m09:24:31.816994 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.832383 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:24:31.879156 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.894772 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m09:24:31.942566 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:31.957743 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m09:24:32.020310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:32.020310 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 09:24:31.667184 => 2023-10-06 09:24:32.020310
[0m09:24:32.020310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF822DD10>]}
[0m09:24:32.020310 [info ] [Thread-1 (]: 13 of 27 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m09:24:32.020310 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m09:24:32.020310 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:24:32.020310 [info ] [Thread-1 (]: 14 of 27 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m09:24:32.020310 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m09:24:32.020310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m09:24:32.020310 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:24:32.020310 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:24:32.020310 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 09:24:32.020310 => 2023-10-06 09:24:32.020310
[0m09:24:32.020310 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:24:32.020310 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m09:24:32.020310 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m09:24:32.090390 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.091901 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:24:32.123430 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:24:32.138856 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m09:24:32.186496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.186496 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:24:32.233254 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.233254 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m09:24:32.296148 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:32.311745 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m09:24:32.359235 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.374936 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 09:24:32.020310 => 2023-10-06 09:24:32.374936
[0m09:24:32.376749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7DC6350>]}
[0m09:24:32.378767 [info ] [Thread-1 (]: 14 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.36s]
[0m09:24:32.380930 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m09:24:32.381883 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:24:32.382871 [info ] [Thread-1 (]: 15 of 27 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m09:24:32.384011 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m09:24:32.384011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m09:24:32.384011 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:24:32.384011 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:24:32.391771 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 09:24:32.384011 => 2023-10-06 09:24:32.391771
[0m09:24:32.391771 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:24:32.396734 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m09:24:32.397585 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m09:24:32.457120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:32.457120 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:24:32.503111 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.503111 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m09:24:32.557053 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.566128 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:24:32.613161 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.613161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m09:24:32.660837 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.660837 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m09:24:32.707975 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.707975 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 09:24:32.392774 => 2023-10-06 09:24:32.707975
[0m09:24:32.707975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF828E2D0>]}
[0m09:24:32.707975 [info ] [Thread-1 (]: 15 of 27 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.32s]
[0m09:24:32.723391 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m09:24:32.723391 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m09:24:32.723391 [info ] [Thread-1 (]: 16 of 27 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m09:24:32.723391 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m09:24:32.723391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m09:24:32.723391 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m09:24:32.723391 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:24:32.723391 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 09:24:32.723391 => 2023-10-06 09:24:32.723391
[0m09:24:32.723391 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m09:24:32.723391 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m09:24:32.723391 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m09:24:32.780370 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:32.783365 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:24:32.824677 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:32.824677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m09:24:32.887931 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:32.903411 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:24:32.957970 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:32.957970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m09:24:33.020447 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:33.020447 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m09:24:33.068419 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.068419 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 09:24:32.723391 => 2023-10-06 09:24:33.068419
[0m09:24:33.083430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF828F310>]}
[0m09:24:33.085150 [info ] [Thread-1 (]: 16 of 27 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.36s]
[0m09:24:33.087141 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m09:24:33.088268 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:24:33.089428 [info ] [Thread-1 (]: 17 of 27 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m09:24:33.090910 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m09:24:33.091466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m09:24:33.092011 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m09:24:33.093576 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:24:33.094615 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 09:24:33.092011 => 2023-10-06 09:24:33.094615
[0m09:24:33.094615 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m09:24:33.099255 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m09:24:33.099255 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m09:24:33.149439 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.149439 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:24:33.196980 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.196980 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m09:24:33.259697 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:33.259697 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:24:33.306862 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.322266 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m09:24:33.370555 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.385114 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m09:24:33.441665 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:33.446729 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 09:24:33.095132 => 2023-10-06 09:24:33.446729
[0m09:24:33.446729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7552510>]}
[0m09:24:33.446729 [info ] [Thread-1 (]: 17 of 27 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.36s]
[0m09:24:33.446729 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m09:24:33.446729 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m09:24:33.446729 [info ] [Thread-1 (]: 18 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m09:24:33.459248 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m09:24:33.459248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m09:24:33.461819 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m09:24:33.461819 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:24:33.461819 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 09:24:33.461819 => 2023-10-06 09:24:33.461819
[0m09:24:33.461819 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m09:24:33.512627 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:33.559361 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.594151 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m09:24:33.659372 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:33.659372 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:33.726082 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:33.736609 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m09:24:33.736609 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m09:24:33.784447 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:33.784447 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088);
    ...
[0m09:24:33.865825 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:24:33.865825 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:33.910323 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:33.910323 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
    ...
[0m09:24:33.981305 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:33.988138 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:34.034875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.034875 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m09:24:34.082821 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.082821 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 09:24:33.461819 => 2023-10-06 09:24:34.082821
[0m09:24:34.098528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF79E0190>]}
[0m09:24:34.098528 [info ] [Thread-1 (]: 18 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.65s]
[0m09:24:34.098528 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m09:24:34.098528 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m09:24:34.098528 [info ] [Thread-1 (]: 19 of 27 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m09:24:34.109216 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m09:24:34.110273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m09:24:34.111236 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m09:24:34.115394 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:24:34.120751 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 09:24:34.111948 => 2023-10-06 09:24:34.119733
[0m09:24:34.121801 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m09:24:34.128658 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:34.176314 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.176314 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m09:24:34.239069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:34.254452 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:34.303065 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.303065 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m09:24:34.303065 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m09:24:34.368973 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:34.368973 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088);
    ...
[0m09:24:34.428910 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:34.430419 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:34.483173 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.483173 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
    ...
[0m09:24:34.534352 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.542359 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:34.578905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:34.590415 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m09:24:34.637743 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.637743 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 09:24:34.121801 => 2023-10-06 09:24:34.637743
[0m09:24:34.637743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF79CF9D0>]}
[0m09:24:34.637743 [info ] [Thread-1 (]: 19 of 27 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.54s]
[0m09:24:34.653357 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m09:24:34.653357 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:24:34.653357 [info ] [Thread-1 (]: 20 of 27 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m09:24:34.653357 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m09:24:34.653357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m09:24:34.653357 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:24:34.660904 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:24:34.660904 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 09:24:34.653357 => 2023-10-06 09:24:34.660904
[0m09:24:34.660904 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:24:34.682279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m09:24:34.741140 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:34.741140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:34.788989 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.804346 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m09:24:34.804346 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m09:24:34.867263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:34.898590 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m09:24:34.946243 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:34.946243 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m09:24:35.008840 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:35.008840 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 09:24:34.660904 => 2023-10-06 09:24:35.008840
[0m09:24:35.008840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7DD0190>]}
[0m09:24:35.008840 [info ] [Thread-1 (]: 20 of 27 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.36s]
[0m09:24:35.008840 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m09:24:35.008840 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m09:24:35.008840 [info ] [Thread-1 (]: 21 of 27 START sql table model travelata.incremental_sheets_mytarget_banners ... [RUN]
[0m09:24:35.008840 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners'
[0m09:24:35.008840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners)
[0m09:24:35.008840 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners
[0m09:24:35.008840 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:24:35.008840 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (compile): 2023-10-06 09:24:35.008840 => 2023-10-06 09:24:35.008840
[0m09:24:35.008840 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners
[0m09:24:35.025917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
    )
        ...
[0m09:24:35.098339 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:35.098339 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:35.157446 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.157446 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners"
[0m09:24:35.162455 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners__dbt_backup ("campagin_id", "id", "textblocks", "urls", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
  ...
[0m09:24:35.205222 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:35.205222 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_banners__dbt_backup AND travelata.incremental_sheets_mytarget_banners 
  
  ...
[0m09:24:35.252048 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.262594 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
drop table if exists travelata.incremental_sheets_mytarget_banners__dbt_backup 
  ...
[0m09:24:35.299879 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:35.299879 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (execute): 2023-10-06 09:24:35.008840 => 2023-10-06 09:24:35.299879
[0m09:24:35.315293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF79CDAD0>]}
[0m09:24:35.315293 [info ] [Thread-1 (]: 21 of 27 OK created sql table model travelata.incremental_sheets_mytarget_banners  [[32mOK[0m in 0.31s]
[0m09:24:35.315293 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m09:24:35.315293 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:24:35.315293 [info ] [Thread-1 (]: 22 of 27 START sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [RUN]
[0m09:24:35.326177 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners_statistics'
[0m09:24:35.327195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners_statistics)
[0m09:24:35.328197 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:24:35.336414 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:24:35.336414 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (compile): 2023-10-06 09:24:35.329131 => 2023-10-06 09:24:35.336414
[0m09:24:35.336414 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:24:35.350038 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */
drop table if exists travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:35.399311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.399311 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(_date),table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
    )
        ...
[0m09:24:35.462916 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:35.462916 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners_statistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:35.525066 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:35.540500 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m09:24:35.540500 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      ...
[0m09:24:35.594301 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      
[0m09:24:35.594301 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (execute): 2023-10-06 09:24:35.341957 => 2023-10-06 09:24:35.594301
[0m09:24:35.609949 [debug] [Thread-1 (]: Database Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:24:35.609949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF837D9D0>]}
[0m09:24:35.609949 [error] [Thread-1 (]: 22 of 27 ERROR creating sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [[31mERROR[0m in 0.29s]
[0m09:24:35.609949 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m09:24:35.609949 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:24:35.609949 [info ] [Thread-1 (]: 23 of 27 START sql table model travelata.incremental_sheets_mytarget_compagins . [RUN]
[0m09:24:35.609949 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_compagins'
[0m09:24:35.625611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_compagins)
[0m09:24:35.625611 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_compagins
[0m09:24:35.625611 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:24:35.625611 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (compile): 2023-10-06 09:24:35.625611 => 2023-10-06 09:24:35.625611
[0m09:24:35.625611 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_compagins
[0m09:24:35.625611 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

            

    
        create table travelata.incremental_sheets_mytarget_compagins__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
    )
        ...
[0m09:24:35.683336 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:35.686331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_compagins__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:35.735714 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.751172 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m09:24:35.751172 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_compagins__dbt_backup ("id", "name", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
  ...
[0m09:24:35.798230 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.798230 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_compagins__dbt_backup AND travelata.incremental_sheets_mytarget_compagins 
  
  ...
[0m09:24:35.845098 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:35.863772 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
drop table if exists travelata.incremental_sheets_mytarget_compagins__dbt_backup 
  ...
[0m09:24:35.908042 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:35.908042 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (execute): 2023-10-06 09:24:35.625611 => 2023-10-06 09:24:35.908042
[0m09:24:35.908042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF795F910>]}
[0m09:24:35.908042 [info ] [Thread-1 (]: 23 of 27 OK created sql table model travelata.incremental_sheets_mytarget_compagins  [[32mOK[0m in 0.30s]
[0m09:24:35.908042 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m09:24:35.908042 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:24:35.908042 [info ] [Thread-1 (]: 24 of 27 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m09:24:35.908042 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m09:24:35.908042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m09:24:35.923668 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:24:35.923668 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:24:35.923668 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 09:24:35.923668 => 2023-10-06 09:24:35.923668
[0m09:24:35.923668 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:24:35.923668 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m09:24:35.983704 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:35.986704 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:36.034616 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.034616 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m09:24:36.034616 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult__dbt_backup ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m09:24:36.115050 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m09:24:36.115050 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
EXCHANGE TABLES travelata.incremental_sheets_utmcraft_utmresult__dbt_backup AND travelata.incremental_sheets_utmcraft_utmresult 
  
  ...
[0m09:24:36.164355 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.171368 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
drop table if exists travelata.incremental_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m09:24:36.218370 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.218370 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 09:24:35.923668 => 2023-10-06 09:24:36.218370
[0m09:24:36.218370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF798A790>]}
[0m09:24:36.218370 [info ] [Thread-1 (]: 24 of 27 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.31s]
[0m09:24:36.218370 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m09:24:36.218370 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:24:36.218370 [info ] [Thread-1 (]: 25 of 27 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m09:24:36.218370 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m09:24:36.218370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m09:24:36.234003 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:24:36.234508 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:24:36.234508 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 09:24:36.234508 => 2023-10-06 09:24:36.234508
[0m09:24:36.234508 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:24:36.234508 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:36.294175 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:36.301252 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m09:24:36.365164 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:36.365164 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:36.424132 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:36.424132 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m09:24:36.439769 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m09:24:36.487284 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.502908 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

      delete from travelata.incremental_sheets_vkads_adgroupsstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088);
    ...
[0m09:24:36.576631 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:36.582737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:36.627052 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:24:36.627052 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
    ...
[0m09:24:36.674415 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.690063 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:36.737026 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:36.737026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_distributed_new_data 
  ...
[0m09:24:36.799966 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:36.799966 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 09:24:36.234508 => 2023-10-06 09:24:36.799966
[0m09:24:36.799966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF82A1C10>]}
[0m09:24:37.801569 [info ] [Thread-1 (]: 25 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.58s]
[0m09:24:37.801569 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m09:24:37.801569 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:24:37.801569 [info ] [Thread-1 (]: 26 of 27 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m09:24:37.801569 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m09:24:37.801569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m09:24:37.801569 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:24:37.801569 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:24:37.801569 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 09:24:37.801569 => 2023-10-06 09:24:37.801569
[0m09:24:37.801569 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:24:37.819034 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:37.867430 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:37.870720 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m09:24:37.924634 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:37.927848 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:37.978943 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:37.981053 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m09:24:37.982618 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m09:24:38.051360 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:24:38.052403 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

      delete from travelata.incremental_sheets_vkads_adplansstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088);
    ...
[0m09:24:38.104452 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.107037 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:38.158781 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.160329 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
    ...
[0m09:24:38.210050 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.210050 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:38.269329 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.272849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_distributed_new_data 
  ...
[0m09:24:38.304468 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:24:38.320134 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 09:24:37.801569 => 2023-10-06 09:24:38.320134
[0m09:24:38.320134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF4B09250>]}
[0m09:24:38.320134 [info ] [Thread-1 (]: 26 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.52s]
[0m09:24:38.320134 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m09:24:38.320134 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:24:38.320134 [info ] [Thread-1 (]: 27 of 27 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m09:24:38.320134 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m09:24:38.320134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m09:24:38.320134 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:24:38.320134 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:24:38.320134 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 09:24:38.320134 => 2023-10-06 09:24:38.320134
[0m09:24:38.320134 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:24:38.320134 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:38.378262 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:38.382261 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m09:24:38.446029 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:38.446029 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:38.499248 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.501289 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m09:24:38.502393 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m09:24:38.553953 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.553953 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

      delete from travelata.incremental_sheets_vkads_bannerssstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088);
    ...
[0m09:24:38.602000 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.617622 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:24:38.670599 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.670599 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088
    ...
[0m09:24:38.728287 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:24:38.728287 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_27507677_df52_48e5_b21d_3796cd30f088 
  ...
[0m09:24:38.781186 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.796830 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_distributed_new_data 
  ...
[0m09:24:38.843911 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:24:38.843911 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 09:24:38.320134 => 2023-10-06 09:24:38.843911
[0m09:24:38.843911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27507677-df52-48e5-b21d-3796cd30f088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF8245D10>]}
[0m09:24:38.843911 [info ] [Thread-1 (]: 27 of 27 OK created sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[32mOK[0m in 0.52s]
[0m09:24:38.843911 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m09:24:38.859329 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:24:38.859329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:38.859329 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:24:38.859329 [debug] [MainThread]: On list_schemas: Close
[0m09:24:38.859329 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:24:38.859329 [debug] [MainThread]: On list_None_travelata: Close
[0m09:24:38.859329 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics' was left open.
[0m09:24:38.859329 [debug] [MainThread]: On model.travelata.incremental_sheets_vkads_bannerssstatistics: Close
[0m09:24:38.859329 [info ] [MainThread]: 
[0m09:24:38.859329 [info ] [MainThread]: Finished running 17 view models, 6 incremental models, 4 table models in 0 hours 0 minutes and 13.63 seconds (13.63s).
[0m09:24:38.870846 [debug] [MainThread]: Command end result
[0m09:24:38.890526 [info ] [MainThread]: 
[0m09:24:38.891624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:24:38.891624 [info ] [MainThread]: 
[0m09:24:38.891624 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)[0m
[0m09:24:38.891624 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m09:24:38.891624 [error] [MainThread]:    Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
[0m09:24:38.891624 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m09:24:38.897440 [info ] [MainThread]: 
[0m09:24:38.898304 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=1 SKIP=0 TOTAL=27
[0m09:24:38.898304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF71B52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7C2DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CF7D918D0>]}
[0m09:24:38.898304 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 10:40:33.143360 | 155a0b5e-66db-4436-9886-01198ce9426a ==============================
[0m10:40:33.143360 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:40:33.144713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:40:33.144713 [debug] [MainThread]: Tracking: tracking
[0m10:40:33.157600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269195C95D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269195D6A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269194E3B90>]}
[0m10:40:33.168055 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 5 files changed.
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_yandexdisk_othercosts.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_yandexdisk_mediaplans.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental__sheets_yd_customreport.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_sessionstart.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_yd_customreport.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_yandexdisk_othercosts.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_deeplinks.sql
[0m10:40:33.306491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_screenview.sql
[0m10:40:33.322118 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_yandexdisk_othercosts.sql
[0m10:40:33.336624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_yandexdisk_othercosts.sql
[0m10:40:33.338129 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_yandexdisk_mediaplans.sql
[0m10:40:33.338129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_yandexdisk_mediaplans.sql
[0m10:40:33.338129 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental__sheets_yd_customreport.sql
[0m10:40:33.338129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental__sheets_yd_customreport.sql
[0m10:40:33.338129 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_sessionstart.sql
[0m10:40:33.338129 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yd_customreport.sql
[0m10:40:33.353854 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yandexdisk_othercosts.sql
[0m10:40:33.354359 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_deeplinks.sql
[0m10:40:33.354359 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_screenview.sql
[0m10:40:33.370510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m10:40:33.370510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691923EE90>]}
[0m10:40:33.397084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919CA3350>]}
[0m10:40:33.398260 [info ] [MainThread]: Found 30 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:40:33.398765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919D74910>]}
[0m10:40:33.403681 [info ] [MainThread]: 
[0m10:40:33.407392 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:40:33.413509 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:40:33.424450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:34.051836 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:40:34.114445 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:34.118952 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:40:34.121410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:34.724933 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:40:34.794752 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:34.805414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919CBF790>]}
[0m10:40:34.805414 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:34.805414 [info ] [MainThread]: 
[0m10:40:34.809514 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:40:34.809514 [info ] [Thread-1 (]: 1 of 30 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m10:40:34.809514 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m10:40:34.809514 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:40:34.816241 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m10:40:34.816241 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 10:40:34.815231 => 2023-10-06 10:40:34.816241
[0m10:40:34.816241 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:40:34.853127 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m10:40:34.853127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:40:35.413011 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m10:40:35.475517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:35.482479 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m10:40:35.531125 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.531125 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m10:40:35.580238 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.586957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m10:40:35.644606 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:35.645606 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m10:40:35.690233 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:35.717243 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m10:40:35.764460 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.765458 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 10:40:34.816241 => 2023-10-06 10:40:35.765458
[0m10:40:35.766458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919AAFA10>]}
[0m10:40:35.766458 [info ] [Thread-1 (]: 1 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 0.96s]
[0m10:40:35.768457 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m10:40:35.768457 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m10:40:35.769459 [info ] [Thread-1 (]: 2 of 30 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m10:40:35.769459 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m10:40:35.770458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m10:40:35.770458 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m10:40:35.771458 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m10:40:35.772457 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 10:40:35.770458 => 2023-10-06 10:40:35.772457
[0m10:40:35.773616 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m10:40:35.776615 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m10:40:35.777617 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m10:40:35.826311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.829310 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m10:40:35.873419 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:35.875930 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m10:40:35.925212 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.927217 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m10:40:35.974478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:35.975093 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m10:40:36.033814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.037815 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m10:40:36.093739 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.095735 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 10:40:35.773616 => 2023-10-06 10:40:36.095735
[0m10:40:36.095735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F553D0>]}
[0m10:40:36.096736 [info ] [Thread-1 (]: 2 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.33s]
[0m10:40:36.096736 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m10:40:36.097734 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m10:40:36.097734 [info ] [Thread-1 (]: 3 of 30 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m10:40:36.098737 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m10:40:36.098737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m10:40:36.099735 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m10:40:36.100736 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m10:40:36.101736 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 10:40:36.099735 => 2023-10-06 10:40:36.101736
[0m10:40:36.101736 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m10:40:36.105735 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m10:40:36.106737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m10:40:36.157085 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.159711 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m10:40:36.204604 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:36.206603 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m10:40:36.254582 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.256587 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m10:40:36.314061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.315062 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m10:40:36.364755 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.367755 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m10:40:36.424637 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.426430 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 10:40:36.102736 => 2023-10-06 10:40:36.426430
[0m10:40:36.426430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269199E4250>]}
[0m10:40:36.426430 [info ] [Thread-1 (]: 3 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.33s]
[0m10:40:36.426430 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m10:40:36.426430 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:40:36.426430 [info ] [Thread-1 (]: 4 of 30 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m10:40:36.426430 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m10:40:36.426430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m10:40:36.426430 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:40:36.426430 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m10:40:36.433432 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 10:40:36.426430 => 2023-10-06 10:40:36.433432
[0m10:40:36.433432 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:40:36.438436 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m10:40:36.439439 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m10:40:36.496814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.499812 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m10:40:36.554435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.555434 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m10:40:36.604483 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.606483 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m10:40:36.654879 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.655883 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m10:40:36.704806 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.708806 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m10:40:36.764024 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.766023 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 10:40:36.434440 => 2023-10-06 10:40:36.766023
[0m10:40:36.766023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269194E3750>]}
[0m10:40:36.767023 [info ] [Thread-1 (]: 4 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.34s]
[0m10:40:36.767023 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m10:40:36.768023 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:40:36.768023 [info ] [Thread-1 (]: 5 of 30 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m10:40:36.769023 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m10:40:36.769023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m10:40:36.770023 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:40:36.771024 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m10:40:36.772023 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 10:40:36.770023 => 2023-10-06 10:40:36.772023
[0m10:40:36.772023 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:40:36.776022 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m10:40:36.777023 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'eventDateTime') AS __datetime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m10:40:36.827476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.829480 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m10:40:36.876857 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.876857 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m10:40:36.927108 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:36.927108 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m10:40:36.984365 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:36.985363 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m10:40:37.034660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.037660 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m10:40:37.094375 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:37.095375 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 10:40:36.772023 => 2023-10-06 10:40:37.095375
[0m10:40:37.096373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A3C55D0>]}
[0m10:40:37.096373 [info ] [Thread-1 (]: 5 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.33s]
[0m10:40:37.097375 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m10:40:37.097375 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:40:37.098374 [info ] [Thread-1 (]: 6 of 30 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m10:40:37.098374 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m10:40:37.099375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m10:40:37.099375 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:40:37.101373 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m10:40:37.101373 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 10:40:37.099375 => 2023-10-06 10:40:37.101373
[0m10:40:37.102376 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:40:37.105373 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m10:40:37.106375 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'session_start_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m10:40:37.155695 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.155695 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m10:40:37.204270 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.206307 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m10:40:37.254366 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.256366 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m10:40:37.298317 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:37.313722 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m10:40:37.357724 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:37.373425 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m10:40:37.420227 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.435873 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 10:40:37.102376 => 2023-10-06 10:40:37.435873
[0m10:40:37.435873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A3F5190>]}
[0m10:40:37.435873 [info ] [Thread-1 (]: 6 of 30 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.34s]
[0m10:40:37.435873 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m10:40:37.435873 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:40:37.435873 [info ] [Thread-1 (]: 7 of 30 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m10:40:37.435873 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m10:40:37.435873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m10:40:37.435873 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:40:37.435873 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m10:40:37.435873 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 10:40:37.435873 => 2023-10-06 10:40:37.435873
[0m10:40:37.443880 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:40:37.443880 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m10:40:37.443880 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m10:40:37.509316 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:37.511318 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m10:40:37.553552 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:37.553552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m10:40:37.600728 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.600728 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m10:40:37.647443 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.647443 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m10:40:37.709986 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.709986 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m10:40:37.773463 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:37.773463 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 10:40:37.443880 => 2023-10-06 10:40:37.773463
[0m10:40:37.773463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919EB1890>]}
[0m10:40:37.773463 [info ] [Thread-1 (]: 7 of 30 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.34s]
[0m10:40:37.773463 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m10:40:37.773463 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:40:37.773463 [info ] [Thread-1 (]: 8 of 30 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m10:40:37.773463 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m10:40:37.773463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m10:40:37.773463 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:40:37.773463 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m10:40:37.773463 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 10:40:37.773463 => 2023-10-06 10:40:37.773463
[0m10:40:37.773463 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:40:37.773463 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m10:40:37.788786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m10:40:37.845142 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:37.852199 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m10:40:37.893584 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:37.909150 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m10:40:37.961384 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:37.961384 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m10:40:38.004310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:38.019779 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m10:40:38.068046 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.083575 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m10:40:38.146807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:38.162509 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 10:40:37.773463 => 2023-10-06 10:40:38.162509
[0m10:40:38.162509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F9B950>]}
[0m10:40:38.162509 [info ] [Thread-1 (]: 8 of 30 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.39s]
[0m10:40:38.162509 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m10:40:38.162509 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:40:38.162509 [info ] [Thread-1 (]: 9 of 30 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m10:40:38.162509 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m10:40:38.162509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m10:40:38.162509 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:40:38.162509 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m10:40:38.162509 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 10:40:38.162509 => 2023-10-06 10:40:38.162509
[0m10:40:38.162509 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:40:38.178069 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m10:40:38.178069 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m10:40:38.246153 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:38.257713 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m10:40:38.304620 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.304620 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m10:40:38.351952 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.368215 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m10:40:38.413444 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.429114 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m10:40:38.477031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.523695 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m10:40:38.570892 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.570892 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 10:40:38.178069 => 2023-10-06 10:40:38.570892
[0m10:40:38.570892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919D2F990>]}
[0m10:40:38.570892 [info ] [Thread-1 (]: 9 of 30 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.41s]
[0m10:40:38.570892 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m10:40:38.570892 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:40:38.570892 [info ] [Thread-1 (]: 10 of 30 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m10:40:38.570892 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m10:40:38.570892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m10:40:38.570892 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:40:38.570892 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m10:40:38.570892 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 10:40:38.570892 => 2023-10-06 10:40:38.570892
[0m10:40:38.570892 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:40:38.586412 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m10:40:38.586412 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m10:40:38.644873 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:38.647454 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m10:40:38.687041 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:38.687041 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m10:40:38.746763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:38.749792 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m10:40:38.796744 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.796744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m10:40:38.856985 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:38.856985 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m10:40:38.903863 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:38.903863 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 10:40:38.570892 => 2023-10-06 10:40:38.903863
[0m10:40:38.903863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A41F790>]}
[0m10:40:38.919489 [info ] [Thread-1 (]: 10 of 30 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.33s]
[0m10:40:38.919489 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m10:40:38.919489 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:40:38.919489 [info ] [Thread-1 (]: 11 of 30 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m10:40:38.919489 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m10:40:38.919489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m10:40:38.919489 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:40:38.919489 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m10:40:38.919489 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 10:40:38.919489 => 2023-10-06 10:40:38.919489
[0m10:40:38.919489 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:40:38.919489 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m10:40:38.919489 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m10:40:38.977679 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:38.980678 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m10:40:39.021484 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:39.021484 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m10:40:39.069214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.069214 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m10:40:39.117150 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.117150 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m10:40:39.163644 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.179158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m10:40:39.226205 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.226205 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 10:40:38.919489 => 2023-10-06 10:40:39.226205
[0m10:40:39.226205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919CF7110>]}
[0m10:40:39.226205 [info ] [Thread-1 (]: 11 of 30 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.31s]
[0m10:40:39.226205 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m10:40:39.226205 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:40:39.226205 [info ] [Thread-1 (]: 12 of 30 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m10:40:39.226205 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m10:40:39.226205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m10:40:39.226205 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:40:39.241592 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m10:40:39.241592 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 10:40:39.226205 => 2023-10-06 10:40:39.241592
[0m10:40:39.241592 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:40:39.248105 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m10:40:39.248105 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m10:40:39.297576 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.301575 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m10:40:39.348191 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.349266 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m10:40:39.396452 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.396452 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m10:40:39.468705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:39.473727 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m10:40:39.524651 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.528656 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m10:40:39.568235 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:39.583905 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 10:40:39.241592 => 2023-10-06 10:40:39.583905
[0m10:40:39.583905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F1B990>]}
[0m10:40:39.583905 [info ] [Thread-1 (]: 12 of 30 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.36s]
[0m10:40:39.583905 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m10:40:39.583905 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:40:39.583905 [info ] [Thread-1 (]: 13 of 30 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m10:40:39.583905 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m10:40:39.583905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m10:40:39.583905 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:40:39.601668 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m10:40:39.603710 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 10:40:39.599664 => 2023-10-06 10:40:39.603710
[0m10:40:39.604666 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:40:39.611663 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m10:40:39.613664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m10:40:39.657410 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:39.657410 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m10:40:39.704537 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.704537 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m10:40:39.767440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:39.767440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m10:40:39.814570 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.829957 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m10:40:39.877935 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:39.893379 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m10:40:39.956386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:39.956386 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 10:40:39.605666 => 2023-10-06 10:40:39.956386
[0m10:40:39.956386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269194E3810>]}
[0m10:40:39.956386 [info ] [Thread-1 (]: 13 of 30 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m10:40:39.972031 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m10:40:39.972031 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:40:39.972031 [info ] [Thread-1 (]: 14 of 30 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m10:40:39.972031 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m10:40:39.972031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m10:40:39.972031 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:40:39.972031 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m10:40:39.972031 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 10:40:39.972031 => 2023-10-06 10:40:39.972031
[0m10:40:39.972031 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:40:39.990219 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m10:40:39.991216 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m10:40:40.040590 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.049598 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m10:40:40.088388 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:40.088388 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m10:40:40.135384 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.151422 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m10:40:40.198585 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.198585 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m10:40:40.261653 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:40.261653 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m10:40:40.308538 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.308538 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 10:40:39.972031 => 2023-10-06 10:40:40.308538
[0m10:40:40.308538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919CF5CD0>]}
[0m10:40:40.308538 [info ] [Thread-1 (]: 14 of 30 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.34s]
[0m10:40:40.308538 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m10:40:40.308538 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:40:40.308538 [info ] [Thread-1 (]: 15 of 30 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m10:40:40.308538 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m10:40:40.308538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m10:40:40.308538 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:40:40.308538 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m10:40:40.308538 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 10:40:40.308538 => 2023-10-06 10:40:40.308538
[0m10:40:40.324162 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:40:40.324162 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m10:40:40.324162 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m10:40:40.386938 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:40.389938 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m10:40:40.434674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:40.435681 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m10:40:40.486991 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.486991 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m10:40:40.531545 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:40.531545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m10:40:40.594244 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:40.609907 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m10:40:40.674916 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:40.675932 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 10:40:40.324162 => 2023-10-06 10:40:40.675932
[0m10:40:40.676922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919E78550>]}
[0m10:40:40.677919 [info ] [Thread-1 (]: 15 of 30 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.37s]
[0m10:40:40.677919 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m10:40:40.678916 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m10:40:40.678916 [info ] [Thread-1 (]: 16 of 30 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m10:40:40.679916 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m10:40:40.679916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m10:40:40.679916 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m10:40:40.681916 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m10:40:40.682919 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 10:40:40.680917 => 2023-10-06 10:40:40.682919
[0m10:40:40.683387 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m10:40:40.683387 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m10:40:40.683387 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m10:40:40.739996 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:40.751503 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m10:40:40.794606 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:40.795611 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m10:40:40.844678 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:40.851697 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m10:40:40.892102 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:40.892102 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m10:40:40.956865 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:40.962863 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m10:40:41.005762 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:41.005762 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 10:40:40.683387 => 2023-10-06 10:40:41.005762
[0m10:40:41.023030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A413910>]}
[0m10:40:41.024155 [info ] [Thread-1 (]: 16 of 30 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.34s]
[0m10:40:41.025967 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m10:40:41.026594 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m10:40:41.027761 [info ] [Thread-1 (]: 17 of 30 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m10:40:41.029528 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m10:40:41.030040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m10:40:41.030586 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m10:40:41.031864 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m10:40:41.032918 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 10:40:41.030586 => 2023-10-06 10:40:41.032918
[0m10:40:41.033441 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m10:40:41.033962 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m10:40:41.038331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m10:40:41.087952 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.087952 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m10:40:41.135113 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.135113 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m10:40:41.198076 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.198076 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m10:40:41.252402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.252402 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m10:40:41.304415 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.308035 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m10:40:41.354496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.356053 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 10:40:41.033441 => 2023-10-06 10:40:41.356053
[0m10:40:41.356569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F54ED0>]}
[0m10:40:41.357087 [info ] [Thread-1 (]: 17 of 30 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.33s]
[0m10:40:41.357606 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m10:40:41.358125 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m10:40:41.358641 [info ] [Thread-1 (]: 18 of 30 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m10:40:41.359161 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m10:40:41.359679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m10:40:41.359679 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m10:40:41.362777 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m10:40:41.363293 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 10:40:41.360198 => 2023-10-06 10:40:41.363293
[0m10:40:41.363811 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m10:40:41.424877 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:41.484573 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.507668 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m10:40:41.559490 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.559490 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:41.616102 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.620135 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m10:40:41.620966 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m10:40:41.671565 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.671565 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a);
    ...
[0m10:40:41.753445 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:41.753445 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:41.810841 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.810841 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
    ...
[0m10:40:41.868317 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.868317 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:41.919763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:41.919763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m10:40:41.977912 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:41.977912 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 10:40:41.364326 => 2023-10-06 10:40:41.977912
[0m10:40:41.977912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F10D90>]}
[0m10:40:41.977912 [info ] [Thread-1 (]: 18 of 30 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.62s]
[0m10:40:41.977912 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m10:40:41.977912 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m10:40:41.977912 [info ] [Thread-1 (]: 19 of 30 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m10:40:41.977912 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m10:40:41.977912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m10:40:41.977912 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m10:40:41.993547 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m10:40:41.993547 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 10:40:41.977912 => 2023-10-06 10:40:41.993547
[0m10:40:41.993547 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m10:40:41.993547 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:42.042104 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.042104 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m10:40:42.095859 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.095859 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:42.153793 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.153793 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m10:40:42.153793 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m10:40:42.199669 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.199669 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a);
    ...
[0m10:40:42.278144 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:42.278144 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:42.325031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.325031 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
    ...
[0m10:40:42.380781 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.388290 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:42.435200 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.435200 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m10:40:42.483009 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.483009 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 10:40:41.993547 => 2023-10-06 10:40:42.483009
[0m10:40:42.483009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919D36ED0>]}
[0m10:40:42.498375 [info ] [Thread-1 (]: 19 of 30 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.51s]
[0m10:40:42.498375 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m10:40:42.498375 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:40:42.498375 [info ] [Thread-1 (]: 20 of 30 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m10:40:42.498375 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m10:40:42.498375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m10:40:42.498375 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:40:42.498375 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m10:40:42.498375 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 10:40:42.498375 => 2023-10-06 10:40:42.498375
[0m10:40:42.498375 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:40:42.518772 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m10:40:42.573206 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.573206 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:42.636616 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.636616 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m10:40:42.636616 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m10:40:42.696331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.696331 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m10:40:42.759464 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.759464 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m10:40:42.806598 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:42.822044 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 10:40:42.498375 => 2023-10-06 10:40:42.822044
[0m10:40:42.822044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F6CD50>]}
[0m10:40:42.822044 [info ] [Thread-1 (]: 20 of 30 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.32s]
[0m10:40:42.822044 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m10:40:42.822044 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m10:40:42.822044 [info ] [Thread-1 (]: 21 of 30 START sql table model travelata.incremental_sheets_mytarget_banners ... [RUN]
[0m10:40:42.837938 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners'
[0m10:40:42.838942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners)
[0m10:40:42.840396 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners
[0m10:40:42.845614 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners"
[0m10:40:42.845614 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (compile): 2023-10-06 10:40:42.840396 => 2023-10-06 10:40:42.845614
[0m10:40:42.845614 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners
[0m10:40:42.853808 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
    )
        ...
[0m10:40:42.917905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.917905 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:42.981330 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:42.996722 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners"
[0m10:40:42.996722 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners__dbt_backup ("campagin_id", "id", "textblocks", "urls", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_new
  ...
[0m10:40:43.068486 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:43.068486 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_banners__dbt_backup AND travelata.incremental_sheets_mytarget_banners 
  
  ...
[0m10:40:43.129902 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:43.138407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners"} */
drop table if exists travelata.incremental_sheets_mytarget_banners__dbt_backup 
  ...
[0m10:40:43.199706 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:43.199706 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners (execute): 2023-10-06 10:40:42.845614 => 2023-10-06 10:40:43.199706
[0m10:40:43.199706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A3C2F10>]}
[0m10:40:43.199706 [info ] [Thread-1 (]: 21 of 30 OK created sql table model travelata.incremental_sheets_mytarget_banners  [[32mOK[0m in 0.38s]
[0m10:40:43.199706 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m10:40:43.199706 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m10:40:43.199706 [info ] [Thread-1 (]: 22 of 30 START sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [RUN]
[0m10:40:43.215328 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_banners_statistics'
[0m10:40:43.216741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_banners_statistics)
[0m10:40:43.216741 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m10:40:43.220425 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m10:40:43.220425 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (compile): 2023-10-06 10:40:43.216741 => 2023-10-06 10:40:43.220425
[0m10:40:43.220425 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m10:40:43.225731 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */
drop table if exists travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:43.273760 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:43.273760 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

            

    
        create table travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(_date),table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
    )
        ...
[0m10:40:43.356971 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:43.368595 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_banners_statistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:43.418675 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.421929 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_banners_statistics"
[0m10:40:43.423548 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_banners_statistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      ...
[0m10:40:43.478252 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_banners_statistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_mytarget_banners_statistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("_date", "shows", "clics", "goals", "spent", "banner_id", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_banners_statjstics_new
  
      
[0m10:40:43.478252 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_banners_statistics (execute): 2023-10-06 10:40:43.220425 => 2023-10-06 10:40:43.478252
[0m10:40:43.478252 [debug] [Thread-1 (]: Database Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m10:40:43.478252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269195E2E50>]}
[0m10:40:43.478252 [error] [Thread-1 (]: 22 of 30 ERROR creating sql incremental model travelata.incremental_sheets_mytarget_banners_statistics  [[31mERROR[0m in 0.28s]
[0m10:40:43.478252 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m10:40:43.478252 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m10:40:43.478252 [info ] [Thread-1 (]: 23 of 30 START sql table model travelata.incremental_sheets_mytarget_compagins . [RUN]
[0m10:40:43.478252 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_mytarget_compagins'
[0m10:40:43.478252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_mytarget_compagins)
[0m10:40:43.478252 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_mytarget_compagins
[0m10:40:43.478252 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m10:40:43.478252 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (compile): 2023-10-06 10:40:43.478252 => 2023-10-06 10:40:43.478252
[0m10:40:43.478252 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_mytarget_compagins
[0m10:40:43.497874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

            

    
        create table travelata.incremental_sheets_mytarget_compagins__dbt_backup
        
  
        
  engine = MergeTree()
        order by (table_name)
        
        
        
        empty
    as (
        

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
    )
        ...
[0m10:40:43.549620 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.552619 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

    select name, type from system.columns where table = 'incremental_sheets_mytarget_compagins__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:43.605162 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.605162 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_mytarget_compagins"
[0m10:40:43.620844 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */

  
    
    
        
        insert into travelata.incremental_sheets_mytarget_compagins__dbt_backup ("id", "name", "airbyte_ab_id", "table_name", "_emitted_at", "_normalized_at")
  

select * replace (CAST (_date as date) as _date)
from travelata.normalized_sheets_mytarget_compagins_new
  ...
[0m10:40:43.668696 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.668696 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
EXCHANGE TABLES travelata.incremental_sheets_mytarget_compagins__dbt_backup AND travelata.incremental_sheets_mytarget_compagins 
  
  ...
[0m10:40:43.711281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:43.726785 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_mytarget_compagins: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_mytarget_compagins"} */
drop table if exists travelata.incremental_sheets_mytarget_compagins__dbt_backup 
  ...
[0m10:40:43.774638 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.774638 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_mytarget_compagins (execute): 2023-10-06 10:40:43.493884 => 2023-10-06 10:40:43.774638
[0m10:40:43.774638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A395310>]}
[0m10:40:43.774638 [info ] [Thread-1 (]: 23 of 30 OK created sql table model travelata.incremental_sheets_mytarget_compagins  [[32mOK[0m in 0.30s]
[0m10:40:43.774638 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m10:40:43.774638 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m10:40:43.774638 [info ] [Thread-1 (]: 24 of 30 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m10:40:43.774638 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m10:40:43.774638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m10:40:43.774638 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m10:40:43.774638 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m10:40:43.774638 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 10:40:43.774638 => 2023-10-06 10:40:43.774638
[0m10:40:43.774638 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m10:40:43.792134 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m10:40:43.844023 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:43.844023 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:43.922629 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:43.922629 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m10:40:43.922629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult__dbt_backup ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m10:40:44.001031 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:44.001031 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
EXCHANGE TABLES travelata.incremental_sheets_utmcraft_utmresult__dbt_backup AND travelata.incremental_sheets_utmcraft_utmresult 
  
  ...
[0m10:40:44.064311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:44.064311 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
drop table if exists travelata.incremental_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m10:40:44.111172 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:44.111172 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 10:40:43.774638 => 2023-10-06 10:40:44.111172
[0m10:40:44.111172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A3F7ED0>]}
[0m10:40:44.111172 [info ] [Thread-1 (]: 24 of 30 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.34s]
[0m10:40:44.111172 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m10:40:44.111172 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:40:44.111172 [info ] [Thread-1 (]: 25 of 30 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m10:40:44.111172 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m10:40:44.111172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m10:40:44.111172 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:40:44.111172 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m10:40:44.111172 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 10:40:44.111172 => 2023-10-06 10:40:44.111172
[0m10:40:44.111172 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:40:44.130276 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:44.170101 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:44.177336 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m10:40:44.248200 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:44.248200 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:44.295960 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:44.295960 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m10:40:44.295960 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m10:40:44.375601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:44.375601 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

      delete from travelata.incremental_sheets_vkads_adgroupsstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a);
    ...
[0m10:40:44.437766 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:44.453392 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:44.509798 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:44.509798 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        insert into travelata.incremental_sheets_vkads_adgroupsstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
    ...
[0m10:40:44.565382 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:44.565382 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:44.614467 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:44.616506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_distributed_new_data 
  ...
[0m10:40:44.658233 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:40:44.670499 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 10:40:44.111172 => 2023-10-06 10:40:44.670499
[0m10:40:44.670499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F8DB50>]}
[0m10:40:45.966810 [info ] [Thread-1 (]: 25 of 30 OK created sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.56s]
[0m10:40:45.966810 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m10:40:45.966810 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:40:45.966810 [info ] [Thread-1 (]: 26 of 30 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m10:40:45.966810 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m10:40:45.966810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m10:40:45.966810 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:40:45.966810 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m10:40:45.966810 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 10:40:45.966810 => 2023-10-06 10:40:45.966810
[0m10:40:45.966810 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:40:45.987501 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:46.044236 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.046233 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m10:40:46.125888 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:46.128886 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:46.185452 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.186451 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m10:40:46.187451 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m10:40:46.247263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.248296 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

      delete from travelata.incremental_sheets_vkads_adplansstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a);
    ...
[0m10:40:46.327033 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:46.331945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:46.382274 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:46.382274 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        insert into travelata.incremental_sheets_vkads_adplansstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
    ...
[0m10:40:46.447195 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.450200 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:46.483660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m10:40:46.499305 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_distributed_new_data 
  ...
[0m10:40:46.563578 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.563578 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 10:40:45.966810 => 2023-10-06 10:40:46.563578
[0m10:40:46.563578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A493F50>]}
[0m10:40:46.563578 [info ] [Thread-1 (]: 26 of 30 OK created sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.60s]
[0m10:40:46.563578 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m10:40:46.563578 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:40:46.563578 [info ] [Thread-1 (]: 27 of 30 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m10:40:46.563578 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m10:40:46.563578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m10:40:46.563578 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:40:46.563578 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m10:40:46.579028 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 10:40:46.563578 => 2023-10-06 10:40:46.579028
[0m10:40:46.579028 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:40:46.579949 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:46.634788 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:46.637786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m10:40:46.705119 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:46.705119 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:46.765965 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:46.767971 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m10:40:46.768965 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m10:40:46.846764 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m10:40:46.851863 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

      delete from travelata.incremental_sheets_vkads_bannerssstatistics where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a);
    ...
[0m10:40:46.923238 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:46.927245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:46.976323 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:46.976323 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        insert into travelata.incremental_sheets_vkads_bannerssstatistics select "__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a
    ...
[0m10:40:47.050834 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:40:47.053440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_155a0b5e_66db_4436_9886_01198ce9426a 
  ...
[0m10:40:47.098786 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.098786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_distributed_new_data 
  ...
[0m10:40:47.145791 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.163849 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 10:40:46.579949 => 2023-10-06 10:40:47.163849
[0m10:40:47.163849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A493750>]}
[0m10:40:47.163849 [info ] [Thread-1 (]: 27 of 30 OK created sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[32mOK[0m in 0.60s]
[0m10:40:47.163849 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m10:40:47.163849 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m10:40:47.177372 [info ] [Thread-1 (]: 28 of 30 START sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [RUN]
[0m10:40:47.177372 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_mediaplans'
[0m10:40:47.177372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_mediaplans)
[0m10:40:47.177372 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m10:40:47.177372 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m10:40:47.177372 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (compile): 2023-10-06 10:40:47.177372 => 2023-10-06 10:40:47.177372
[0m10:40:47.177372 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m10:40:47.177372 [debug] [Thread-1 (]: Creating new relation incremental_sheets_yandexdisk_mediaplans
[0m10:40:47.177372 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_mediaplans
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
    )
        ...
[0m10:40:47.241754 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:47.244847 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_mediaplans'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:47.290369 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.306014 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m10:40:47.306014 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_mediaplans ("Source", "Medium", "Campaign", "ProductName", "Geo", "Period_start", "Period_end", "Cost", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
  ...
[0m10:40:47.369299 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:47.369299 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (execute): 2023-10-06 10:40:47.177372 => 2023-10-06 10:40:47.369299
[0m10:40:47.369299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919E66D10>]}
[0m10:40:47.369299 [info ] [Thread-1 (]: 28 of 30 OK created sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.19s]
[0m10:40:47.369299 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m10:40:47.369299 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m10:40:47.369299 [info ] [Thread-1 (]: 29 of 30 START sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [RUN]
[0m10:40:47.369299 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_othercosts'
[0m10:40:47.369299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_othercosts)
[0m10:40:47.369299 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m10:40:47.369299 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m10:40:47.369299 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (compile): 2023-10-06 10:40:47.369299 => 2023-10-06 10:40:47.369299
[0m10:40:47.369299 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m10:40:47.386154 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_othercosts
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
    )
        ...
[0m10:40:47.434139 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.444148 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_othercosts'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:47.494966 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.495900 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m10:40:47.495900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_othercosts ("__datetime", "Source", "Medium", "Campaign", "ProductName", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
  
    ...
[0m10:40:47.559109 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:40:47.564648 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (execute): 2023-10-06 10:40:47.369299 => 2023-10-06 10:40:47.564648
[0m10:40:47.564648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919CD2190>]}
[0m10:40:47.564648 [info ] [Thread-1 (]: 29 of 30 OK created sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.20s]
[0m10:40:47.564648 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m10:40:47.564648 [debug] [Thread-1 (]: Began running node model.travelata.incremental__sheets_yd_customreport
[0m10:40:47.564648 [info ] [Thread-1 (]: 30 of 30 START sql incremental model travelata.incremental__sheets_yd_customreport  [RUN]
[0m10:40:47.564648 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental__sheets_yd_customreport'
[0m10:40:47.564648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental__sheets_yd_customreport)
[0m10:40:47.564648 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental__sheets_yd_customreport
[0m10:40:47.571686 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental__sheets_yd_customreport"
[0m10:40:47.573683 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (compile): 2023-10-06 10:40:47.564648 => 2023-10-06 10:40:47.573683
[0m10:40:47.573683 [debug] [Thread-1 (]: Began executing node model.travelata.incremental__sheets_yd_customreport
[0m10:40:47.579062 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

            

    
        create table travelata.incremental__sheets_yd_customreport
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
    )
        ...
[0m10:40:47.630215 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.632220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

    select name, type from system.columns where table = 'incremental__sheets_yd_customreport'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:40:47.685037 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.685037 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental__sheets_yd_customreport"
[0m10:40:47.685037 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

        
  
    
    
        
        insert into travelata.incremental__sheets_yd_customreport ("__datetime", "reportType", "CampaignId", "CampaignName", "CampaignType", "AdGroupId", "AdGroupName", "AdId", "CriterionId", "Criterion", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
  
    ...
[0m10:40:47.732368 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:40:47.732368 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (execute): 2023-10-06 10:40:47.573683 => 2023-10-06 10:40:47.732368
[0m10:40:47.744374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '155a0b5e-66db-4436-9886-01198ce9426a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F6FA50>]}
[0m10:40:47.744374 [info ] [Thread-1 (]: 30 of 30 OK created sql incremental model travelata.incremental__sheets_yd_customreport  [[32mOK[0m in 0.18s]
[0m10:40:47.746076 [debug] [Thread-1 (]: Finished running node model.travelata.incremental__sheets_yd_customreport
[0m10:40:47.746076 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:40:47.746076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:47.746076 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:40:47.746076 [debug] [MainThread]: On list_schemas: Close
[0m10:40:47.746076 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:40:47.746076 [debug] [MainThread]: On list_None_travelata: Close
[0m10:40:47.746076 [debug] [MainThread]: Connection 'model.travelata.incremental__sheets_yd_customreport' was left open.
[0m10:40:47.746076 [debug] [MainThread]: On model.travelata.incremental__sheets_yd_customreport: Close
[0m10:40:47.746076 [info ] [MainThread]: 
[0m10:40:47.746076 [info ] [MainThread]: Finished running 17 view models, 8 incremental models, 5 table models in 0 hours 0 minutes and 14.34 seconds (14.34s).
[0m10:40:47.752248 [debug] [MainThread]: Command end result
[0m10:40:47.761690 [info ] [MainThread]: 
[0m10:40:47.762688 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:40:47.762688 [info ] [MainThread]: 
[0m10:40:47.763690 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_mytarget_banners_statistics (models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql)[0m
[0m10:40:47.764690 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m10:40:47.765202 [error] [MainThread]:    Code: 6. DB::Exception: Cannot parse string '01.10.2023 0:02:50' as Date: syntax error at position 8 (parsed just '01.10.20'): while executing 'FUNCTION CAST(_date :: 10, 'date' :: 11) -> CAST(_date, 'date') Date : 9'. (CANNOT_PARSE_TEXT) (version 23.3.13.6 (official build))
[0m10:40:47.766625 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m10:40:47.767210 [info ] [MainThread]: 
[0m10:40:47.767948 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=1 SKIP=0 TOTAL=30
[0m10:40:47.767948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919F67FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026919A7CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002691A41D810>]}
[0m10:40:47.767948 [debug] [MainThread]: Flushing usage events
