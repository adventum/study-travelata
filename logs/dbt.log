

============================== 2023-09-27 09:56:14.819371 | da95eec8-f7f7-451f-90be-0fec5d743e3b ==============================
[0m09:56:14.819371 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:56:14.834996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:56:14.834996 [debug] [MainThread]: Tracking: tracking
[0m09:56:14.834996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8880>]}
[0m09:56:14.851015 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:56:14.851015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:14.851015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F88F8>]}
[0m09:56:16.954656 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m09:56:16.970297 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5DD8>]}
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>]}
[0m09:56:17.142684 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:56:17.142684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059E96A0>]}
[0m09:56:17.142684 [info ] [MainThread]: 
[0m09:56:17.142684 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:56:17.142684 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:56:17.158719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:27.915586 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE028>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m09:56:36.983601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:36.983601 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:56:36.983601 [debug] [MainThread]: On list_schemas: No close available on handle
[0m09:56:36.983601 [info ] [MainThread]: 
[0m09:56:36.983601 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 19.84 seconds (19.84s).
[0m09:56:36.983601 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE220>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D41CB8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FCFE340>]}
[0m09:56:36.983601 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:01:25.322824 | be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a ==============================
[0m10:01:25.322824 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:01:25.326846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:01:25.326846 [debug] [MainThread]: Tracking: tracking
[0m10:01:25.327845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767838>]}
[0m10:01:25.355300 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:26.191340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068446E8>]}
[0m10:01:26.202352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7658>]}
[0m10:01:26.202352 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:01:26.203351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7670>]}
[0m10:01:26.205345 [info ] [MainThread]: 
[0m10:01:26.208343 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:01:26.210343 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:01:26.229343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.989071 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845B20>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:01:47.061312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:47.061312 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:01:47.061312 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:01:47.061312 [info ] [MainThread]: 
[0m10:01:47.061312 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.85 seconds (20.85s).
[0m10:01:47.061312 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845D18>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D72C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F845E38>]}
[0m10:01:47.061312 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:02:16.338593 | 5af424ed-2a38-4297-bcd6-d46bd3e8e53e ==============================
[0m10:02:16.338593 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:02:16.338593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:02:16.338593 [debug] [MainThread]: Tracking: tracking
[0m10:02:16.338593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8868>]}
[0m10:02:16.360232 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:16.574192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ED4718>]}
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E65688>]}
[0m10:02:16.589833 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E656A0>]}
[0m10:02:16.589833 [info ] [MainThread]: 
[0m10:02:16.605456 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:02:16.605456 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:02:16.621081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:25.317650 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5B50>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:02:34.493743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:34.493743 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:02:34.493743 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:02:34.493743 [info ] [MainThread]: 
[0m10:02:34.493743 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 17.90 seconds (17.90s).
[0m10:02:34.493743 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5D48>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05581730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E652F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EED5E68>]}
[0m10:02:34.493743 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:15:00.923308 | ad1000d9-4990-4e47-a48a-334ef46d8e98 ==============================
[0m10:15:00.923308 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:15:00.938952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:15:00.938952 [debug] [MainThread]: Tracking: tracking
[0m10:15:00.938952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B597C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B59808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B598F8>]}
[0m10:15:00.970197 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:01.805363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064357A8>]}
[0m10:15:01.809880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8718>]}
[0m10:15:01.809880 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:15:01.821388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8730>]}
[0m10:15:01.821388 [info ] [MainThread]: 
[0m10:15:01.821388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:01.821388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:15:01.837031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.146370 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:15:05.209378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.215394 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:15:05.225413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.815665 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:15:05.878180 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.878180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x040BF3B8>]}
[0m10:15:05.893943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:05.893943 [info ] [MainThread]: 
[0m10:15:05.972519 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [info ] [Thread-1  ]: 1 of 2 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:15:05.972519 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:15:05.972519 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:15:05.988139 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-27 10:15:05.972519 => 2023-09-27 10:15:05.988139
[0m10:15:05.988139 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:15:06.019931 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:15:06.066716 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:15:06.679729 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:15:06.726995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.742635 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:15:06.789509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.805135 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:15:06.805135 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:15:06.868053 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:06.917963 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-27 10:15:05.988139 => 2023-09-27 10:15:06.914935
[0m10:15:06.917963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06422F70>]}
[0m10:15:06.917963 [info ] [Thread-1  ]: 1 of 2 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.95s]
[0m10:15:06.917963 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:15:06.917963 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:15:06.925504 [info ] [Thread-1  ]: 2 of 2 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:15:06.925504 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:15:06.925504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:15:06.925504 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:15:06.931030 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:15:06.931030 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-27 10:15:06.925504 => 2023-09-27 10:15:06.931030
[0m10:15:06.931030 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:15:06.962297 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:15:07.025191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:07.025191 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-27 10:15:06.931030 => 2023-09-27 10:15:07.025191
[0m10:15:07.025191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8538>]}
[0m10:15:07.025191 [info ] [Thread-1  ]: 2 of 2 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.10s]
[0m10:15:07.025191 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:15:07.025191 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:07.025191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_schemas: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_None_travelata: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:15:07.040830 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m10:15:07.040830 [debug] [MainThread]: Command end result
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.056454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:15:07.056454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065B02B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10DDE4D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0421B508>]}
[0m10:15:07.056454 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:04:49.891103 | e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0 ==============================
[0m10:04:49.891103 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:04:49.891103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:04:49.891103 [debug] [MainThread]: Tracking: tracking
[0m10:04:49.891103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298538>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298568>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298658>]}
[0m10:04:49.928844 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.832619 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.926797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075D72F8>]}
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364C40>]}
[0m10:04:50.942421 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364EF8>]}
[0m10:04:50.942421 [info ] [MainThread]: 
[0m10:04:50.942421 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:50.942421 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:04:50.958051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:54.461225 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:04:54.508521 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:54.524157 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:04:54.524157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:55.135028 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:04:55.197937 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.197937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075CDD78>]}
[0m10:04:55.197937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:55.197937 [info ] [MainThread]: 
[0m10:04:55.213577 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:04:55.213577 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:04:55.213577 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:04:55.213577 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:55.213577
[0m10:04:55.213577 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:04:55.257810 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:04:55.311853 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:04:55.902137 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:04:55.964649 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.980276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:04:56.048733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.056752 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:04:56.058277 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:04:56.126233 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.157486 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:56.157486
[0m10:04:56.157486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898F28>]}
[0m10:04:56.157486 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.94s]
[0m10:04:56.157486 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:04:56.157486 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.157486 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:04:56.157486 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:04:56.157486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:04:56.157486 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:04:56.173112 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.173112 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.173112
[0m10:04:56.173112 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:04:56.195742 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_installs
[0m10:04:56.217745 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.217745 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs 
  
  as (
    select *
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:04:56.272563 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:56.288193 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.288193
[0m10:04:56.288193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898AD8>]}
[0m10:04:56.288193 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.13s]
[0m10:04:56.288193 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.288193 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:04:56.288193 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:04:56.295704 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:04:56.295704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:04:56.295704 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:04:56.295704 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:04:56.295704 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.295704
[0m10:04:56.295704 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:04:56.304220 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:04:56.367035 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:56.371032 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.371032
[0m10:04:56.372026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11F59F58>]}
[0m10:04:56.373026 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.08s]
[0m10:04:56.374027 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:04:56.376030 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:56.377094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_schemas: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_None_travelata: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:04:56.377094 [info ] [MainThread]: 
[0m10:04:56.377094 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m10:04:56.377094 [debug] [MainThread]: Command end result
[0m10:04:56.392734 [info ] [MainThread]: 
[0m10:04:56.392734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:56.395753 [info ] [MainThread]: 
[0m10:04:56.395753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:04:56.395753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0626EB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x062862E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364DC0>]}
[0m10:04:56.395753 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:20:33.166185 | 822cc9da-952e-4a3b-90f4-fedd909cf552 ==============================
[0m10:20:33.166185 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:20:33.166185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:20:33.166185 [debug] [MainThread]: Tracking: tracking
[0m10:20:33.181825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9E50>]}
[0m10:20:33.197454 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:33.315122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550260D0>]}
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F859A0>]}
[0m10:20:33.330747 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85C10>]}
[0m10:20:33.346388 [info ] [MainThread]: 
[0m10:20:33.346388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:33.346388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:20:33.362414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.297249 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:20:35.360149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:35.375786 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:20:35.375786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.970774 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:20:36.033323 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.038317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D455044970>]}
[0m10:20:36.040322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:36.041320 [info ] [MainThread]: 
[0m10:20:36.049227 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:20:36.050233 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:20:36.051226 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:20:36.052233 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:20:36.057740 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:20:36.059757 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:20:36.053232 => 2023-09-28 10:20:36.058757
[0m10:20:36.059757 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:20:36.132760 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:20:36.721120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:20:36.774463 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:36.790017 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:20:36.852532 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.858551 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:20:36.858551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:20:36.899826 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:36.915456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:20:36.978358 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.009610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:20:37.058997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:20:36.060753 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4564118B0>]}
[0m10:20:37.072510 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m10:20:37.072510 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:20:37.072510 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:20:37.072510 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:20:37.072510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:20:37.072510 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:20:37.072510 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:20:37.120637 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.120637 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    select *
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:20:37.174686 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.190318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.308276 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.323905 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:20:37.496736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.496736 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:20:37.088152 => 2023-09-28 10:20:37.496736
[0m10:20:37.496736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D456468F40>]}
[0m10:20:37.496736 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.42s]
[0m10:20:37.496736 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.496736 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:20:37.496736 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:20:37.496736 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:20:37.496736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:20:37.496736 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:20:37.496736 => 2023-09-28 10:20:37.512368
[0m10:20:37.512368 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.675677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.685700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.769752 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.788311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:20:37.841558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.841558 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:20:37.512368 => 2023-09-28 10:20:37.841558
[0m10:20:37.841558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565232B0>]}
[0m10:20:37.841558 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.34s]
[0m10:20:37.857181 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:20:37.860193 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:37.860193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_schemas: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_None_travelata: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:20:37.860193 [info ] [MainThread]: 
[0m10:20:37.860193 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m10:20:37.860193 [debug] [MainThread]: Command end result
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:20:37.882067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565101C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550EC790>]}
[0m10:20:37.883085 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:33:18.958604 | d73870df-3ddc-4f46-b473-bd951638145c ==============================
[0m10:33:18.958604 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:33:18.960702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:33:18.961230 [debug] [MainThread]: Tracking: tracking
[0m10:33:18.973650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D790D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79E50>]}
[0m10:33:18.991176 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:33:19.097171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:19.098171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:19.107170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D0E60D0>]}
[0m10:33:19.117173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1A00>]}
[0m10:33:19.119172 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:33:19.120170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C70>]}
[0m10:33:19.122167 [info ] [MainThread]: 
[0m10:33:19.124172 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:19.126168 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:33:19.144173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:20.454170 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:33:20.504733 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:20.509736 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:33:20.518733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:21.124172 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:33:21.177043 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:21.182038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1049D0>]}
[0m10:33:21.183045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:21.184038 [info ] [MainThread]: 
[0m10:33:21.190101 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:33:21.191101 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:33:21.194107 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:33:21.195101 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:33:21.200101 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:33:21.201105 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:33:21.195101 => 2023-09-28 10:33:21.201105
[0m10:33:21.202106 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:33:21.276644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:21.874233 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:33:21.932024 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:21.945025 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:33:22.005208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.010200 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:33:22.012215 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:33:22.067290 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.075309 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:33:22.124819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.164816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:33:22.214637 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.216632 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:33:21.203106 => 2023-09-28 10:33:22.216632
[0m10:33:22.218637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E0910>]}
[0m10:33:22.220640 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.03s]
[0m10:33:22.223636 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:33:22.224633 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.225633 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:33:22.227635 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:33:22.227635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:33:22.228634 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:33:22.232632 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.233647 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:33:22.229639 => 2023-09-28 10:33:22.233647
[0m10:33:22.234635 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:33:22.275643 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.277644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(
        JSONExtractString(_airbyte_data, 'install_datetime'),
        '%d.%m.%Y'
    ) AS __datetime,
    JSONExtractString(_airbyte_data, 'city') AS city


FROM (
        select *
        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
    )
  )...
[0m10:33:22.330770 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.340765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.394390 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.396384 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.454609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.458610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.514149 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.516153 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.564483 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.571479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:33:22.634556 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.636550 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:33:22.234635 => 2023-09-28 10:33:22.636550
[0m10:33:22.638550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4F9730>]}
[0m10:33:22.639558 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.41s]
[0m10:33:22.640550 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.641558 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:33:22.642556 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:33:22.644557 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:33:22.645554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:33:22.645554 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:33:22.649553 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:33:22.650553 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:33:22.646557 => 2023-09-28 10:33:22.650553
[0m10:33:22.651556 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:33:22.662553 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:33:22.664556 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:33:22.717590 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.721593 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.774256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.776265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.824160 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.829158 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.883801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.885791 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.944524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.951524 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:33:23.004774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:23.006777 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:33:22.651556 => 2023-09-28 10:33:23.006777
[0m10:33:23.007773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E04F0>]}
[0m10:33:23.008775 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m10:33:23.010770 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:33:23.012772 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:23.013770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:23.014773 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:33:23.014773 [debug] [MainThread]: On list_schemas: Close
[0m10:33:23.015772 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:33:23.015772 [debug] [MainThread]: On list_None_travelata: Close
[0m10:33:23.016772 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:33:23.017771 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:33:23.017771 [info ] [MainThread]: 
[0m10:33:23.018771 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m10:33:23.020774 [debug] [MainThread]: Command end result
[0m10:33:23.030773 [info ] [MainThread]: 
[0m10:33:23.032770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:23.033769 [info ] [MainThread]: 
[0m10:33:23.034772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:33:23.035771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E5E7EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1AC7F0>]}
[0m10:33:23.036777 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:21:50.550849 | ed8c38e2-03ed-40df-ab51-f0d7ea4729ab ==============================
[0m11:21:50.550849 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:21:50.552844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:21:50.553850 [debug] [MainThread]: Tracking: tracking
[0m11:21:50.567384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7E50>]}
[0m11:21:50.585389 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:50.706068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4370D0>]}
[0m11:21:50.716059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BA00>]}
[0m11:21:50.717060 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:21:50.719065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BC70>]}
[0m11:21:50.721059 [info ] [MainThread]: 
[0m11:21:50.724060 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:50.727069 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:21:50.742061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.096741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:21:52.146894 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.152916 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:21:52.163908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.776139 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:21:52.829300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.834293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4549D0>]}
[0m11:21:52.835287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:52.836290 [info ] [MainThread]: 
[0m11:21:52.843295 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:21:52.844290 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:21:52.846293 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:21:52.847298 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:21:52.852300 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:21:52.854319 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:21:52.847298 => 2023-09-28 11:21:52.854319
[0m11:21:52.855319 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:21:52.935345 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:21:53.537150 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:21:53.594678 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.606673 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:21:53.667696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.675767 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:21:53.678373 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:21:53.729108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.737124 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:21:53.786648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.826167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:21:53.876741 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.879755 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:21:52.856318 => 2023-09-28 11:21:53.879755
[0m11:21:53.881745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B830910>]}
[0m11:21:53.882739 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m11:21:53.885741 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:21:53.886737 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:21:53.889740 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:21:53.892740 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:21:53.893742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:21:53.894743 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:21:53.899747 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.903741 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:21:53.895745 => 2023-09-28 11:21:53.903741
[0m11:21:53.904739 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:21:53.961379 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.962382 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(
        JSONExtractString(_airbyte_data, 'install_datetime'),
        '%d.%m.%Y'
    ) AS __datetime,
    JSONExtractString(_airbyte_data, 'city') AS city


FROM (
        select *
        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
    )SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m11:21:54.016922 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(
        JSONExtractString(_airbyte_data, 'install_datetime'),
        '%d.%m.%Y'
    ) AS __datetime,
    JSONExtractString(_airbyte_data, 'city') AS city


FROM (
        select *
        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
    )SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )
[0m11:21:54.017910 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:21:53.905743 => 2023-09-28 11:21:54.017910
[0m11:21:54.027916 [debug] [Thread-1  ]: Database Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
  JSONExtractString(_airbyte_data, 'city') AS city,
  JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.028911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7E0A60>]}
[0m11:21:54.029917 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model travelata.normalize_sheet_default_installs  [[31mERROR[0m in 0.14s]
[0m11:21:54.030908 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:21:54.031914 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:21:54.032915 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:21:54.034913 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:21:54.034913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:21:54.035908 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:21:54.039904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:21:54.040910 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:21:54.035908 => 2023-09-28 11:21:54.040910
[0m11:21:54.041913 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:21:54.049916 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:21:54.051912 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:21:54.101447 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.118444 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.166231 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.167226 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.216882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.223881 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.285910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.287907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.336432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.342424 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:21:54.405954 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.408958 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:21:54.041913 => 2023-09-28 11:21:54.408958
[0m11:21:54.410954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B897040>]}
[0m11:21:54.411951 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m11:21:54.412950 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:21:54.414952 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:54.415958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:54.415958 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:21:54.416950 [debug] [MainThread]: On list_schemas: Close
[0m11:21:54.416950 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:21:54.417954 [debug] [MainThread]: On list_None_travelata: Close
[0m11:21:54.417954 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:21:54.418950 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:21:54.419951 [info ] [MainThread]: 
[0m11:21:54.420947 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m11:21:54.422953 [debug] [MainThread]: Command end result
[0m11:21:54.433955 [info ] [MainThread]: 
[0m11:21:54.434952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:21:54.435952 [info ] [MainThread]: 
[0m11:21:54.437956 [error] [MainThread]: [33mDatabase Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)[0m
[0m11:21:54.440952 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:21:54.441956 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
[0m11:21:54.443958 [error] [MainThread]:   JSONExtractString(_airbyte_data, 'city') AS city,
[0m11:21:54.444953 [error] [MainThread]:   JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m11:21:54.446955 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.447950 [info ] [MainThread]: 
[0m11:21:54.448951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:21:54.450957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4FB880>]}
[0m11:21:54.451953 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:22:30.162865 | 86ba7e4c-395b-498b-b462-45038a70680b ==============================
[0m11:22:30.162865 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:22:30.166881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:30.166881 [debug] [MainThread]: Tracking: tracking
[0m11:22:30.178882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9E50>]}
[0m11:22:30.198391 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:30.316132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C680D0>]}
[0m11:22:30.327136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4A30>]}
[0m11:22:30.328134 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:22:30.330132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4CA0>]}
[0m11:22:30.332129 [info ] [MainThread]: 
[0m11:22:30.336136 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:30.338140 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:22:30.359135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:31.726494 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:22:31.787087 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:31.791618 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:22:31.803138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:32.386061 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:22:32.449690 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:32.455692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C84A00>]}
[0m11:22:32.457688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:32.458684 [info ] [MainThread]: 
[0m11:22:32.466689 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:22:32.468702 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:22:32.469692 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:22:32.470688 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:22:32.475688 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:22:32.476690 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:22:32.471690 => 2023-09-28 11:22:32.476690
[0m11:22:32.477690 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:22:32.551223 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:22:33.136701 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:22:33.192584 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.205103 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:22:33.257579 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.263578 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:22:33.265088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:22:33.318905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.326903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:22:33.387051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.423575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:22:33.476133 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.478137 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:22:32.478694 => 2023-09-28 11:22:33.478137
[0m11:22:33.480134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F940>]}
[0m11:22:33.481136 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.01s]
[0m11:22:33.484146 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:22:33.485142 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.486147 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:22:33.489149 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:22:33.489149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:22:33.490160 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:22:33.493147 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.494146 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:22:33.491150 => 2023-09-28 11:22:33.494146
[0m11:22:33.495148 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:22:33.532665 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.534667 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m11:22:33.590861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.601392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.645458 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.647448 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.696429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.700674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.745841 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.747834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.796371 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.802903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m11:22:33.855899 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.858893 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:22:33.496149 => 2023-09-28 11:22:33.858893
[0m11:22:33.859900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C990D0>]}
[0m11:22:33.860893 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m11:22:33.862904 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.863902 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:22:33.864900 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:22:33.866904 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:22:33.867910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:22:33.869904 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:22:33.875904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:22:33.877906 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:22:33.869904 => 2023-09-28 11:22:33.877906
[0m11:22:33.878909 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:22:33.889921 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:22:33.892929 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:22:33.949455 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.954456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.015995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.018005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.066052 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.071051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.116599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.118604 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.175867 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.182877 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:22:34.235599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.238604 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:22:33.879906 => 2023-09-28 11:22:34.238604
[0m11:22:34.240602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F4F0>]}
[0m11:22:34.241601 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m11:22:34.242595 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:22:34.244598 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:34.245600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:34.246603 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:22:34.246603 [debug] [MainThread]: On list_schemas: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:22:34.247601 [debug] [MainThread]: On list_None_travelata: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:22:34.248601 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:22:34.249602 [info ] [MainThread]: 
[0m11:22:34.250599 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m11:22:34.252600 [debug] [MainThread]: Command end result
[0m11:22:34.261602 [info ] [MainThread]: 
[0m11:22:34.263600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:34.264602 [info ] [MainThread]: 
[0m11:22:34.266692 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:34.267600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015755168EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753D2C820>]}
[0m11:22:34.268599 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 14:51:49.527538 | 75a26bc2-a813-4200-8a93-68280085b930 ==============================
[0m14:51:49.527538 [info ] [MainThread]: Running with dbt=1.4.8
[0m14:51:49.531179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:49.531179 [debug] [MainThread]: Tracking: tracking
[0m14:51:49.546213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223814990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499E50>]}
[0m14:51:49.563728 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:49.685564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238480F0D0>]}
[0m14:51:49.698566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4FA0>]}
[0m14:51:49.699574 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:51:49.701565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>]}
[0m14:51:49.703562 [info ] [MainThread]: 
[0m14:51:49.706570 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:49.709585 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m14:51:49.732562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:51.711721 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m14:51:51.763292 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:51.767290 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m14:51:51.775812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.391811 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m14:51:52.445330 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:52.449346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4F10>]}
[0m14:51:52.451352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:52.452354 [info ] [MainThread]: 
[0m14:51:52.462351 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m14:51:52.463362 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m14:51:52.464901 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m14:51:52.465905 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m14:51:52.470899 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m14:51:52.473898 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 14:51:52.466904 => 2023-09-28 14:51:52.473898
[0m14:51:52.474898 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m14:51:52.551900 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:51:53.143858 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m14:51:53.206392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.224392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m14:51:53.277980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.285975 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m14:51:53.288976 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m14:51:53.347354 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.367779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m14:51:53.423818 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.467471 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m14:51:53.521623 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.524625 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 14:51:52.476918 => 2023-09-28 14:51:53.524625
[0m14:51:53.526626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C00D30>]}
[0m14:51:53.527627 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m14:51:53.530641 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m14:51:53.531614 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m14:51:53.532611 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m14:51:53.534616 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m14:51:53.535618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m14:51:53.536611 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m14:51:53.539617 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.541616 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-28 14:51:53.537613 => 2023-09-28 14:51:53.541616
[0m14:51:53.542620 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m14:51:53.567157 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_events
[0m14:51:53.584160 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.586156 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m14:51:53.638153 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.641154 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-28 14:51:53.543615 => 2023-09-28 14:51:53.641154
[0m14:51:53.642148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C16BB0>]}
[0m14:51:53.643157 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.11s]
[0m14:51:53.645152 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m14:51:53.646155 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m14:51:53.647154 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m14:51:53.648153 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m14:51:53.649154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m14:51:53.650165 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m14:51:53.652161 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.654165 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 14:51:53.650165 => 2023-09-28 14:51:53.653163
[0m14:51:53.654165 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m14:51:53.671321 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.674311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m14:51:53.729307 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.740306 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.792359 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.795359 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.843360 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.850367 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.901881 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.904528 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.953880 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.962897 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m14:51:54.011449 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.013463 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 14:51:53.655167 => 2023-09-28 14:51:54.013463
[0m14:51:54.015450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C279D0>]}
[0m14:51:54.016456 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m14:51:54.017445 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m14:51:54.018448 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m14:51:54.019445 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m14:51:54.021447 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m14:51:54.021447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m14:51:54.022450 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m14:51:54.027450 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m14:51:54.028448 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 14:51:54.023444 => 2023-09-28 14:51:54.028448
[0m14:51:54.030452 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m14:51:54.044441 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m14:51:54.048446 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m14:51:54.110492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.117485 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.172453 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.175453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.222451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.230450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.281976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.285973 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.331976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.341988 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m14:51:54.401540 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.404535 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 14:51:54.030452 => 2023-09-28 14:51:54.404535
[0m14:51:54.406533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385BB2520>]}
[0m14:51:54.407537 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m14:51:54.409537 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m14:51:54.412527 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:54.414526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:54.415530 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m14:51:54.416529 [debug] [MainThread]: On list_schemas: Close
[0m14:51:54.416529 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m14:51:54.417527 [debug] [MainThread]: On list_None_travelata: Close
[0m14:51:54.418828 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m14:51:54.419531 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m14:51:54.421531 [info ] [MainThread]: 
[0m14:51:54.423526 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m14:51:54.425528 [debug] [MainThread]: Command end result
[0m14:51:54.445047 [info ] [MainThread]: 
[0m14:51:54.448053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:54.451061 [info ] [MainThread]: 
[0m14:51:54.453065 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:51:54.456064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223848D3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381494E20>]}
[0m14:51:54.457068 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:05:45.764519 | e1ed8562-997b-46d2-a9b6-730dca8ec006 ==============================
[0m06:05:45.764519 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:05:45.764519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:45.764519 [debug] [MainThread]: Tracking: tracking
[0m06:05:45.784115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE590D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59E50>]}
[0m06:05:45.795527 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201EC0D0>]}
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2FD0>]}
[0m06:05:45.951682 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:05:45.951682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>]}
[0m06:05:45.951682 [info ] [MainThread]: 
[0m06:05:45.951682 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:45.951682 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:05:45.977927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:47.808761 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:05:47.871258 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:47.871258 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:05:47.879771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:48.499597 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:05:48.558875 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:48.558875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2F40>]}
[0m06:05:48.558875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:48.558875 [info ] [MainThread]: 
[0m06:05:48.576757 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:05:48.577755 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:05:48.579759 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:05:48.580760 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:05:48.584051 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:05:48.584051 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:05:48.581974 => 2023-09-29 06:05:48.584051
[0m06:05:48.584051 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:05:48.623316 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m06:05:48.671620 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:05:49.270961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:05:49.332163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.347792 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.395064 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:05:49.457583 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.489243 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:05:48.584051 => 2023-09-29 06:05:49.489243
[0m06:05:49.489243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCC40>]}
[0m06:05:49.489243 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.91s]
[0m06:05:49.504889 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:05:49.504889 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:05:49.504889 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:05:49.504889 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:05:49.510623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:05:49.511640 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:05:49.515999 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.515999 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:05:49.512640 => 2023-09-29 06:05:49.515999
[0m06:05:49.515999 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:05:49.610633 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.611633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m06:05:49.668625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.684665 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.715934 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:49.731555 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.778429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.781941 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.888124 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.903763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:05:49.951048 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.951048 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:05:49.515999 => 2023-09-29 06:05:49.951048
[0m06:05:49.951048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCB80>]}
[0m06:05:49.951048 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.45s]
[0m06:05:49.966671 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:05:49.966671 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:05:49.966671 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:05:49.966671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:05:49.966671 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.966671 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:49.966671
[0m06:05:49.966671 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.984608 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m06:05:50.045238 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.049235 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.159564 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.164564 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.195175 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:50.210804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.257679 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.273302 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:05:50.336211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.336211 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:50.336211
[0m06:05:50.336211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A821691430>]}
[0m06:05:50.336211 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m06:05:50.336211 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:05:50.336211 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:05:50.336211 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:05:50.336211 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:05:50.336211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:05:50.336211 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:05:50.356149 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:05:50.358149 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:05:50.351837 => 2023-09-29 06:05:50.358149
[0m06:05:50.359155 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:05:50.368396 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:05:50.370571 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:05:50.421163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.430519 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.479750 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.481908 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.541131 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.546447 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.600861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.603026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.650142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.650660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:05:50.697871 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.712886 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:05:50.360157 => 2023-09-29 06:05:50.712886
[0m06:05:50.712886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8216D5EB0>]}
[0m06:05:50.712886 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m06:05:50.712886 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:05:50.712886 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:50.712886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_schemas: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_None_travelata: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:05:50.712886 [info ] [MainThread]: 
[0m06:05:50.712886 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m06:05:50.727633 [debug] [MainThread]: Command end result
[0m06:05:50.738631 [info ] [MainThread]: 
[0m06:05:50.739630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:50.741679 [info ] [MainThread]: 
[0m06:05:50.741679 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:05:50.741679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8202B2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE4FF40>]}
[0m06:05:50.741679 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:12:14.089183 | 37f5e437-b126-421d-8955-7f629a98a9b6 ==============================
[0m06:12:14.089183 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:12:14.089183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:12:14.089183 [debug] [MainThread]: Tracking: tracking
[0m06:12:14.104801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388E80>]}
[0m06:12:14.130381 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:14.248827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46FE0D0>]}
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632220>]}
[0m06:12:14.256344 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632490>]}
[0m06:12:14.256344 [info ] [MainThread]: 
[0m06:12:14.256344 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:14.271988 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:12:14.289644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:15.610602 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:12:15.657878 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:15.673520 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:12:15.673520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:16.255651 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:12:16.318256 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:16.318256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4721040>]}
[0m06:12:16.318256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:12:16.333890 [info ] [MainThread]: 
[0m06:12:16.333890 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:12:16.333890 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:12:16.342982 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:12:16.342982 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:12:16.347995 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:12:16.349859 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:12:16.344005 => 2023-09-29 06:12:16.349002
[0m06:12:16.349859 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:12:16.424899 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:12:17.001575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:12:17.056291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.071940 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.118805 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:12:17.182191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.197825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:12:17.260758 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.292027 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:12:17.338902 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.352919 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:12:16.351375 => 2023-09-29 06:12:17.352919
[0m06:12:17.352919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5AE2BB0>]}
[0m06:12:17.354931 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:12:17.354931 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:12:17.354931 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:12:17.354931 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:12:17.363781 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:12:17.365256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:12:17.365256 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:12:17.365256 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.370882 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:12:17.365256 => 2023-09-29 06:12:17.370882
[0m06:12:17.370882 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:12:17.412039 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.412039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m06:12:17.466315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.481969 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.530531 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.544453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:12:17.759673 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.759673 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:12:17.370882 => 2023-09-29 06:12:17.759673
[0m06:12:17.759673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5BC8D00>]}
[0m06:12:17.759673 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.40s]
[0m06:12:17.759673 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:12:17.759673 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:12:17.759673 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:12:17.759673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:12:17.759673 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.775833 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:12:17.759673 => 2023-09-29 06:12:17.775833
[0m06:12:17.778497 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:12:17.786094 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.786094 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m06:12:17.853091 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:17.862210 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:12:18.139865 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.139865 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:12:17.778497 => 2023-09-29 06:12:18.139865
[0m06:12:18.139865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5C06FD0>]}
[0m06:12:18.139865 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.38s]
[0m06:12:18.139865 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:12:18.139865 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.139865 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheet_default_profiles ......... [RUN]
[0m06:12:18.139865 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_profiles'
[0m06:12:18.139865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_profiles)
[0m06:12:18.139865 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.153378 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.155885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (compile): 2023-09-29 06:12:18.139865 => 2023-09-29 06:12:18.155885
[0m06:12:18.157743 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.161764 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_profiles
[0m06:12:18.165214 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.165214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_profiles"} */


  create view travelata.normalize_sheet_default_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles
)
  )...
[0m06:12:18.224854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.227846 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (execute): 2023-09-29 06:12:18.158760 => 2023-09-29 06:12:18.227846
[0m06:12:18.228846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5A8FA00>]}
[0m06:12:18.230856 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheet_default_profiles .... [[32mOK[0m in 0.09s]
[0m06:12:18.231856 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.232854 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:12:18.233860 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:12:18.234862 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:12:18.235942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:12:18.235942 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.235942
[0m06:12:18.235942 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:12:18.304481 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:18.309481 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.353694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:18.361212 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:12:18.581618 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.584630 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.584630
[0m06:12:18.586629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46C3F40>]}
[0m06:12:18.588629 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.35s]
[0m06:12:18.590641 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:12:18.592629 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:18.593632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:18.593632 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:12:18.594627 [debug] [MainThread]: On list_schemas: Close
[0m06:12:18.594627 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:12:18.595628 [debug] [MainThread]: On list_None_travelata: Close
[0m06:12:18.595628 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:12:18.596631 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:12:18.597049 [info ] [MainThread]: 
[0m06:12:18.599050 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:12:18.600280 [debug] [MainThread]: Command end result
[0m06:12:18.613104 [info ] [MainThread]: 
[0m06:12:18.614748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:18.617267 [info ] [MainThread]: 
[0m06:12:18.617267 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:12:18.617267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B59E7D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F10>]}
[0m06:12:18.617267 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:01.573650 | 24d118a3-a5f0-4db8-89c9-757c0aebd5da ==============================
[0m06:20:01.573650 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:01.573650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:01.573650 [debug] [MainThread]: Tracking: tracking
[0m06:20:01.592026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9EE0>]}
[0m06:20:01.617475 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_events.sql
[0m06:20:01.727497 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_profiles.sql
[0m06:20:01.743127 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.771769 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.774945 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.790478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C70D0>]}
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950E700>]}
[0m06:20:01.806116 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950EB50>]}
[0m06:20:01.806116 [info ] [MainThread]: 
[0m06:20:01.806116 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:01.806116 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:01.828405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.097984 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:20:03.150930 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:03.154928 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:20:03.160338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.756928 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:20:03.812076 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:03.812076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C22E0>]}
[0m06:20:03.812076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:20:03.820593 [info ] [MainThread]: 
[0m06:20:03.820593 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:20:03.820593 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:20:03.831617 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:20:03.832650 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:20:03.836650 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:20:03.837731 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:20:03.832650 => 2023-09-29 06:20:03.837731
[0m06:20:03.840067 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:20:03.922096 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:20:04.519776 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:20:04.575694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.588209 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.635097 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:20:04.747040 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.794414 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:20:04.841315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.841315 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:20:03.841099 => 2023-09-29 06:20:04.841315
[0m06:20:04.841315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B700>]}
[0m06:20:04.841315 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:20:04.856928 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:20:04.856928 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.856928 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:20:04.862598 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:20:04.863614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:20:04.864617 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.868611 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.870612 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:20:04.865609 => 2023-09-29 06:20:04.869611
[0m06:20:04.871492 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.881026 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.894651 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.894651 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m06:20:04.965166 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:04.970156 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:20:04.871492 => 2023-09-29 06:20:04.970156
[0m06:20:04.971159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B190>]}
[0m06:20:04.972157 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.11s]
[0m06:20:04.974270 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.974270 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:20:04.976283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:20:04.976283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:20:04.976283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.976283 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:04.976283
[0m06:20:04.976283 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.989805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles
)
  )...
[0m06:20:05.043935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.047937 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:05.047937
[0m06:20:05.048932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DD9CC70>]}
[0m06:20:05.049932 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.07s]
[0m06:20:05.051938 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:05.051938 [debug] [Thread-1  ]: Began running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.052937 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalizesheets_default_travelataappmetrica_events  [RUN]
[0m06:20:05.054946 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalizesheets_default_travelataappmetrica_events'
[0m06:20:05.055939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalizesheets_default_travelataappmetrica_events)
[0m06:20:05.055939 [debug] [Thread-1  ]: Began compiling node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.057934 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.059945 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (compile): 2023-09-29 06:20:05.055939 => 2023-09-29 06:20:05.059945
[0m06:20:05.060943 [debug] [Thread-1  ]: Began executing node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.064954 [debug] [Thread-1  ]: Creating new relation normalizesheets_default_travelataappmetrica_events
[0m06:20:05.066998 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.069008 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalizesheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalizesheets_default_travelataappmetrica_events"} */


  create view travelata.normalizesheets_default_travelataappmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m06:20:05.135182 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:05.139173 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (execute): 2023-09-29 06:20:05.060943 => 2023-09-29 06:20:05.139173
[0m06:20:05.140180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DCAB280>]}
[0m06:20:05.142172 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalizesheets_default_travelataappmetrica_events  [[32mOK[0m in 0.09s]
[0m06:20:05.143177 [debug] [Thread-1  ]: Finished running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.144179 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:20:05.145172 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:20:05.147254 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:20:05.147254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:20:05.147254 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:20:05.147254 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:20:05.147254 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.147254
[0m06:20:05.147254 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:20:05.176501 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:20:05.178950 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:20:05.233421 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.240492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.327224 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.342856 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:20:05.515727 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.515727 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.515727
[0m06:20:05.515727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDC6FD0>]}
[0m06:20:05.515727 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m06:20:05.525737 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:20:05.525737 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:05.525737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:05.525737 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:20:05.531248 [debug] [MainThread]: On list_schemas: Close
[0m06:20:05.532468 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:20:05.533478 [debug] [MainThread]: On list_None_travelata: Close
[0m06:20:05.534868 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:20:05.534868 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:20:05.534868 [info ] [MainThread]: 
[0m06:20:05.534868 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m06:20:05.534868 [debug] [MainThread]: Command end result
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:20:05.548006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDD05E0>]}
[0m06:20:05.548006 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:59.136590 | 61eaa5ff-5532-422e-ae05-1c5de141be29 ==============================
[0m06:20:59.136590 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:59.151604 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:59.152613 [debug] [MainThread]: Tracking: tracking
[0m06:20:59.152613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089F70>]}
[0m06:20:59.181517 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:59.329445 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.361106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104900D0>]}
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D790>]}
[0m06:20:59.376752 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>]}
[0m06:20:59.376752 [info ] [MainThread]: 
[0m06:20:59.376752 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:59.376752 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:59.404171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:00.753260 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:21:00.809378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:00.809378 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:21:00.825016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:01.417937 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:21:01.470455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:01.488109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104938B0>]}
[0m06:21:01.488109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:21:01.488109 [info ] [MainThread]: 
[0m06:21:01.488109 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:21:01.488109 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:21:01.502126 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:21:01.503064 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:21:01.508080 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:21:01.510082 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:21:01.504089 => 2023-09-29 06:21:01.510082
[0m06:21:01.511079 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:21:01.594986 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:21:02.183613 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:21:02.257792 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.261807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:21:02.308696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.324323 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:21:02.324323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:21:02.371607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.387244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:21:02.434108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.465763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:21:02.528283 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.528283 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:21:01.512883 => 2023-09-29 06:21:02.528283
[0m06:21:02.528283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822EB0>]}
[0m06:21:02.528283 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m06:21:02.528283 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:21:02.528283 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.528283 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [RUN]
[0m06:21:02.528283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_events'
[0m06:21:02.528283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_events)
[0m06:21:02.528283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.545351 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.547366 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (compile): 2023-09-29 06:21:02.528283 => 2023-09-29 06:21:02.547366
[0m06:21:02.548366 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.563432 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.576819 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.576819 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_events"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m06:21:02.634392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.637386 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (execute): 2023-09-29 06:21:02.549364 => 2023-09-29 06:21:02.637386
[0m06:21:02.639392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711855C10>]}
[0m06:21:02.640399 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [[32mOK[0m in 0.11s]
[0m06:21:02.641401 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.643404 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.645404 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:21:02.647413 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:21:02.648411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:21:02.649411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.651413 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.653411 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:21:02.649411 => 2023-09-29 06:21:02.653411
[0m06:21:02.653411 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.657244 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.657244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install to travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.935292 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.954947 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  ...
[0m06:21:02.998244 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:02.998244 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:21:02.653411 => 2023-09-29 06:21:02.998244
[0m06:21:03.013885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822DF0>]}
[0m06:21:03.013885 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.35s]
[0m06:21:03.013885 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:03.013885 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:21:03.013885 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:21:03.013885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:21:03.013885 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.013885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.013885
[0m06:21:03.013885 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.032730 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.034740 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles
)
  )...
[0m06:21:03.084524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.088517 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.126787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.142418 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles to travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.290441 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.302267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  ...
[0m06:21:03.355718 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.362401 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.362401
[0m06:21:03.362911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271187E520>]}
[0m06:21:03.362911 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.35s]
[0m06:21:03.362911 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.362911 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:21:03.362911 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:21:03.362911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:21:03.362911 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:21:03.362911 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:21:03.362911 => 2023-09-29 06:21:03.362911
[0m06:21:03.377925 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:21:03.384823 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:21:03.386821 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:21:03.452811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:03.457914 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.556008 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.564030 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.610248 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.612013 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:21:03.705092 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.720719 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:21:03.377925 => 2023-09-29 06:21:03.720719
[0m06:21:03.720719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227118E5550>]}
[0m06:21:03.720719 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m06:21:03.720719 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:21:03.720719 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:21:03.720719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_schemas: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_None_travelata: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:21:03.720719 [info ] [MainThread]: 
[0m06:21:03.720719 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:21:03.738083 [debug] [MainThread]: Command end result
[0m06:21:03.749063 [info ] [MainThread]: 
[0m06:21:03.750081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:21:03.751074 [info ] [MainThread]: 
[0m06:21:03.751074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:21:03.751074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022710451820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711921700>]}
[0m06:21:03.756097 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 08:55:59.908704 | 89ed6b51-4414-4516-b3a5-577d4f313ffa ==============================
[0m08:55:59.908704 [info ] [MainThread]: Running with dbt=1.4.8
[0m08:55:59.915248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:59.916276 [debug] [MainThread]: Tracking: tracking
[0m08:55:59.916276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A868>]}
[0m08:55:59.949068 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\schema.yml
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_second_dbt_model.sql
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_first_dbt_model.sql
[0m08:56:01.042760 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m08:56:01.073884 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m08:56:01.192798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068572F8>]}
[0m08:56:01.205803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x023E7D78>]}
[0m08:56:01.205803 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:56:01.206795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C3D0>]}
[0m08:56:01.209802 [info ] [MainThread]: 
[0m08:56:01.211794 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:01.214796 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m08:56:01.234796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:04.740276 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m08:56:04.799389 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:04.804387 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m08:56:04.816381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:05.438440 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m08:56:05.496222 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:05.503220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>]}
[0m08:56:05.504223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:05.505216 [info ] [MainThread]: 
[0m08:56:05.514008 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m08:56:05.515007 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m08:56:05.516010 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m08:56:05.517012 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m08:56:05.522008 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m08:56:05.523008 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 08:56:05.517012 => 2023-10-02 08:56:05.523008
[0m08:56:05.523008 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m08:56:05.609065 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:56:06.208834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m08:56:06.277959 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.292958 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:56:06.340418 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.350434 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m08:56:06.352430 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m08:56:06.401396 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.411416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m08:56:06.458666 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.510451 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m08:56:06.569078 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:06.572073 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 08:56:05.524009 => 2023-10-02 08:56:06.572073
[0m08:56:06.573075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B192B0>]}
[0m08:56:06.574081 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m08:56:06.577076 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m08:56:06.578077 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.579074 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m08:56:06.580073 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m08:56:06.580073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m08:56:06.581072 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.582077 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.582077 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 08:56:06.581072 => 2023-10-02 08:56:06.582077
[0m08:56:06.582077 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.611113 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m08:56:06.623455 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.625457 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_events
)
  )...
[0m08:56:06.699397 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.704928 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 08:56:06.582077 => 2023-10-02 08:56:06.704928
[0m08:56:06.706931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B31808>]}
[0m08:56:06.708933 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.13s]
[0m08:56:06.733347 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.733347 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.733347 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m08:56:06.733347 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m08:56:06.733347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m08:56:06.733347 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 08:56:06.733347 => 2023-10-02 08:56:06.743882
[0m08:56:06.743882 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
)
  )...
[0m08:56:06.813155 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.817158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 08:56:06.743882 => 2023-10-02 08:56:06.817158
[0m08:56:06.818158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CF8E08>]}
[0m08:56:06.819159 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.08s]
[0m08:56:06.820160 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.821157 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.822153 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m08:56:06.823154 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m08:56:06.824159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m08:56:06.824159 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.827157 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.829158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 08:56:06.824159 => 2023-10-02 08:56:06.829158
[0m08:56:06.829158 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.834159 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m08:56:06.836241 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.836241 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name
from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles
)
  )...
[0m08:56:06.902197 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.906206 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 08:56:06.830161 => 2023-10-02 08:56:06.905207
[0m08:56:06.907208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8DF0>]}
[0m08:56:06.907208 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m08:56:06.909207 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.909207 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m08:56:06.910204 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m08:56:06.911207 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m08:56:06.911207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m08:56:06.912204 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m08:56:06.916214 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m08:56:06.918206 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 08:56:06.912204 => 2023-10-02 08:56:06.917209
[0m08:56:06.918206 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m08:56:06.933773 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m08:56:06.935366 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m08:56:06.983504 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.006441 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.108601 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.114116 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.209710 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:07.225339 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m08:56:07.272611 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.272611 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 08:56:06.918206 => 2023-10-02 08:56:07.272611
[0m08:56:07.272611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8430>]}
[0m08:56:07.272611 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m08:56:07.272611 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m08:56:07.272611 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:07.288249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_schemas: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_None_travelata: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m08:56:07.288249 [info ] [MainThread]: 
[0m08:56:07.288249 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m08:56:07.288249 [debug] [MainThread]: Command end result
[0m08:56:07.306805 [info ] [MainThread]: 
[0m08:56:07.307808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:07.309813 [info ] [MainThread]: 
[0m08:56:07.310807 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:56:07.312810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06743BE0>]}
[0m08:56:07.312810 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:03:56.005710 | 6bedf390-12b6-4656-9e10-e3fc488ef5de ==============================
[0m09:03:56.005710 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:03:56.005710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:03:56.005710 [debug] [MainThread]: Tracking: tracking
[0m09:03:56.005710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79820>]}
[0m09:03:56.028780 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.310342 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.328477 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.342262 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.413394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071BBE80>]}
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CDC0>]}
[0m09:03:56.428409 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CCA0>]}
[0m09:03:56.428409 [info ] [MainThread]: 
[0m09:03:56.428409 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:56.445386 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:03:56.466484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:57.702537 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:03:57.749735 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:57.749735 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:03:57.765364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:58.365403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:03:58.428314 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:58.431824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ECA220>]}
[0m09:03:58.431824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:58.431824 [info ] [MainThread]: 
[0m09:03:58.444334 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:03:58.445495 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:03:58.447515 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:03:58.447515 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:03:58.453279 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:03:58.454304 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:03:58.448504 => 2023-10-02 09:03:58.454304
[0m09:03:58.455292 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:03:58.567389 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:03:59.147735 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:03:59.210256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.225883 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.273183 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:03:59.336093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.351733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:03:59.414303 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.461603 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:03:59.508477 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.508477 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:03:58.455292 => 2023-10-02 09:03:59.508477
[0m09:03:59.508477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B24CB8>]}
[0m09:03:59.508477 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m09:03:59.524098 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:03:59.524098 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.524098 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:03:59.524098 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:03:59.524098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:03:59.529691 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.532777 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.533229 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:03:59.529691 => 2023-10-02 09:03:59.533229
[0m09:03:59.535286 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.562544 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:03:59.575644 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.575644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name
from travelata.sheets_appmetrica_travelata_events
)
  )...
[0m09:03:59.628430 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name
from travelata.sheets_appmetrica_travelata_events
)
  )
[0m09:03:59.628430 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:03:59.535286 => 2023-10-02 09:03:59.628430
[0m09:03:59.732898 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.732898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B363D0>]}
[0m09:03:59.732898 [error] [Thread-1  ]: 2 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.21s]
[0m09:03:59.732898 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.732898 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.732898 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:03:59.739411 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:03:59.739411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:03:59.739411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.739411
[0m09:03:59.739411 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name
from travelata.sheets_appmetrica_travelata_install
)
  )...
[0m09:03:59.802684 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name
from travelata.sheets_appmetrica_travelata_install
)
  )
[0m09:03:59.802684 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.802684
[0m09:03:59.802684 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.802684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36340>]}
[0m09:03:59.802684 [error] [Thread-1  ]: 3 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.07s]
[0m09:03:59.802684 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.813336 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:03:59.814452 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:03:59.814452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:03:59.814452 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.814452 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.814452
[0m09:03:59.814452 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:03:59.826722 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.828736 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name
from travelata.sheets_appmetrica_travelata_profiles
)
  )...
[0m09:03:59.869362 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name
from travelata.sheets_appmetrica_travelata_profiles
)
  )
[0m09:03:59.869362 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.869362
[0m09:03:59.869362 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.869362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36298>]}
[0m09:03:59.880043 [error] [Thread-1  ]: 4 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.05s]
[0m09:03:59.881061 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.882058 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:03:59.882058 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:03:59.884057 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:03:59.884057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:03:59.885050 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:03:59.889054 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:03:59.891054 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:03:59.885050 => 2023-10-02 09:03:59.890051
[0m09:03:59.891054 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:03:59.895051 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m09:03:59.897051 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:03:59.898051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:03:59.949205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.949205 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:03:59.891054 => 2023-10-02 09:03:59.949205
[0m09:03:59.949205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11C153B8>]}
[0m09:03:59.949205 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m09:03:59.949205 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:03:59.949205 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:59.959962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:59.960974 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:03:59.960974 [debug] [MainThread]: On list_schemas: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:03:59.961969 [debug] [MainThread]: On list_None_travelata: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:03:59.962969 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:03:59.962969 [info ] [MainThread]: 
[0m09:03:59.963974 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m09:03:59.965981 [debug] [MainThread]: Command end result
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m09:03:59.975019 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.975019 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.975019 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.986687 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m09:03:59.987707 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.988701 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.989707 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.990708 [info ] [MainThread]: 
[0m09:03:59.991712 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m09:03:59.993704 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.994702 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.995703 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.997712 [info ] [MainThread]: 
[0m09:04:00.000112 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m09:04:00.002128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F45D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8730>]}
[0m09:04:00.003129 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:05:24.720227 | e3bc7e59-e164-41c1-b7b2-62b05fcc5990 ==============================
[0m09:05:24.720227 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:05:24.720227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:05:24.720227 [debug] [MainThread]: Tracking: tracking
[0m09:05:24.720227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A7F0>]}
[0m09:05:24.739215 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:05:24.986962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.034261 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.112540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0716AE50>]}
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BFB8>]}
[0m09:05:25.128182 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BF88>]}
[0m09:05:25.143804 [info ] [MainThread]: 
[0m09:05:25.143804 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:25.143804 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:05:25.166444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:26.415062 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:05:26.463294 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:26.478917 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:05:26.478917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:27.065312 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:05:27.117386 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:27.117386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>]}
[0m09:05:27.117386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:05:27.117386 [info ] [MainThread]: 
[0m09:05:27.135249 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:05:27.136251 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:05:27.138250 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:05:27.139262 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:05:27.139588 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:05:27.139588 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:27.139588
[0m09:05:27.139588 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:05:27.243860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:05:27.828996 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:05:27.891509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.915168 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:05:27.970201 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.980213 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:05:27.980213 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:05:28.094660 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.144214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:05:28.188517 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:05:28.188517 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:28.188517
[0m09:05:28.188517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660868>]}
[0m09:05:28.188517 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.05s]
[0m09:05:28.188517 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:05:28.188517 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.204151 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:05:28.204151 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:05:28.204151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:05:28.206612 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.209739 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.210745 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:05:28.206612 => 2023-10-02 09:05:28.210745
[0m09:05:28.211706 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.237026 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:05:28.246140 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.246140 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m09:05:28.315341 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:05:28.315341 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:05:28.212696 => 2023-10-02 09:05:28.315341
[0m09:05:28.315341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660580>]}
[0m09:05:28.315341 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.11s]
[0m09:05:28.315341 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.315341 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.315341 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:05:28.328850 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:05:28.328850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:05:28.328850 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.328850
[0m09:05:28.328850 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m09:05:28.391074 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.391074 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.391074
[0m09:05:28.391074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10B05CA0>]}
[0m09:05:28.403602 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.06s]
[0m09:05:28.404847 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.404847 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:05:28.404847 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:05:28.404847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:05:28.404847 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.404847 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:05:28.404847 => 2023-10-02 09:05:28.404847
[0m09:05:28.415365 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.419832 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:05:28.421838 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.422834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m09:05:28.479065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.482057 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:05:28.415365 => 2023-10-02 09:05:28.482057
[0m09:05:28.483063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660418>]}
[0m09:05:28.484066 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m09:05:28.485067 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.485067 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:05:28.486065 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:05:28.488068 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:05:28.488068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:05:28.489069 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:05:28.494063 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:05:28.495058 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:05:28.489069 => 2023-10-02 09:05:28.495058
[0m09:05:28.496066 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:05:28.511015 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:05:28.512576 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:05:28.565809 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.584907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.635416 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.637039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.685767 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.691674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.746055 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.748167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.804927 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.812379 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m09:05:28.874979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.877136 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:05:28.496066 => 2023-10-02 09:05:28.876598
[0m09:05:28.877676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B9DD18>]}
[0m09:05:28.878756 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m09:05:28.879826 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:05:28.882104 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:28.883162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:28.883709 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:05:28.884448 [debug] [MainThread]: On list_schemas: Close
[0m09:05:28.884958 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:05:28.884958 [debug] [MainThread]: On list_None_travelata: Close
[0m09:05:28.885490 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:05:28.886016 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:05:28.886535 [info ] [MainThread]: 
[0m09:05:28.887581 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:05:28.889517 [debug] [MainThread]: Command end result
[0m09:05:28.903568 [info ] [MainThread]: 
[0m09:05:28.904666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:28.906285 [info ] [MainThread]: 
[0m09:05:28.906818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:05:28.907878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05EF6D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA0670>]}
[0m09:05:28.908400 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 15:46:40.667670 | 5571fcad-f526-4b89-8a77-edc2beab3e93 ==============================
[0m15:46:40.667670 [info ] [MainThread]: Running with dbt=1.4.8
[0m15:46:40.667670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:46:40.667670 [debug] [MainThread]: Tracking: tracking
[0m15:46:40.683297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60731250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F3AE50>]}
[0m15:46:40.698922 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m15:46:40.740177 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:46:40.741123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612090D0>]}
[0m15:46:41.400692 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\test.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m15:46:41.439846 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m15:46:41.484541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F81C50>]}
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D61290350>]}
[0m15:46:41.500164 [info ] [MainThread]: Found 7 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A6D1D0>]}
[0m15:46:41.500164 [info ] [MainThread]: 
[0m15:46:41.500164 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:41.500164 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m15:46:41.515794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.168111 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m15:46:42.217327 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:42.217327 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m15:46:42.223835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.787185 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m15:46:42.865284 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:46:42.865284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60929B90>]}
[0m15:46:42.865284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:42.865284 [info ] [MainThread]: 
[0m15:46:42.865284 [debug] [Thread-1 (]: Began running node model.travelata.my_first_dbt_model
[0m15:46:42.865284 [info ] [Thread-1 (]: 1 of 6 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m15:46:42.880911 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m15:46:42.880911 [debug] [Thread-1 (]: Began compiling node model.travelata.my_first_dbt_model
[0m15:46:42.880911 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m15:46:42.880911 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:42.880911
[0m15:46:42.880911 [debug] [Thread-1 (]: Began executing node model.travelata.my_first_dbt_model
[0m15:46:42.898564 [debug] [Thread-1 (]: Creating new relation my_first_dbt_model
[0m15:46:42.926827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:43.576851 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m15:46:43.623777 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.639343 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.686353 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m15:46:43.748964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED4D90>]}
[0m15:46:43.764627 [info ] [Thread-1 (]: 1 of 6 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.88s]
[0m15:46:43.764627 [debug] [Thread-1 (]: Finished running node model.travelata.my_first_dbt_model
[0m15:46:43.764627 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [info ] [Thread-1 (]: 2 of 6 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m15:46:43.764627 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m15:46:43.764627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m15:46:43.764627 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.780245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m15:46:43.861813 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )
[0m15:46:43.867840 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.867840
[0m15:46:43.938380 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:43.954020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A08690>]}
[0m15:46:43.954020 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.17s]
[0m15:46:43.954020 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.954020 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [info ] [Thread-1 (]: 3 of 6 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m15:46:43.954020 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m15:46:43.954020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m15:46:43.954020 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:43.954020
[0m15:46:43.954020 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m15:46:44.007655 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 
parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )
[0m15:46:44.008654 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:44.008654
[0m15:46:44.010653 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.011654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D611D6710>]}
[0m15:46:44.011654 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.06s]
[0m15:46:44.012656 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:44.012656 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.012656 [info ] [Thread-1 (]: 4 of 6 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m15:46:44.013736 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m15:46:44.013736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m15:46:44.014745 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 15:46:44.014745 => 2023-10-02 15:46:44.015746
[0m15:46:44.015746 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m15:46:44.065746 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )
[0m15:46:44.065746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 15:46:44.015746 => 2023-10-02 15:46:44.065746
[0m15:46:44.072486 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.072486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CFB50>]}
[0m15:46:44.072486 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.06s]
[0m15:46:44.072486 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.072486 [debug] [Thread-1 (]: Began running node model.travelata.test
[0m15:46:44.072486 [info ] [Thread-1 (]: 5 of 6 START sql view model travelata.test ..................................... [RUN]
[0m15:46:44.072486 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.test'
[0m15:46:44.072486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.test)
[0m15:46:44.078285 [debug] [Thread-1 (]: Began compiling node model.travelata.test
[0m15:46:44.079293 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.test"
[0m15:46:44.080294 [debug] [Thread-1 (]: Timing info for model.travelata.test (compile): 2023-10-02 15:46:44.078285 => 2023-10-02 15:46:44.080294
[0m15:46:44.081291 [debug] [Thread-1 (]: Began executing node model.travelata.test
[0m15:46:44.083290 [debug] [Thread-1 (]: Creating new relation test
[0m15:46:44.084290 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.test"
[0m15:46:44.085291 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.test: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )...
[0m15:46:44.150497 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.test (execute): 2023-10-02 15:46:44.081291 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Database Error in model test (models\1_normalize\test.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.150497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CED50>]}
[0m15:46:44.150497 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model travelata.test ............................ [[31mERROR[0m in 0.08s]
[0m15:46:44.150497 [debug] [Thread-1 (]: Finished running node model.travelata.test
[0m15:46:44.150497 [debug] [Thread-1 (]: Began running node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [info ] [Thread-1 (]: 6 of 6 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m15:46:44.150497 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m15:46:44.150497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m15:46:44.150497 [debug] [Thread-1 (]: Began compiling node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Began executing node model.travelata.my_second_dbt_model
[0m15:46:44.168083 [debug] [Thread-1 (]: Creating new relation my_second_dbt_model
[0m15:46:44.169084 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m15:46:44.170083 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m15:46:44.221437 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:44.223435 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.223435
[0m15:46:44.223435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6179E250>]}
[0m15:46:44.224437 [info ] [Thread-1 (]: 6 of 6 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m15:46:44.224437 [debug] [Thread-1 (]: Finished running node model.travelata.my_second_dbt_model
[0m15:46:44.224437 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:44.224437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_schemas: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_None_travelata: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m15:46:44.224437 [info ] [MainThread]: 
[0m15:46:44.224437 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m15:46:44.230343 [debug] [MainThread]: Command end result
[0m15:46:44.239494 [info ] [MainThread]: 
[0m15:46:44.240498 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:46:44.241494 [info ] [MainThread]: 
[0m15:46:44.241494 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m15:46:44.243264 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.243829 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.243829 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:44.244876 [info ] [MainThread]: 
[0m15:46:44.245885 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m15:46:44.246882 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.247881 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.247881 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.248883 [info ] [MainThread]: 
[0m15:46:44.249419 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m15:46:44.249419 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.249419 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.251897 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.252908 [info ] [MainThread]: 
[0m15:46:44.253906 [error] [MainThread]: [33mDatabase Error in model test (models\1_normalize\test.sql)[0m
[0m15:46:44.253906 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m15:46:44.254904 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m15:46:44.255904 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.255904 [info ] [MainThread]: 
[0m15:46:44.256904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m15:46:44.257906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60EB5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FEC50>]}
[0m15:46:44.257906 [debug] [MainThread]: Flushing usage events
