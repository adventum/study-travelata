

============================== 2023-09-27 09:56:14.819371 | da95eec8-f7f7-451f-90be-0fec5d743e3b ==============================
[0m09:56:14.819371 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:56:14.834996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:56:14.834996 [debug] [MainThread]: Tracking: tracking
[0m09:56:14.834996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8880>]}
[0m09:56:14.851015 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:56:14.851015 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:14.851015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F88F8>]}
[0m09:56:16.954656 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m09:56:16.970297 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5DD8>]}
[0m09:56:17.127044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059F8760>]}
[0m09:56:17.142684 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:56:17.142684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da95eec8-f7f7-451f-90be-0fec5d743e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x059E96A0>]}
[0m09:56:17.142684 [info ] [MainThread]: 
[0m09:56:17.142684 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:56:17.142684 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:56:17.158719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:27.915586 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE028>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m09:56:36.983601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:36.983601 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:56:36.983601 [debug] [MainThread]: On list_schemas: No close available on handle
[0m09:56:36.983601 [info ] [MainThread]: 
[0m09:56:36.983601 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 19.84 seconds (19.84s).
[0m09:56:36.983601 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0FCFE220>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m09:56:36.983601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05AE5778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D41CB8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0FCFE340>]}
[0m09:56:36.983601 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:01:25.322824 | be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a ==============================
[0m10:01:25.322824 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:01:25.326846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:01:25.326846 [debug] [MainThread]: Tracking: tracking
[0m10:01:25.327845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06767838>]}
[0m10:01:25.355300 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:01:26.178337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:01:26.191340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068446E8>]}
[0m10:01:26.202352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7658>]}
[0m10:01:26.202352 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:01:26.203351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1fb54d-b07e-46d5-9a5a-5fe4be8fc72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D7670>]}
[0m10:01:26.205345 [info ] [MainThread]: 
[0m10:01:26.208343 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:01:26.210343 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:01:26.229343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:37.989071 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845B20>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:01:47.061312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:47.061312 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:01:47.061312 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:01:47.061312 [info ] [MainThread]: 
[0m10:01:47.061312 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.85 seconds (20.85s).
[0m10:01:47.061312 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0F845D18>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:01:47.061312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067D72C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0F845E38>]}
[0m10:01:47.061312 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:02:16.338593 | 5af424ed-2a38-4297-bcd6-d46bd3e8e53e ==============================
[0m10:02:16.338593 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:02:16.338593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:02:16.338593 [debug] [MainThread]: Tracking: tracking
[0m10:02:16.338593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF8868>]}
[0m10:02:16.360232 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:16.560679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:16.574192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ED4718>]}
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E65688>]}
[0m10:02:16.589833 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:02:16.589833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af424ed-2a38-4297-bcd6-d46bd3e8e53e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E656A0>]}
[0m10:02:16.589833 [info ] [MainThread]: 
[0m10:02:16.605456 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:02:16.605456 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:02:16.621081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:25.317650 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5B50>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:02:34.493743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:34.493743 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:02:34.493743 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:02:34.493743 [info ] [MainThread]: 
[0m10:02:34.493743 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 17.90 seconds (17.90s).
[0m10:02:34.493743 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0EED5D48>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:02:34.493743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05581730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E652F8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0EED5E68>]}
[0m10:02:34.493743 [debug] [MainThread]: Flushing usage events


============================== 2023-09-27 10:15:00.923308 | ad1000d9-4990-4e47-a48a-334ef46d8e98 ==============================
[0m10:15:00.923308 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:15:00.938952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:15:00.938952 [debug] [MainThread]: Tracking: tracking
[0m10:15:00.938952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B597C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B59808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B598F8>]}
[0m10:15:00.970197 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:01.789748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:01.805363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064357A8>]}
[0m10:15:01.809880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8718>]}
[0m10:15:01.809880 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:15:01.821388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8730>]}
[0m10:15:01.821388 [info ] [MainThread]: 
[0m10:15:01.821388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:01.821388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:15:01.837031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.146370 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:15:05.209378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.215394 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:15:05.225413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:05.815665 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:15:05.878180 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:05.878180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x040BF3B8>]}
[0m10:15:05.893943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:05.893943 [info ] [MainThread]: 
[0m10:15:05.972519 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [info ] [Thread-1  ]: 1 of 2 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:15:05.972519 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:15:05.972519 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:15:05.972519 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:15:05.988139 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-27 10:15:05.972519 => 2023-09-27 10:15:05.988139
[0m10:15:05.988139 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:15:06.019931 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:15:06.066716 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:15:06.679729 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:15:06.726995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.742635 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:15:06.789509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:15:06.805135 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:15:06.805135 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:15:06.868053 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:06.917963 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-27 10:15:05.988139 => 2023-09-27 10:15:06.914935
[0m10:15:06.917963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06422F70>]}
[0m10:15:06.917963 [info ] [Thread-1  ]: 1 of 2 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.95s]
[0m10:15:06.917963 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:15:06.917963 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:15:06.925504 [info ] [Thread-1  ]: 2 of 2 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:15:06.925504 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:15:06.925504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:15:06.925504 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:15:06.931030 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:15:06.931030 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-27 10:15:06.925504 => 2023-09-27 10:15:06.931030
[0m10:15:06.931030 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:15:06.962297 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:15:06.962297 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:15:07.025191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:15:07.025191 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-27 10:15:06.931030 => 2023-09-27 10:15:07.025191
[0m10:15:07.025191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1000d9-4990-4e47-a48a-334ef46d8e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x063C8538>]}
[0m10:15:07.025191 [info ] [Thread-1  ]: 2 of 2 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.10s]
[0m10:15:07.025191 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:15:07.025191 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:15:07.025191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_schemas: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:15:07.025191 [debug] [MainThread]: On list_None_travelata: Close
[0m10:15:07.025191 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:15:07.040830 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m10:15:07.040830 [debug] [MainThread]: Command end result
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.040830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:07.040830 [info ] [MainThread]: 
[0m10:15:07.056454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:15:07.056454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065B02B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10DDE4D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0421B508>]}
[0m10:15:07.056454 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:04:49.891103 | e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0 ==============================
[0m10:04:49.891103 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:04:49.891103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:04:49.891103 [debug] [MainThread]: Tracking: tracking
[0m10:04:49.891103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298538>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298568>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06298658>]}
[0m10:04:49.928844 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:04:50.816998 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.832619 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheet_default_installs.sql
[0m10:04:50.926797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075D72F8>]}
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364C40>]}
[0m10:04:50.942421 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:04:50.942421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364EF8>]}
[0m10:04:50.942421 [info ] [MainThread]: 
[0m10:04:50.942421 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:50.942421 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:04:50.958051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:54.461225 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:04:54.508521 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:54.524157 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:04:54.524157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:55.135028 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:04:55.197937 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.197937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075CDD78>]}
[0m10:04:55.197937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:55.197937 [info ] [MainThread]: 
[0m10:04:55.213577 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:04:55.213577 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:04:55.213577 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:04:55.213577 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:04:55.213577 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:55.213577
[0m10:04:55.213577 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:04:55.257810 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m10:04:55.311853 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:04:55.902137 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:04:55.964649 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:55.980276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:04:56.048733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.056752 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:04:56.058277 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:04:56.126233 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:04:56.157486 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:04:55.213577 => 2023-09-28 10:04:56.157486
[0m10:04:56.157486 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898F28>]}
[0m10:04:56.157486 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.94s]
[0m10:04:56.157486 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:04:56.157486 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.157486 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:04:56.157486 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:04:56.157486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:04:56.157486 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:04:56.173112 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.173112 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.173112
[0m10:04:56.173112 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:04:56.195742 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_installs
[0m10:04:56.217745 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:04:56.217745 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs 
  
  as (
    select *

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:04:56.272563 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:04:56.288193 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:04:56.173112 => 2023-09-28 10:04:56.288193
[0m10:04:56.288193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898AD8>]}
[0m10:04:56.288193 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.13s]
[0m10:04:56.288193 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:04:56.288193 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:04:56.288193 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:04:56.295704 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:04:56.295704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:04:56.295704 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:04:56.295704 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:04:56.295704 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.295704
[0m10:04:56.295704 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m10:04:56.304220 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:04:56.304220 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:04:56.367035 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:04:56.371032 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:04:56.295704 => 2023-09-28 10:04:56.371032
[0m10:04:56.372026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e89cfd58-a1b7-4ce7-8f3b-9356dc6301b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11F59F58>]}
[0m10:04:56.373026 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.08s]
[0m10:04:56.374027 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:04:56.376030 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:04:56.377094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_schemas: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On list_None_travelata: Close
[0m10:04:56.377094 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:04:56.377094 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:04:56.377094 [info ] [MainThread]: 
[0m10:04:56.377094 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m10:04:56.377094 [debug] [MainThread]: Command end result
[0m10:04:56.392734 [info ] [MainThread]: 
[0m10:04:56.392734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:56.395753 [info ] [MainThread]: 
[0m10:04:56.395753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:04:56.395753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0626EB08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x062862E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06364DC0>]}
[0m10:04:56.395753 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:20:33.166185 | 822cc9da-952e-4a3b-90f4-fedd909cf552 ==============================
[0m10:20:33.166185 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:20:33.166185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:20:33.166185 [debug] [MainThread]: Tracking: tracking
[0m10:20:33.181825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D451CA9E50>]}
[0m10:20:33.197454 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:33.315122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:33.315122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550260D0>]}
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F859A0>]}
[0m10:20:33.330747 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:20:33.330747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85C10>]}
[0m10:20:33.346388 [info ] [MainThread]: 
[0m10:20:33.346388 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:33.346388 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:20:33.362414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.297249 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:20:35.360149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:35.375786 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:20:35.375786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:35.970774 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:20:36.033323 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.038317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D455044970>]}
[0m10:20:36.040322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:36.041320 [info ] [MainThread]: 
[0m10:20:36.049227 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:20:36.050233 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:20:36.051226 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:20:36.052233 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:20:36.057740 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:20:36.059757 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:20:36.053232 => 2023-09-28 10:20:36.058757
[0m10:20:36.059757 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:20:36.132760 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:20:36.721120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:20:36.774463 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:36.790017 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:20:36.852532 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:36.858551 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:20:36.858551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:20:36.899826 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:36.915456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:20:36.978358 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.009610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:20:37.058997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:20:36.060753 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4564118B0>]}
[0m10:20:37.072510 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m10:20:37.072510 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:20:37.072510 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:20:37.072510 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:20:37.072510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:20:37.072510 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:20:37.072510 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.072510 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:20:37.072510 => 2023-09-28 10:20:37.072510
[0m10:20:37.072510 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:20:37.120637 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:20:37.120637 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    select *

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install
  )...
[0m10:20:37.174686 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.190318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m10:20:37.258857 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:20:37.308276 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.323905 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.371171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.433811 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:20:37.496736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.496736 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:20:37.088152 => 2023-09-28 10:20:37.496736
[0m10:20:37.496736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D456468F40>]}
[0m10:20:37.496736 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.42s]
[0m10:20:37.496736 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:20:37.496736 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:20:37.496736 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:20:37.496736 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:20:37.496736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:20:37.496736 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:20:37.496736 => 2023-09-28 10:20:37.512368
[0m10:20:37.512368 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:20:37.512368 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:20:37.512368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.573113 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:20:37.628227 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:20:37.675677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.685700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m10:20:37.722478 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:20:37.769752 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.788311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:20:37.841558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:20:37.841558 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:20:37.512368 => 2023-09-28 10:20:37.841558
[0m10:20:37.841558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822cc9da-952e-4a3b-90f4-fedd909cf552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565232B0>]}
[0m10:20:37.841558 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.34s]
[0m10:20:37.857181 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:20:37.860193 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:20:37.860193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_schemas: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On list_None_travelata: Close
[0m10:20:37.860193 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:20:37.860193 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:20:37.860193 [info ] [MainThread]: 
[0m10:20:37.860193 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m10:20:37.860193 [debug] [MainThread]: Command end result
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:37.873204 [info ] [MainThread]: 
[0m10:20:37.873204 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:20:37.882067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D454F85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4565101C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4550EC790>]}
[0m10:20:37.883085 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 10:33:18.958604 | d73870df-3ddc-4f46-b473-bd951638145c ==============================
[0m10:33:18.958604 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:33:18.960702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:33:18.961230 [debug] [MainThread]: Tracking: tracking
[0m10:33:18.973650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D790D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29D79E50>]}
[0m10:33:18.991176 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:33:19.097171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:19.098171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:19.107170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D0E60D0>]}
[0m10:33:19.117173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1A00>]}
[0m10:33:19.119172 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:33:19.120170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C70>]}
[0m10:33:19.122167 [info ] [MainThread]: 
[0m10:33:19.124172 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:19.126168 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:33:19.144173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:20.454170 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m10:33:20.504733 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:20.509736 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m10:33:20.518733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:21.124172 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m10:33:21.177043 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:21.182038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1049D0>]}
[0m10:33:21.183045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:21.184038 [info ] [MainThread]: 
[0m10:33:21.190101 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m10:33:21.191101 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m10:33:21.194107 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m10:33:21.195101 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m10:33:21.200101 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m10:33:21.201105 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 10:33:21.195101 => 2023-09-28 10:33:21.201105
[0m10:33:21.202106 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m10:33:21.276644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:21.874233 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m10:33:21.932024 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:21.945025 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m10:33:22.005208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.010200 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m10:33:22.012215 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m10:33:22.067290 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.075309 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m10:33:22.124819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.164816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m10:33:22.214637 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.216632 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 10:33:21.203106 => 2023-09-28 10:33:22.216632
[0m10:33:22.218637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E0910>]}
[0m10:33:22.220640 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.03s]
[0m10:33:22.223636 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m10:33:22.224633 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.225633 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m10:33:22.227635 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m10:33:22.227635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m10:33:22.228634 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m10:33:22.232632 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.233647 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 10:33:22.229639 => 2023-09-28 10:33:22.233647
[0m10:33:22.234635 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m10:33:22.275643 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m10:33:22.277644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )
  )...
[0m10:33:22.330770 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.340765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.394390 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.396384 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m10:33:22.454609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.458610 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.514149 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.516153 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m10:33:22.564483 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.571479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m10:33:22.634556 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.636550 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 10:33:22.234635 => 2023-09-28 10:33:22.636550
[0m10:33:22.638550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4F9730>]}
[0m10:33:22.639558 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.41s]
[0m10:33:22.640550 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m10:33:22.641558 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m10:33:22.642556 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m10:33:22.644557 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m10:33:22.645554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m10:33:22.645554 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m10:33:22.649553 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m10:33:22.650553 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 10:33:22.646557 => 2023-09-28 10:33:22.650553
[0m10:33:22.651556 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m10:33:22.662553 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m10:33:22.664556 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m10:33:22.717590 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.721593 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.774256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.776265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m10:33:22.824160 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.829158 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.883801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:22.885791 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m10:33:22.944524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m10:33:22.951524 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m10:33:23.004774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m10:33:23.006777 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 10:33:22.651556 => 2023-09-28 10:33:23.006777
[0m10:33:23.007773 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73870df-3ddc-4f46-b473-bd951638145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E4E04F0>]}
[0m10:33:23.008775 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m10:33:23.010770 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m10:33:23.012772 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:33:23.013770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:23.014773 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:33:23.014773 [debug] [MainThread]: On list_schemas: Close
[0m10:33:23.015772 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m10:33:23.015772 [debug] [MainThread]: On list_None_travelata: Close
[0m10:33:23.016772 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m10:33:23.017771 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m10:33:23.017771 [info ] [MainThread]: 
[0m10:33:23.018771 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m10:33:23.020774 [debug] [MainThread]: Command end result
[0m10:33:23.030773 [info ] [MainThread]: 
[0m10:33:23.032770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:23.033769 [info ] [MainThread]: 
[0m10:33:23.034772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:33:23.035771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2CFD1C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2E5E7EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A2D1AC7F0>]}
[0m10:33:23.036777 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:21:50.550849 | ed8c38e2-03ed-40df-ab51-f0d7ea4729ab ==============================
[0m11:21:50.550849 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:21:50.552844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:21:50.553850 [debug] [MainThread]: Tracking: tracking
[0m11:21:50.567384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB070C7E50>]}
[0m11:21:50.585389 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:21:50.696061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:21:50.706068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4370D0>]}
[0m11:21:50.716059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BA00>]}
[0m11:21:50.717060 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:21:50.719065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38BC70>]}
[0m11:21:50.721059 [info ] [MainThread]: 
[0m11:21:50.724060 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:50.727069 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:21:50.742061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.096741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:21:52.146894 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.152916 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:21:52.163908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:52.776139 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:21:52.829300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:52.834293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4549D0>]}
[0m11:21:52.835287 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:52.836290 [info ] [MainThread]: 
[0m11:21:52.843295 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:21:52.844290 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:21:52.846293 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:21:52.847298 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:21:52.852300 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:21:52.854319 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:21:52.847298 => 2023-09-28 11:21:52.854319
[0m11:21:52.855319 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:21:52.935345 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:21:53.537150 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:21:53.594678 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.606673 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:21:53.667696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:53.675767 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:21:53.678373 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:21:53.729108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.737124 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:21:53.786648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.826167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:21:53.876741 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:53.879755 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:21:52.856318 => 2023-09-28 11:21:53.879755
[0m11:21:53.881745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B830910>]}
[0m11:21:53.882739 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m11:21:53.885741 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:21:53.886737 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:21:53.889740 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:21:53.892740 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:21:53.893742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:21:53.894743 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:21:53.899747 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.903741 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:21:53.895745 => 2023-09-28 11:21:53.903741
[0m11:21:53.904739 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:21:53.961379 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:21:53.962382 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m11:21:54.016922 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT parseDateTime(

        JSONExtractString(_airbyte_data, 'install_datetime'),

        '%d.%m.%Y'

    ) AS __datetime,

    JSONExtractString(_airbyte_data, 'city') AS city





FROM (

        select *

        from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

    )SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )
[0m11:21:54.017910 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:21:53.905743 => 2023-09-28 11:21:54.017910
[0m11:21:54.027916 [debug] [Thread-1  ]: Database Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

  JSONExtractString(_airbyte_data, 'city') AS city,

  JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.028911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7E0A60>]}
[0m11:21:54.029917 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model travelata.normalize_sheet_default_installs  [[31mERROR[0m in 0.14s]
[0m11:21:54.030908 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:21:54.031914 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:21:54.032915 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:21:54.034913 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:21:54.034913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:21:54.035908 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:21:54.039904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:21:54.040910 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:21:54.035908 => 2023-09-28 11:21:54.040910
[0m11:21:54.041913 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:21:54.049916 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:21:54.051912 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:21:54.101447 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.118444 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.166231 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.167226 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:21:54.216882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.223881 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.285910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.287907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:21:54.336432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:21:54.342424 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:21:54.405954 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:21:54.408958 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:21:54.041913 => 2023-09-28 11:21:54.408958
[0m11:21:54.410954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8c38e2-03ed-40df-ab51-f0d7ea4729ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B897040>]}
[0m11:21:54.411951 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m11:21:54.412950 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:21:54.414952 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:21:54.415958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:54.415958 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:21:54.416950 [debug] [MainThread]: On list_schemas: Close
[0m11:21:54.416950 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:21:54.417954 [debug] [MainThread]: On list_None_travelata: Close
[0m11:21:54.417954 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:21:54.418950 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:21:54.419951 [info ] [MainThread]: 
[0m11:21:54.420947 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m11:21:54.422953 [debug] [MainThread]: Command end result
[0m11:21:54.433955 [info ] [MainThread]: 
[0m11:21:54.434952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:21:54.435952 [info ] [MainThread]: 
[0m11:21:54.437956 [error] [MainThread]: [33mDatabase Error in model normalize_sheet_default_installs (models\1_normalize\normalize_sheet_default_installs.sql)[0m
[0m11:21:54.440952 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:21:54.441956 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 549 ('parseDateTime') (line 18, col 1): parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

[0m11:21:54.443958 [error] [MainThread]:   JSONExtractString(_airbyte_data, 'city') AS city,

[0m11:21:54.444953 [error] [MainThread]:   JSONExtractSt. Expected one of: FINAL, SAMPLE, table, table function, subquery or list of joined tables, array join, LEFT ARRAY JOIN, INNER, ARRAY JOIN, JOIN, PREWHERE, WHERE, GROUP BY, WITH, HAVING, WINDOW, ORDER BY, LIMIT, OFFSET, SETTINGS, UNION, EXCEPT, INTERSECT. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m11:21:54.446955 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalize_sheet_default_installs.sql
[0m11:21:54.447950 [info ] [MainThread]: 
[0m11:21:54.448951 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:21:54.450957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0B7CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A38B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0A4FB880>]}
[0m11:21:54.451953 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 11:22:30.162865 | 86ba7e4c-395b-498b-b462-45038a70680b ==============================
[0m11:22:30.162865 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:22:30.166881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:22:30.166881 [debug] [MainThread]: Tracking: tracking
[0m11:22:30.178882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E90D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157508E9E50>]}
[0m11:22:30.198391 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:30.306785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:30.316132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C680D0>]}
[0m11:22:30.327136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4A30>]}
[0m11:22:30.328134 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:22:30.330132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4CA0>]}
[0m11:22:30.332129 [info ] [MainThread]: 
[0m11:22:30.336136 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:30.338140 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:22:30.359135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:31.726494 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:22:31.787087 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:31.791618 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:22:31.803138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:32.386061 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:22:32.449690 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:32.455692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C84A00>]}
[0m11:22:32.457688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:32.458684 [info ] [MainThread]: 
[0m11:22:32.466689 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m11:22:32.468702 [info ] [Thread-1  ]: 1 of 3 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m11:22:32.469692 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m11:22:32.470688 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m11:22:32.475688 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m11:22:32.476690 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 11:22:32.471690 => 2023-09-28 11:22:32.476690
[0m11:22:32.477690 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m11:22:32.551223 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:22:33.136701 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m11:22:33.192584 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.205103 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:22:33.257579 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.263578 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m11:22:33.265088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m11:22:33.318905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.326903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m11:22:33.387051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.423575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m11:22:33.476133 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.478137 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 11:22:32.478694 => 2023-09-28 11:22:33.478137
[0m11:22:33.480134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F940>]}
[0m11:22:33.481136 [info ] [Thread-1  ]: 1 of 3 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.01s]
[0m11:22:33.484146 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m11:22:33.485142 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.486147 [info ] [Thread-1  ]: 2 of 3 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m11:22:33.489149 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m11:22:33.489149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m11:22:33.490160 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m11:22:33.493147 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.494146 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 11:22:33.491150 => 2023-09-28 11:22:33.494146
[0m11:22:33.495148 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m11:22:33.532665 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m11:22:33.534667 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m11:22:33.590861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.601392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.645458 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.647448 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m11:22:33.696429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.700674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.745841 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:22:33.747834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m11:22:33.796371 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.802903 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m11:22:33.855899 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:33.858893 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 11:22:33.496149 => 2023-09-28 11:22:33.858893
[0m11:22:33.859900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753C990D0>]}
[0m11:22:33.860893 [info ] [Thread-1  ]: 2 of 3 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m11:22:33.862904 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m11:22:33.863902 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m11:22:33.864900 [info ] [Thread-1  ]: 3 of 3 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m11:22:33.866904 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m11:22:33.867910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m11:22:33.869904 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m11:22:33.875904 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m11:22:33.877906 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 11:22:33.869904 => 2023-09-28 11:22:33.877906
[0m11:22:33.878909 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m11:22:33.889921 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m11:22:33.892929 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m11:22:33.949455 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:33.954456 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.015995 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.018005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m11:22:34.066052 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.071051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.116599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.118604 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m11:22:34.175867 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:22:34.182877 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m11:22:34.235599 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:22:34.238604 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 11:22:33.879906 => 2023-09-28 11:22:34.238604
[0m11:22:34.240602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86ba7e4c-395b-498b-b462-45038a70680b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001575505F4F0>]}
[0m11:22:34.241601 [info ] [Thread-1  ]: 3 of 3 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m11:22:34.242595 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m11:22:34.244598 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:22:34.245600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:34.246603 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:22:34.246603 [debug] [MainThread]: On list_schemas: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:22:34.247601 [debug] [MainThread]: On list_None_travelata: Close
[0m11:22:34.247601 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m11:22:34.248601 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m11:22:34.249602 [info ] [MainThread]: 
[0m11:22:34.250599 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m11:22:34.252600 [debug] [MainThread]: Command end result
[0m11:22:34.261602 [info ] [MainThread]: 
[0m11:22:34.263600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:34.264602 [info ] [MainThread]: 
[0m11:22:34.266692 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:34.267600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753BC4C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015755168EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015753D2C820>]}
[0m11:22:34.268599 [debug] [MainThread]: Flushing usage events


============================== 2023-09-28 14:51:49.527538 | 75a26bc2-a813-4200-8a93-68280085b930 ==============================
[0m14:51:49.527538 [info ] [MainThread]: Running with dbt=1.4.8
[0m14:51:49.531179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:49.531179 [debug] [MainThread]: Tracking: tracking
[0m14:51:49.546213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223814990D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381499E50>]}
[0m14:51:49.563728 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:49.673568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:49.685564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002238480F0D0>]}
[0m14:51:49.698566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4FA0>]}
[0m14:51:49.699574 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:51:49.701565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>]}
[0m14:51:49.703562 [info ] [MainThread]: 
[0m14:51:49.706570 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:49.709585 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m14:51:49.732562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:51.711721 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m14:51:51.763292 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:51.767290 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m14:51:51.775812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:52.391811 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m14:51:52.445330 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:52.449346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847D4F10>]}
[0m14:51:52.451352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:52.452354 [info ] [MainThread]: 
[0m14:51:52.462351 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m14:51:52.463362 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m14:51:52.464901 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m14:51:52.465905 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m14:51:52.470899 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m14:51:52.473898 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-28 14:51:52.466904 => 2023-09-28 14:51:52.473898
[0m14:51:52.474898 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m14:51:52.551900 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:51:53.143858 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m14:51:53.206392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.224392 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m14:51:53.277980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.285975 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m14:51:53.288976 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m14:51:53.347354 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:53.367779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m14:51:53.423818 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.467471 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m14:51:53.521623 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.524625 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-28 14:51:52.476918 => 2023-09-28 14:51:53.524625
[0m14:51:53.526626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C00D30>]}
[0m14:51:53.527627 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m14:51:53.530641 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m14:51:53.531614 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m14:51:53.532611 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m14:51:53.534616 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m14:51:53.535618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m14:51:53.536611 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m14:51:53.539617 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.541616 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-28 14:51:53.537613 => 2023-09-28 14:51:53.541616
[0m14:51:53.542620 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m14:51:53.567157 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_events
[0m14:51:53.584160 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m14:51:53.586156 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m14:51:53.638153 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.641154 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-28 14:51:53.543615 => 2023-09-28 14:51:53.641154
[0m14:51:53.642148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C16BB0>]}
[0m14:51:53.643157 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.11s]
[0m14:51:53.645152 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m14:51:53.646155 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m14:51:53.647154 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m14:51:53.648153 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m14:51:53.649154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m14:51:53.650165 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m14:51:53.652161 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.654165 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-28 14:51:53.650165 => 2023-09-28 14:51:53.653163
[0m14:51:53.654165 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m14:51:53.671321 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m14:51:53.674311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m14:51:53.729307 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.740306 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.792359 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.795359 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m14:51:53.843360 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.850367 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.901881 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.904528 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m14:51:53.953880 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:53.962897 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m14:51:54.011449 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.013463 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-28 14:51:53.655167 => 2023-09-28 14:51:54.013463
[0m14:51:54.015450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385C279D0>]}
[0m14:51:54.016456 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m14:51:54.017445 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m14:51:54.018448 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m14:51:54.019445 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m14:51:54.021447 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m14:51:54.021447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m14:51:54.022450 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m14:51:54.027450 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m14:51:54.028448 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-28 14:51:54.023444 => 2023-09-28 14:51:54.028448
[0m14:51:54.030452 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m14:51:54.044441 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m14:51:54.048446 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m14:51:54.110492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.117485 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.172453 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.175453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m14:51:54.222451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.230450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.281976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.285973 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m14:51:54.331976 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:51:54.341988 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m14:51:54.401540 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:51:54.404535 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-28 14:51:54.030452 => 2023-09-28 14:51:54.404535
[0m14:51:54.406533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75a26bc2-a813-4200-8a93-68280085b930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022385BB2520>]}
[0m14:51:54.407537 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m14:51:54.409537 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m14:51:54.412527 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:51:54.414526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:54.415530 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m14:51:54.416529 [debug] [MainThread]: On list_schemas: Close
[0m14:51:54.416529 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m14:51:54.417527 [debug] [MainThread]: On list_None_travelata: Close
[0m14:51:54.418828 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m14:51:54.419531 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m14:51:54.421531 [info ] [MainThread]: 
[0m14:51:54.423526 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m14:51:54.425528 [debug] [MainThread]: Command end result
[0m14:51:54.445047 [info ] [MainThread]: 
[0m14:51:54.448053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:54.451061 [info ] [MainThread]: 
[0m14:51:54.453065 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:51:54.456064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223847DE040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223848D3BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022381494E20>]}
[0m14:51:54.457068 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:05:45.764519 | e1ed8562-997b-46d2-a9b6-730dca8ec006 ==============================
[0m06:05:45.764519 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:05:45.764519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:45.764519 [debug] [MainThread]: Tracking: tracking
[0m06:05:45.784115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE590D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE59E50>]}
[0m06:05:45.795527 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:05:45.920432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201EC0D0>]}
[0m06:05:45.936058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2FD0>]}
[0m06:05:45.951682 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:05:45.951682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>]}
[0m06:05:45.951682 [info ] [MainThread]: 
[0m06:05:45.951682 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:45.951682 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:05:45.977927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:47.808761 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:05:47.871258 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:47.871258 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:05:47.879771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:05:48.499597 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:05:48.558875 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:48.558875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8201B2F40>]}
[0m06:05:48.558875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:05:48.558875 [info ] [MainThread]: 
[0m06:05:48.576757 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:05:48.577755 [info ] [Thread-1  ]: 1 of 4 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:05:48.579759 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:05:48.580760 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:05:48.584051 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:05:48.584051 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:05:48.581974 => 2023-09-29 06:05:48.584051
[0m06:05:48.584051 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:05:48.623316 [debug] [Thread-1  ]: Creating new relation my_first_dbt_model
[0m06:05:48.671620 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:05:49.270961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:05:49.332163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.347792 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.395064 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:05:49.395064 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:05:49.457583 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.489243 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:05:48.584051 => 2023-09-29 06:05:49.489243
[0m06:05:49.489243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCC40>]}
[0m06:05:49.489243 [info ] [Thread-1  ]: 1 of 4 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.91s]
[0m06:05:49.504889 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:05:49.504889 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:05:49.504889 [info ] [Thread-1  ]: 2 of 4 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:05:49.504889 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:05:49.510623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:05:49.511640 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:05:49.515999 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.515999 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:05:49.512640 => 2023-09-29 06:05:49.515999
[0m06:05:49.515999 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:05:49.610633 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:05:49.611633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:05:49.668625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.684665 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.715934 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:49.731555 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:05:49.778429 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.781941 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:05:49.825739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:05:49.888124 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:49.903763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:05:49.951048 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:49.951048 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:05:49.515999 => 2023-09-29 06:05:49.951048
[0m06:05:49.951048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8215BCB80>]}
[0m06:05:49.951048 [info ] [Thread-1  ]: 2 of 4 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.45s]
[0m06:05:49.966671 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:05:49.966671 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [info ] [Thread-1  ]: 3 of 4 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:05:49.966671 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:05:49.966671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:05:49.966671 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.966671 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:49.966671
[0m06:05:49.966671 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:05:49.966671 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:05:49.984608 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:05:50.045238 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.049235 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.100980 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:05:50.159564 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.164564 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.195175 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m06:05:50.210804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:05:50.257679 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.273302 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:05:50.336211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.336211 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:05:49.966671 => 2023-09-29 06:05:50.336211
[0m06:05:50.336211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A821691430>]}
[0m06:05:50.336211 [info ] [Thread-1  ]: 3 of 4 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.37s]
[0m06:05:50.336211 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:05:50.336211 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:05:50.336211 [info ] [Thread-1  ]: 4 of 4 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:05:50.336211 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:05:50.336211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:05:50.336211 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:05:50.356149 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:05:50.358149 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:05:50.351837 => 2023-09-29 06:05:50.358149
[0m06:05:50.359155 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:05:50.368396 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:05:50.370571 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:05:50.421163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.430519 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.479750 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.481908 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:05:50.541131 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:05:50.546447 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.600861 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.603026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:05:50.650142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.650660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:05:50.697871 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:05:50.712886 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:05:50.360157 => 2023-09-29 06:05:50.712886
[0m06:05:50.712886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1ed8562-997b-46d2-a9b6-730dca8ec006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8216D5EB0>]}
[0m06:05:50.712886 [info ] [Thread-1  ]: 4 of 4 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.38s]
[0m06:05:50.712886 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:05:50.712886 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:05:50.712886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_schemas: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On list_None_travelata: Close
[0m06:05:50.712886 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:05:50.712886 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:05:50.712886 [info ] [MainThread]: 
[0m06:05:50.712886 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m06:05:50.727633 [debug] [MainThread]: Command end result
[0m06:05:50.738631 [info ] [MainThread]: 
[0m06:05:50.739630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:05:50.741679 [info ] [MainThread]: 
[0m06:05:50.741679 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:05:50.741679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A820122040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8202B2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A81CE4FF40>]}
[0m06:05:50.741679 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:12:14.089183 | 37f5e437-b126-421d-8955-7f629a98a9b6 ==============================
[0m06:12:14.089183 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:12:14.089183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:12:14.089183 [debug] [MainThread]: Tracking: tracking
[0m06:12:14.104801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B1388E80>]}
[0m06:12:14.130381 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:12:14.234775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:12:14.248827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46FE0D0>]}
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632220>]}
[0m06:12:14.256344 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:12:14.256344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4632490>]}
[0m06:12:14.256344 [info ] [MainThread]: 
[0m06:12:14.256344 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:14.271988 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:12:14.289644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:15.610602 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:12:15.657878 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:15.673520 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:12:15.673520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:16.255651 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:12:16.318256 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:16.318256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B4721040>]}
[0m06:12:16.318256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:12:16.333890 [info ] [MainThread]: 
[0m06:12:16.333890 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:12:16.333890 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:12:16.342982 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:12:16.342982 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:12:16.347995 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:12:16.349859 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:12:16.344005 => 2023-09-29 06:12:16.349002
[0m06:12:16.349859 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:12:16.424899 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:12:17.001575 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:12:17.056291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.071940 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.118805 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:12:17.118805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:12:17.182191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.197825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:12:17.260758 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.292027 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:12:17.338902 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.352919 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:12:16.351375 => 2023-09-29 06:12:17.352919
[0m06:12:17.352919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5AE2BB0>]}
[0m06:12:17.354931 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:12:17.354931 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:12:17.354931 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_events
[0m06:12:17.354931 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheet_default_events ........... [RUN]
[0m06:12:17.363781 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_events'
[0m06:12:17.365256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_events)
[0m06:12:17.365256 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_events
[0m06:12:17.365256 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.370882 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (compile): 2023-09-29 06:12:17.365256 => 2023-09-29 06:12:17.370882
[0m06:12:17.370882 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_events
[0m06:12:17.412039 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_events"
[0m06:12:17.412039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */


  create view travelata.normalize_sheet_default_events__dbt_tmp 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:12:17.466315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.481969 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.530531 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.544453 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events to travelata.normalize_sheet_default_events__dbt_backup 
  
  ...
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:17.586398 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    drop table if exists travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.633598 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */

    rename table travelata.normalize_sheet_default_events__dbt_tmp to travelata.normalize_sheet_default_events 
  
  ...
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.696774 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_events"} */
drop table if exists travelata.normalize_sheet_default_events__dbt_backup 
  ...
[0m06:12:17.759673 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.759673 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_events (execute): 2023-09-29 06:12:17.370882 => 2023-09-29 06:12:17.759673
[0m06:12:17.759673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5BC8D00>]}
[0m06:12:17.759673 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheet_default_events ...... [[32mOK[0m in 0.40s]
[0m06:12:17.759673 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_events
[0m06:12:17.759673 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheet_default_installs ......... [RUN]
[0m06:12:17.759673 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_installs'
[0m06:12:17.759673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_installs)
[0m06:12:17.759673 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_installs
[0m06:12:17.759673 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.775833 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (compile): 2023-09-29 06:12:17.759673 => 2023-09-29 06:12:17.775833
[0m06:12:17.778497 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_installs
[0m06:12:17.786094 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_installs"
[0m06:12:17.786094 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */


  create view travelata.normalize_sheet_default_installs__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:12:17.853091 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:17.862210 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:17.920543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs to travelata.normalize_sheet_default_installs__dbt_backup 
  
  ...
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:17.968291 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    drop table if exists travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.030805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */

    rename table travelata.normalize_sheet_default_installs__dbt_tmp to travelata.normalize_sheet_default_installs 
  
  ...
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.077348 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_installs: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_installs"} */
drop table if exists travelata.normalize_sheet_default_installs__dbt_backup 
  ...
[0m06:12:18.139865 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.139865 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_installs (execute): 2023-09-29 06:12:17.778497 => 2023-09-29 06:12:18.139865
[0m06:12:18.139865 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5C06FD0>]}
[0m06:12:18.139865 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheet_default_installs .... [[32mOK[0m in 0.38s]
[0m06:12:18.139865 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_installs
[0m06:12:18.139865 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.139865 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheet_default_profiles ......... [RUN]
[0m06:12:18.139865 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheet_default_profiles'
[0m06:12:18.139865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheet_default_profiles)
[0m06:12:18.139865 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.153378 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.155885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (compile): 2023-09-29 06:12:18.139865 => 2023-09-29 06:12:18.155885
[0m06:12:18.157743 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.161764 [debug] [Thread-1  ]: Creating new relation normalize_sheet_default_profiles
[0m06:12:18.165214 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheet_default_profiles"
[0m06:12:18.165214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheet_default_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheet_default_profiles"} */


  create view travelata.normalize_sheet_default_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:12:18.224854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.227846 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheet_default_profiles (execute): 2023-09-29 06:12:18.158760 => 2023-09-29 06:12:18.227846
[0m06:12:18.228846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B5A8FA00>]}
[0m06:12:18.230856 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheet_default_profiles .... [[32mOK[0m in 0.09s]
[0m06:12:18.231856 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheet_default_profiles
[0m06:12:18.232854 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:12:18.233860 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:12:18.234862 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:12:18.235942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:12:18.235942 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.235942
[0m06:12:18.235942 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:12:18.235942 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:12:18.235942 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:12:18.304481 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:12:18.309481 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.353694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:12:18.361212 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.408110 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:12:18.455402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.517918 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:12:18.581618 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:12:18.584630 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:12:18.235942 => 2023-09-29 06:12:18.584630
[0m06:12:18.586629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f5e437-b126-421d-8955-7f629a98a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B46C3F40>]}
[0m06:12:18.588629 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.35s]
[0m06:12:18.590641 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:12:18.592629 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:12:18.593632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:18.593632 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:12:18.594627 [debug] [MainThread]: On list_schemas: Close
[0m06:12:18.594627 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:12:18.595628 [debug] [MainThread]: On list_None_travelata: Close
[0m06:12:18.595628 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:12:18.596631 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:12:18.597049 [info ] [MainThread]: 
[0m06:12:18.599050 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:12:18.600280 [debug] [MainThread]: Command end result
[0m06:12:18.613104 [info ] [MainThread]: 
[0m06:12:18.614748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:12:18.617267 [info ] [MainThread]: 
[0m06:12:18.617267 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:12:18.617267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B59E7D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150B47C1F10>]}
[0m06:12:18.617267 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:01.573650 | 24d118a3-a5f0-4db8-89c9-757c0aebd5da ==============================
[0m06:20:01.573650 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:01.573650 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:01.573650 [debug] [MainThread]: Tracking: tracking
[0m06:20:01.592026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6794F9EE0>]}
[0m06:20:01.617475 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_installs.sql
[0m06:20:01.711857 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_events.sql
[0m06:20:01.727497 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalize_sheet_default_profiles.sql
[0m06:20:01.743127 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:01.771769 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_install.sql
[0m06:20:01.774945 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_profiles.sql
[0m06:20:01.790478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C70D0>]}
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950E700>]}
[0m06:20:01.806116 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:01.806116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67950EB50>]}
[0m06:20:01.806116 [info ] [MainThread]: 
[0m06:20:01.806116 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:01.806116 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:01.828405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.097984 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:20:03.150930 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:03.154928 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:20:03.160338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:03.756928 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:20:03.812076 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:03.812076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C8C22E0>]}
[0m06:20:03.812076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:20:03.820593 [info ] [MainThread]: 
[0m06:20:03.820593 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:20:03.820593 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:20:03.831617 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:20:03.832650 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:20:03.836650 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:20:03.837731 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:20:03.832650 => 2023-09-29 06:20:03.837731
[0m06:20:03.840067 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:20:03.922096 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:20:04.519776 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:20:04.575694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.588209 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.635097 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:20:04.635097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:04.698489 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:20:04.747040 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.794414 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:20:04.841315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:04.841315 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:20:03.841099 => 2023-09-29 06:20:04.841315
[0m06:20:04.841315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B700>]}
[0m06:20:04.841315 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.02s]
[0m06:20:04.856928 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:20:04.856928 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.856928 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:20:04.862598 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:20:04.863614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:20:04.864617 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.868611 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.870612 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:20:04.865609 => 2023-09-29 06:20:04.869611
[0m06:20:04.871492 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.881026 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.894651 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:20:04.894651 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:20:04.965166 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:04.970156 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:20:04.871492 => 2023-09-29 06:20:04.970156
[0m06:20:04.971159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DC9B190>]}
[0m06:20:04.972157 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.11s]
[0m06:20:04.974270 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:20:04.974270 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:20:04.976283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:20:04.976283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:20:04.976283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.976283 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:04.976283
[0m06:20:04.976283 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:04.976283 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:20:04.989805 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:20:05.043935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.047937 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:20:04.976283 => 2023-09-29 06:20:05.047937
[0m06:20:05.048932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DD9CC70>]}
[0m06:20:05.049932 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.07s]
[0m06:20:05.051938 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:20:05.051938 [debug] [Thread-1  ]: Began running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.052937 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalizesheets_default_travelataappmetrica_events  [RUN]
[0m06:20:05.054946 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalizesheets_default_travelataappmetrica_events'
[0m06:20:05.055939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalizesheets_default_travelataappmetrica_events)
[0m06:20:05.055939 [debug] [Thread-1  ]: Began compiling node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.057934 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.059945 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (compile): 2023-09-29 06:20:05.055939 => 2023-09-29 06:20:05.059945
[0m06:20:05.060943 [debug] [Thread-1  ]: Began executing node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.064954 [debug] [Thread-1  ]: Creating new relation normalizesheets_default_travelataappmetrica_events
[0m06:20:05.066998 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalizesheets_default_travelataappmetrica_events"
[0m06:20:05.069008 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalizesheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalizesheets_default_travelataappmetrica_events"} */


  create view travelata.normalizesheets_default_travelataappmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:20:05.135182 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:20:05.139173 [debug] [Thread-1  ]: Timing info for model.travelata.normalizesheets_default_travelataappmetrica_events (execute): 2023-09-29 06:20:05.060943 => 2023-09-29 06:20:05.139173
[0m06:20:05.140180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DCAB280>]}
[0m06:20:05.142172 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalizesheets_default_travelataappmetrica_events  [[32mOK[0m in 0.09s]
[0m06:20:05.143177 [debug] [Thread-1  ]: Finished running node model.travelata.normalizesheets_default_travelataappmetrica_events
[0m06:20:05.144179 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:20:05.145172 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:20:05.147254 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:20:05.147254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:20:05.147254 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:20:05.147254 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:20:05.147254 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.147254
[0m06:20:05.147254 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:20:05.176501 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:20:05.178950 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:20:05.233421 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.240492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:20:05.280450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:20:05.327224 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.342856 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.405765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:20:05.452640 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:20:05.515727 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:20:05.515727 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:20:05.147254 => 2023-09-29 06:20:05.515727
[0m06:20:05.515727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24d118a3-a5f0-4db8-89c9-757c0aebd5da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDC6FD0>]}
[0m06:20:05.515727 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.37s]
[0m06:20:05.525737 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:20:05.525737 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:05.525737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:05.525737 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:20:05.531248 [debug] [MainThread]: On list_schemas: Close
[0m06:20:05.532468 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:20:05.533478 [debug] [MainThread]: On list_None_travelata: Close
[0m06:20:05.534868 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:20:05.534868 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:20:05.534868 [info ] [MainThread]: 
[0m06:20:05.534868 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m06:20:05.534868 [debug] [MainThread]: Command end result
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:05.548006 [info ] [MainThread]: 
[0m06:20:05.548006 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:20:05.548006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67C903C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67DDD05E0>]}
[0m06:20:05.548006 [debug] [MainThread]: Flushing usage events


============================== 2023-09-29 06:20:59.136590 | 61eaa5ff-5532-422e-ae05-1c5de141be29 ==============================
[0m06:20:59.136590 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:20:59.151604 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:20:59.152613 [debug] [MainThread]: Tracking: tracking
[0m06:20:59.152613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D089F70>]}
[0m06:20:59.181517 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.298203 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\1_normalize\normalizesheets_default_travelataappmetrica_events.sql
[0m06:20:59.329445 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalize_sheets_default_travelataappmetrica_events.sql
[0m06:20:59.361106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104900D0>]}
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D790>]}
[0m06:20:59.376752 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:20:59.376752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>]}
[0m06:20:59.376752 [info ] [MainThread]: 
[0m06:20:59.376752 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:20:59.376752 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:20:59.404171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:00.753260 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:21:00.809378 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:00.809378 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:21:00.825016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:01.417937 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:21:01.470455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:01.488109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227104938B0>]}
[0m06:21:01.488109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:21:01.488109 [info ] [MainThread]: 
[0m06:21:01.488109 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m06:21:01.488109 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m06:21:01.502126 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m06:21:01.503064 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m06:21:01.508080 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m06:21:01.510082 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-09-29 06:21:01.504089 => 2023-09-29 06:21:01.510082
[0m06:21:01.511079 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m06:21:01.594986 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:21:02.183613 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m06:21:02.257792 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.261807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:21:02.308696 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.324323 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m06:21:02.324323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m06:21:02.371607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.387244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m06:21:02.434108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.465763 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m06:21:02.528283 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.528283 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-09-29 06:21:01.512883 => 2023-09-29 06:21:02.528283
[0m06:21:02.528283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822EB0>]}
[0m06:21:02.528283 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.04s]
[0m06:21:02.528283 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m06:21:02.528283 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.528283 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [RUN]
[0m06:21:02.528283 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_events'
[0m06:21:02.528283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_events)
[0m06:21:02.528283 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.545351 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.547366 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (compile): 2023-09-29 06:21:02.528283 => 2023-09-29 06:21:02.547366
[0m06:21:02.548366 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.563432 [debug] [Thread-1  ]: Creating new relation normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.576819 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_events"
[0m06:21:02.576819 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_events"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m06:21:02.634392 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.637386 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_events (execute): 2023-09-29 06:21:02.549364 => 2023-09-29 06:21:02.637386
[0m06:21:02.639392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711855C10>]}
[0m06:21:02.640399 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_events  [[32mOK[0m in 0.11s]
[0m06:21:02.641401 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_events
[0m06:21:02.643404 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.645404 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [RUN]
[0m06:21:02.647413 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_install'
[0m06:21:02.648411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_install)
[0m06:21:02.649411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.651413 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.653411 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (compile): 2023-09-29 06:21:02.649411 => 2023-09-29 06:21:02.653411
[0m06:21:02.653411 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:02.657244 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_install"
[0m06:21:02.657244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:02.724836 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.778733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install to travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  
  ...
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.825510 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:21:02.888434 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_install__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_install 
  
  ...
[0m06:21:02.935292 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:02.954947 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_install"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_install__dbt_backup 
  ...
[0m06:21:02.998244 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:02.998244 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_install (execute): 2023-09-29 06:21:02.653411 => 2023-09-29 06:21:02.998244
[0m06:21:03.013885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711822DF0>]}
[0m06:21:03.013885 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_install  [[32mOK[0m in 0.35s]
[0m06:21:03.013885 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_install
[0m06:21:03.013885 [debug] [Thread-1  ]: Began running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [RUN]
[0m06:21:03.013885 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalize_sheets_default_travelataappmetrica_profiles'
[0m06:21:03.013885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalize_sheets_default_travelataappmetrica_profiles)
[0m06:21:03.013885 [debug] [Thread-1  ]: Began compiling node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.013885 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.013885 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (compile): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.013885
[0m06:21:03.013885 [debug] [Thread-1  ]: Began executing node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.032730 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"
[0m06:21:03.034740 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */


  create view travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m06:21:03.084524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.088517 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.126787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.142418 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles to travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  
  ...
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.189706 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.237336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */

    rename table travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_tmp to travelata.normalize_sheets_default_travelataappmetrica_profiles 
  
  ...
[0m06:21:03.290441 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.302267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalize_sheets_default_travelataappmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalize_sheets_default_travelataappmetrica_profiles"} */
drop table if exists travelata.normalize_sheets_default_travelataappmetrica_profiles__dbt_backup 
  ...
[0m06:21:03.355718 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.362401 [debug] [Thread-1  ]: Timing info for model.travelata.normalize_sheets_default_travelataappmetrica_profiles (execute): 2023-09-29 06:21:03.013885 => 2023-09-29 06:21:03.362401
[0m06:21:03.362911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271187E520>]}
[0m06:21:03.362911 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalize_sheets_default_travelataappmetrica_profiles  [[32mOK[0m in 0.35s]
[0m06:21:03.362911 [debug] [Thread-1  ]: Finished running node model.travelata.normalize_sheets_default_travelataappmetrica_profiles
[0m06:21:03.362911 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m06:21:03.362911 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m06:21:03.362911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m06:21:03.362911 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m06:21:03.362911 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m06:21:03.362911 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-09-29 06:21:03.362911 => 2023-09-29 06:21:03.362911
[0m06:21:03.377925 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m06:21:03.384823 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m06:21:03.386821 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m06:21:03.452811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:21:03.457914 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:21:03.501117 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m06:21:03.556008 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.564030 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.610248 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.612013 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.658203 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m06:21:03.705092 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:21:03.720719 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-09-29 06:21:03.377925 => 2023-09-29 06:21:03.720719
[0m06:21:03.720719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eaa5ff-5532-422e-ae05-1c5de141be29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227118E5550>]}
[0m06:21:03.720719 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m06:21:03.720719 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m06:21:03.720719 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:21:03.720719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_schemas: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On list_None_travelata: Close
[0m06:21:03.720719 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m06:21:03.720719 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m06:21:03.720719 [info ] [MainThread]: 
[0m06:21:03.720719 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m06:21:03.738083 [debug] [MainThread]: Command end result
[0m06:21:03.749063 [info ] [MainThread]: 
[0m06:21:03.750081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:21:03.751074 [info ] [MainThread]: 
[0m06:21:03.751074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:21:03.751074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270D09D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022710451820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022711921700>]}
[0m06:21:03.756097 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 08:55:59.908704 | 89ed6b51-4414-4516-b3a5-577d4f313ffa ==============================
[0m08:55:59.908704 [info ] [MainThread]: Running with dbt=1.4.8
[0m08:55:59.915248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:59.916276 [debug] [MainThread]: Tracking: tracking
[0m08:55:59.916276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0677A868>]}
[0m08:55:59.949068 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\schema.yml
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_second_dbt_model.sql
[0m08:56:01.011491 [debug] [MainThread]: Partial parsing: updated file: travelata://models\example\my_first_dbt_model.sql
[0m08:56:01.042760 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m08:56:01.073884 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m08:56:01.192798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x068572F8>]}
[0m08:56:01.205803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x023E7D78>]}
[0m08:56:01.205803 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m08:56:01.206795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C3D0>]}
[0m08:56:01.209802 [info ] [MainThread]: 
[0m08:56:01.211794 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:01.214796 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m08:56:01.234796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:04.740276 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m08:56:04.799389 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:04.804387 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m08:56:04.816381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:05.438440 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m08:56:05.496222 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:05.503220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>]}
[0m08:56:05.504223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:05.505216 [info ] [MainThread]: 
[0m08:56:05.514008 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m08:56:05.515007 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m08:56:05.516010 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m08:56:05.517012 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m08:56:05.522008 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m08:56:05.523008 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 08:56:05.517012 => 2023-10-02 08:56:05.523008
[0m08:56:05.523008 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m08:56:05.609065 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:56:06.208834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m08:56:06.277959 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.292958 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m08:56:06.340418 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.350434 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m08:56:06.352430 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m08:56:06.401396 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.411416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m08:56:06.458666 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:06.510451 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m08:56:06.569078 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:06.572073 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 08:56:05.524009 => 2023-10-02 08:56:06.572073
[0m08:56:06.573075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B192B0>]}
[0m08:56:06.574081 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m08:56:06.577076 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m08:56:06.578077 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.579074 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m08:56:06.580073 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m08:56:06.580073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m08:56:06.581072 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.582077 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.582077 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 08:56:06.581072 => 2023-10-02 08:56:06.582077
[0m08:56:06.582077 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.611113 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m08:56:06.623455 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m08:56:06.625457 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_events' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_events

)
  )...
[0m08:56:06.699397 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.704928 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 08:56:06.582077 => 2023-10-02 08:56:06.704928
[0m08:56:06.706931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07B31808>]}
[0m08:56:06.708933 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.13s]
[0m08:56:06.733347 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m08:56:06.733347 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.733347 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m08:56:06.733347 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m08:56:06.733347 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m08:56:06.733347 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 08:56:06.733347 => 2023-10-02 08:56:06.743882
[0m08:56:06.743882 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m08:56:06.743882 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m08:56:06.743882 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_install' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_install

)
  )...
[0m08:56:06.813155 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.817158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 08:56:06.743882 => 2023-10-02 08:56:06.817158
[0m08:56:06.818158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CF8E08>]}
[0m08:56:06.819159 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.08s]
[0m08:56:06.820160 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m08:56:06.821157 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.822153 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m08:56:06.823154 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m08:56:06.824159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m08:56:06.824159 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.827157 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.829158 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 08:56:06.824159 => 2023-10-02 08:56:06.829158
[0m08:56:06.829158 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.834159 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m08:56:06.836241 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m08:56:06.836241 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles' as __table_name

from travelata._airbyte_raw_sheets_default_travelataappmetrica_profiles

)
  )...
[0m08:56:06.902197 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m08:56:06.906206 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 08:56:06.830161 => 2023-10-02 08:56:06.905207
[0m08:56:06.907208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8DF0>]}
[0m08:56:06.907208 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m08:56:06.909207 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m08:56:06.909207 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m08:56:06.910204 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m08:56:06.911207 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m08:56:06.911207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m08:56:06.912204 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m08:56:06.916214 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m08:56:06.918206 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 08:56:06.912204 => 2023-10-02 08:56:06.917209
[0m08:56:06.918206 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m08:56:06.933773 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m08:56:06.935366 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m08:56:06.983504 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.006441 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.053708 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m08:56:07.108601 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.114116 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:56:07.146793 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m08:56:07.209710 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:56:07.225339 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m08:56:07.272611 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m08:56:07.272611 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 08:56:06.918206 => 2023-10-02 08:56:07.272611
[0m08:56:07.272611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89ed6b51-4414-4516-b3a5-577d4f313ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07CA8430>]}
[0m08:56:07.272611 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.36s]
[0m08:56:07.272611 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m08:56:07.272611 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:56:07.288249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_schemas: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On list_None_travelata: Close
[0m08:56:07.288249 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m08:56:07.288249 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m08:56:07.288249 [info ] [MainThread]: 
[0m08:56:07.288249 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m08:56:07.288249 [debug] [MainThread]: Command end result
[0m08:56:07.306805 [info ] [MainThread]: 
[0m08:56:07.307808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:07.309813 [info ] [MainThread]: 
[0m08:56:07.310807 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:56:07.312810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B970A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0683C448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06743BE0>]}
[0m08:56:07.312810 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:03:56.005710 | 6bedf390-12b6-4656-9e10-e3fc488ef5de ==============================
[0m09:03:56.005710 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:03:56.005710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:03:56.005710 [debug] [MainThread]: Tracking: tracking
[0m09:03:56.005710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E79820>]}
[0m09:03:56.028780 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.279091 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.310342 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:56.328477 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:56.342262 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:56.413394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071BBE80>]}
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CDC0>]}
[0m09:03:56.428409 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:03:56.428409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F5CCA0>]}
[0m09:03:56.428409 [info ] [MainThread]: 
[0m09:03:56.428409 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:56.445386 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:03:56.466484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:57.702537 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:03:57.749735 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:57.749735 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:03:57.765364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:58.365403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:03:58.428314 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:58.431824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05ECA220>]}
[0m09:03:58.431824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:58.431824 [info ] [MainThread]: 
[0m09:03:58.444334 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:03:58.445495 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:03:58.447515 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:03:58.447515 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:03:58.453279 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:03:58.454304 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:03:58.448504 => 2023-10-02 09:03:58.454304
[0m09:03:58.455292 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:03:58.567389 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:03:59.147735 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:03:59.210256 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.225883 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.273183 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:03:59.273183 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:03:59.336093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.351733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:03:59.414303 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:03:59.461603 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:03:59.508477 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.508477 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:03:58.455292 => 2023-10-02 09:03:59.508477
[0m09:03:59.508477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B24CB8>]}
[0m09:03:59.508477 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.06s]
[0m09:03:59.524098 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:03:59.524098 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.524098 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:03:59.524098 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:03:59.524098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:03:59.529691 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.532777 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.533229 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:03:59.529691 => 2023-10-02 09:03:59.533229
[0m09:03:59.535286 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.562544 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:03:59.575644 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:03:59.575644 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name

from travelata.sheets_appmetrica_travelata_events

)
  )...
[0m09:03:59.628430 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata__events' as __table_name

from travelata.sheets_appmetrica_travelata_events

)
  )
[0m09:03:59.628430 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:03:59.535286 => 2023-10-02 09:03:59.628430
[0m09:03:59.732898 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.732898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B363D0>]}
[0m09:03:59.732898 [error] [Thread-1  ]: 2 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.21s]
[0m09:03:59.732898 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:03:59.732898 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.732898 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:03:59.739411 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:03:59.739411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:03:59.739411 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.739411
[0m09:03:59.739411 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:03:59.739411 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:03:59.739411 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name

from travelata.sheets_appmetrica_travelata_install

)
  )...
[0m09:03:59.802684 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_install' as __table_name

from travelata.sheets_appmetrica_travelata_install

)
  )
[0m09:03:59.802684 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:03:59.739411 => 2023-10-02 09:03:59.802684
[0m09:03:59.802684 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.802684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36340>]}
[0m09:03:59.802684 [error] [Thread-1  ]: 3 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.07s]
[0m09:03:59.802684 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:03:59.813336 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:03:59.814452 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:03:59.814452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:03:59.814452 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.814452 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.814452
[0m09:03:59.814452 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.814452 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:03:59.826722 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:03:59.828736 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name

from travelata.sheets_appmetrica_travelata_profiles

)
  )...
[0m09:03:59.869362 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata.sheets_appmetrica_travelata_profiles' as __table_name

from travelata.sheets_appmetrica_travelata_profiles

)
  )
[0m09:03:59.869362 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:03:59.814452 => 2023-10-02 09:03:59.869362
[0m09:03:59.869362 [debug] [Thread-1  ]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.869362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B36298>]}
[0m09:03:59.880043 [error] [Thread-1  ]: 4 of 5 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.05s]
[0m09:03:59.881061 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:03:59.882058 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:03:59.882058 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:03:59.884057 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:03:59.884057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:03:59.885050 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:03:59.889054 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:03:59.891054 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:03:59.885050 => 2023-10-02 09:03:59.890051
[0m09:03:59.891054 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:03:59.895051 [debug] [Thread-1  ]: Creating new relation my_second_dbt_model
[0m09:03:59.897051 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:03:59.898051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:03:59.949205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:03:59.949205 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:03:59.891054 => 2023-10-02 09:03:59.949205
[0m09:03:59.949205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bedf390-12b6-4656-9e10-e3fc488ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11C153B8>]}
[0m09:03:59.949205 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m09:03:59.949205 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:03:59.949205 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:03:59.959962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:59.960974 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:03:59.960974 [debug] [MainThread]: On list_schemas: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:03:59.961969 [debug] [MainThread]: On list_None_travelata: Close
[0m09:03:59.961969 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:03:59.962969 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:03:59.962969 [info ] [MainThread]: 
[0m09:03:59.963974 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m09:03:59.965981 [debug] [MainThread]: Command end result
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.975019 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m09:03:59.975019 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.975019 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.975019 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:03:59.975019 [info ] [MainThread]: 
[0m09:03:59.986687 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m09:03:59.987707 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.988701 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.989707 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:03:59.990708 [info ] [MainThread]: 
[0m09:03:59.991712 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m09:03:59.993704 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m09:03:59.994702 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata.sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m09:03:59.995703 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:03:59.997712 [info ] [MainThread]: 
[0m09:04:00.000112 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m09:04:00.002128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F45D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA8730>]}
[0m09:04:00.003129 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 09:05:24.720227 | e3bc7e59-e164-41c1-b7b2-62b05fcc5990 ==============================
[0m09:05:24.720227 [info ] [MainThread]: Running with dbt=1.4.8
[0m09:05:24.720227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:05:24.720227 [debug] [MainThread]: Tracking: tracking
[0m09:05:24.720227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E2A7F0>]}
[0m09:05:24.739215 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m09:05:24.986962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.002588 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.034261 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m09:05:25.049889 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m09:05:25.112540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0716AE50>]}
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BFB8>]}
[0m09:05:25.128182 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m09:05:25.128182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F0BF88>]}
[0m09:05:25.143804 [info ] [MainThread]: 
[0m09:05:25.143804 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:25.143804 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m09:05:25.166444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:26.415062 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m09:05:26.463294 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:26.478917 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m09:05:26.478917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:27.065312 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m09:05:27.117386 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:27.117386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>]}
[0m09:05:27.117386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:05:27.117386 [info ] [MainThread]: 
[0m09:05:27.135249 [debug] [Thread-1  ]: Began running node model.travelata.my_first_dbt_model
[0m09:05:27.136251 [info ] [Thread-1  ]: 1 of 5 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m09:05:27.138250 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m09:05:27.139262 [debug] [Thread-1  ]: Began compiling node model.travelata.my_first_dbt_model
[0m09:05:27.139588 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m09:05:27.139588 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:27.139588
[0m09:05:27.139588 [debug] [Thread-1  ]: Began executing node model.travelata.my_first_dbt_model
[0m09:05:27.243860 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:05:27.828996 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m09:05:27.891509 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.915168 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m09:05:27.970201 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:27.980213 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m09:05:27.980213 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.031961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m09:05:28.094660 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.144214 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m09:05:28.188517 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m09:05:28.188517 [debug] [Thread-1  ]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 09:05:27.139588 => 2023-10-02 09:05:28.188517
[0m09:05:28.188517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660868>]}
[0m09:05:28.188517 [info ] [Thread-1  ]: 1 of 5 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 1.05s]
[0m09:05:28.188517 [debug] [Thread-1  ]: Finished running node model.travelata.my_first_dbt_model
[0m09:05:28.188517 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.204151 [info ] [Thread-1  ]: 2 of 5 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m09:05:28.204151 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m09:05:28.204151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m09:05:28.206612 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.209739 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.210745 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 09:05:28.206612 => 2023-10-02 09:05:28.210745
[0m09:05:28.211706 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.237026 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_events
[0m09:05:28.246140 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m09:05:28.246140 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m09:05:28.315341 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m09:05:28.315341 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 09:05:28.212696 => 2023-10-02 09:05:28.315341
[0m09:05:28.315341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660580>]}
[0m09:05:28.315341 [info ] [Thread-1  ]: 2 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_events . [[32mOK[0m in 0.11s]
[0m09:05:28.315341 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m09:05:28.315341 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.315341 [info ] [Thread-1  ]: 3 of 5 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m09:05:28.328850 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m09:05:28.328850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m09:05:28.328850 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.328850
[0m09:05:28.328850 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_install
[0m09:05:28.328850 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m09:05:28.328850 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m09:05:28.391074 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.391074 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 09:05:28.328850 => 2023-10-02 09:05:28.391074
[0m09:05:28.391074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10B05CA0>]}
[0m09:05:28.403602 [info ] [Thread-1  ]: 3 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.06s]
[0m09:05:28.404847 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m09:05:28.404847 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [info ] [Thread-1  ]: 4 of 5 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m09:05:28.404847 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m09:05:28.404847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m09:05:28.404847 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.404847 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.404847 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 09:05:28.404847 => 2023-10-02 09:05:28.404847
[0m09:05:28.415365 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.419832 [debug] [Thread-1  ]: Creating new relation normalized_sheets_appmetrica_profiles
[0m09:05:28.421838 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m09:05:28.422834 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m09:05:28.479065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.482057 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 09:05:28.415365 => 2023-10-02 09:05:28.482057
[0m09:05:28.483063 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660418>]}
[0m09:05:28.484066 [info ] [Thread-1  ]: 4 of 5 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.08s]
[0m09:05:28.485067 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m09:05:28.485067 [debug] [Thread-1  ]: Began running node model.travelata.my_second_dbt_model
[0m09:05:28.486065 [info ] [Thread-1  ]: 5 of 5 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m09:05:28.488068 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m09:05:28.488068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m09:05:28.489069 [debug] [Thread-1  ]: Began compiling node model.travelata.my_second_dbt_model
[0m09:05:28.494063 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m09:05:28.495058 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 09:05:28.489069 => 2023-10-02 09:05:28.495058
[0m09:05:28.496066 [debug] [Thread-1  ]: Began executing node model.travelata.my_second_dbt_model
[0m09:05:28.511015 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m09:05:28.512576 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m09:05:28.565809 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.584907 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.635416 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.637039 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m09:05:28.685767 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.691674 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.746055 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m09:05:28.748167 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m09:05:28.804927 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.812379 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m09:05:28.874979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m09:05:28.877136 [debug] [Thread-1  ]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 09:05:28.496066 => 2023-10-02 09:05:28.876598
[0m09:05:28.877676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc7e59-e164-41c1-b7b2-62b05fcc5990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11B9DD18>]}
[0m09:05:28.878756 [info ] [Thread-1  ]: 5 of 5 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.39s]
[0m09:05:28.879826 [debug] [Thread-1  ]: Finished running node model.travelata.my_second_dbt_model
[0m09:05:28.882104 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:05:28.883162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:28.883709 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m09:05:28.884448 [debug] [MainThread]: On list_schemas: Close
[0m09:05:28.884958 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m09:05:28.884958 [debug] [MainThread]: On list_None_travelata: Close
[0m09:05:28.885490 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m09:05:28.886016 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m09:05:28.886535 [info ] [MainThread]: 
[0m09:05:28.887581 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:05:28.889517 [debug] [MainThread]: Command end result
[0m09:05:28.903568 [info ] [MainThread]: 
[0m09:05:28.904666 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:05:28.906285 [info ] [MainThread]: 
[0m09:05:28.906818 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:05:28.907878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05E7A1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05EF6D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11BA0670>]}
[0m09:05:28.908400 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 15:46:40.667670 | 5571fcad-f526-4b89-8a77-edc2beab3e93 ==============================
[0m15:46:40.667670 [info ] [MainThread]: Running with dbt=1.4.8
[0m15:46:40.667670 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:46:40.667670 [debug] [MainThread]: Tracking: tracking
[0m15:46:40.683297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60731250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F3AE50>]}
[0m15:46:40.698922 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m15:46:40.740177 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:46:40.741123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612090D0>]}
[0m15:46:41.400692 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:41.416281 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\test.sql
[0m15:46:41.431905 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m15:46:41.439846 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m15:46:41.484541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60F81C50>]}
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D61290350>]}
[0m15:46:41.500164 [info ] [MainThread]: Found 7 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:46:41.500164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A6D1D0>]}
[0m15:46:41.500164 [info ] [MainThread]: 
[0m15:46:41.500164 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:41.500164 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m15:46:41.515794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.168111 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m15:46:42.217327 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:42.217327 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m15:46:42.223835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:42.787185 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m15:46:42.865284 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:46:42.865284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60929B90>]}
[0m15:46:42.865284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:42.865284 [info ] [MainThread]: 
[0m15:46:42.865284 [debug] [Thread-1 (]: Began running node model.travelata.my_first_dbt_model
[0m15:46:42.865284 [info ] [Thread-1 (]: 1 of 6 START sql table model travelata.my_first_dbt_model ...................... [RUN]
[0m15:46:42.880911 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m15:46:42.880911 [debug] [Thread-1 (]: Began compiling node model.travelata.my_first_dbt_model
[0m15:46:42.880911 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m15:46:42.880911 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:42.880911
[0m15:46:42.880911 [debug] [Thread-1 (]: Began executing node model.travelata.my_first_dbt_model
[0m15:46:42.898564 [debug] [Thread-1 (]: Creating new relation my_first_dbt_model
[0m15:46:42.926827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:46:43.576851 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m15:46:43.623777 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.639343 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model'
    
      and database = 'travelata'
    
    order by position
  ...
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:43.686353 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m15:46:43.686353 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m15:46:43.748964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 15:46:42.880911 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60ED4D90>]}
[0m15:46:43.764627 [info ] [Thread-1 (]: 1 of 6 OK created sql table model travelata.my_first_dbt_model ................. [[32mOK[0m in 0.88s]
[0m15:46:43.764627 [debug] [Thread-1 (]: Finished running node model.travelata.my_first_dbt_model
[0m15:46:43.764627 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [info ] [Thread-1 (]: 2 of 6 START sql view model travelata.normalized_sheets_appmetrica_events ...... [RUN]
[0m15:46:43.764627 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m15:46:43.764627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m15:46:43.764627 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.764627 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.764627 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.764627
[0m15:46:43.764627 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_events
[0m15:46:43.780245 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m15:46:43.780245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m15:46:43.861813 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )
[0m15:46:43.867840 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 15:46:43.764627 => 2023-10-02 15:46:43.867840
[0m15:46:43.938380 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:43.954020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60A08690>]}
[0m15:46:43.954020 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.17s]
[0m15:46:43.954020 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m15:46:43.954020 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [info ] [Thread-1 (]: 3 of 6 START sql view model travelata.normalized_sheets_appmetrica_install ..... [RUN]
[0m15:46:43.954020 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m15:46:43.954020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m15:46:43.954020 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:43.954020
[0m15:46:43.954020 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_install
[0m15:46:43.954020 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m15:46:43.954020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m15:46:44.007655 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )
[0m15:46:44.008654 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 15:46:43.954020 => 2023-10-02 15:46:44.008654
[0m15:46:44.010653 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.011654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D611D6710>]}
[0m15:46:44.011654 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.06s]
[0m15:46:44.012656 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m15:46:44.012656 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.012656 [info ] [Thread-1 (]: 4 of 6 START sql view model travelata.normalized_sheets_appmetrica_profiles .... [RUN]
[0m15:46:44.013736 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m15:46:44.013736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m15:46:44.014745 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 15:46:44.014745 => 2023-10-02 15:46:44.015746
[0m15:46:44.015746 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_profiles
[0m15:46:44.015746 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m15:46:44.015746 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m15:46:44.065746 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )
[0m15:46:44.065746 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 15:46:44.015746 => 2023-10-02 15:46:44.065746
[0m15:46:44.072486 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.072486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CFB50>]}
[0m15:46:44.072486 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.06s]
[0m15:46:44.072486 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m15:46:44.072486 [debug] [Thread-1 (]: Began running node model.travelata.test
[0m15:46:44.072486 [info ] [Thread-1 (]: 5 of 6 START sql view model travelata.test ..................................... [RUN]
[0m15:46:44.072486 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.test'
[0m15:46:44.072486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.test)
[0m15:46:44.078285 [debug] [Thread-1 (]: Began compiling node model.travelata.test
[0m15:46:44.079293 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.test"
[0m15:46:44.080294 [debug] [Thread-1 (]: Timing info for model.travelata.test (compile): 2023-10-02 15:46:44.078285 => 2023-10-02 15:46:44.080294
[0m15:46:44.081291 [debug] [Thread-1 (]: Began executing node model.travelata.test
[0m15:46:44.083290 [debug] [Thread-1 (]: Creating new relation test
[0m15:46:44.084290 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.test"
[0m15:46:44.085291 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.test: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )...
[0m15:46:44.150497 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.test (execute): 2023-10-02 15:46:44.081291 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Database Error in model test (models\1_normalize\test.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.150497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D612CED50>]}
[0m15:46:44.150497 [error] [Thread-1 (]: 5 of 6 ERROR creating sql view model travelata.test ............................ [[31mERROR[0m in 0.08s]
[0m15:46:44.150497 [debug] [Thread-1 (]: Finished running node model.travelata.test
[0m15:46:44.150497 [debug] [Thread-1 (]: Began running node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [info ] [Thread-1 (]: 6 of 6 START sql view model travelata.my_second_dbt_model ...................... [RUN]
[0m15:46:44.150497 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m15:46:44.150497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m15:46:44.150497 [debug] [Thread-1 (]: Began compiling node model.travelata.my_second_dbt_model
[0m15:46:44.150497 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m15:46:44.150497 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.150497
[0m15:46:44.150497 [debug] [Thread-1 (]: Began executing node model.travelata.my_second_dbt_model
[0m15:46:44.168083 [debug] [Thread-1 (]: Creating new relation my_second_dbt_model
[0m15:46:44.169084 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m15:46:44.170083 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m15:46:44.221437 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:46:44.223435 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 15:46:44.150497 => 2023-10-02 15:46:44.223435
[0m15:46:44.223435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5571fcad-f526-4b89-8a77-edc2beab3e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6179E250>]}
[0m15:46:44.224437 [info ] [Thread-1 (]: 6 of 6 OK created sql view model travelata.my_second_dbt_model ................. [[32mOK[0m in 0.07s]
[0m15:46:44.224437 [debug] [Thread-1 (]: Finished running node model.travelata.my_second_dbt_model
[0m15:46:44.224437 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:46:44.224437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_schemas: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On list_None_travelata: Close
[0m15:46:44.224437 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m15:46:44.224437 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m15:46:44.224437 [info ] [MainThread]: 
[0m15:46:44.224437 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m15:46:44.230343 [debug] [MainThread]: Command end result
[0m15:46:44.239494 [info ] [MainThread]: 
[0m15:46:44.240498 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:46:44.241494 [info ] [MainThread]: 
[0m15:46:44.241494 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m15:46:44.243264 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.243829 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.243829 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m15:46:44.244876 [info ] [MainThread]: 
[0m15:46:44.245885 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m15:46:44.246882 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.247881 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.247881 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m15:46:44.248883 [info ] [MainThread]: 
[0m15:46:44.249419 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m15:46:44.249419 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m15:46:44.249419 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m15:46:44.251897 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m15:46:44.252908 [info ] [MainThread]: 
[0m15:46:44.253906 [error] [MainThread]: [33mDatabase Error in model test (models\1_normalize\test.sql)[0m
[0m15:46:44.253906 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m15:46:44.254904 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m15:46:44.255904 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m15:46:44.255904 [info ] [MainThread]: 
[0m15:46:44.256904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m15:46:44.257906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D60EB5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FF9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D5E2FEC50>]}
[0m15:46:44.257906 [debug] [MainThread]: Flushing usage events


============================== 2023-10-02 17:43:11.025652 | 15314e20-88fc-404d-affd-afb093f1cadb ==============================
[0m17:43:11.025652 [info ] [MainThread]: Running with dbt=1.4.8
[0m17:43:11.028654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\pocel\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:43:11.029652 [debug] [MainThread]: Tracking: tracking
[0m17:43:11.044653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8DB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA65AAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9224950>]}
[0m17:43:11.058655 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m17:43:11.209655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m17:43:11.210653 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m17:43:11.211655 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m17:43:11.212651 [debug] [MainThread]: Partial parsing: added file: travelata://models\1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m17:43:11.213656 [debug] [MainThread]: Partial parsing: updated file: travelata://models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:11.230658 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m17:43:11.249235 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m17:43:11.253241 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m17:43:11.257247 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:11.282268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8B30C10>]}
[0m17:43:11.289233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8D2EDD0>]}
[0m17:43:11.289233 [info ] [MainThread]: Found 10 models, 4 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m17:43:11.290234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA28C9B10>]}
[0m17:43:11.291233 [info ] [MainThread]: 
[0m17:43:11.293237 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:43:11.296233 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m17:43:11.306234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:11.930206 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m17:43:11.980217 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:11.983209 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m17:43:11.987205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:12.568930 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m17:43:12.629229 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:12.633227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9695350>]}
[0m17:43:12.634228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:12.635234 [info ] [MainThread]: 
[0m17:43:12.641249 [debug] [Thread-1 (]: Began running node model.travelata.my_first_dbt_model
[0m17:43:12.641249 [info ] [Thread-1 (]: 1 of 10 START sql table model travelata.my_first_dbt_model ..................... [RUN]
[0m17:43:12.642247 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_first_dbt_model'
[0m17:43:12.642247 [debug] [Thread-1 (]: Began compiling node model.travelata.my_first_dbt_model
[0m17:43:12.645228 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_first_dbt_model"
[0m17:43:12.646227 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (compile): 2023-10-02 17:43:12.643236 => 2023-10-02 17:43:12.646227
[0m17:43:12.647228 [debug] [Thread-1 (]: Began executing node model.travelata.my_first_dbt_model
[0m17:43:12.699228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:13.289280 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

            

    
        create table travelata.my_first_dbt_model__dbt_backup
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        empty
    as (
        /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )
        ...
[0m17:43:13.354972 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:13.361970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

    select name, type from system.columns where table = 'my_first_dbt_model__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m17:43:13.422517 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m17:43:13.425517 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_first_dbt_model"
[0m17:43:13.426517 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */

  
    
    
        
        insert into travelata.my_first_dbt_model__dbt_backup ("id")
  /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  ...
[0m17:43:13.472106 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.477113 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
EXCHANGE TABLES travelata.my_first_dbt_model__dbt_backup AND travelata.my_first_dbt_model 
  
  ...
[0m17:43:13.530099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.554099 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_first_dbt_model"} */
drop table if exists travelata.my_first_dbt_model__dbt_backup 
  ...
[0m17:43:13.598763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:13.600762 [debug] [Thread-1 (]: Timing info for model.travelata.my_first_dbt_model (execute): 2023-10-02 17:43:12.647228 => 2023-10-02 17:43:13.600762
[0m17:43:13.600762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA950D310>]}
[0m17:43:13.601761 [info ] [Thread-1 (]: 1 of 10 OK created sql table model travelata.my_first_dbt_model ................ [[32mOK[0m in 0.96s]
[0m17:43:13.602763 [debug] [Thread-1 (]: Finished running node model.travelata.my_first_dbt_model
[0m17:43:13.603762 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.603762 [info ] [Thread-1 (]: 2 of 10 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m17:43:13.604763 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m17:43:13.605762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m17:43:13.605762 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.606762 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m17:43:13.607762 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-02 17:43:13.605762 => 2023-10-02 17:43:13.607762
[0m17:43:13.608762 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.619762 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_events
[0m17:43:13.624762 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m17:43:13.625763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )...
[0m17:43:13.671696 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events 
  
  as (
    SELECT

parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,

JSONExtractString(_airbyte_data, 'event_json') AS event_json,

JSONExtractString(_airbyte_data, 'event_name') AS event_name,

JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'session_id') AS session_id,

JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata__events' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_events

)
  )
[0m17:43:13.671696 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-02 17:43:13.608762 => 2023-10-02 17:43:13.671696
[0m17:43:13.680698 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m17:43:13.680698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8DB67D0>]}
[0m17:43:13.681843 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_events  [[31mERROR[0m in 0.08s]
[0m17:43:13.682347 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m17:43:13.682897 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.683419 [info ] [Thread-1 (]: 3 of 10 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m17:43:13.683934 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m17:43:13.684461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m17:43:13.684977 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.686545 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m17:43:13.687586 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-02 17:43:13.684977 => 2023-10-02 17:43:13.687586
[0m17:43:13.688119 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.690091 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_install
[0m17:43:13.691125 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m17:43:13.692321 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )...
[0m17:43:13.739663 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install 
  
  as (
    SELECT 

parseDateTime(JSONExtractString(_airbyte_data, 'install_datetime'), '%d.%m.%Y') AS __datetime,

JSONExtractString(_airbyte_data, 'city') AS city,

JSONExtractString(_airbyte_data, 'os_name') AS os_name,

JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,

JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,

JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,

JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,

JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_install

)
  )
[0m17:43:13.740184 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-02 17:43:13.688119 => 2023-10-02 17:43:13.740184
[0m17:43:13.742775 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m17:43:13.743363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9B7AED0>]}
[0m17:43:13.743867 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_install  [[31mERROR[0m in 0.06s]
[0m17:43:13.744388 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m17:43:13.744915 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.745435 [info ] [Thread-1 (]: 4 of 10 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m17:43:13.745961 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m17:43:13.746478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m17:43:13.746478 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.748032 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m17:43:13.749066 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-02 17:43:13.746997 => 2023-10-02 17:43:13.749066
[0m17:43:13.749066 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.751715 [debug] [Thread-1 (]: Creating new relation normalized_sheets_appmetrica_profiles
[0m17:43:13.753834 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m17:43:13.754894 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )...
[0m17:43:13.809502 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles 
  
  as (
    SELECT 

JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,

JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,

JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,

JSONExtractString(_airbyte_data, 'city_code') AS city_code,

toDateTime32(_airbyte_emitted_at) AS __emitted_at,

toLowCardinality(__table_name) AS __table_name,

NOW() as __normalized_at

FROM 

(

select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name

from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles

)
  )
[0m17:43:13.810022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-02 17:43:13.749584 => 2023-10-02 17:43:13.810022
[0m17:43:13.812101 [debug] [Thread-1 (]: Database Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m17:43:13.812620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9AE10D0>]}
[0m17:43:13.813138 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model travelata.normalized_sheets_appmetrica_profiles  [[31mERROR[0m in 0.07s]
[0m17:43:13.813671 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m17:43:13.814190 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.814190 [info ] [Thread-1 (]: 5 of 10 START sql view model travelata.normalized_sheets_utmcraft_utmresult .... [RUN]
[0m17:43:13.815232 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m17:43:13.815232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m17:43:13.815755 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.816798 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m17:43:13.817314 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-02 17:43:13.815755 => 2023-10-02 17:43:13.817314
[0m17:43:13.818320 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.821984 [debug] [Thread-1 (]: Creating new relation normalized_sheets_utmcraft_utmresult
[0m17:43:13.823038 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m17:43:13.824091 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult 
  
  as (
    select

	JSONExtractString(_airbyte_data, 'id') as id,

	JSONExtractString(_airbyte_data, 'created_at') as created_at,

	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	JSONExtractString(_airbyte_data, 'data') as data,

	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,

	JSONExtractString(_airbyte_data, 'form_id') as form_id,

	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,

	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata._airbyte_raw_sheets_default_travelatautmcraft_normalize_utmcraft_utmresult' as __table_name 

	from travelata.`_airbyte_raw_normalize_utmcraft_utmresult`) x
  )...
[0m17:43:13.878409 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult 
  
  as (
    select

	JSONExtractString(_airbyte_data, 'id') as id,

	JSONExtractString(_airbyte_data, 'created_at') as created_at,

	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	JSONExtractString(_airbyte_data, 'data') as data,

	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,

	JSONExtractString(_airbyte_data, 'form_id') as form_id,

	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,

	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata._airbyte_raw_sheets_default_travelatautmcraft_normalize_utmcraft_utmresult' as __table_name 

	from travelata.`_airbyte_raw_normalize_utmcraft_utmresult`) x
  )
[0m17:43:13.878959 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-02 17:43:13.818320 => 2023-10-02 17:43:13.878959
[0m17:43:13.880518 [debug] [Thread-1 (]: Database Error in model normalized_sheets_utmcraft_utmresult (models\1_normalize\normalized_sheets_utmcraft_utmresult.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 44. DB::Exception: Cannot add column utm_hashcode: column with this name already exists. (ILLEGAL_COLUMN) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:13.881517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C42810>]}
[0m17:43:13.881517 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model travelata.normalized_sheets_utmcraft_utmresult  [[31mERROR[0m in 0.07s]
[0m17:43:13.883113 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m17:43:13.883665 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.884192 [info ] [Thread-1 (]: 6 of 10 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m17:43:13.885244 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m17:43:13.885244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m17:43:13.885767 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.886809 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m17:43:13.888359 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-02 17:43:13.885767 => 2023-10-02 17:43:13.887844
[0m17:43:13.888359 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.890459 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.891499 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m17:43:13.892529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_ad_groups_statistics`' as __table_name 

	from travelata.`_airbyte_raw_ad_groups_statistics`) x
  )...
[0m17:43:13.942695 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:13.944694 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-02 17:43:13.888885 => 2023-10-02 17:43:13.944694
[0m17:43:13.945694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C32E10>]}
[0m17:43:13.945694 [info ] [Thread-1 (]: 6 of 10 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.06s]
[0m17:43:13.946695 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m17:43:13.946695 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.947694 [info ] [Thread-1 (]: 7 of 10 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m17:43:13.947694 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m17:43:13.948694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m17:43:13.948694 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.949695 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m17:43:13.951695 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-02 17:43:13.948694 => 2023-10-02 17:43:13.950694
[0m17:43:13.951695 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:13.953694 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_adplansstatistics
[0m17:43:13.954694 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m17:43:13.955694 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_ad_plans_statistics`' as __table_name 

	from travelata.`_airbyte_raw_ad_plans_statistics`) x
  )...
[0m17:43:14.001072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.003071 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-02 17:43:13.951695 => 2023-10-02 17:43:14.003071
[0m17:43:14.004071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9B7BA90>]}
[0m17:43:14.004071 [info ] [Thread-1 (]: 7 of 10 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.06s]
[0m17:43:14.005072 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m17:43:14.005072 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.006073 [info ] [Thread-1 (]: 8 of 10 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m17:43:14.006073 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m17:43:14.007073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m17:43:14.007073 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.008072 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m17:43:14.010072 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-02 17:43:14.007073 => 2023-10-02 17:43:14.010072
[0m17:43:14.010072 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.012073 [debug] [Thread-1 (]: Creating new relation normalized_sheets_vkads_bannersstatistics
[0m17:43:14.013071 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m17:43:14.015075 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics 
  
  as (
    select

	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,

	JSONExtractString(_airbyte_data, 'tps') as tps,

	JSONExtractString(_airbyte_data, 'spent') as spent,

	JSONExtractString(_airbyte_data, 'shows') as shows,

	JSONExtractString(_airbyte_data, 'clicks') as clicks,

	JSONExtractString(_airbyte_data, 'base') as base,

	JSONExtractString(_airbyte_data, 'date') as date,

	JSONExtractString(_airbyte_data, 'moat') as moat,

	JSONExtractString(_airbyte_data, 'romi') as romi,

	JSONExtractString(_airbyte_data, 'video') as video,

	JSONExtractString(_airbyte_data, 'events') as events,

	JSONExtractString(_airbyte_data, 'uniques') as uniques,

	JSONExtractString(_airbyte_data, 'carousel') as carousel,

	JSONExtractString(_airbyte_data, 'playable') as playable,

	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,

	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,

	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,

    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,

	JSONExtractString(_airbyte_data, 'load_date') as load_date,

	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,

	toLowCardinality(__table_name) as __table_name,

	toDateTime32(_airbyte_emitted_at) as __emitted_at,

	now() as __normalized_at

from

	(select *,

	'travelata.`_airbyte_raw_banners_statistics``' as __table_name 

	from travelata.`_airbyte_raw_banners_statistics`) x
  )...
[0m17:43:14.062269 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.063579 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-02 17:43:14.010072 => 2023-10-02 17:43:14.063579
[0m17:43:14.064303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8D12890>]}
[0m17:43:14.065302 [info ] [Thread-1 (]: 8 of 10 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.06s]
[0m17:43:14.065302 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m17:43:14.066268 [debug] [Thread-1 (]: Began running node model.travelata.test
[0m17:43:14.066268 [info ] [Thread-1 (]: 9 of 10 START sql view model travelata.test .................................... [RUN]
[0m17:43:14.067268 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.test'
[0m17:43:14.067268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.test)
[0m17:43:14.067268 [debug] [Thread-1 (]: Began compiling node model.travelata.test
[0m17:43:14.069269 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.test"
[0m17:43:14.070269 [debug] [Thread-1 (]: Timing info for model.travelata.test (compile): 2023-10-02 17:43:14.068269 => 2023-10-02 17:43:14.070269
[0m17:43:14.070269 [debug] [Thread-1 (]: Began executing node model.travelata.test
[0m17:43:14.072774 [debug] [Thread-1 (]: Creating new relation test
[0m17:43:14.073779 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.test"
[0m17:43:14.074779 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.test: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )...
[0m17:43:14.119795 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.test"} */


  create view travelata.test 
  
  as (
    --ghjkl
  )
[0m17:43:14.120795 [debug] [Thread-1 (]: Timing info for model.travelata.test (execute): 2023-10-02 17:43:14.071268 => 2023-10-02 17:43:14.120795
[0m17:43:14.122794 [debug] [Thread-1 (]: Database Error in model test (models\1_normalize\test.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
  compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m17:43:14.123759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9AE1890>]}
[0m17:43:14.123759 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model travelata.test ........................... [[31mERROR[0m in 0.06s]
[0m17:43:14.123759 [debug] [Thread-1 (]: Finished running node model.travelata.test
[0m17:43:14.124796 [debug] [Thread-1 (]: Began running node model.travelata.my_second_dbt_model
[0m17:43:14.124796 [info ] [Thread-1 (]: 10 of 10 START sql view model travelata.my_second_dbt_model .................... [RUN]
[0m17:43:14.125795 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.my_second_dbt_model'
[0m17:43:14.125795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.my_second_dbt_model)
[0m17:43:14.126795 [debug] [Thread-1 (]: Began compiling node model.travelata.my_second_dbt_model
[0m17:43:14.128795 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.my_second_dbt_model"
[0m17:43:14.129795 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (compile): 2023-10-02 17:43:14.126795 => 2023-10-02 17:43:14.129795
[0m17:43:14.129795 [debug] [Thread-1 (]: Began executing node model.travelata.my_second_dbt_model
[0m17:43:14.138912 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.my_second_dbt_model"
[0m17:43:14.139918 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */


  create view travelata.my_second_dbt_model__dbt_tmp 
  
  as (
    -- Use the `ref` function to select from other models

select *
from travelata.my_first_dbt_model
where id = 1
  )...
[0m17:43:14.191849 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.199358 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m17:43:14.249061 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.250062 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model to travelata.my_second_dbt_model__dbt_backup 
  
  ...
[0m17:43:14.300131 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.302131 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    drop table if exists travelata.my_second_dbt_model 
  
  ...
[0m17:43:14.348969 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.349970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */

    rename table travelata.my_second_dbt_model__dbt_tmp to travelata.my_second_dbt_model 
  
  ...
[0m17:43:14.399735 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m17:43:14.403737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.my_second_dbt_model"} */
drop table if exists travelata.my_second_dbt_model__dbt_backup 
  ...
[0m17:43:14.449339 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m17:43:14.451340 [debug] [Thread-1 (]: Timing info for model.travelata.my_second_dbt_model (execute): 2023-10-02 17:43:14.129795 => 2023-10-02 17:43:14.451340
[0m17:43:14.451340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15314e20-88fc-404d-affd-afb093f1cadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA9C8FFD0>]}
[0m17:43:14.452340 [info ] [Thread-1 (]: 10 of 10 OK created sql view model travelata.my_second_dbt_model ............... [[32mOK[0m in 0.33s]
[0m17:43:14.452340 [debug] [Thread-1 (]: Finished running node model.travelata.my_second_dbt_model
[0m17:43:14.454340 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:43:14.454340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:14.455340 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m17:43:14.455340 [debug] [MainThread]: On list_schemas: Close
[0m17:43:14.455340 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m17:43:14.456341 [debug] [MainThread]: On list_None_travelata: Close
[0m17:43:14.456341 [debug] [MainThread]: Connection 'model.travelata.my_second_dbt_model' was left open.
[0m17:43:14.456341 [debug] [MainThread]: On model.travelata.my_second_dbt_model: Close
[0m17:43:14.457339 [info ] [MainThread]: 
[0m17:43:14.457339 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m17:43:14.458341 [debug] [MainThread]: Command end result
[0m17:43:14.464342 [info ] [MainThread]: 
[0m17:43:14.465341 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:43:14.466340 [info ] [MainThread]: 
[0m17:43:14.467342 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_events (models\1_normalize\normalized_sheets_appmetrica_events.sql)[0m
[0m17:43:14.467342 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.468342 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_events doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.468342 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_events.sql
[0m17:43:14.469343 [info ] [MainThread]: 
[0m17:43:14.470344 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_install (models\1_normalize\normalized_sheets_appmetrica_install.sql)[0m
[0m17:43:14.470344 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.471345 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_install doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.472342 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_install.sql
[0m17:43:14.473344 [info ] [MainThread]: 
[0m17:43:14.473344 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_appmetrica_profiles (models\1_normalize\normalized_sheets_appmetrica_profiles.sql)[0m
[0m17:43:14.474344 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m17:43:14.475343 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_appmetrica_travelata_profiles doesn't exist. (UNKNOWN_TABLE) (version 23.3.13.6 (official build))
[0m17:43:14.475343 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m17:43:14.476343 [info ] [MainThread]: 
[0m17:43:14.477343 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_utmcraft_utmresult (models\1_normalize\normalized_sheets_utmcraft_utmresult.sql)[0m
[0m17:43:14.477343 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m17:43:14.478344 [error] [MainThread]:    Code: 44. DB::Exception: Cannot add column utm_hashcode: column with this name already exists. (ILLEGAL_COLUMN) (version 23.3.13.6 (official build))
[0m17:43:14.479341 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m17:43:14.480341 [info ] [MainThread]: 
[0m17:43:14.481355 [error] [MainThread]: [33mDatabase Error in model test (models\1_normalize\test.sql)[0m
[0m17:43:14.482343 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m17:43:14.483344 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 188 (')') (line 8, col 3): ). Expected one of: SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with UNION, SELECT subquery, SELECT query, WITH, FROM, SELECT, EXPLAIN. (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m17:43:14.484345 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\test.sql
[0m17:43:14.486347 [info ] [MainThread]: 
[0m17:43:14.487348 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=5 SKIP=0 TOTAL=10
[0m17:43:14.490348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8CFCD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8E05610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA8A5E710>]}
[0m17:43:14.491342 [debug] [MainThread]: Flushing usage events


============================== 2023-10-04 10:57:13.532790 | 3342ba5a-f8eb-427e-9749-fffbdde5af3e ==============================
[0m10:57:13.532790 [info ] [MainThread]: Running with dbt=1.4.8
[0m10:57:13.532790 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:57:13.532790 [debug] [MainThread]: Tracking: tracking
[0m10:57:13.548409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC26D9EE0>]}
[0m10:57:13.564965 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m10:57:13.673615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:13.673615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:13.673615 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m10:57:13.673615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC5A6DEE0>]}
[0m10:57:13.701087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC59B2B20>]}
[0m10:57:13.701087 [info ] [MainThread]: Found 16 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m10:57:13.704603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3342ba5a-f8eb-427e-9749-fffbdde5af3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC59B2D90>]}
[0m10:57:13.704603 [info ] [MainThread]: 
[0m10:57:13.710583 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:57:13.710583 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m10:57:13.724326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:23.005668 [debug] [ThreadPool]: dbt_clickhouse adapter: Got a retryable error when attempting to open a clickhouse connection.
1 attempts remaining. Retrying in 1 seconds.
Error:
Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000025DC6D4F940>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:57:32.113061 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro list_schemas
[0m10:57:32.113061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:32.113061 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m10:57:32.113061 [debug] [MainThread]: On list_schemas: No close available on handle
[0m10:57:32.113061 [info ] [MainThread]: 
[0m10:57:32.113061 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 18.40 seconds (18.40s).
[0m10:57:32.121049 [error] [MainThread]: Encountered an error:
Database Error
  Error HTTPConnectionPool(host='localhost', port=8123): Max retries exceeded with url: /?wait_end_of_query=1 (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x0000025DC6D4FD30>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')) executing HTTP request attempt 1 http://localhost:8123
[0m10:57:32.124066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC5981130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6D4FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6D4FF10>]}
[0m10:57:32.124066 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:51:33.451056 | 84e9acef-1223-43c1-bd0f-8fc7e4ed9539 ==============================
[0m06:51:33.451056 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:51:33.453058 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:51:33.454057 [debug] [MainThread]: Tracking: tracking
[0m06:51:33.466059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126CDB9EE0>]}
[0m06:51:33.483056 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:51:33.590001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:33.590001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:33.592019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:51:33.602012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127013EFD0>]}
[0m06:51:33.614012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127010B0D0>]}
[0m06:51:33.615016 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:51:33.616018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127010B1C0>]}
[0m06:51:33.618008 [info ] [MainThread]: 
[0m06:51:33.621015 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:51:33.624029 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:51:33.644555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:35.656470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:51:35.707009 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:51:35.713008 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:51:35.721015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:36.316804 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:51:36.373474 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:51:36.385472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212701582E0>]}
[0m06:51:36.386470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:51:36.387471 [info ] [MainThread]: 
[0m06:51:36.395054 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.395054 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:51:36.397051 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:51:36.397051 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.402049 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:51:36.404055 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:51:36.398055 => 2023-10-05 06:51:36.403053
[0m06:51:36.404055 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:36.507923 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:51:37.137074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y')) AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:51:37.189195 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y')) AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:51:37.190200 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:51:36.405052 => 2023-10-05 06:51:37.190200
[0m06:51:37.201510 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 62. DB::Exception: Syntax error: failed at position 533 (')') (line 21, col 5): )
          . Unmatched parentheses: ). (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m06:51:37.202512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e9acef-1223-43c1-bd0f-8fc7e4ed9539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127142FC40>]}
[0m06:51:37.203515 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.81s]
[0m06:51:37.206512 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:51:37.209510 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:51:37.210509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:37.210509 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:51:37.211509 [debug] [MainThread]: On list_schemas: Close
[0m06:51:37.211509 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:51:37.211509 [debug] [MainThread]: On list_None_travelata: Close
[0m06:51:37.212512 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:51:37.212512 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:51:37.213511 [info ] [MainThread]: 
[0m06:51:37.213511 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m06:51:37.214512 [debug] [MainThread]: Command end result
[0m06:51:37.224514 [info ] [MainThread]: 
[0m06:51:37.225515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:51:37.226515 [info ] [MainThread]: 
[0m06:51:37.227515 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:51:37.228512 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m06:51:37.229513 [error] [MainThread]:    Code: 62. DB::Exception: Syntax error: failed at position 533 (')') (line 21, col 5): )
[0m06:51:37.230512 [error] [MainThread]:           . Unmatched parentheses: ). (SYNTAX_ERROR) (version 23.3.13.6 (official build))
[0m06:51:37.231513 [info ] [MainThread]: 
[0m06:51:37.231513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:51:37.233525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212701582E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212714C13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127012D910>]}
[0m06:51:37.234511 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:52:01.824682 | 0f428723-f7f1-43c6-942a-ea298885d33a ==============================
[0m06:52:01.824682 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:52:01.827557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:52:01.827557 [debug] [MainThread]: Tracking: tracking
[0m06:52:01.843119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFBF79F70>]}
[0m06:52:01.870684 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:52:01.996037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:52:01.997026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:52:01.999025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:52:02.012035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF30E0D0>]}
[0m06:52:02.025026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2DB100>]}
[0m06:52:02.026029 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:52:02.028024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2DB1F0>]}
[0m06:52:02.030019 [info ] [MainThread]: 
[0m06:52:02.033030 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:52:02.034034 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:52:02.053023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:03.457041 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:52:03.507914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:52:03.512914 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:52:03.521914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:52:04.126789 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:52:04.189149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:52:04.198679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF328310>]}
[0m06:52:04.200679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:52:04.201676 [info ] [MainThread]: 
[0m06:52:04.211227 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.213226 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:52:04.216226 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:52:04.217229 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.224923 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:52:04.227928 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:52:04.218225 => 2023-10-05 06:52:04.227928
[0m06:52:04.229919 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:04.372271 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:52:04.956663 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:52:05.023590 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (roDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:52:05.024586 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:52:04.231442 => 2023-10-05 06:52:05.024586
[0m06:52:05.034118 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:52:05.035119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f428723-f7f1-43c6-942a-ea298885d33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E805EFEB0>]}
[0m06:52:05.036117 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.82s]
[0m06:52:05.039116 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:52:05.040663 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:52:05.041676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:52:05.042676 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:52:05.043677 [debug] [MainThread]: On list_schemas: Close
[0m06:52:05.043677 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:52:05.044671 [debug] [MainThread]: On list_None_travelata: Close
[0m06:52:05.044671 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:52:05.045674 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:52:05.046675 [info ] [MainThread]: 
[0m06:52:05.048679 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m06:52:05.050675 [debug] [MainThread]: Command end result
[0m06:52:05.061945 [info ] [MainThread]: 
[0m06:52:05.062953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:52:05.064946 [info ] [MainThread]: 
[0m06:52:05.066946 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:52:05.067944 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m06:52:05.069950 [error] [MainThread]:    Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:52:05.071971 [info ] [MainThread]: 
[0m06:52:05.074016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:52:05.075029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF2FDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF328310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E806EDFA0>]}
[0m06:52:05.076028 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:53:46.109938 | 9a1c51fc-24dc-4cdc-917b-9da3e0a875eb ==============================
[0m06:53:46.109938 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:53:46.111942 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['incremental_sheets_appmetrica_events'], 'which': 'test', 'rpc_method': 'test'}
[0m06:53:46.111942 [debug] [MainThread]: Tracking: tracking
[0m06:53:46.127279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCC4DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCC4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE8CCD45B0>]}
[0m06:53:46.148781 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:53:46.285321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:46.285321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:46.287310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:53:46.296307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89CDE0D0>]}
[0m06:53:46.309317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A250>]}
[0m06:53:46.310315 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:53:46.311311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1c51fc-24dc-4cdc-917b-9da3e0a875eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A4C0>]}
[0m06:53:46.312313 [info ] [MainThread]: 
[0m06:53:46.314317 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:53:46.316312 [debug] [MainThread]: Command end result
[0m06:53:46.330332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE89C1A1C0>]}
[0m06:53:46.331331 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:53:56.364768 | 59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc ==============================
[0m06:53:56.364768 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:53:56.366765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['incremental_sheets_appmetrica_events.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:53:56.367766 [debug] [MainThread]: Tracking: tracking
[0m06:53:56.378765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711E559EE0>]}
[0m06:53:56.396770 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:53:56.504160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:56.505160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:56.506158 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:53:56.518155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218DEFD0>]}
[0m06:53:56.530159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218080D0>]}
[0m06:53:56.531168 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:53:56.532164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218081C0>]}
[0m06:53:56.535162 [info ] [MainThread]: 
[0m06:53:56.539178 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:53:56.541180 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:53:56.557706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:57.827035 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:53:57.877592 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:53:57.882596 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:53:57.891589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:58.486948 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:53:58.540085 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:53:58.552080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218F92E0>]}
[0m06:53:58.553594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:53:58.554126 [info ] [MainThread]: 
[0m06:53:58.561162 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.561162 [info ] [Thread-1  ]: 1 of 1 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m06:53:58.563156 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m06:53:58.564153 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.569162 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m06:53:58.570159 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 06:53:58.564153 => 2023-10-05 06:53:58.570159
[0m06:53:58.571151 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:58.690868 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:53:59.316242 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m06:53:59.377543 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        
[0m06:53:59.378541 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 06:53:58.572163 => 2023-10-05 06:53:59.378541
[0m06:53:59.385192 [debug] [Thread-1  ]: Database Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)
  :HTTPDriver for http://localhost:8123 returned response code 500)
   Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:53:59.386211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f8dadf-2f04-45d3-8b4c-7e4b6d67a4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122D0C9A0>]}
[0m06:53:59.387210 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_events  [[31mERROR[0m in 0.82s]
[0m06:53:59.390205 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m06:53:59.393211 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:53:59.394205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:59.395218 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:53:59.396210 [debug] [MainThread]: On list_schemas: Close
[0m06:53:59.396210 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:53:59.397213 [debug] [MainThread]: On list_None_travelata: Close
[0m06:53:59.398212 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_events' was left open.
[0m06:53:59.399210 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_events: Close
[0m06:53:59.399210 [info ] [MainThread]: 
[0m06:53:59.401209 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m06:53:59.403219 [debug] [MainThread]: Command end result
[0m06:53:59.412210 [info ] [MainThread]: 
[0m06:53:59.414212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:53:59.416213 [info ] [MainThread]: 
[0m06:53:59.417208 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_events (models\2_incremental\incremental_sheets_appmetrica_events.sql)[0m
[0m06:53:59.418209 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 500)
[0m06:53:59.419216 [error] [MainThread]:    Code: 43. DB::Exception: Illegal type DateTime('UTC') of first argument of function parseDateTime. Should be String: While processing parseDateTime(__datetime, '%d.%m.%Y') AS __datetime, event_datetime, event_json, event_name, installation_id, appmetrica_device_id, city, google_aid, os_name, profile_id, session_id, app_version_name, ios_ifa, __emitted_at, __table_name, __normalized_at. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.3.13.6 (official build))
[0m06:53:59.421211 [info ] [MainThread]: 
[0m06:53:59.423209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:53:59.424209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017122C80880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218A2F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171218CD910>]}
[0m06:53:59.424209 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 06:57:31.627371 | c6770c30-dfd0-48f3-8ecd-922446683774 ==============================
[0m06:57:31.627371 [info ] [MainThread]: Running with dbt=1.4.8
[0m06:57:31.630366 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:57:31.631372 [debug] [MainThread]: Tracking: tracking
[0m06:57:31.643383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E5219E80>]}
[0m06:57:31.660895 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m06:57:31.771737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:57:31.771737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:57:31.772744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m06:57:31.783258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E859EFA0>]}
[0m06:57:31.795265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E856B0A0>]}
[0m06:57:31.796277 [info ] [MainThread]: Found 17 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:57:31.798265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E856B190>]}
[0m06:57:31.804268 [info ] [MainThread]: 
[0m06:57:31.809797 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:57:31.813886 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m06:57:31.829928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:33.136265 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m06:57:33.187860 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:33.192861 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m06:57:33.201867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:57:33.786500 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m06:57:33.839300 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:33.851806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E85B84C0>]}
[0m06:57:33.852810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:57:33.853809 [info ] [MainThread]: 
[0m06:57:33.861066 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.861066 [info ] [Thread-1  ]: 1 of 17 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m06:57:33.863067 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m06:57:33.864071 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.866064 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m06:57:33.868075 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 06:57:33.864071 => 2023-10-05 06:57:33.867063
[0m06:57:33.868075 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:33.925076 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m06:57:33.926081 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m06:57:34.506253 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m06:57:34.566419 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:34.577578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m06:57:34.626378 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.628378 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m06:57:34.676751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.681752 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m06:57:34.735872 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.737874 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m06:57:34.786459 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.826025 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m06:57:34.876208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:34.878216 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 06:57:33.869068 => 2023-10-05 06:57:34.878216
[0m06:57:34.880211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3EB0>]}
[0m06:57:34.881212 [info ] [Thread-1  ]: 1 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m06:57:34.884210 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m06:57:34.885219 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.886207 [info ] [Thread-1  ]: 2 of 17 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m06:57:34.888203 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m06:57:34.889207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m06:57:34.889207 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.892749 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m06:57:34.894750 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 06:57:34.890207 => 2023-10-05 06:57:34.894750
[0m06:57:34.895753 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:34.902866 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m06:57:34.904749 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
parseDateTime(JSONExtractString(_airbyte_data, 'event_datetime'), '%d.%m.%Y') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m06:57:34.963428 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:34.968432 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m06:57:35.015990 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.018002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m06:57:35.065979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.070502 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m06:57:35.126572 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.127567 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m06:57:35.186132 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.193646 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m06:57:35.246706 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.249265 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 06:57:34.895753 => 2023-10-05 06:57:35.249265
[0m06:57:35.251289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3DF0>]}
[0m06:57:35.252283 [info ] [Thread-1  ]: 2 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m06:57:35.254288 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m06:57:35.255286 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.256302 [info ] [Thread-1  ]: 3 of 17 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m06:57:35.258291 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m06:57:35.259294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m06:57:35.260287 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.263306 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m06:57:35.266280 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 06:57:35.260287 => 2023-10-05 06:57:35.265285
[0m06:57:35.267297 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.278844 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m06:57:35.281838 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m06:57:35.344435 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.350060 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m06:57:35.397090 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.399099 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m06:57:35.456736 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.462304 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m06:57:35.527273 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.529274 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m06:57:35.577056 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.588646 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m06:57:35.636446 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.639449 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 06:57:35.268290 => 2023-10-05 06:57:35.639449
[0m06:57:35.641456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3EB0>]}
[0m06:57:35.642450 [info ] [Thread-1  ]: 3 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.38s]
[0m06:57:35.644450 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m06:57:35.645449 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.646448 [info ] [Thread-1  ]: 4 of 17 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m06:57:35.648453 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m06:57:35.650135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m06:57:35.650999 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.654998 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m06:57:35.656566 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 06:57:35.650999 => 2023-10-05 06:57:35.656566
[0m06:57:35.657544 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:35.669549 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m06:57:35.671543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m06:57:35.732724 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.738731 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m06:57:35.796555 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:35.798557 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m06:57:35.847151 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.852689 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m06:57:35.906012 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.908005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m06:57:35.956290 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:35.964287 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m06:57:36.016375 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.018375 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 06:57:35.658545 => 2023-10-05 06:57:36.018375
[0m06:57:36.020378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AAC850>]}
[0m06:57:36.021375 [info ] [Thread-1  ]: 4 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.37s]
[0m06:57:36.022377 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m06:57:36.023372 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.024372 [info ] [Thread-1  ]: 5 of 17 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m06:57:36.026380 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m06:57:36.026380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m06:57:36.027370 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.030370 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m06:57:36.032372 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 06:57:36.027370 => 2023-10-05 06:57:36.032372
[0m06:57:36.032372 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.038381 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m06:57:36.040389 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m06:57:36.101201 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.105051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m06:57:36.166235 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.169236 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m06:57:36.216328 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.222323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m06:57:36.276261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.278263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m06:57:36.325868 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.332855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m06:57:36.387084 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.389080 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 06:57:36.033375 => 2023-10-05 06:57:36.389080
[0m06:57:36.390088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AE0A90>]}
[0m06:57:36.391089 [info ] [Thread-1  ]: 5 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m06:57:36.393086 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m06:57:36.393086 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.394084 [info ] [Thread-1  ]: 6 of 17 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m06:57:36.396081 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m06:57:36.397084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m06:57:36.397084 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.400090 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m06:57:36.401081 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 06:57:36.398087 => 2023-10-05 06:57:36.401081
[0m06:57:36.402082 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.409083 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m06:57:36.411089 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m06:57:36.459648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.465653 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m06:57:36.526262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.528263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m06:57:36.576138 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.581127 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m06:57:36.626223 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:36.628217 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m06:57:36.687158 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:36.695171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m06:57:36.746692 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.748686 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 06:57:36.402082 => 2023-10-05 06:57:36.748686
[0m06:57:36.750199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99A3D60>]}
[0m06:57:36.751208 [info ] [Thread-1  ]: 6 of 17 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.35s]
[0m06:57:36.752212 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m06:57:36.753216 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.754460 [info ] [Thread-1  ]: 7 of 17 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m06:57:36.756215 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m06:57:36.756215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m06:57:36.757210 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.759207 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m06:57:36.760211 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 06:57:36.757210 => 2023-10-05 06:57:36.760211
[0m06:57:36.761220 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:36.766734 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m06:57:36.767733 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m06:57:36.819581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.825585 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m06:57:36.876244 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.878244 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m06:57:36.926420 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:36.931415 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m06:57:36.976787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:36.978785 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m06:57:37.036012 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.043003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m06:57:37.096124 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.099115 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 06:57:36.761220 => 2023-10-05 06:57:37.099115
[0m06:57:37.100122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9A91310>]}
[0m06:57:37.101116 [info ] [Thread-1  ]: 7 of 17 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.34s]
[0m06:57:37.103126 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m06:57:37.104125 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.105122 [info ] [Thread-1  ]: 8 of 17 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m06:57:37.107121 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m06:57:37.108120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m06:57:37.108120 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.111123 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m06:57:37.112118 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 06:57:37.109123 => 2023-10-05 06:57:37.112118
[0m06:57:37.113121 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.123120 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m06:57:37.125641 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m06:57:37.181786 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.186777 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m06:57:37.236952 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.238952 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m06:57:37.287112 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.292109 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m06:57:37.336723 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:37.337718 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m06:57:37.386271 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.393266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m06:57:37.447257 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.449251 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 06:57:37.113121 => 2023-10-05 06:57:37.449251
[0m06:57:37.450256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9A26370>]}
[0m06:57:37.451322 [info ] [Thread-1  ]: 8 of 17 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.34s]
[0m06:57:37.453325 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m06:57:37.453325 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.454318 [info ] [Thread-1  ]: 9 of 17 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m06:57:37.456323 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m06:57:37.457323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m06:57:37.457323 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.460321 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m06:57:37.462323 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 06:57:37.458323 => 2023-10-05 06:57:37.461320
[0m06:57:37.462323 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.469327 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m06:57:37.471322 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m06:57:37.531063 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.536074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m06:57:37.596001 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:37.598001 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m06:57:37.646147 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.650647 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m06:57:37.705593 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.707601 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m06:57:37.756715 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.763711 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m06:57:37.816867 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.818857 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 06:57:37.463332 => 2023-10-05 06:57:37.818857
[0m06:57:37.821376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9ACBBB0>]}
[0m06:57:37.821376 [info ] [Thread-1  ]: 9 of 17 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.36s]
[0m06:57:37.823379 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m06:57:37.824378 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.825375 [info ] [Thread-1  ]: 10 of 17 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m06:57:37.827377 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m06:57:37.827377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m06:57:37.828371 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.830372 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m06:57:37.831377 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 06:57:37.828371 => 2023-10-05 06:57:37.831377
[0m06:57:37.832375 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:37.839378 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m06:57:37.840385 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m06:57:37.891896 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.895895 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m06:57:37.946409 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:37.947404 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m06:57:38.005916 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.010915 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m06:57:38.056453 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:38.058452 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m06:57:38.106118 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.113116 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m06:57:38.166633 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.168632 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 06:57:37.832375 => 2023-10-05 06:57:38.168632
[0m06:57:38.170635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AEDF70>]}
[0m06:57:38.171633 [info ] [Thread-1  ]: 10 of 17 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.34s]
[0m06:57:38.172630 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m06:57:38.173633 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.174627 [info ] [Thread-1  ]: 11 of 17 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m06:57:38.176631 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m06:57:38.176631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m06:57:38.177627 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.179628 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m06:57:38.181630 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 06:57:38.177627 => 2023-10-05 06:57:38.181630
[0m06:57:38.181630 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.188636 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m06:57:38.189628 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m06:57:38.242524 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.246533 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m06:57:38.296080 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.299070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m06:57:38.346193 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.351690 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m06:57:38.395740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:38.397729 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m06:57:38.445677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.453194 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m06:57:38.507261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.509256 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 06:57:38.182632 => 2023-10-05 06:57:38.509256
[0m06:57:38.511265 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B1A8E0>]}
[0m06:57:38.512263 [info ] [Thread-1  ]: 11 of 17 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.34s]
[0m06:57:38.513258 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m06:57:38.514257 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.515263 [info ] [Thread-1  ]: 12 of 17 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m06:57:38.517264 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m06:57:38.517264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m06:57:38.518262 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.521256 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m06:57:38.523260 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 06:57:38.518262 => 2023-10-05 06:57:38.523260
[0m06:57:38.523260 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.531264 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m06:57:38.532262 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m06:57:38.603294 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:57:38.608291 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m06:57:38.666411 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.668412 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m06:57:38.725857 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.731852 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m06:57:38.796262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.798260 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m06:57:38.846402 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:38.852924 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m06:57:38.915935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:38.918944 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 06:57:38.524263 => 2023-10-05 06:57:38.918944
[0m06:57:38.919940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AD85E0>]}
[0m06:57:38.920939 [info ] [Thread-1  ]: 12 of 17 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.40s]
[0m06:57:38.921937 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m06:57:38.922942 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.923939 [info ] [Thread-1  ]: 13 of 17 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m06:57:38.925940 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m06:57:38.926938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m06:57:38.926938 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.929945 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m06:57:38.930955 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 06:57:38.927939 => 2023-10-05 06:57:38.930955
[0m06:57:38.931952 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:38.938971 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m06:57:38.940972 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m06:57:39.004020 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.008015 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m06:57:39.056545 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.058546 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m06:57:39.106607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.111600 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m06:57:39.155962 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.157951 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m06:57:39.216831 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.222830 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m06:57:39.276274 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.279266 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 06:57:38.931952 => 2023-10-05 06:57:39.278270
[0m06:57:39.280268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B25610>]}
[0m06:57:39.281270 [info ] [Thread-1  ]: 13 of 17 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.36s]
[0m06:57:39.282264 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m06:57:39.283268 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.284264 [info ] [Thread-1  ]: 14 of 17 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m06:57:39.286268 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m06:57:39.286268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m06:57:39.287265 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.289263 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m06:57:39.290265 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 06:57:39.287265 => 2023-10-05 06:57:39.290265
[0m06:57:39.291268 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.302274 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m06:57:39.304267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m06:57:39.361386 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.366384 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m06:57:39.426042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.428042 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m06:57:39.476028 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.481681 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m06:57:39.525821 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.527820 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m06:57:39.576607 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.583605 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m06:57:39.635997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:39.639001 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 06:57:39.291268 => 2023-10-05 06:57:39.639001
[0m06:57:39.640009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B255B0>]}
[0m06:57:39.641008 [info ] [Thread-1  ]: 14 of 17 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m06:57:39.643008 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m06:57:39.644008 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.644008 [info ] [Thread-1  ]: 15 of 17 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m06:57:39.646008 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m06:57:39.647006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m06:57:39.647006 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.650006 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m06:57:39.652009 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 06:57:39.648005 => 2023-10-05 06:57:39.652009
[0m06:57:39.652526 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:39.660545 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m06:57:39.662542 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m06:57:39.731108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m06:57:39.737099 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m06:57:39.796296 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.798295 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m06:57:39.856123 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.861122 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m06:57:39.906269 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m06:57:39.908261 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m06:57:39.966557 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:39.972552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m06:57:40.026019 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.029020 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 06:57:39.653547 => 2023-10-05 06:57:40.029020
[0m06:57:40.030026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EAB496D0>]}
[0m06:57:40.031024 [info ] [Thread-1  ]: 15 of 17 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.38s]
[0m06:57:40.033021 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m06:57:40.033021 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.034019 [info ] [Thread-1  ]: 16 of 17 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m06:57:40.036014 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m06:57:40.037012 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m06:57:40.037012 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.040020 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m06:57:40.041024 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 06:57:40.038020 => 2023-10-05 06:57:40.041024
[0m06:57:40.042025 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.049027 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m06:57:40.052026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m06:57:40.100877 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.105879 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m06:57:40.166471 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.168471 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m06:57:40.216785 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.221779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m06:57:40.276265 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.278265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m06:57:40.326275 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.333273 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m06:57:40.386685 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.388680 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 06:57:40.043026 => 2023-10-05 06:57:40.388680
[0m06:57:40.389685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99DD7C0>]}
[0m06:57:40.390686 [info ] [Thread-1  ]: 16 of 17 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.35s]
[0m06:57:40.392677 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m06:57:40.393677 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.394676 [info ] [Thread-1  ]: 17 of 17 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m06:57:40.395675 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m06:57:40.396677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m06:57:40.397676 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.402681 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m06:57:40.404675 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 06:57:40.397676 => 2023-10-05 06:57:40.404675
[0m06:57:40.404675 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.485860 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m06:57:40.546569 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.559090 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m06:57:40.607490 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m06:57:40.614485 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m06:57:40.616492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
    ...
[0m06:57:40.676108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m06:57:40.684812 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 06:57:40.405688 => 2023-10-05 06:57:40.684812
[0m06:57:40.685825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6770c30-dfd0-48f3-8ecd-922446683774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9AF3A00>]}
[0m06:57:40.686825 [info ] [Thread-1  ]: 17 of 17 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.29s]
[0m06:57:40.688824 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m06:57:40.690992 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:57:40.692063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:57:40.692604 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m06:57:40.693144 [debug] [MainThread]: On list_schemas: Close
[0m06:57:40.693699 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m06:57:40.694243 [debug] [MainThread]: On list_None_travelata: Close
[0m06:57:40.694779 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_install' was left open.
[0m06:57:40.695313 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_install: Close
[0m06:57:40.695849 [info ] [MainThread]: 
[0m06:57:40.697719 [info ] [MainThread]: Finished running 16 view models, 1 incremental model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m06:57:40.699941 [debug] [MainThread]: Command end result
[0m06:57:40.710802 [info ] [MainThread]: 
[0m06:57:40.711803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:57:40.713812 [info ] [MainThread]: 
[0m06:57:40.714805 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m06:57:40.717171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E99416D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9941670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8E9B04FD0>]}
[0m06:57:40.718278 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 07:00:40.302289 | f1f6ed44-9c69-4572-a09e-c15a3eb298c3 ==============================
[0m07:00:40.302289 [info ] [MainThread]: Running with dbt=1.4.8
[0m07:00:40.304293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:00:40.305294 [debug] [MainThread]: Tracking: tracking
[0m07:00:40.316294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020084EB7EE0>]}
[0m07:00:40.334291 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m07:00:40.444134 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:00:40.445135 [debug] [MainThread]: Partial parsing: added file: travelata://models\2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.445135 [debug] [MainThread]: Partial parsing: deleted file: travelata://models\2_incremental\incremental.sql
[0m07:00:40.474141 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.498216 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m07:00:40.507218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m07:00:40.516217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200882FB0D0>]}
[0m07:00:40.529233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200881C9670>]}
[0m07:00:40.530224 [info ] [MainThread]: Found 18 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:00:40.531223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020088222D00>]}
[0m07:00:40.534225 [info ] [MainThread]: 
[0m07:00:40.539216 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:00:40.542215 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m07:00:40.559221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:41.885217 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m07:00:41.937181 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:41.942165 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m07:00:41.950167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:42.535904 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m07:00:42.588621 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:42.600623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200882F0370>]}
[0m07:00:42.601632 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:42.602629 [info ] [MainThread]: 
[0m07:00:42.620616 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.621619 [info ] [Thread-1  ]: 1 of 18 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m07:00:42.624629 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m07:00:42.625622 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.630628 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:00:42.632628 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 07:00:42.626625 => 2023-10-05 07:00:42.632628
[0m07:00:42.633628 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:42.698708 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:00:42.699715 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:00:43.265889 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m07:00:43.320492 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.331491 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:00:43.376882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.378885 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:00:43.426279 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:43.431276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:00:43.485753 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.487752 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:00:43.535364 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.573883 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m07:00:43.636138 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:43.638131 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 07:00:42.634621 => 2023-10-05 07:00:43.638131
[0m07:00:43.639135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008971AAC0>]}
[0m07:00:43.639135 [info ] [Thread-1  ]: 1 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.02s]
[0m07:00:43.643137 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:00:43.644137 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.645136 [info ] [Thread-1  ]: 2 of 18 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m07:00:43.646136 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m07:00:43.647142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m07:00:43.648140 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.650652 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:00:43.651666 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 07:00:43.648140 => 2023-10-05 07:00:43.651666
[0m07:00:43.652664 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:43.662664 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:00:43.663660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m07:00:43.730293 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:43.735289 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:00:43.786502 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.788496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:00:43.835772 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.841765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:00:43.895768 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.898770 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:00:43.945768 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:43.953765 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m07:00:44.006211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.008212 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 07:00:43.653664 => 2023-10-05 07:00:44.008212
[0m07:00:44.010213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089715BE0>]}
[0m07:00:44.010213 [info ] [Thread-1  ]: 2 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m07:00:44.012161 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m07:00:44.013178 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.013178 [info ] [Thread-1  ]: 3 of 18 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m07:00:44.016174 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m07:00:44.016174 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m07:00:44.017172 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.019169 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:00:44.020170 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 07:00:44.017172 => 2023-10-05 07:00:44.020170
[0m07:00:44.021172 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.027172 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:00:44.029186 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m07:00:44.083262 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.087266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:00:44.135609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.137609 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:00:44.185444 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.191432 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:00:44.255707 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.258713 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:00:44.316382 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.323377 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m07:00:44.386365 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.388355 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 07:00:44.021172 => 2023-10-05 07:00:44.388355
[0m07:00:44.389361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089688EB0>]}
[0m07:00:44.390360 [info ] [Thread-1  ]: 3 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.37s]
[0m07:00:44.392358 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m07:00:44.393360 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.394360 [info ] [Thread-1  ]: 4 of 18 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m07:00:44.395361 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m07:00:44.396360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m07:00:44.397515 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.399376 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:00:44.401364 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 07:00:44.397515 => 2023-10-05 07:00:44.401364
[0m07:00:44.402364 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.409901 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:00:44.411900 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m07:00:44.469863 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.475863 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:00:44.525810 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.527797 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:00:44.576202 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.582804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:00:44.635977 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.637980 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:00:44.695629 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:44.702617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m07:00:44.756021 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.758023 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 07:00:44.403364 => 2023-10-05 07:00:44.758023
[0m07:00:44.759017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089794820>]}
[0m07:00:44.760018 [info ] [Thread-1  ]: 4 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.36s]
[0m07:00:44.761018 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:00:44.762022 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.763023 [info ] [Thread-1  ]: 5 of 18 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m07:00:44.764019 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m07:00:44.765536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m07:00:44.765536 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.768545 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:00:44.769545 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 07:00:44.766549 => 2023-10-05 07:00:44.769545
[0m07:00:44.770549 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:44.779551 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:00:44.781065 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m07:00:44.830777 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.836780 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:00:44.885142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.888133 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:00:44.936218 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.941213 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:00:44.995296 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:44.997293 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:00:45.055320 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.062316 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m07:00:45.118451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.120450 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 07:00:44.771558 => 2023-10-05 07:00:45.120450
[0m07:00:45.121451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895B18B0>]}
[0m07:00:45.122451 [info ] [Thread-1  ]: 5 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m07:00:45.124454 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:00:45.124454 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.125449 [info ] [Thread-1  ]: 6 of 18 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m07:00:45.127454 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m07:00:45.128451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m07:00:45.128451 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.131459 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:00:45.133469 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 07:00:45.129450 => 2023-10-05 07:00:45.133469
[0m07:00:45.135452 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.145445 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:00:45.146449 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m07:00:45.199765 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.204767 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:00:45.256030 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.258024 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:00:45.305727 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.310721 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:00:45.355836 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:45.357829 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:00:45.405892 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.413890 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m07:00:45.466056 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.468063 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 07:00:45.135452 => 2023-10-05 07:00:45.468063
[0m07:00:45.470069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200897D2340>]}
[0m07:00:45.470069 [info ] [Thread-1  ]: 6 of 18 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.34s]
[0m07:00:45.472067 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:00:45.472067 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.473067 [info ] [Thread-1  ]: 7 of 18 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m07:00:45.475070 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m07:00:45.476067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m07:00:45.477071 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.481575 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:00:45.482587 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 07:00:45.477071 => 2023-10-05 07:00:45.482587
[0m07:00:45.482587 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.489101 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:00:45.490104 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m07:00:45.542274 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.546265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:00:45.596792 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.598788 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:00:45.645866 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.650865 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:00:45.705558 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.707554 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:00:45.765632 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.772147 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m07:00:45.835653 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.838647 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 07:00:45.483590 => 2023-10-05 07:00:45.838647
[0m07:00:45.839651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200897A7FD0>]}
[0m07:00:45.840654 [info ] [Thread-1  ]: 7 of 18 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.36s]
[0m07:00:45.842655 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:00:45.843654 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.844652 [info ] [Thread-1  ]: 8 of 18 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m07:00:45.845654 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m07:00:45.846648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m07:00:45.847651 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.849648 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:00:45.851652 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 07:00:45.847651 => 2023-10-05 07:00:45.851652
[0m07:00:45.851652 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:45.858661 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:00:45.860660 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m07:00:45.920086 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:45.924082 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:00:45.976168 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:45.978166 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:00:46.035441 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.040435 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:00:46.096042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.098035 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:00:46.156049 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.165042 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m07:00:46.215569 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.217582 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 07:00:45.852652 => 2023-10-05 07:00:46.217582
[0m07:00:46.219575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008966BDF0>]}
[0m07:00:46.219575 [info ] [Thread-1  ]: 8 of 18 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.37s]
[0m07:00:46.221574 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:00:46.222575 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.222575 [info ] [Thread-1  ]: 9 of 18 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m07:00:46.224570 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m07:00:46.225572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m07:00:46.225572 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.228572 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:00:46.229571 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 07:00:46.226574 => 2023-10-05 07:00:46.229571
[0m07:00:46.230570 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.236568 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:00:46.238570 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m07:00:46.290095 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.294096 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:00:46.346300 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.348298 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:00:46.395523 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.400520 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:00:46.445407 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:46.447403 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:00:46.505264 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.513267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m07:00:46.575756 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:46.577751 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 07:00:46.230570 => 2023-10-05 07:00:46.577751
[0m07:00:46.579756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008966BF70>]}
[0m07:00:46.579756 [info ] [Thread-1  ]: 9 of 18 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.36s]
[0m07:00:46.582285 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:00:46.582801 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.583809 [info ] [Thread-1  ]: 10 of 18 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m07:00:46.585815 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m07:00:46.585815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m07:00:46.586809 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.589824 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:00:46.591820 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 07:00:46.587812 => 2023-10-05 07:00:46.590821
[0m07:00:46.591820 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.598813 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:00:46.600816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m07:00:46.651258 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.657261 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:00:46.705404 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.707402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:00:46.755426 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.760409 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:00:46.806446 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.808445 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:00:46.856511 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.862499 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m07:00:46.915725 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:46.917720 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 07:00:46.592818 => 2023-10-05 07:00:46.917720
[0m07:00:46.919727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089812E80>]}
[0m07:00:46.919727 [info ] [Thread-1  ]: 10 of 18 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.33s]
[0m07:00:46.921723 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:00:46.922725 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.922725 [info ] [Thread-1  ]: 11 of 18 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m07:00:46.924732 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m07:00:46.925727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m07:00:46.926724 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.929720 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:00:46.930728 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 07:00:46.926724 => 2023-10-05 07:00:46.930728
[0m07:00:46.930728 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:46.940719 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:00:46.943728 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m07:00:47.010540 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:47.015537 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:00:47.065541 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.067539 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:00:47.125155 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.130158 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:00:47.185751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.187744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:00:47.236794 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.249796 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m07:00:47.306348 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.309349 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 07:00:46.931723 => 2023-10-05 07:00:47.309349
[0m07:00:47.311364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008974B2B0>]}
[0m07:00:47.313357 [info ] [Thread-1  ]: 11 of 18 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.39s]
[0m07:00:47.315353 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:00:47.316358 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.317356 [info ] [Thread-1  ]: 12 of 18 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m07:00:47.320346 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m07:00:47.321352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m07:00:47.322356 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.326365 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:00:47.328354 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 07:00:47.323362 => 2023-10-05 07:00:47.327353
[0m07:00:47.328354 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.343988 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:00:47.345006 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m07:00:47.401825 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.408831 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:00:47.465829 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.466825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:00:47.515936 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.520937 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:00:47.575526 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.578026 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:00:47.625642 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.633632 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m07:00:47.696888 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.699875 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 07:00:47.329358 => 2023-10-05 07:00:47.699875
[0m07:00:47.701881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089772F40>]}
[0m07:00:47.701881 [info ] [Thread-1  ]: 12 of 18 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.38s]
[0m07:00:47.703882 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:00:47.704882 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.705881 [info ] [Thread-1  ]: 13 of 18 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m07:00:47.706884 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m07:00:47.707878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m07:00:47.708881 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.711885 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:00:47.712886 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 07:00:47.709883 => 2023-10-05 07:00:47.712886
[0m07:00:47.713880 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:47.719874 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:00:47.721875 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m07:00:47.781808 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:47.786322 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:00:47.835941 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.837940 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:00:47.886076 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:47.891074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:00:47.935082 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:47.937070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:00:47.995935 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.002928 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m07:00:48.055534 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.057531 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 07:00:47.714880 => 2023-10-05 07:00:48.057531
[0m07:00:48.059533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089825790>]}
[0m07:00:48.060531 [info ] [Thread-1  ]: 13 of 18 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.35s]
[0m07:00:48.062537 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:00:48.062537 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.063531 [info ] [Thread-1  ]: 14 of 18 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m07:00:48.065539 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m07:00:48.066534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m07:00:48.067535 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.070547 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:00:48.071541 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 07:00:48.067535 => 2023-10-05 07:00:48.071541
[0m07:00:48.072547 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.149077 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:00:48.151074 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m07:00:48.200136 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.206129 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:00:48.265655 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.267649 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:00:48.316191 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.320188 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:00:48.366193 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:48.368188 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:00:48.415523 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.422516 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m07:00:48.475817 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.478823 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 07:00:48.073548 => 2023-10-05 07:00:48.477822
[0m07:00:48.479822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008982B490>]}
[0m07:00:48.480819 [info ] [Thread-1  ]: 14 of 18 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.41s]
[0m07:00:48.482816 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:00:48.482816 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.484326 [info ] [Thread-1  ]: 15 of 18 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m07:00:48.485337 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m07:00:48.486651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m07:00:48.486651 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.489647 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:00:48.490653 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 07:00:48.487652 => 2023-10-05 07:00:48.490653
[0m07:00:48.491654 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.498659 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:00:48.500654 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m07:00:48.549616 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.554617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:00:48.606002 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.607999 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:00:48.656100 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.660097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:00:48.705576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:48.707570 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:00:48.755882 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.763737 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m07:00:48.815814 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.818814 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 07:00:48.492655 => 2023-10-05 07:00:48.818814
[0m07:00:48.819812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008979E7F0>]}
[0m07:00:48.820816 [info ] [Thread-1  ]: 15 of 18 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.33s]
[0m07:00:48.822819 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:00:48.822819 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.823816 [info ] [Thread-1  ]: 16 of 18 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m07:00:48.825819 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m07:00:48.825819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m07:00:48.826812 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.828814 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:00:48.829810 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 07:00:48.826812 => 2023-10-05 07:00:48.829810
[0m07:00:48.830815 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m07:00:48.838818 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:00:48.840825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m07:00:48.905142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:48.912143 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:00:48.966134 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:48.969145 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:00:49.015694 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.022693 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:00:49.075702 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.077699 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:00:49.126226 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.141223 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m07:00:49.195472 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.198477 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 07:00:48.830815 => 2023-10-05 07:00:49.198477
[0m07:00:49.199474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008979EEB0>]}
[0m07:00:49.200473 [info ] [Thread-1  ]: 16 of 18 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.37s]
[0m07:00:49.202474 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m07:00:49.203475 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.204472 [info ] [Thread-1  ]: 17 of 18 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m07:00:49.206472 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m07:00:49.206472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m07:00:49.207474 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.211469 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:00:49.213472 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 07:00:49.207474 => 2023-10-05 07:00:49.213472
[0m07:00:49.213472 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.303748 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m07:00:49.365518 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.377518 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.426759 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.432756 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:00:49.435671 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
    ...
[0m07:00:49.496126 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.504121 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 07:00:49.214472 => 2023-10-05 07:00:49.504121
[0m07:00:49.505119 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008967EAF0>]}
[0m07:00:49.506125 [info ] [Thread-1  ]: 17 of 18 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.30s]
[0m07:00:49.508133 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m07:00:49.508133 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.509132 [info ] [Thread-1  ]: 18 of 18 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m07:00:49.511120 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m07:00:49.512124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m07:00:49.512124 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.517125 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:00:49.519125 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 07:00:49.513121 => 2023-10-05 07:00:49.519125
[0m07:00:49.519125 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:49.540122 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 
  ...
[0m07:00:49.595970 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.598967 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m07:00:49.655472 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.660465 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.707629 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.710623 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:00:49.711625 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m07:00:49.773609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:00:49.775606 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3);
    ...
[0m07:00:49.842908 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:49.846912 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:00:49.897740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:49.900739 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3
    ...
[0m07:00:49.971015 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:00:49.976531 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_f1f6ed44_9c69_4572_a09e_c15a3eb298c3 
  ...
[0m07:00:50.025205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:50.030197 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m07:00:50.075999 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:50.080003 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 07:00:49.520123 => 2023-10-05 07:00:50.080003
[0m07:00:50.081000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f6ed44-9c69-4572-a09e-c15a3eb298c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020089752A60>]}
[0m07:00:50.082001 [info ] [Thread-1  ]: 18 of 18 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.57s]
[0m07:00:50.084005 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m07:00:50.085009 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:00:50.086522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:50.087536 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m07:00:50.087536 [debug] [MainThread]: On list_schemas: Close
[0m07:00:50.088535 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m07:00:50.088535 [debug] [MainThread]: On list_None_travelata: Close
[0m07:00:50.088535 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_install' was left open.
[0m07:00:50.089533 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_install: Close
[0m07:00:50.090532 [info ] [MainThread]: 
[0m07:00:50.091534 [info ] [MainThread]: Finished running 16 view models, 2 incremental models in 0 hours 0 minutes and 9.55 seconds (9.55s).
[0m07:00:50.093545 [debug] [MainThread]: Command end result
[0m07:00:50.104533 [info ] [MainThread]: 
[0m07:00:50.105536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:50.106536 [info ] [MainThread]: 
[0m07:00:50.107538 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 TOTAL=18
[0m07:00:50.109540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200881C95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895EBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200895B1970>]}
[0m07:00:50.110534 [debug] [MainThread]: Flushing usage events


============================== 2023-10-05 07:02:29.483062 | e61ab7fe-9fdd-485e-a10a-fc6279de8ba4 ==============================
[0m07:02:29.483062 [info ] [MainThread]: Running with dbt=1.4.8
[0m07:02:29.485067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Dmitriy\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:02:29.486575 [debug] [MainThread]: Tracking: tracking
[0m07:02:29.498111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412A160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412A130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668412AEE0>]}
[0m07:02:29.517122 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m07:02:29.632260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:29.632260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:29.634262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m07:02:29.646255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166874AE0D0>]}
[0m07:02:29.658261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166873F66D0>]}
[0m07:02:29.659260 [info ] [MainThread]: Found 19 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:02:29.661260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166873F6940>]}
[0m07:02:29.664262 [info ] [MainThread]: 
[0m07:02:29.667260 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:02:29.671256 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m07:02:29.687794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:30.955773 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m07:02:31.006711 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:31.014557 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m07:02:31.025638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:31.636789 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m07:02:31.699098 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:31.709093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166874C6AC0>]}
[0m07:02:31.710090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:02:31.711090 [info ] [MainThread]: 
[0m07:02:31.718092 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.719097 [info ] [Thread-1  ]: 1 of 19 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m07:02:31.721096 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m07:02:31.722100 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.725094 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:02:31.726099 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-05 07:02:31.723105 => 2023-10-05 07:02:31.726099
[0m07:02:31.727098 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:31.782616 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m07:02:31.784632 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:02:32.396370 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
toDateTime(JSONExtractString(_airbyte_data, 'event_datetime')) AS event_datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m07:02:32.462215 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.472206 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:02:32.525763 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.527873 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m07:02:32.575422 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.580855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:02:32.626028 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:32.627033 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m07:02:32.675038 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.712551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m07:02:32.775760 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.777761 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-05 07:02:31.728101 => 2023-10-05 07:02:32.777761
[0m07:02:32.779754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166888BDCA0>]}
[0m07:02:32.780758 [info ] [Thread-1  ]: 1 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.06s]
[0m07:02:32.783754 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m07:02:32.784754 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.785765 [info ] [Thread-1  ]: 2 of 19 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m07:02:32.787770 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m07:02:32.787770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m07:02:32.789289 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.791304 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:02:32.793303 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-05 07:02:32.789289 => 2023-10-05 07:02:32.793303
[0m07:02:32.794306 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:32.801302 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m07:02:32.802302 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m07:02:32.859978 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:32.864965 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:02:32.915237 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.917238 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m07:02:32.965757 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:32.971751 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:02:33.016344 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:33.018337 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m07:02:33.066065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.072061 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m07:02:33.125442 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.128437 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-05 07:02:32.795306 => 2023-10-05 07:02:33.128437
[0m07:02:33.129445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166888F1E50>]}
[0m07:02:33.130442 [info ] [Thread-1  ]: 2 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.34s]
[0m07:02:33.132440 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m07:02:33.133437 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.133437 [info ] [Thread-1  ]: 3 of 19 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m07:02:33.135441 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m07:02:33.136439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m07:02:33.136439 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.139433 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:02:33.140446 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-05 07:02:33.137443 => 2023-10-05 07:02:33.140446
[0m07:02:33.141447 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.151435 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m07:02:33.153439 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m07:02:33.213083 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.217083 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:02:33.275222 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.278222 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m07:02:33.335878 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:33.341868 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:02:33.395541 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.397543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m07:02:33.445539 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.454552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m07:02:33.505705 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.507709 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-05 07:02:33.142445 => 2023-10-05 07:02:33.507709
[0m07:02:33.508700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889CEFD0>]}
[0m07:02:33.509707 [info ] [Thread-1  ]: 3 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.37s]
[0m07:02:33.510702 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m07:02:33.511703 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.512704 [info ] [Thread-1  ]: 4 of 19 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m07:02:33.514710 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m07:02:33.514710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m07:02:33.515703 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.517701 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:02:33.519704 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-05 07:02:33.515703 => 2023-10-05 07:02:33.519704
[0m07:02:33.520710 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.529704 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m07:02:33.530705 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m07:02:33.582581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.586328 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:02:33.636389 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.638380 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m07:02:33.685865 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.690371 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:02:33.735900 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.737895 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m07:02:33.786755 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.795263 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m07:02:33.846272 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.848264 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-05 07:02:33.521706 => 2023-10-05 07:02:33.848264
[0m07:02:33.849270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F3670>]}
[0m07:02:33.850266 [info ] [Thread-1  ]: 4 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.34s]
[0m07:02:33.852269 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m07:02:33.852269 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.853265 [info ] [Thread-1  ]: 5 of 19 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m07:02:33.856271 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m07:02:33.856271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m07:02:33.857269 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.859265 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:02:33.861275 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-05 07:02:33.857269 => 2023-10-05 07:02:33.861275
[0m07:02:33.861275 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:33.867264 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m07:02:33.868264 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
toDateTime(JSONExtractString(_airbyte_data, 'eventDateTime')) AS eventDateTime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m07:02:33.921096 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.925094 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:02:33.975805 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:33.978798 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m07:02:34.036848 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.040840 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:02:34.085932 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:34.087928 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m07:02:34.145828 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.152825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m07:02:34.205677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.208672 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-05 07:02:33.862269 => 2023-10-05 07:02:34.207668
[0m07:02:34.209669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889E9310>]}
[0m07:02:34.210667 [info ] [Thread-1  ]: 5 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.35s]
[0m07:02:34.212675 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m07:02:34.212675 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.213676 [info ] [Thread-1  ]: 6 of 19 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m07:02:34.215676 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m07:02:34.215676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m07:02:34.216673 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.218673 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:02:34.220671 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-05 07:02:34.216673 => 2023-10-05 07:02:34.220671
[0m07:02:34.220671 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.227668 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m07:02:34.228677 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
toDateTime(JSONExtractString(_airbyte_data, 'session_start_datetime')) AS session_start_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m07:02:34.281069 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.285070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:02:34.345261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.347266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m07:02:34.395574 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.401578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:02:34.455179 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.457184 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m07:02:34.506281 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.513276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m07:02:34.565410 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.568405 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-05 07:02:34.221673 => 2023-10-05 07:02:34.568405
[0m07:02:34.569408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668891EE50>]}
[0m07:02:34.570406 [info ] [Thread-1  ]: 6 of 19 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.35s]
[0m07:02:34.572405 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m07:02:34.572405 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.573999 [info ] [Thread-1  ]: 7 of 19 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m07:02:34.576025 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m07:02:34.576739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m07:02:34.577892 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.581143 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:02:34.583289 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-05 07:02:34.578511 => 2023-10-05 07:02:34.582748
[0m07:02:34.583840 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.591153 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m07:02:34.593148 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m07:02:34.651870 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.656872 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:02:34.705320 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.707314 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new to travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  
  ...
[0m07:02:34.766163 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:34.770665 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:02:34.815093 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:34.817088 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_new 
  
  ...
[0m07:02:34.866236 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.874236 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_new__dbt_backup 
  ...
[0m07:02:34.925454 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:34.928445 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-05 07:02:34.584384 => 2023-10-05 07:02:34.928445
[0m07:02:34.929444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A18C70>]}
[0m07:02:34.930446 [info ] [Thread-1  ]: 7 of 19 OK created sql view model travelata.normalized_sheets_mytarget_banners_new  [[32mOK[0m in 0.35s]
[0m07:02:34.933447 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m07:02:34.934451 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.935445 [info ] [Thread-1  ]: 8 of 19 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m07:02:34.937449 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m07:02:34.937449 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m07:02:34.937449 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.940440 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:02:34.941442 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-05 07:02:34.938451 => 2023-10-05 07:02:34.941442
[0m07:02:34.942443 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:34.953451 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m07:02:34.954450 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m07:02:35.012834 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.016833 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:02:35.065326 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.067330 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new to travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  
  ...
[0m07:02:35.115505 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.120499 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:02:35.176190 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.178187 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */

    rename table travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_tmp to travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  ...
[0m07:02:35.235754 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.242747 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */
drop table if exists travelata.normalized_sheets_mytarget_banners_statjstics_new__dbt_backup 
  ...
[0m07:02:35.295866 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.297860 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-05 07:02:34.942443 => 2023-10-05 07:02:35.297860
[0m07:02:35.298856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A18B20>]}
[0m07:02:35.299863 [info ] [Thread-1  ]: 8 of 19 OK created sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[32mOK[0m in 0.36s]
[0m07:02:35.302292 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m07:02:35.302292 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.303289 [info ] [Thread-1  ]: 9 of 19 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m07:02:35.305294 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m07:02:35.306294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m07:02:35.306294 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.309294 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:02:35.310297 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-05 07:02:35.306294 => 2023-10-05 07:02:35.310297
[0m07:02:35.311295 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.319291 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m07:02:35.320295 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m07:02:35.379447 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.384446 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:02:35.435845 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.437839 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new to travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  
  ...
[0m07:02:35.495816 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.500813 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    drop table if exists travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:02:35.555849 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.557847 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */

    rename table travelata.normalized_sheets_mytarget_compagins_new__dbt_tmp to travelata.normalized_sheets_mytarget_compagins_new 
  
  ...
[0m07:02:35.605662 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.612655 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */
drop table if exists travelata.normalized_sheets_mytarget_compagins_new__dbt_backup 
  ...
[0m07:02:35.675939 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.677949 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-05 07:02:35.312293 => 2023-10-05 07:02:35.677949
[0m07:02:35.678953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A56790>]}
[0m07:02:35.679949 [info ] [Thread-1  ]: 9 of 19 OK created sql view model travelata.normalized_sheets_mytarget_compagins_new  [[32mOK[0m in 0.37s]
[0m07:02:35.681637 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m07:02:35.681637 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.682631 [info ] [Thread-1  ]: 10 of 19 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m07:02:35.684637 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m07:02:35.685631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m07:02:35.685631 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.689633 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:02:35.692152 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-05 07:02:35.686634 => 2023-10-05 07:02:35.692152
[0m07:02:35.692152 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:35.698147 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m07:02:35.700151 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m07:02:35.761522 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.765462 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:02:35.825507 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.828496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m07:02:35.885285 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:35.891276 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:02:35.945795 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:35.947802 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m07:02:35.996126 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.003120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m07:02:36.065593 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.068598 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-05 07:02:35.693152 => 2023-10-05 07:02:36.067599
[0m07:02:36.069604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A71700>]}
[0m07:02:36.070602 [info ] [Thread-1  ]: 10 of 19 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.39s]
[0m07:02:36.072595 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m07:02:36.072595 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.073592 [info ] [Thread-1  ]: 11 of 19 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m07:02:36.075595 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m07:02:36.076601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m07:02:36.076601 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.079621 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:02:36.080621 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-05 07:02:36.077604 => 2023-10-05 07:02:36.080621
[0m07:02:36.081618 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.088606 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m07:02:36.089617 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m07:02:36.149905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.154904 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:02:36.215432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.218425 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m07:02:36.266425 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.270418 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:02:36.315749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:36.317744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m07:02:36.365780 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.373779 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m07:02:36.425409 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.428405 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-05 07:02:36.081618 => 2023-10-05 07:02:36.428405
[0m07:02:36.429412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F0D30>]}
[0m07:02:36.430405 [info ] [Thread-1  ]: 11 of 19 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.35s]
[0m07:02:36.431406 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m07:02:36.432419 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.433412 [info ] [Thread-1  ]: 12 of 19 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m07:02:36.434407 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m07:02:36.435413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m07:02:36.436409 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.439409 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:02:36.440411 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-05 07:02:36.436409 => 2023-10-05 07:02:36.440411
[0m07:02:36.441411 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.449418 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m07:02:36.450405 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m07:02:36.500854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.504852 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:02:36.566369 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.568368 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m07:02:36.615485 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.620479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:02:36.666609 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:36.668601 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m07:02:36.716648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:36.723647 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m07:02:36.786173 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.788170 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-05 07:02:36.442414 => 2023-10-05 07:02:36.788170
[0m07:02:36.789169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A2CA60>]}
[0m07:02:36.790169 [info ] [Thread-1  ]: 12 of 19 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.35s]
[0m07:02:36.792691 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m07:02:36.793692 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.793692 [info ] [Thread-1  ]: 13 of 19 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m07:02:36.795696 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m07:02:36.796692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m07:02:36.796692 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.800706 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:02:36.802700 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-05 07:02:36.797690 => 2023-10-05 07:02:36.801702
[0m07:02:36.803691 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:36.811693 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m07:02:36.812691 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	parseDateTime(JSONExtractString(_airbyte_data, 'date'), '%Y-%m-%d %H:%M:%S') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m07:02:36.881054 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:02:36.888055 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:02:36.945576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:36.947576 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m07:02:36.995698 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.000700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:02:37.045002 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:37.047002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m07:02:37.095595 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.101591 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m07:02:37.165725 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.167729 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-05 07:02:36.803691 => 2023-10-05 07:02:37.167729
[0m07:02:37.168727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001668897A130>]}
[0m07:02:37.169727 [info ] [Thread-1  ]: 13 of 19 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m07:02:37.171729 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m07:02:37.172726 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.172726 [info ] [Thread-1  ]: 14 of 19 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m07:02:37.174727 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m07:02:37.175721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m07:02:37.175721 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.177734 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:02:37.179730 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-05 07:02:37.176724 => 2023-10-05 07:02:37.179730
[0m07:02:37.179730 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.187751 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m07:02:37.189741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m07:02:37.240362 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.246362 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:02:37.295219 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.297216 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m07:02:37.355740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.359741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:02:37.405910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.407909 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m07:02:37.455596 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.461592 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m07:02:37.525430 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.527428 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-05 07:02:37.180736 => 2023-10-05 07:02:37.527428
[0m07:02:37.529430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016689A66F10>]}
[0m07:02:37.530428 [info ] [Thread-1  ]: 14 of 19 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m07:02:37.531426 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m07:02:37.532432 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.533430 [info ] [Thread-1  ]: 15 of 19 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m07:02:37.535431 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m07:02:37.536424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m07:02:37.537428 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.540441 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:02:37.541435 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-05 07:02:37.537428 => 2023-10-05 07:02:37.541435
[0m07:02:37.542437 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.551423 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m07:02:37.552433 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m07:02:37.610236 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.678240 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:02:37.726173 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.728163 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m07:02:37.786527 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.790531 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:02:37.855748 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:37.857749 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m07:02:37.905678 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.912678 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m07:02:37.966319 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:37.968315 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-05 07:02:37.543438 => 2023-10-05 07:02:37.968315
[0m07:02:37.969829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889E8FA0>]}
[0m07:02:37.970842 [info ] [Thread-1  ]: 15 of 19 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.44s]
[0m07:02:37.971837 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m07:02:37.972846 [debug] [Thread-1  ]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.973844 [info ] [Thread-1  ]: 16 of 19 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m07:02:37.975846 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m07:02:37.976843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m07:02:37.976843 [debug] [Thread-1  ]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.979854 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:02:37.981854 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-05 07:02:37.977862 => 2023-10-05 07:02:37.981854
[0m07:02:37.981854 [debug] [Thread-1  ]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m07:02:37.988850 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m07:02:37.989849 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
parseDateTime(JSONExtractString(_airbyte_data, 'Date'), '%Y-%m-%d') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m07:02:38.046094 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.051090 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:02:38.095628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:02:38.097623 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m07:02:38.155450 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.159973 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:02:38.215793 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.216794 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m07:02:38.265969 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.271967 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m07:02:38.336213 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.338209 [debug] [Thread-1  ]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-05 07:02:37.982854 => 2023-10-05 07:02:38.338209
[0m07:02:38.340206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889B6F10>]}
[0m07:02:38.341201 [info ] [Thread-1  ]: 16 of 19 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.36s]
[0m07:02:38.343144 [debug] [Thread-1  ]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m07:02:38.344142 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.345142 [info ] [Thread-1  ]: 17 of 19 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m07:02:38.346639 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m07:02:38.347639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m07:02:38.348641 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.355655 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:02:38.356641 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-05 07:02:38.349640 => 2023-10-05 07:02:38.356641
[0m07:02:38.357638 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:38.421772 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:38.475801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.511002 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m07:02:38.567079 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.578084 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:38.627751 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.633745 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m07:02:38.634757 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m07:02:38.695383 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.697377 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4);
    ...
[0m07:02:38.777596 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m07:02:38.782109 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:38.837637 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:38.839633 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
    ...
[0m07:02:38.889467 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.892969 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:38.945749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:38.952741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m07:02:39.005997 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.008997 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-05 07:02:38.357638 => 2023-10-05 07:02:39.008997
[0m07:02:39.010999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688A1FE80>]}
[0m07:02:39.010999 [info ] [Thread-1  ]: 17 of 19 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.66s]
[0m07:02:39.012998 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m07:02:39.013998 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.015002 [info ] [Thread-1  ]: 18 of 19 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m07:02:39.016993 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m07:02:39.017991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m07:02:39.017991 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.022991 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:02:39.023996 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-05 07:02:39.019000 => 2023-10-05 07:02:39.023996
[0m07:02:39.025004 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.032996 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:39.085137 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.090138 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m07:02:39.146808 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.150802 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.197451 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.200451 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m07:02:39.203454 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m07:02:39.264334 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.266336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4);
    ...
[0m07:02:39.331896 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m07:02:39.335892 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.397350 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.400343 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4
    ...
[0m07:02:39.450051 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.455048 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_e61ab7fe_9fdd_485e_a10a_fc6279de8ba4 
  ...
[0m07:02:39.505414 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.510416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m07:02:39.565625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.569619 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-05 07:02:39.025004 => 2023-10-05 07:02:39.569619
[0m07:02:39.571629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889F6B20>]}
[0m07:02:39.571629 [info ] [Thread-1  ]: 18 of 19 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.55s]
[0m07:02:39.573623 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m07:02:39.574629 [debug] [Thread-1  ]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.575624 [info ] [Thread-1  ]: 19 of 19 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m07:02:39.576621 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m07:02:39.577639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m07:02:39.578655 [debug] [Thread-1  ]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.583840 [debug] [Thread-1  ]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m07:02:39.585461 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-05 07:02:39.579658 => 2023-10-05 07:02:39.585461
[0m07:02:39.586549 [debug] [Thread-1  ]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.610850 [debug] [Thread-1  ]: Creating new relation incremental_sheets_appmetrica_profiles
[0m07:02:39.612845 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m07:02:39.676065 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.680070 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles'
    
      and database = 'travelata'
    
    order by position
  ...
[0m07:02:39.727033 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:02:39.730024 [debug] [Thread-1  ]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m07:02:39.732030 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m07:02:39.790573 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m07:02:39.794083 [debug] [Thread-1  ]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-05 07:02:39.587093 => 2023-10-05 07:02:39.794083
[0m07:02:39.796103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e61ab7fe-9fdd-485e-a10a-fc6279de8ba4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688842AC0>]}
[0m07:02:39.796103 [info ] [Thread-1  ]: 19 of 19 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.22s]
[0m07:02:39.798104 [debug] [Thread-1  ]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m07:02:39.800097 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:02:39.801096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:02:39.802097 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m07:02:39.802097 [debug] [MainThread]: On list_schemas: Close
[0m07:02:39.803097 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m07:02:39.804102 [debug] [MainThread]: On list_None_travelata: Close
[0m07:02:39.804102 [debug] [MainThread]: Connection 'model.travelata.incremental_sheets_appmetrica_profiles' was left open.
[0m07:02:39.805094 [debug] [MainThread]: On model.travelata.incremental_sheets_appmetrica_profiles: Close
[0m07:02:39.805094 [info ] [MainThread]: 
[0m07:02:39.807102 [info ] [MainThread]: Finished running 16 view models, 2 incremental models, 1 table model in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m07:02:39.812098 [debug] [MainThread]: Command end result
[0m07:02:39.824100 [info ] [MainThread]: 
[0m07:02:39.825103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:02:39.827101 [info ] [MainThread]: 
[0m07:02:39.828095 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m07:02:39.830105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166889241F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688924160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016688842AC0>]}
[0m07:02:39.830105 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 11:19:01.737356 | 40d29a74-c27b-4e2b-8556-97858c6d17e3 ==============================
[0m11:19:01.737356 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:19:01.741357 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ZeBook\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:19:01.742352 [debug] [MainThread]: Tracking: tracking
[0m11:19:01.763620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26D286910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26D2862D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DF3E1D0>]}
[0m11:19:01.797988 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:19:01.876988 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:19:01.878977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DC38C90>]}
[0m11:19:04.462677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_deeplinks.sql
[0m11:19:04.485677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_events.sql
[0m11:19:04.491678 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_install.sql
[0m11:19:04.498680 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_profiles.sql
[0m11:19:04.505674 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_screenview.sql
[0m11:19:04.512677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_appmetrica_sessionstart.sql
[0m11:19:04.518677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:19:04.525677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:19:04.532677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:19:04.538677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_utmcraft_utmresult.sql
[0m11:19:04.545677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adgroupsstatistics.sql
[0m11:19:04.551677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_adplansstatistics.sql
[0m11:19:04.558677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_vkads_bannersstatistics.sql
[0m11:19:04.564677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yandexdisk_mediaplans.sql
[0m11:19:04.570677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yandexdisk_othercosts.sql
[0m11:19:04.577677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_yd_customreport.sql
[0m11:19:04.583677 [debug] [MainThread]: 1699: static parser successfully parsed 1_normalize\normalized_sheets_ymvisits_visits.sql
[0m11:19:04.590677 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:19:04.599663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:19:04.603656 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m11:19:04.611677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_events.sql
[0m11:19:04.615672 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_install.sql
[0m11:19:04.624677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_install.sql
[0m11:19:04.628672 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_profiles.sql
[0m11:19:04.636677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_profiles.sql
[0m11:19:04.639680 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:19:04.648677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:19:04.652677 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:19:04.661677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:19:04.664677 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m11:19:04.673677 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners.sql
[0m11:19:04.677412 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m11:19:04.686535 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_banners_statistics.sql
[0m11:19:04.689945 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m11:19:04.698692 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_mytarget_compagins.sql
[0m11:19:04.702317 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m11:19:04.710335 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_utmcraft_utmresult.sql
[0m11:19:04.713337 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:19:04.722352 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:19:04.726352 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:19:04.736357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:19:04.740361 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:19:04.748357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:19:04.752361 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_yandexdisk_mediaplans.sql
[0m11:19:04.760357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_yandexdisk_mediaplans.sql
[0m11:19:04.764358 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental_sheets_yandexdisk_othercosts.sql
[0m11:19:04.773357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental_sheets_yandexdisk_othercosts.sql
[0m11:19:04.776357 [debug] [MainThread]: 1603: static parser failed on 2_incremental\incremental__sheets_yd_customreport.sql
[0m11:19:04.785357 [debug] [MainThread]: 1602: parser fallback to jinja rendering on 2_incremental\incremental__sheets_yd_customreport.sql
[0m11:19:04.934069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m11:19:04.946696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DF88290>]}
[0m11:19:04.964058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E4F1690>]}
[0m11:19:04.965289 [info ] [MainThread]: Found 33 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:19:04.967140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26D5A0590>]}
[0m11:19:04.971634 [info ] [MainThread]: 
[0m11:19:04.975847 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:19:04.981833 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:19:05.001834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:05.840239 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:19:05.893252 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:05.901265 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:19:05.911235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:06.492739 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:19:06.543513 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:06.557498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DF7F510>]}
[0m11:19:06.559507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:06.560511 [info ] [MainThread]: 
[0m11:19:06.576515 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:19:06.577512 [info ] [Thread-1 (]: 1 of 33 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m11:19:06.580509 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m11:19:06.580509 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:19:06.584174 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:19:06.586003 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:19:06.581511 => 2023-10-06 11:19:06.585460
[0m11:19:06.586770 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:19:06.661255 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:19:06.662247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:19:07.250584 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m11:19:07.309942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:07.322751 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:19:07.370838 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.372838 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:19:07.419668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.424690 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:19:07.480214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.482214 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:19:07.531962 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.585946 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m11:19:07.639948 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.642946 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:19:06.587374 => 2023-10-06 11:19:07.642946
[0m11:19:07.643947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DC69CD0>]}
[0m11:19:07.644948 [info ] [Thread-1 (]: 1 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.06s]
[0m11:19:07.648959 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:19:07.649968 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m11:19:07.651954 [info ] [Thread-1 (]: 2 of 33 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m11:19:07.653951 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m11:19:07.653951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m11:19:07.654950 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m11:19:07.658657 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:19:07.660512 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 11:19:07.655956 => 2023-10-06 11:19:07.659904
[0m11:19:07.661140 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m11:19:07.670676 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:19:07.672412 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m11:19:07.728912 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:07.733917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:19:07.780170 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.782168 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:19:07.830094 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.835076 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:19:07.880070 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:07.882061 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:19:07.929741 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.936750 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m11:19:07.990040 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:07.993038 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 11:19:07.661756 => 2023-10-06 11:19:07.993038
[0m11:19:07.994047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E844BD0>]}
[0m11:19:07.995045 [info ] [Thread-1 (]: 2 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.34s]
[0m11:19:07.997044 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m11:19:07.998037 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m11:19:07.999044 [info ] [Thread-1 (]: 3 of 33 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m11:19:08.001035 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m11:19:08.002058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m11:19:08.002058 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m11:19:08.005062 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:19:08.007036 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 11:19:08.003055 => 2023-10-06 11:19:08.007036
[0m11:19:08.008029 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m11:19:08.016796 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:19:08.017995 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m11:19:08.079598 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:08.084614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:19:08.149443 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:08.152456 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:19:08.200262 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.205267 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:19:08.260234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.262233 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:19:08.310035 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.317035 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m11:19:08.370263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.372264 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 11:19:08.008029 => 2023-10-06 11:19:08.372264
[0m11:19:08.374255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E843A10>]}
[0m11:19:08.375255 [info ] [Thread-1 (]: 3 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.37s]
[0m11:19:08.376233 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m11:19:08.377235 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:19:08.378246 [info ] [Thread-1 (]: 4 of 33 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m11:19:08.380257 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m11:19:08.381255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m11:19:08.382099 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:19:08.384693 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:19:08.386622 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 11:19:08.382638 => 2023-10-06 11:19:08.386622
[0m11:19:08.387260 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:19:08.397549 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:19:08.399400 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m11:19:08.457118 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:08.463104 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:19:08.510080 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.512068 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:19:08.560153 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.564831 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:19:08.620100 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.622320 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:19:08.679791 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:08.697904 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m11:19:08.750153 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.752828 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 11:19:08.387909 => 2023-10-06 11:19:08.752828
[0m11:19:08.754785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E948BD0>]}
[0m11:19:08.755729 [info ] [Thread-1 (]: 4 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.38s]
[0m11:19:08.757880 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:19:08.758452 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:19:08.759614 [info ] [Thread-1 (]: 5 of 33 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m11:19:08.761913 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m11:19:08.762570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m11:19:08.763082 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:19:08.765459 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:19:08.767902 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 11:19:08.763082 => 2023-10-06 11:19:08.767221
[0m11:19:08.768505 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:19:08.776811 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:19:08.778677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'eventDateTime') AS __datetime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m11:19:08.837260 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:08.842371 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:19:08.890439 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.892439 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:19:08.940157 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:08.945157 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:19:09.011786 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:09.014805 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:19:09.059708 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:09.066716 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m11:19:09.120089 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:09.122089 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 11:19:08.769092 => 2023-10-06 11:19:09.122089
[0m11:19:09.124089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E997BD0>]}
[0m11:19:09.124089 [info ] [Thread-1 (]: 5 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m11:19:09.127076 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:19:09.128075 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:19:09.129089 [info ] [Thread-1 (]: 6 of 33 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m11:19:09.131082 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m11:19:09.132081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m11:19:09.132081 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:19:09.135080 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:19:09.137088 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:19:09.133081 => 2023-10-06 11:19:09.137088
[0m11:19:09.137088 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:19:09.145945 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:19:09.147731 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'session_start_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m11:19:09.208954 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:09.213945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:19:09.259234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:09.262250 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:19:09.310422 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:09.314430 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:19:09.372265 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:09.374265 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:19:09.420681 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:09.430675 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m11:19:09.480447 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:09.483446 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:19:09.138081 => 2023-10-06 11:19:09.483446
[0m11:19:09.485450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E5F1AD0>]}
[0m11:19:09.486441 [info ] [Thread-1 (]: 6 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.36s]
[0m11:19:09.488441 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:19:09.489443 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:19:09.490442 [info ] [Thread-1 (]: 7 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m11:19:09.492422 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m11:19:09.493450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m11:19:09.493450 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:19:09.496441 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:19:09.498450 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 11:19:09.494450 => 2023-10-06 11:19:09.498450
[0m11:19:09.499441 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:19:09.503442 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_new
[0m11:19:09.505444 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:19:09.507435 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m11:19:09.561865 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )
[0m11:19:09.563845 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 11:19:09.499441 => 2023-10-06 11:19:09.563845
[0m11:19:09.701388 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:19:09.703003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E9BC610>]}
[0m11:19:09.703811 [error] [Thread-1 (]: 7 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_new  [[31mERROR[0m in 0.21s]
[0m11:19:09.706286 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:19:09.706891 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:19:09.708600 [info ] [Thread-1 (]: 8 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m11:19:09.710693 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m11:19:09.711686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m11:19:09.711686 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:19:09.715709 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:19:09.717688 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 11:19:09.712687 => 2023-10-06 11:19:09.717688
[0m11:19:09.718691 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:19:09.722688 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_statjstics_new
[0m11:19:09.725689 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:19:09.727900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m11:19:09.782234 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )
[0m11:19:09.783234 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 11:19:09.718691 => 2023-10-06 11:19:09.783234
[0m11:19:09.788235 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:19:09.789242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E69F890>]}
[0m11:19:09.790234 [error] [Thread-1 (]: 8 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[31mERROR[0m in 0.08s]
[0m11:19:09.792226 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:19:09.793235 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:19:09.794229 [info ] [Thread-1 (]: 9 of 33 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m11:19:09.796235 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m11:19:09.796235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m11:19:09.797235 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:19:09.800242 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:19:09.802717 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 11:19:09.797235 => 2023-10-06 11:19:09.801867
[0m11:19:09.803345 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:19:09.807867 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_compagins_new
[0m11:19:09.810281 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:19:09.813595 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m11:19:09.861126 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )
[0m11:19:09.862140 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 11:19:09.804021 => 2023-10-06 11:19:09.862140
[0m11:19:09.867148 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:19:09.868148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E927DD0>]}
[0m11:19:09.869122 [error] [Thread-1 (]: 9 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_compagins_new  [[31mERROR[0m in 0.07s]
[0m11:19:09.871149 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:19:09.872145 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:19:09.873141 [info ] [Thread-1 (]: 10 of 33 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m11:19:09.875150 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m11:19:09.875150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m11:19:09.876142 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:19:09.878140 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:19:09.880149 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 11:19:09.876142 => 2023-10-06 11:19:09.880149
[0m11:19:09.881142 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:19:09.889148 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:19:09.891150 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m11:19:09.949118 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:09.955149 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:19:10.012684 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.014687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:19:10.059271 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:10.065291 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:19:10.120048 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.122048 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:19:10.171057 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.179068 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m11:19:10.230100 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.232482 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 11:19:09.882141 => 2023-10-06 11:19:10.231941
[0m11:19:10.233628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E6D2590>]}
[0m11:19:10.234774 [info ] [Thread-1 (]: 10 of 33 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.36s]
[0m11:19:10.236507 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:19:10.237587 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:19:10.238726 [info ] [Thread-1 (]: 11 of 33 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:19:10.240249 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m11:19:10.241253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m11:19:10.241253 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:19:10.245302 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:19:10.247008 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:19:10.242254 => 2023-10-06 11:19:10.246496
[0m11:19:10.247665 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:19:10.255239 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:19:10.256997 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m11:19:10.319529 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.327547 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:19:10.391538 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.393537 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:19:10.450538 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.455546 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:19:10.520110 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.521827 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:19:10.570070 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.579079 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m11:19:10.642641 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.644640 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:19:10.248237 => 2023-10-06 11:19:10.644640
[0m11:19:10.645642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA3F210>]}
[0m11:19:10.646643 [info ] [Thread-1 (]: 11 of 33 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.41s]
[0m11:19:10.648640 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:19:10.649643 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:19:10.650642 [info ] [Thread-1 (]: 12 of 33 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m11:19:10.652643 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m11:19:10.653647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m11:19:10.653647 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:19:10.656639 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:19:10.658641 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:19:10.654642 => 2023-10-06 11:19:10.657640
[0m11:19:10.658641 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:19:10.666642 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:19:10.668642 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m11:19:10.730034 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.735040 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:19:10.792369 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:10.794372 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:19:10.839784 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:10.844782 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:19:10.899626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.901629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:19:10.953229 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:10.960228 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m11:19:11.020203 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.022223 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:19:10.659644 => 2023-10-06 11:19:11.022223
[0m11:19:11.024215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA4F550>]}
[0m11:19:11.024215 [info ] [Thread-1 (]: 12 of 33 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.37s]
[0m11:19:11.027194 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:19:11.028216 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:19:11.029192 [info ] [Thread-1 (]: 13 of 33 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m11:19:11.031516 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m11:19:11.032084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m11:19:11.032719 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:19:11.035933 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:19:11.037736 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 11:19:11.033361 => 2023-10-06 11:19:11.037198
[0m11:19:11.038372 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:19:11.046598 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:19:11.048428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m11:19:11.108875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.114851 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:19:11.160217 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:11.162216 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:19:11.209717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.215717 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:19:11.269887 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.271887 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:19:11.320209 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.327209 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m11:19:11.380100 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.382100 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 11:19:11.038474 => 2023-10-06 11:19:11.382100
[0m11:19:11.383301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E9B7850>]}
[0m11:19:11.384100 [info ] [Thread-1 (]: 13 of 33 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.35s]
[0m11:19:11.386096 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:19:11.387102 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:19:11.388079 [info ] [Thread-1 (]: 14 of 33 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m11:19:11.391101 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m11:19:11.391101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m11:19:11.392109 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:19:11.395108 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:19:11.396095 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:19:11.392109 => 2023-10-06 11:19:11.396095
[0m11:19:11.397101 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:19:11.408118 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:19:11.409336 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m11:19:11.468583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.473591 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:19:11.529639 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.532640 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:19:11.591496 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.596540 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:19:11.650168 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.652190 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:19:11.700221 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.707229 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m11:19:11.760383 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.762383 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:19:11.397101 => 2023-10-06 11:19:11.762383
[0m11:19:11.763392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E62E610>]}
[0m11:19:11.764392 [info ] [Thread-1 (]: 14 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.37s]
[0m11:19:11.766392 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:19:11.767388 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:19:11.768392 [info ] [Thread-1 (]: 15 of 33 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m11:19:11.770383 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m11:19:11.771392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m11:19:11.771392 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:19:11.774392 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:19:11.776375 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:19:11.772384 => 2023-10-06 11:19:11.776375
[0m11:19:11.777372 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:19:11.785197 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:19:11.787088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m11:19:11.847641 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:11.852646 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:19:11.899643 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.901642 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:19:11.949832 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:11.954824 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:19:12.009921 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.011920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:19:12.059813 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.066818 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m11:19:12.119807 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.121786 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:19:11.777372 => 2023-10-06 11:19:12.121786
[0m11:19:12.123787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA6DCD0>]}
[0m11:19:12.124786 [info ] [Thread-1 (]: 15 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.35s]
[0m11:19:12.126788 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:19:12.126788 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m11:19:12.128785 [info ] [Thread-1 (]: 16 of 33 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m11:19:12.130787 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m11:19:12.130787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m11:19:12.131786 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m11:19:12.134782 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:19:12.137820 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 11:19:12.131786 => 2023-10-06 11:19:12.137820
[0m11:19:12.138834 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m11:19:12.147833 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:19:12.149834 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m11:19:12.207791 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:12.212791 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:19:12.260808 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.262808 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:19:12.310129 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.315138 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:19:12.379032 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:12.382041 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:19:12.429545 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.439563 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m11:19:12.492004 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.495022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 11:19:12.139833 => 2023-10-06 11:19:12.494009
[0m11:19:12.496012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA2F790>]}
[0m11:19:12.497012 [info ] [Thread-1 (]: 16 of 33 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.37s]
[0m11:19:12.499006 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m11:19:12.499006 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:19:12.500004 [info ] [Thread-1 (]: 17 of 33 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m11:19:12.502004 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m11:19:12.503007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m11:19:12.504003 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m11:19:12.507000 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:19:12.509003 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 11:19:12.504003 => 2023-10-06 11:19:12.508004
[0m11:19:12.509003 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m11:19:12.517002 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:19:12.519002 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m11:19:12.576660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:12.581659 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:19:12.630001 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.632061 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:19:12.680203 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.685207 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:19:12.739353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.742329 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:19:12.791694 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.799695 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m11:19:12.850796 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:12.853792 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 11:19:12.510003 => 2023-10-06 11:19:12.853792
[0m11:19:12.854792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA2E550>]}
[0m11:19:12.856787 [info ] [Thread-1 (]: 17 of 33 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.35s]
[0m11:19:12.857788 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:19:12.858803 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:19:12.859787 [info ] [Thread-1 (]: 18 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [RUN]
[0m11:19:12.862787 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_deeplinks'
[0m11:19:12.862787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_deeplinks)
[0m11:19:12.863781 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:19:12.869792 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:19:12.871779 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:19:12.864796 => 2023-10-06 11:19:12.870793
[0m11:19:12.871779 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:19:12.989830 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

            

    
        create table travelata.incremental_sheets_appmetrica_deeplinks
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
    )
        ...
[0m11:19:13.055814 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:13.071831 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_deeplinks'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:13.121816 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:13.132814 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:19:13.135808 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
    ...
[0m11:19:13.254781 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
    
[0m11:19:13.255781 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:19:12.872796 => 2023-10-06 11:19:13.255781
[0m11:19:13.260781 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:19:13.261755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E694150>]}
[0m11:19:13.262772 [error] [Thread-1 (]: 18 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [[31mERROR[0m in 0.40s]
[0m11:19:13.264772 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:19:13.264772 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m11:19:13.265773 [info ] [Thread-1 (]: 19 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m11:19:13.268763 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m11:19:13.269754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m11:19:13.270757 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m11:19:13.280316 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:19:13.283258 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 11:19:13.271766 => 2023-10-06 11:19:13.283258
[0m11:19:13.284451 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m11:19:13.318649 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:13.324646 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:19:13.328650 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m11:19:13.392653 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:13.399652 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:13.453644 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:13.458650 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:19:13.460654 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m11:19:13.522661 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:13.524665 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3);
    ...
[0m11:19:13.681650 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.16 seconds
[0m11:19:13.686573 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:13.695023 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:19:13.698552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
    ...
[0m11:19:13.755626 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:13.760617 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:13.812153 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:13.819166 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m11:19:13.879379 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:13.883384 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 11:19:13.285059 => 2023-10-06 11:19:13.883384
[0m11:19:13.885384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EAFD1D0>]}
[0m11:19:13.886379 [info ] [Thread-1 (]: 19 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.62s]
[0m11:19:13.887379 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m11:19:13.888356 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m11:19:13.889388 [info ] [Thread-1 (]: 20 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m11:19:13.891379 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m11:19:13.892388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m11:19:13.892388 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m11:19:13.898379 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:19:13.902366 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 11:19:13.893384 => 2023-10-06 11:19:13.902366
[0m11:19:13.903358 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m11:19:13.913833 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:13.960338 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:19:13.965335 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m11:19:14.036402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:14.044403 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:14.102839 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.106865 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:19:14.109863 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m11:19:14.174640 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.176639 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3);
    ...
[0m11:19:14.264798 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m11:19:14.269820 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:14.332187 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.335187 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
    ...
[0m11:19:14.398602 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.404603 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:14.450066 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:14.456072 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m11:19:14.509360 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:14.513381 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 11:19:13.903358 => 2023-10-06 11:19:14.513381
[0m11:19:14.515383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E9A5F90>]}
[0m11:19:14.515383 [info ] [Thread-1 (]: 20 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.62s]
[0m11:19:14.517365 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m11:19:14.518384 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:19:14.519382 [info ] [Thread-1 (]: 21 of 33 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m11:19:14.521382 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m11:19:14.522384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m11:19:14.522384 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:19:14.528038 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:19:14.531800 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 11:19:14.523369 => 2023-10-06 11:19:14.531211
[0m11:19:14.532402 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:19:14.566841 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m11:19:14.634836 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:14.639837 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:14.691819 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:14.695837 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:19:14.697847 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m11:19:14.757296 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.767348 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m11:19:14.820450 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:14.828453 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m11:19:14.890771 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.892770 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 11:19:14.533059 => 2023-10-06 11:19:14.892770
[0m11:19:14.894776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E9851D0>]}
[0m11:19:14.895781 [info ] [Thread-1 (]: 21 of 33 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.37s]
[0m11:19:14.897767 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:19:14.898785 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:19:14.899773 [info ] [Thread-1 (]: 22 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_screenview  [RUN]
[0m11:19:14.901772 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_screenview'
[0m11:19:14.901772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_screenview)
[0m11:19:14.902756 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:19:14.909750 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:19:14.911753 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (compile): 2023-10-06 11:19:14.903775 => 2023-10-06 11:19:14.910755
[0m11:19:14.911753 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:19:14.922779 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

            

    
        create table travelata.incremental_sheets_appmetrica_screenview
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
    )
        ...
[0m11:19:14.984870 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:14.989879 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_screenview'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:15.042189 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:15.048190 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:19:15.052460 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
    ...
[0m11:19:15.108114 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
    
[0m11:19:15.108114 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (execute): 2023-10-06 11:19:14.912760 => 2023-10-06 11:19:15.108114
[0m11:19:15.114137 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:19:15.114137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA87DD0>]}
[0m11:19:15.115137 [error] [Thread-1 (]: 22 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_screenview  [[31mERROR[0m in 0.21s]
[0m11:19:15.117128 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:19:15.118133 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:19:15.119124 [info ] [Thread-1 (]: 23 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [RUN]
[0m11:19:15.121121 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_sessionstart'
[0m11:19:15.122134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_sessionstart)
[0m11:19:15.123133 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:19:15.129276 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:19:15.131620 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:19:15.123133 => 2023-10-06 11:19:15.131046
[0m11:19:15.132192 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:19:15.141674 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

            

    
        create table travelata.incremental_sheets_appmetrica_sessionstart
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
    )
        ...
[0m11:19:15.203899 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:15.209921 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_sessionstart'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:15.262305 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:15.267305 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:19:15.268321 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
    ...
[0m11:19:15.332585 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
    
[0m11:19:15.333580 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:19:15.132754 => 2023-10-06 11:19:15.333580
[0m11:19:15.338580 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:19:15.339579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26D243710>]}
[0m11:19:15.340566 [error] [Thread-1 (]: 23 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [[31mERROR[0m in 0.22s]
[0m11:19:15.342559 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:19:15.343565 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m11:19:15.344567 [info ] [Thread-1 (]: 24 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners ........... [[33mSKIP[0m]
[0m11:19:15.345568 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m11:19:15.346565 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:19:15.347567 [info ] [Thread-1 (]: 25 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners_statistics  [[33mSKIP[0m]
[0m11:19:15.348563 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:19:15.349573 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:19:15.350573 [info ] [Thread-1 (]: 26 of 33 SKIP relation travelata.incremental_sheets_mytarget_compagins ......... [[33mSKIP[0m]
[0m11:19:15.352572 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:19:15.353562 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:19:15.354567 [info ] [Thread-1 (]: 27 of 33 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m11:19:15.356587 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m11:19:15.357526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m11:19:15.358137 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:19:15.363597 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:19:15.365469 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 11:19:15.358742 => 2023-10-06 11:19:15.365469
[0m11:19:15.366080 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:19:15.371013 [debug] [Thread-1 (]: Creating new relation incremental_sheets_utmcraft_utmresult
[0m11:19:15.374873 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m11:19:15.443698 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:15.448698 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:15.503763 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:15.508768 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:19:15.510763 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m11:19:15.585160 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:15.589159 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 11:19:15.366659 => 2023-10-06 11:19:15.589159
[0m11:19:15.590162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E94D6D0>]}
[0m11:19:16.749192 [info ] [Thread-1 (]: 27 of 33 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.23s]
[0m11:19:16.751190 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:19:16.752195 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:19:16.753195 [info ] [Thread-1 (]: 28 of 33 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:19:16.756195 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m11:19:16.756195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m11:19:16.757195 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:19:16.767884 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:19:16.771205 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:19:16.758521 => 2023-10-06 11:19:16.771205
[0m11:19:16.772317 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:19:16.783354 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:16.829616 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:16.834607 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m11:19:16.896608 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:16.902613 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:16.951629 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:16.955638 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:19:16.957631 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m11:19:17.040477 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      
[0m11:19:17.042623 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:19:16.772894 => 2023-10-06 11:19:17.041480
[0m11:19:17.049477 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:19:17.050480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26DC32550>]}
[0m11:19:17.051472 [error] [Thread-1 (]: 28 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[31mERROR[0m in 0.30s]
[0m11:19:17.054439 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:19:17.055697 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:19:17.057007 [info ] [Thread-1 (]: 29 of 33 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m11:19:17.059590 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m11:19:17.060253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m11:19:17.061487 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:19:17.068167 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:19:17.070341 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:19:17.062112 => 2023-10-06 11:19:17.069828
[0m11:19:17.071000 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:19:17.081284 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:17.129272 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:17.134265 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m11:19:17.215264 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m11:19:17.221263 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:17.271264 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:17.275269 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:19:17.279270 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m11:19:17.358269 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      
[0m11:19:17.359287 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:19:17.071600 => 2023-10-06 11:19:17.359287
[0m11:19:17.365275 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:19:17.366272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E88C310>]}
[0m11:19:17.367820 [error] [Thread-1 (]: 29 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[31mERROR[0m in 0.31s]
[0m11:19:17.369593 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:19:17.370769 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:19:17.371369 [info ] [Thread-1 (]: 30 of 33 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m11:19:17.373740 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m11:19:17.374844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m11:19:17.375534 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:19:17.381638 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:19:17.383474 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 11:19:17.376163 => 2023-10-06 11:19:17.383474
[0m11:19:17.384657 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:19:17.396959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 
  ...
[0m11:19:17.449955 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:17.454947 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m11:19:17.521968 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:19:17.527976 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:17.591969 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:17.595977 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:19:17.596979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m11:19:17.678968 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_40d29a74_c27b_4e2b_8556_97858c6d17e3 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      
[0m11:19:17.678968 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 11:19:17.385244 => 2023-10-06 11:19:17.678968
[0m11:19:17.684976 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:19:17.685968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA97310>]}
[0m11:19:17.686979 [error] [Thread-1 (]: 30 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[31mERROR[0m in 0.31s]
[0m11:19:17.688961 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:19:17.689972 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:19:17.690971 [info ] [Thread-1 (]: 31 of 33 START sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [RUN]
[0m11:19:17.692959 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_mediaplans'
[0m11:19:17.692959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_mediaplans)
[0m11:19:17.693971 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:19:17.698957 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:19:17.700971 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:19:17.693971 => 2023-10-06 11:19:17.700971
[0m11:19:17.701579 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:19:17.709225 [debug] [Thread-1 (]: Creating new relation incremental_sheets_yandexdisk_mediaplans
[0m11:19:17.712507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_mediaplans
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
    )
        ...
[0m11:19:17.774149 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:17.779172 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_mediaplans'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:17.832069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:17.836065 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:19:17.838066 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_mediaplans ("Source", "Medium", "Campaign", "ProductName", "Geo", "Period_start", "Period_end", "Cost", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
  ...
[0m11:19:17.901975 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:17.905972 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:19:17.702215 => 2023-10-06 11:19:17.905972
[0m11:19:17.907172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E986210>]}
[0m11:19:17.907977 [info ] [Thread-1 (]: 31 of 33 OK created sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.22s]
[0m11:19:17.909972 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:19:17.910953 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:19:17.911972 [info ] [Thread-1 (]: 32 of 33 START sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [RUN]
[0m11:19:17.913972 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_othercosts'
[0m11:19:17.913972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_othercosts)
[0m11:19:17.914972 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:19:17.921495 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:19:17.923511 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:19:17.914972 => 2023-10-06 11:19:17.923511
[0m11:19:17.924151 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:19:17.933760 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_othercosts
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
    )
        ...
[0m11:19:17.993321 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:17.998429 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_othercosts'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:18.052250 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:18.056247 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:19:18.058250 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_othercosts ("__datetime", "Source", "Medium", "Campaign", "ProductName", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
  
    ...
[0m11:19:18.122432 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:18.134462 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:19:17.924797 => 2023-10-06 11:19:18.134462
[0m11:19:18.135462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EAFBB50>]}
[0m11:19:18.136462 [info ] [Thread-1 (]: 32 of 33 OK created sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.22s]
[0m11:19:18.138450 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:19:18.139455 [debug] [Thread-1 (]: Began running node model.travelata.incremental__sheets_yd_customreport
[0m11:19:18.140458 [info ] [Thread-1 (]: 33 of 33 START sql incremental model travelata.incremental__sheets_yd_customreport  [RUN]
[0m11:19:18.142457 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental__sheets_yd_customreport'
[0m11:19:18.142457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental__sheets_yd_customreport)
[0m11:19:18.143454 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental__sheets_yd_customreport
[0m11:19:18.149462 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:19:18.151462 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (compile): 2023-10-06 11:19:18.144454 => 2023-10-06 11:19:18.151462
[0m11:19:18.152454 [debug] [Thread-1 (]: Began executing node model.travelata.incremental__sheets_yd_customreport
[0m11:19:18.161606 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

            

    
        create table travelata.incremental__sheets_yd_customreport
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
    )
        ...
[0m11:19:18.225239 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:18.230236 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

    select name, type from system.columns where table = 'incremental__sheets_yd_customreport'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:19:18.282228 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:19:18.287218 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:19:18.289214 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

        
  
    
    
        
        insert into travelata.incremental__sheets_yd_customreport ("__datetime", "reportType", "CampaignId", "CampaignName", "CampaignType", "AdGroupId", "AdGroupName", "AdId", "CriterionId", "Criterion", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
  
    ...
[0m11:19:18.351880 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:19:18.356913 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (execute): 2023-10-06 11:19:18.152454 => 2023-10-06 11:19:18.356913
[0m11:19:18.358916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d29a74-c27b-4e2b-8556-97858c6d17e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26EA2C090>]}
[0m11:19:18.358916 [info ] [Thread-1 (]: 33 of 33 OK created sql incremental model travelata.incremental__sheets_yd_customreport  [[32mOK[0m in 0.22s]
[0m11:19:18.360913 [debug] [Thread-1 (]: Finished running node model.travelata.incremental__sheets_yd_customreport
[0m11:19:18.364288 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:19:18.365299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:18.366288 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:19:18.367296 [debug] [MainThread]: On list_schemas: Close
[0m11:19:18.368288 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:19:18.368288 [debug] [MainThread]: On list_None_travelata: Close
[0m11:19:18.369275 [debug] [MainThread]: Connection 'model.travelata.incremental__sheets_yd_customreport' was left open.
[0m11:19:18.369275 [debug] [MainThread]: On model.travelata.incremental__sheets_yd_customreport: Close
[0m11:19:18.370288 [info ] [MainThread]: 
[0m11:19:18.372297 [info ] [MainThread]: Finished running 17 view models, 11 incremental models, 5 table models in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m11:19:18.375676 [debug] [MainThread]: Command end result
[0m11:19:18.394218 [info ] [MainThread]: 
[0m11:19:18.395505 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m11:19:18.396670 [info ] [MainThread]: 
[0m11:19:18.397705 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)[0m
[0m11:19:18.399690 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:19:18.400712 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:19:18.402690 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:19:18.403709 [info ] [MainThread]: 
[0m11:19:18.405691 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)[0m
[0m11:19:18.407693 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:19:18.408691 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:19:18.410691 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:19:18.411716 [info ] [MainThread]: 
[0m11:19:18.413694 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)[0m
[0m11:19:18.415700 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:19:18.416710 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:19:18.418692 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:19:18.420713 [info ] [MainThread]: 
[0m11:19:18.421689 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)[0m
[0m11:19:18.423715 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.425695 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.427702 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:19:18.429693 [info ] [MainThread]: 
[0m11:19:18.430696 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)[0m
[0m11:19:18.432696 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.434701 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.436695 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:19:18.438696 [info ] [MainThread]: 
[0m11:19:18.439695 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)[0m
[0m11:19:18.441712 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.442699 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.444695 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:19:18.446696 [info ] [MainThread]: 
[0m11:19:18.447695 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)[0m
[0m11:19:18.449692 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.450693 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.452692 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:19:18.454694 [info ] [MainThread]: 
[0m11:19:18.455695 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)[0m
[0m11:19:18.457692 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.458692 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.460701 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:19:18.462689 [info ] [MainThread]: 
[0m11:19:18.463695 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)[0m
[0m11:19:18.465695 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:19:18.467692 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:19:18.469695 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:19:18.470701 [info ] [MainThread]: 
[0m11:19:18.471690 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=9 SKIP=3 TOTAL=33
[0m11:19:18.473700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E6D7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E6D7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F26E6D6CD0>]}
[0m11:19:18.474694 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 11:30:14.398902 | 6a9e92d5-54ff-4d42-a72c-d274e4e1c307 ==============================
[0m11:30:14.398902 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:30:14.402902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ZeBook\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:30:14.403910 [debug] [MainThread]: Tracking: tracking
[0m11:30:14.418902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0659E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290DD972C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E019F690>]}
[0m11:30:14.439697 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:30:14.633286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:14.634286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:14.638286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m11:30:14.653287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0D684D0>]}
[0m11:30:14.670893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0CCFCD0>]}
[0m11:30:14.671682 [info ] [MainThread]: Found 33 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:30:14.673140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0C2E7D0>]}
[0m11:30:14.677674 [info ] [MainThread]: 
[0m11:30:14.681524 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:30:14.687506 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:30:14.709524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:15.366360 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:30:15.417909 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:15.426905 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:30:15.437907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:16.017377 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:30:16.079068 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:16.093076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290D9DA6890>]}
[0m11:30:16.094068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:16.096050 [info ] [MainThread]: 
[0m11:30:16.106068 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:30:16.107073 [info ] [Thread-1 (]: 1 of 33 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m11:30:16.110050 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m11:30:16.110050 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:30:16.113975 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:30:16.115724 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:30:16.111048 => 2023-10-06 11:30:16.115724
[0m11:30:16.116292 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:30:16.193811 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:30:16.194811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:30:16.796710 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m11:30:16.858073 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:16.872081 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:30:16.926275 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:16.929283 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:30:16.986694 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:16.991691 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:30:17.046793 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.048792 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:30:17.106184 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.157205 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m11:30:17.216334 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.218342 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:30:16.116878 => 2023-10-06 11:30:17.218342
[0m11:30:17.220343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0E76650>]}
[0m11:30:17.221327 [info ] [Thread-1 (]: 1 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.11s]
[0m11:30:17.225334 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:30:17.226334 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m11:30:17.227334 [info ] [Thread-1 (]: 2 of 33 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m11:30:17.229329 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m11:30:17.230335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m11:30:17.230335 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m11:30:17.233993 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:30:17.235353 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 11:30:17.231335 => 2023-10-06 11:30:17.235353
[0m11:30:17.235988 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m11:30:17.245359 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:30:17.247107 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m11:30:17.304583 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.310595 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:30:17.356621 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.358629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:30:17.406083 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.411090 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:30:17.466166 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.469167 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:30:17.516159 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.523139 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m11:30:17.587164 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.590160 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 11:30:17.237172 => 2023-10-06 11:30:17.589162
[0m11:30:17.591161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0CE5050>]}
[0m11:30:17.592161 [info ] [Thread-1 (]: 2 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m11:30:17.593163 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m11:30:17.594162 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m11:30:17.595168 [info ] [Thread-1 (]: 3 of 33 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m11:30:17.597160 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m11:30:17.598164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m11:30:17.599163 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m11:30:17.602676 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:30:17.603945 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 11:30:17.599163 => 2023-10-06 11:30:17.603945
[0m11:30:17.605104 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m11:30:17.615618 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:30:17.617050 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m11:30:17.676855 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.682864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:30:17.745857 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.748849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:30:17.796063 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.801079 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:30:17.855679 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.858700 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:30:17.906558 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:17.913557 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m11:30:17.976128 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:17.979126 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 11:30:17.605618 => 2023-10-06 11:30:17.979126
[0m11:30:17.980254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E1042190>]}
[0m11:30:17.981121 [info ] [Thread-1 (]: 3 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.38s]
[0m11:30:17.983111 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m11:30:17.984122 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:30:17.985115 [info ] [Thread-1 (]: 4 of 33 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m11:30:17.987101 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m11:30:17.988105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m11:30:17.988105 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:30:17.991121 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:30:17.993131 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 11:30:17.989108 => 2023-10-06 11:30:17.993131
[0m11:30:17.994130 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:30:18.001129 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:30:18.003105 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m11:30:18.072482 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:18.081488 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:30:18.136504 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.138493 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:30:18.185933 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.190945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:30:18.235955 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:30:18.238955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:30:18.286585 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.293604 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m11:30:18.346308 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.349294 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 11:30:17.994130 => 2023-10-06 11:30:18.349294
[0m11:30:18.351295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E060EB50>]}
[0m11:30:18.352294 [info ] [Thread-1 (]: 4 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.37s]
[0m11:30:18.354292 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:30:18.355293 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:30:18.356317 [info ] [Thread-1 (]: 5 of 33 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m11:30:18.358292 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m11:30:18.359292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m11:30:18.359292 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:30:18.362289 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:30:18.364295 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 11:30:18.360295 => 2023-10-06 11:30:18.364295
[0m11:30:18.365298 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:30:18.374814 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:30:18.376583 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'eventDateTime') AS __datetime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m11:30:18.433454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:18.438456 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:30:18.486480 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.488480 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:30:18.536026 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.541041 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:30:18.596453 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.598453 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:30:18.646549 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.655550 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m11:30:18.706549 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.708549 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 11:30:18.366298 => 2023-10-06 11:30:18.708549
[0m11:30:18.710554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E1063650>]}
[0m11:30:18.710554 [info ] [Thread-1 (]: 5 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.35s]
[0m11:30:18.712542 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:30:18.713549 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:30:18.714537 [info ] [Thread-1 (]: 6 of 33 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m11:30:18.716536 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m11:30:18.716536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m11:30:18.717549 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:30:18.720549 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:30:18.722537 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:30:18.717549 => 2023-10-06 11:30:18.721747
[0m11:30:18.722537 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:30:18.731561 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:30:18.732532 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'session_start_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m11:30:18.795285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:18.800293 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:30:18.846528 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.849556 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:30:18.896184 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.902189 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:30:18.956240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:18.958231 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:30:19.006120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.014099 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m11:30:19.068747 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.071153 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:30:18.723551 => 2023-10-06 11:30:19.071153
[0m11:30:19.072841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E10626D0>]}
[0m11:30:19.073985 [info ] [Thread-1 (]: 6 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.36s]
[0m11:30:19.075691 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:30:19.076268 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:30:19.077421 [info ] [Thread-1 (]: 7 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m11:30:19.079165 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m11:30:19.079752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m11:30:19.080331 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:30:19.083213 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:30:19.085690 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 11:30:19.080910 => 2023-10-06 11:30:19.085170
[0m11:30:19.086297 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:30:19.091372 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_new
[0m11:30:19.093559 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:30:19.095245 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m11:30:19.148802 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )
[0m11:30:19.149943 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 11:30:19.086863 => 2023-10-06 11:30:19.149375
[0m11:30:19.158857 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:30:19.159962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0D069D0>]}
[0m11:30:19.161024 [error] [Thread-1 (]: 7 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_new  [[31mERROR[0m in 0.08s]
[0m11:30:19.162741 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:30:19.163306 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:30:19.165019 [info ] [Thread-1 (]: 8 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m11:30:19.166689 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m11:30:19.167236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m11:30:19.167784 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:30:19.171608 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:30:19.173335 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 11:30:19.168344 => 2023-10-06 11:30:19.173335
[0m11:30:19.173916 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:30:19.178829 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_statjstics_new
[0m11:30:19.181050 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:30:19.183363 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m11:30:19.238231 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )
[0m11:30:19.239629 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 11:30:19.175030 => 2023-10-06 11:30:19.239629
[0m11:30:19.245221 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:30:19.245855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E1044050>]}
[0m11:30:19.247641 [error] [Thread-1 (]: 8 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[31mERROR[0m in 0.08s]
[0m11:30:19.251500 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:30:19.255091 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:30:19.257527 [info ] [Thread-1 (]: 9 of 33 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m11:30:19.260036 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m11:30:19.261288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m11:30:19.263154 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:30:19.268674 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:30:19.272866 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 11:30:19.264380 => 2023-10-06 11:30:19.272866
[0m11:30:19.274725 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:30:19.281942 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_compagins_new
[0m11:30:19.287515 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:30:19.289202 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m11:30:19.340950 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )
[0m11:30:19.341508 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 11:30:19.276258 => 2023-10-06 11:30:19.341508
[0m11:30:19.347489 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:30:19.348695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E11CD990>]}
[0m11:30:19.349837 [error] [Thread-1 (]: 9 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_compagins_new  [[31mERROR[0m in 0.09s]
[0m11:30:19.351807 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:30:19.352544 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:30:19.354276 [info ] [Thread-1 (]: 10 of 33 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m11:30:19.356240 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m11:30:19.356796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m11:30:19.357489 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:30:19.360220 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:30:19.362220 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 11:30:19.357489 => 2023-10-06 11:30:19.362220
[0m11:30:19.363216 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:30:19.372215 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:30:19.373839 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m11:30:19.431834 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:19.439849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:30:19.486660 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.488664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:30:19.538909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.602908 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:30:19.666026 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:19.668026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:30:19.716412 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.724229 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m11:30:19.776655 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.779761 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 11:30:19.363216 => 2023-10-06 11:30:19.779761
[0m11:30:19.780657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E11EDC50>]}
[0m11:30:19.781652 [info ] [Thread-1 (]: 10 of 33 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.43s]
[0m11:30:19.783631 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:30:19.783631 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:30:19.784652 [info ] [Thread-1 (]: 11 of 33 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:30:19.786657 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m11:30:19.787652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m11:30:19.787652 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:30:19.791657 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:30:19.792660 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:30:19.788660 => 2023-10-06 11:30:19.792660
[0m11:30:19.793638 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:30:19.802461 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:30:19.804354 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m11:30:19.875228 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:19.880237 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:30:19.926201 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:30:19.928192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:30:19.977298 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:19.982293 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:30:20.036316 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.038315 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:30:20.086409 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.093414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m11:30:20.155980 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:20.157988 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:30:19.793638 => 2023-10-06 11:30:20.157988
[0m11:30:20.159988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E11CC350>]}
[0m11:30:20.160980 [info ] [Thread-1 (]: 11 of 33 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.37s]
[0m11:30:20.162986 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:30:20.163981 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:30:20.164980 [info ] [Thread-1 (]: 12 of 33 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m11:30:20.166978 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m11:30:20.167983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m11:30:20.168980 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:30:20.172177 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:30:20.173541 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:30:20.168980 => 2023-10-06 11:30:20.173541
[0m11:30:20.174181 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:30:20.182400 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:30:20.183687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m11:30:20.245613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:20.250603 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:30:20.306311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.308308 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:30:20.358249 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.363328 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:30:20.427324 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:20.429333 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:30:20.477028 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.485028 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m11:30:20.536535 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.538533 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:30:20.174812 => 2023-10-06 11:30:20.538533
[0m11:30:20.539542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E101F510>]}
[0m11:30:20.540543 [info ] [Thread-1 (]: 12 of 33 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.37s]
[0m11:30:20.542521 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:30:20.543526 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:30:20.544536 [info ] [Thread-1 (]: 13 of 33 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m11:30:20.546533 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m11:30:20.547533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m11:30:20.548535 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:30:20.550541 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:30:20.552542 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 11:30:20.548535 => 2023-10-06 11:30:20.552542
[0m11:30:20.553518 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:30:20.563686 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:30:20.565639 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m11:30:20.626212 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:20.632209 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:30:20.686448 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.688456 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:30:20.736516 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.741534 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:30:20.796739 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.798467 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:30:20.846656 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.853655 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m11:30:20.906661 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.908659 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 11:30:20.553518 => 2023-10-06 11:30:20.908659
[0m11:30:20.910664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0E9DC10>]}
[0m11:30:20.911655 [info ] [Thread-1 (]: 13 of 33 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.36s]
[0m11:30:20.913659 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:30:20.914661 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:30:20.915657 [info ] [Thread-1 (]: 14 of 33 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m11:30:20.918663 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m11:30:20.919662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m11:30:20.920666 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:30:20.926366 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:30:20.928191 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:30:20.922269 => 2023-10-06 11:30:20.928191
[0m11:30:20.929361 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:30:20.938149 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:30:20.939807 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m11:30:20.993215 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:20.998211 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:30:21.047226 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.049231 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:30:21.096889 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.101898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:30:21.156492 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.158492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:30:21.208794 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.216849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m11:30:21.267141 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.270146 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:30:20.929967 => 2023-10-06 11:30:21.270146
[0m11:30:21.272148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F833D0>]}
[0m11:30:21.273141 [info ] [Thread-1 (]: 14 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m11:30:21.275129 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:30:21.276145 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:30:21.277134 [info ] [Thread-1 (]: 15 of 33 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m11:30:21.279126 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m11:30:21.280133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m11:30:21.281124 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:30:21.284071 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:30:21.285830 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:30:21.281124 => 2023-10-06 11:30:21.285830
[0m11:30:21.286425 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:30:21.294692 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:30:21.296473 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m11:30:21.354731 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:21.359731 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:30:21.406084 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.409088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:30:21.466513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:21.471520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:30:21.526208 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.528208 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:30:21.576386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.586394 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m11:30:21.638081 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.641074 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:30:21.287014 => 2023-10-06 11:30:21.641074
[0m11:30:21.643073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0FBEDD0>]}
[0m11:30:21.644073 [info ] [Thread-1 (]: 15 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.36s]
[0m11:30:21.647075 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:30:21.647075 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m11:30:21.648073 [info ] [Thread-1 (]: 16 of 33 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m11:30:21.651072 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m11:30:21.652073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m11:30:21.652073 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m11:30:21.656080 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:30:21.657083 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 11:30:21.653075 => 2023-10-06 11:30:21.657083
[0m11:30:21.658081 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m11:30:21.666062 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:30:21.667754 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m11:30:21.725332 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:21.730332 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:30:21.776219 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.778219 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:30:21.828734 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.834731 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:30:21.885926 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.888920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:30:21.936696 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.944568 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m11:30:21.996628 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:21.998635 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 11:30:21.658081 => 2023-10-06 11:30:21.998635
[0m11:30:22.000635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0C35390>]}
[0m11:30:22.000635 [info ] [Thread-1 (]: 16 of 33 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.35s]
[0m11:30:22.002632 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m11:30:22.003638 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:30:22.004627 [info ] [Thread-1 (]: 17 of 33 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m11:30:22.006627 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m11:30:22.006627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m11:30:22.007637 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m11:30:22.010627 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:30:22.011618 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 11:30:22.007637 => 2023-10-06 11:30:22.011618
[0m11:30:22.012615 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m11:30:22.020635 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:30:22.021632 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m11:30:22.085613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:22.090621 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:30:22.137154 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.139150 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:30:22.188425 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.193430 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:30:22.245674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.248703 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:30:22.296687 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.303664 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m11:30:22.356857 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.359866 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 11:30:22.012615 => 2023-10-06 11:30:22.359866
[0m11:30:22.360866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F0E550>]}
[0m11:30:22.361857 [info ] [Thread-1 (]: 17 of 33 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.36s]
[0m11:30:22.362868 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:30:22.363858 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:30:22.364857 [info ] [Thread-1 (]: 18 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [RUN]
[0m11:30:22.366857 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_deeplinks'
[0m11:30:22.367845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_deeplinks)
[0m11:30:22.367845 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:30:22.374279 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:30:22.376181 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:30:22.368493 => 2023-10-06 11:30:22.375562
[0m11:30:22.376819 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:30:22.461576 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.incremental_sheets_appmetrica_deeplinks__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:22.516571 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.567580 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

            

    
        create table travelata.incremental_sheets_appmetrica_deeplinks__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
    )
        ...
[0m11:30:22.630629 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:22.648629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_deeplinks__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:22.698527 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.706520 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:30:22.708524 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
      ...
[0m11:30:22.766676 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
      
[0m11:30:22.767676 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:30:22.377336 => 2023-10-06 11:30:22.767676
[0m11:30:22.773660 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:30:22.774676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0DA8990>]}
[0m11:30:22.775667 [error] [Thread-1 (]: 18 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [[31mERROR[0m in 0.41s]
[0m11:30:22.777676 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:30:22.777676 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m11:30:22.778677 [info ] [Thread-1 (]: 19 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m11:30:22.780677 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m11:30:22.781676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m11:30:22.781676 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m11:30:22.787685 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:30:22.789686 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 11:30:22.782685 => 2023-10-06 11:30:22.789686
[0m11:30:22.789686 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m11:30:22.801055 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:22.846003 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:30:22.850026 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m11:30:22.911151 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:22.917158 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:22.968679 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:22.972674 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:30:22.973656 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
      ...
[0m11:30:23.038877 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:23.040876 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

      delete from travelata.incremental_sheets_appmetrica_events where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307);
    ...
[0m11:30:23.117610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m11:30:23.121610 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:23.188085 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:23.191108 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        insert into travelata.incremental_sheets_appmetrica_events select "__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
    ...
[0m11:30:23.264099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:23.269108 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:23.317325 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.322322 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */
drop table if exists travelata.incremental_sheets_appmetrica_events__dbt_distributed_new_data 
  ...
[0m11:30:23.376867 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.380867 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 11:30:22.790677 => 2023-10-06 11:30:23.380867
[0m11:30:23.381875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E1061010>]}
[0m11:30:23.382872 [info ] [Thread-1 (]: 19 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.60s]
[0m11:30:23.384867 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m11:30:23.385870 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m11:30:23.386863 [info ] [Thread-1 (]: 20 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m11:30:23.388860 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m11:30:23.388860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m11:30:23.389867 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m11:30:23.395876 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:30:23.397849 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 11:30:23.389867 => 2023-10-06 11:30:23.397849
[0m11:30:23.398770 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m11:30:23.412127 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:23.466127 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.470135 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m11:30:23.531574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:23.537598 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:23.588623 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.591626 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:30:23.593623 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
      ...
[0m11:30:23.657969 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:23.659970 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

      delete from travelata.incremental_sheets_appmetrica_install where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307);
    ...
[0m11:30:23.732866 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:23.737883 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:23.789196 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.793195 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        insert into travelata.incremental_sheets_appmetrica_install select "__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at" from travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
    ...
[0m11:30:23.854571 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:23.860595 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:23.907058 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.912056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */
drop table if exists travelata.incremental_sheets_appmetrica_install__dbt_distributed_new_data 
  ...
[0m11:30:23.966559 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:23.970788 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 11:30:23.399401 => 2023-10-06 11:30:23.970518
[0m11:30:23.971985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F585D0>]}
[0m11:30:23.973141 [info ] [Thread-1 (]: 20 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.58s]
[0m11:30:23.974973 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m11:30:23.975581 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:30:23.976166 [info ] [Thread-1 (]: 21 of 33 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m11:30:23.979183 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m11:30:23.979762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m11:30:23.980364 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:30:23.985944 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:30:23.987947 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 11:30:23.980939 => 2023-10-06 11:30:23.987947
[0m11:30:23.987947 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:30:24.024943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m11:30:24.090190 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:24.095206 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:24.158983 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:24.161991 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:30:24.163988 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles__dbt_backup ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m11:30:24.223574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:24.233580 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
EXCHANGE TABLES travelata.incremental_sheets_appmetrica_profiles__dbt_backup AND travelata.incremental_sheets_appmetrica_profiles 
  
  ...
[0m11:30:24.287017 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.295009 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */
drop table if exists travelata.incremental_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m11:30:24.347778 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.349771 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 11:30:23.988947 => 2023-10-06 11:30:24.349771
[0m11:30:24.350784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0DB69D0>]}
[0m11:30:24.351781 [info ] [Thread-1 (]: 21 of 33 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.37s]
[0m11:30:24.353750 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:30:24.354783 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:30:24.355772 [info ] [Thread-1 (]: 22 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_screenview  [RUN]
[0m11:30:24.357773 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_screenview'
[0m11:30:24.357773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_screenview)
[0m11:30:24.358772 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:30:24.364749 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:30:24.365751 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (compile): 2023-10-06 11:30:24.358772 => 2023-10-06 11:30:24.365751
[0m11:30:24.367012 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:30:24.378206 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */
drop table if exists travelata.incremental_sheets_appmetrica_screenview__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:24.426555 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.431572 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

            

    
        create table travelata.incremental_sheets_appmetrica_screenview__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
    )
        ...
[0m11:30:24.501505 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:24.506503 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_screenview__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:24.558097 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.564106 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:30:24.565097 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
      ...
[0m11:30:24.624640 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
      
[0m11:30:24.625640 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (execute): 2023-10-06 11:30:24.367594 => 2023-10-06 11:30:24.625640
[0m11:30:24.633983 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:30:24.634645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F7A050>]}
[0m11:30:24.635649 [error] [Thread-1 (]: 22 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_screenview  [[31mERROR[0m in 0.28s]
[0m11:30:24.637631 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:30:24.638640 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:30:24.639640 [info ] [Thread-1 (]: 23 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [RUN]
[0m11:30:24.641649 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_sessionstart'
[0m11:30:24.642640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_sessionstart)
[0m11:30:24.642640 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:30:24.648634 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:30:24.650299 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:30:24.643650 => 2023-10-06 11:30:24.650299
[0m11:30:24.651453 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:30:24.662370 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.incremental_sheets_appmetrica_sessionstart__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:24.716420 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.721428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

            

    
        create table travelata.incremental_sheets_appmetrica_sessionstart__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
    )
        ...
[0m11:30:24.790981 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:24.795976 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_sessionstart__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:24.848633 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:24.851633 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:30:24.853624 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
      ...
[0m11:30:24.915077 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
      
[0m11:30:24.915077 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:30:24.651568 => 2023-10-06 11:30:24.915077
[0m11:30:24.921067 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:30:24.922076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E11F7C10>]}
[0m11:30:24.923079 [error] [Thread-1 (]: 23 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [[31mERROR[0m in 0.28s]
[0m11:30:24.925077 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:30:24.926071 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m11:30:24.926071 [info ] [Thread-1 (]: 24 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners ........... [[33mSKIP[0m]
[0m11:30:24.928079 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m11:30:24.929071 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:30:24.930071 [info ] [Thread-1 (]: 25 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners_statistics  [[33mSKIP[0m]
[0m11:30:24.931069 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:30:24.932051 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:30:24.932051 [info ] [Thread-1 (]: 26 of 33 SKIP relation travelata.incremental_sheets_mytarget_compagins ......... [[33mSKIP[0m]
[0m11:30:24.934392 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:30:24.935560 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:30:24.936165 [info ] [Thread-1 (]: 27 of 33 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m11:30:24.937954 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m11:30:24.939115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m11:30:24.939704 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:30:24.945008 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:30:24.946732 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 11:30:24.940220 => 2023-10-06 11:30:24.946732
[0m11:30:24.947329 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:30:24.955072 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m11:30:25.020362 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:25.027342 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:25.078408 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:25.082400 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:30:25.084399 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult__dbt_backup ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m11:30:25.156710 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:25.159711 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
EXCHANGE TABLES travelata.incremental_sheets_utmcraft_utmresult__dbt_backup AND travelata.incremental_sheets_utmcraft_utmresult 
  
  ...
[0m11:30:25.207464 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:25.214462 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */
drop table if exists travelata.incremental_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m11:30:25.266805 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:25.269813 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 11:30:24.947931 => 2023-10-06 11:30:25.269813
[0m11:30:25.270805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0DBD110>]}
[0m11:30:25.271810 [info ] [Thread-1 (]: 27 of 33 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.33s]
[0m11:30:25.273807 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:30:25.273807 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:30:25.274805 [info ] [Thread-1 (]: 28 of 33 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:30:25.276793 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m11:30:25.277785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m11:30:25.277785 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:30:25.283785 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:30:25.285786 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:30:25.278786 => 2023-10-06 11:30:25.285786
[0m11:30:25.286786 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:30:25.298149 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:25.346206 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:25.351215 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m11:30:25.412385 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:25.419385 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:25.469123 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:25.472096 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:30:25.474110 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      ...
[0m11:30:25.553570 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
      
[0m11:30:25.553570 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:30:25.287548 => 2023-10-06 11:30:25.553570
[0m11:30:25.559571 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:30:25.560578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0CE6A90>]}
[0m11:30:26.778874 [error] [Thread-1 (]: 28 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[31mERROR[0m in 0.28s]
[0m11:30:26.780884 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:30:26.780884 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:30:26.781873 [info ] [Thread-1 (]: 29 of 33 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m11:30:26.784884 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m11:30:26.785881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m11:30:26.785881 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:30:26.795879 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:30:26.796875 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:30:26.786881 => 2023-10-06 11:30:26.796875
[0m11:30:26.797880 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:30:26.808870 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:26.855897 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:26.860883 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m11:30:26.932902 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:26.938893 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:26.988245 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:26.993267 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:30:26.994263 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      ...
[0m11:30:27.074104 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
      
[0m11:30:27.075100 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:30:26.798878 => 2023-10-06 11:30:27.075100
[0m11:30:27.081098 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:30:27.082117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E11FC0D0>]}
[0m11:30:27.084101 [error] [Thread-1 (]: 29 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[31mERROR[0m in 0.30s]
[0m11:30:27.085104 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:30:27.086103 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:30:27.087094 [info ] [Thread-1 (]: 30 of 33 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m11:30:27.089103 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m11:30:27.090104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m11:30:27.090104 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:30:27.096119 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:30:27.098119 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 11:30:27.091099 => 2023-10-06 11:30:27.098119
[0m11:30:27.099096 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:30:27.110096 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */
drop table if exists travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:27.156120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.161125 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m11:30:27.220105 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:27.226099 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:27.279099 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.282102 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:30:27.284099 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      ...
[0m11:30:27.363332 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
      
[0m11:30:27.364335 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 11:30:27.099096 => 2023-10-06 11:30:27.364335
[0m11:30:27.369357 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:30:27.370357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0C72350>]}
[0m11:30:27.371363 [error] [Thread-1 (]: 30 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[31mERROR[0m in 0.28s]
[0m11:30:27.373329 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:30:27.374329 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:30:27.375330 [info ] [Thread-1 (]: 31 of 33 START sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [RUN]
[0m11:30:27.376329 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_mediaplans'
[0m11:30:27.377332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_mediaplans)
[0m11:30:27.378328 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:30:27.383330 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:30:27.385330 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:30:27.378328 => 2023-10-06 11:30:27.384329
[0m11:30:27.385330 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:30:27.393327 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_mediaplans__dbt_backup
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
    )
        ...
[0m11:30:27.462492 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:27.468504 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_mediaplans__dbt_backup'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:27.519842 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.523848 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:30:27.524848 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_mediaplans__dbt_backup ("Source", "Medium", "Campaign", "ProductName", "Geo", "Period_start", "Period_end", "Cost", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
  ...
[0m11:30:27.586825 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:27.589845 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */
EXCHANGE TABLES travelata.incremental_sheets_yandexdisk_mediaplans__dbt_backup AND travelata.incremental_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:30:27.637255 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.645017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.incremental_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m11:30:27.696642 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.699658 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:30:27.386328 => 2023-10-06 11:30:27.699658
[0m11:30:27.700645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0DBE090>]}
[0m11:30:27.701661 [info ] [Thread-1 (]: 31 of 33 OK created sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.32s]
[0m11:30:27.703647 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:30:27.704657 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:30:27.705653 [info ] [Thread-1 (]: 32 of 33 START sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [RUN]
[0m11:30:27.706660 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_othercosts'
[0m11:30:27.707653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_othercosts)
[0m11:30:27.707653 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:30:27.713659 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:30:27.714658 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:30:27.708654 => 2023-10-06 11:30:27.714658
[0m11:30:27.715663 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:30:27.729785 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:27.775975 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.780972 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
    )
        ...
[0m11:30:27.840684 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:27.846702 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:27.898276 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:27.901275 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:30:27.903358 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "Source", "Medium", "Campaign", "ProductName", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
  
      ...
[0m11:30:27.964627 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:27.966626 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

      delete from travelata.incremental_sheets_yandexdisk_othercosts where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307);
    ...
[0m11:30:28.045120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m11:30:28.049129 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_othercosts'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:28.098732 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.101727 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

        insert into travelata.incremental_sheets_yandexdisk_othercosts select "__datetime", "Source", "Medium", "Campaign", "ProductName", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
    ...
[0m11:30:28.160864 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:28.165864 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.incremental_sheets_yandexdisk_othercosts__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:28.216138 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.221337 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.incremental_sheets_yandexdisk_othercosts__dbt_distributed_new_data 
  ...
[0m11:30:28.275739 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.279737 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:30:27.716657 => 2023-10-06 11:30:28.279737
[0m11:30:28.281742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F61150>]}
[0m11:30:28.282758 [info ] [Thread-1 (]: 32 of 33 OK created sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.58s]
[0m11:30:28.284745 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:30:28.285740 [debug] [Thread-1 (]: Began running node model.travelata.incremental__sheets_yd_customreport
[0m11:30:28.286738 [info ] [Thread-1 (]: 33 of 33 START sql incremental model travelata.incremental__sheets_yd_customreport  [RUN]
[0m11:30:28.287736 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental__sheets_yd_customreport'
[0m11:30:28.288735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental__sheets_yd_customreport)
[0m11:30:28.289735 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental__sheets_yd_customreport
[0m11:30:28.295756 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:30:28.296756 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (compile): 2023-10-06 11:30:28.289735 => 2023-10-06 11:30:28.296756
[0m11:30:28.297764 [debug] [Thread-1 (]: Began executing node model.travelata.incremental__sheets_yd_customreport
[0m11:30:28.308756 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */
drop table if exists travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:28.355757 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.360737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

            

    
        create table travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
    )
        ...
[0m11:30:28.421711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:28.427708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

    select name, type from system.columns where table = 'incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:28.477645 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.481650 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:30:28.482650 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

        
  
    
    
        
        insert into travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 ("__datetime", "reportType", "CampaignId", "CampaignName", "CampaignType", "AdGroupId", "AdGroupName", "AdId", "CriterionId", "Criterion", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
  
      ...
[0m11:30:28.547212 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:28.549214 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

      delete from travelata.incremental__sheets_yd_customreport where (toDate(__datetime), __table_name) in (select toDate(__datetime), __table_name
                                          from travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307);
    ...
[0m11:30:28.624419 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:30:28.628414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

    select name, type from system.columns where table = 'incremental__sheets_yd_customreport'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:30:28.688647 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:28.692647 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

        insert into travelata.incremental__sheets_yd_customreport select "__datetime", "reportType", "CampaignId", "CampaignName", "CampaignType", "AdGroupId", "AdGroupName", "AdId", "CriterionId", "Criterion", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at" from travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307
    ...
[0m11:30:28.751115 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:30:28.756116 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */
drop table if exists travelata.incremental__sheets_yd_customreport__dbt_new_data_6a9e92d5_54ff_4d42_a72c_d274e4e1c307 
  ...
[0m11:30:28.807071 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.812080 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */
drop table if exists travelata.incremental__sheets_yd_customreport__dbt_distributed_new_data 
  ...
[0m11:30:28.866727 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:30:28.870726 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (execute): 2023-10-06 11:30:28.297764 => 2023-10-06 11:30:28.870726
[0m11:30:28.871732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9e92d5-54ff-4d42-a72c-d274e4e1c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E1006D90>]}
[0m11:30:28.872717 [info ] [Thread-1 (]: 33 of 33 OK created sql incremental model travelata.incremental__sheets_yd_customreport  [[32mOK[0m in 0.58s]
[0m11:30:28.874720 [debug] [Thread-1 (]: Finished running node model.travelata.incremental__sheets_yd_customreport
[0m11:30:28.877726 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:30:28.878708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:28.879709 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:30:28.879709 [debug] [MainThread]: On list_schemas: Close
[0m11:30:28.880735 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:30:28.881727 [debug] [MainThread]: On list_None_travelata: Close
[0m11:30:28.881727 [debug] [MainThread]: Connection 'model.travelata.incremental__sheets_yd_customreport' was left open.
[0m11:30:28.882707 [debug] [MainThread]: On model.travelata.incremental__sheets_yd_customreport: Close
[0m11:30:28.883730 [info ] [MainThread]: 
[0m11:30:28.885728 [info ] [MainThread]: Finished running 17 view models, 11 incremental models, 5 table models in 0 hours 0 minutes and 14.20 seconds (14.20s).
[0m11:30:28.888728 [debug] [MainThread]: Command end result
[0m11:30:28.907726 [info ] [MainThread]: 
[0m11:30:28.908710 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m11:30:28.910731 [info ] [MainThread]: 
[0m11:30:28.911727 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)[0m
[0m11:30:28.913714 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:30:28.914729 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:30:28.916713 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:30:28.918712 [info ] [MainThread]: 
[0m11:30:28.919713 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)[0m
[0m11:30:28.921712 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:30:28.922712 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:30:28.924708 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:30:28.925715 [info ] [MainThread]: 
[0m11:30:28.927709 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)[0m
[0m11:30:28.928712 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:30:28.930705 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:30:28.931706 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:30:28.933712 [info ] [MainThread]: 
[0m11:30:28.934712 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)[0m
[0m11:30:28.936705 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.937716 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.940716 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:30:28.941713 [info ] [MainThread]: 
[0m11:30:28.943708 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)[0m
[0m11:30:28.945711 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.946715 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.948712 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:30:28.949711 [info ] [MainThread]: 
[0m11:30:28.951712 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)[0m
[0m11:30:28.952710 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.954722 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.955712 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:30:28.957713 [info ] [MainThread]: 
[0m11:30:28.959707 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)[0m
[0m11:30:28.960714 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.962710 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.963713 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:30:28.965713 [info ] [MainThread]: 
[0m11:30:28.966708 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)[0m
[0m11:30:28.968712 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.969713 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.971709 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:30:28.973709 [info ] [MainThread]: 
[0m11:30:28.974715 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)[0m
[0m11:30:28.976711 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:30:28.977711 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:30:28.979713 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:30:28.981713 [info ] [MainThread]: 
[0m11:30:28.982715 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=9 SKIP=3 TOTAL=33
[0m11:30:28.983711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E060EC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E00D23D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290E0F33B90>]}
[0m11:30:28.984707 [debug] [MainThread]: Flushing usage events


============================== 2023-10-06 11:37:04.370951 | cd4d81c7-931e-4eb6-ae77-5872ff82ec2a ==============================
[0m11:37:04.370951 [info ] [MainThread]: Running with dbt=1.4.8
[0m11:37:04.373946 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\ZeBook\\.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:37:04.374949 [debug] [MainThread]: Tracking: tracking
[0m11:37:04.389948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D46A710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D667CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D707690>]}
[0m11:37:04.411653 [debug] [MainThread]: checksum: f01b10a6d8b8fec35a0597d95e90748b0c8d809fd4dc5966a395de2efe8a9e99, vars: {}, profile: None, target: None, version: 1.4.8
[0m11:37:04.595361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:04.596359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:04.599359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.travelata.example
[0m11:37:04.613362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D44FF90>]}
[0m11:37:04.631398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DEB3A10>]}
[0m11:37:04.631980 [info ] [MainThread]: Found 33 models, 0 tests, 0 snapshots, 0 analyses, 324 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:37:04.633717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4CAF9A50>]}
[0m11:37:04.638354 [info ] [MainThread]: 
[0m11:37:04.642674 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:37:04.648252 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_schemas'
[0m11:37:04.668252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:05.323205 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
[0m11:37:05.373477 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:05.382486 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_None_travelata'
[0m11:37:05.394469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:05.973023 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_None_travelata: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "connection_name": "list_None_travelata"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine
    from system.tables as t JOIN system.databases as db on t.database = db.name
    where schema = 'travelata'
  ...
[0m11:37:06.026692 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:06.037636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DEA3CD0>]}
[0m11:37:06.039443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:06.040472 [info ] [MainThread]: 
[0m11:37:06.051406 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:37:06.052401 [info ] [Thread-1 (]: 1 of 33 START sql view model travelata.normalized_sheets_appmetrica_deeplinks .. [RUN]
[0m11:37:06.054406 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_deeplinks'
[0m11:37:06.055411 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:37:06.058414 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:37:06.060405 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:37:06.055411 => 2023-10-06 11:37:06.060405
[0m11:37:06.061404 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:37:06.137430 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_deeplinks"
[0m11:37:06.139433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:37:06.733407 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */


  create view travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'deeplink_url_parameters') AS deeplink_url_parameters,
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_deeplinks
)
  )...
[0m11:37:06.791474 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:06.804485 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:37:06.852714 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:06.855704 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks to travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  
  ...
[0m11:37:06.903216 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:06.908216 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    drop table if exists travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:37:06.962488 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:06.965506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */

    rename table travelata.normalized_sheets_appmetrica_deeplinks__dbt_tmp to travelata.normalized_sheets_appmetrica_deeplinks 
  
  ...
[0m11:37:07.012699 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.063724 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_deeplinks"} */
drop table if exists travelata.normalized_sheets_appmetrica_deeplinks__dbt_backup 
  ...
[0m11:37:07.112574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.115569 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:37:06.062407 => 2023-10-06 11:37:07.115569
[0m11:37:07.116568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DF63810>]}
[0m11:37:07.117570 [info ] [Thread-1 (]: 1 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_deeplinks  [[32mOK[0m in 1.06s]
[0m11:37:07.122111 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_deeplinks
[0m11:37:07.123122 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_events
[0m11:37:07.124120 [info ] [Thread-1 (]: 2 of 33 START sql view model travelata.normalized_sheets_appmetrica_events ..... [RUN]
[0m11:37:07.126102 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_events'
[0m11:37:07.127114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_events)
[0m11:37:07.127114 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_events
[0m11:37:07.131120 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:37:07.132115 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (compile): 2023-10-06 11:37:07.128102 => 2023-10-06 11:37:07.132115
[0m11:37:07.133112 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_events
[0m11:37:07.142112 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_events"
[0m11:37:07.144107 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */


  create view travelata.normalized_sheets_appmetrica_events__dbt_tmp 
  
  as (
    SELECT
JSONExtractString(_airbyte_data, 'event_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'event_datetime') AS event_datetime,
JSONExtractString(_airbyte_data, 'event_json') AS event_json,
JSONExtractString(_airbyte_data, 'event_name') AS event_name,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'app_version_name') AS app_version_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_events' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_events
)
  )...
[0m11:37:07.201957 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:07.206955 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:37:07.253208 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:07.255199 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events to travelata.normalized_sheets_appmetrica_events__dbt_backup 
  
  ...
[0m11:37:07.302881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.307883 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    drop table if exists travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:37:07.362612 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.365612 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */

    rename table travelata.normalized_sheets_appmetrica_events__dbt_tmp to travelata.normalized_sheets_appmetrica_events 
  
  ...
[0m11:37:07.422722 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:07.430712 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_events"} */
drop table if exists travelata.normalized_sheets_appmetrica_events__dbt_backup 
  ...
[0m11:37:07.483242 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.485264 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_events (execute): 2023-10-06 11:37:07.134115 => 2023-10-06 11:37:07.485264
[0m11:37:07.486252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D469910>]}
[0m11:37:07.487269 [info ] [Thread-1 (]: 2 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_events  [[32mOK[0m in 0.36s]
[0m11:37:07.489264 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_events
[0m11:37:07.490247 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_install
[0m11:37:07.491264 [info ] [Thread-1 (]: 3 of 33 START sql view model travelata.normalized_sheets_appmetrica_install .... [RUN]
[0m11:37:07.493264 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_install'
[0m11:37:07.493264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_install)
[0m11:37:07.494264 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_install
[0m11:37:07.497272 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:37:07.498257 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (compile): 2023-10-06 11:37:07.494264 => 2023-10-06 11:37:07.498257
[0m11:37:07.499253 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_install
[0m11:37:07.509188 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_install"
[0m11:37:07.510379 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */


  create view travelata.normalized_sheets_appmetrica_install__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'install_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'click_datetime') AS click_datetime,
JSONExtractString(_airbyte_data, 'install_datetime') AS install_datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'click_url_parameters') AS click_url_parameters,
JSONExtractString(_airbyte_data, 'is_reinstallation') AS is_reinstallation,
JSONExtractString(_airbyte_data, 'publisher_name') AS publisher_name,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_install' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_install
)
  )...
[0m11:37:07.571530 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:07.577544 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:37:07.622736 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:07.624735 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install to travelata.normalized_sheets_appmetrica_install__dbt_backup 
  
  ...
[0m11:37:07.673202 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.678207 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    drop table if exists travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:37:07.733179 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.735185 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */

    rename table travelata.normalized_sheets_appmetrica_install__dbt_tmp to travelata.normalized_sheets_appmetrica_install 
  
  ...
[0m11:37:07.792919 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:07.799919 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_install"} */
drop table if exists travelata.normalized_sheets_appmetrica_install__dbt_backup 
  ...
[0m11:37:07.853123 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.855124 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_install (execute): 2023-10-06 11:37:07.499253 => 2023-10-06 11:37:07.855124
[0m11:37:07.857124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E0B3F10>]}
[0m11:37:07.858126 [info ] [Thread-1 (]: 3 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_install  [[32mOK[0m in 0.36s]
[0m11:37:07.859968 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_install
[0m11:37:07.860968 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:37:07.861973 [info ] [Thread-1 (]: 4 of 33 START sql view model travelata.normalized_sheets_appmetrica_profiles ... [RUN]
[0m11:37:07.863968 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_profiles'
[0m11:37:07.863968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_profiles)
[0m11:37:07.864968 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:37:07.867974 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:37:07.869976 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (compile): 2023-10-06 11:37:07.864968 => 2023-10-06 11:37:07.868974
[0m11:37:07.869976 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:37:07.877965 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_profiles"
[0m11:37:07.879977 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */


  create view travelata.normalized_sheets_appmetrica_profiles__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'mp_card_number') AS mp_card_number,
JSONExtractString(_airbyte_data, 'city_code') AS city_code,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_profiles' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_profiles
)
  )...
[0m11:37:07.941964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:07.946961 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:37:07.993003 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:07.995003 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles to travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  
  ...
[0m11:37:08.042929 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.048930 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    drop table if exists travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:37:08.102502 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.104503 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */

    rename table travelata.normalized_sheets_appmetrica_profiles__dbt_tmp to travelata.normalized_sheets_appmetrica_profiles 
  
  ...
[0m11:37:08.153185 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.160927 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_profiles"} */
drop table if exists travelata.normalized_sheets_appmetrica_profiles__dbt_backup 
  ...
[0m11:37:08.213107 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.215109 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_profiles (execute): 2023-10-06 11:37:07.870980 => 2023-10-06 11:37:08.215109
[0m11:37:08.217111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E203DD0>]}
[0m11:37:08.218113 [info ] [Thread-1 (]: 4 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_profiles  [[32mOK[0m in 0.35s]
[0m11:37:08.220111 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_profiles
[0m11:37:08.221110 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:37:08.222111 [info ] [Thread-1 (]: 5 of 33 START sql view model travelata.normalized_sheets_appmetrica_screenview . [RUN]
[0m11:37:08.224111 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_screenview'
[0m11:37:08.224111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_screenview)
[0m11:37:08.225111 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:37:08.228107 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:37:08.229112 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (compile): 2023-10-06 11:37:08.225111 => 2023-10-06 11:37:08.229112
[0m11:37:08.230112 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:37:08.241114 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_screenview"
[0m11:37:08.243737 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */


  create view travelata.normalized_sheets_appmetrica_screenview__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'eventDateTime') AS __datetime,
JSONExtractString(_airbyte_data, 'mobileAdsId') AS appmetricamobileAdsId_device_id,
JSONExtractString(_airbyte_data, 'accountName') AS accountName,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'cityName') AS cityName,
JSONExtractString(_airbyte_data, 'osName') AS osName,
JSONExtractString(_airbyte_data, 'crmUserId') AS crmUserId,
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'screen_view') AS screen_view,
toDateTime32(_airbyte_emitted_at) AS __emitted_at,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_screen_view
)
  )...
[0m11:37:08.299841 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.305849 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:37:08.353197 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.355202 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview to travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  
  ...
[0m11:37:08.403092 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.408091 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    drop table if exists travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:37:08.463567 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.465576 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */

    rename table travelata.normalized_sheets_appmetrica_screenview__dbt_tmp to travelata.normalized_sheets_appmetrica_screenview 
  
  ...
[0m11:37:08.512860 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.519865 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_screenview"} */
drop table if exists travelata.normalized_sheets_appmetrica_screenview__dbt_backup 
  ...
[0m11:37:08.575139 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.577132 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_screenview (execute): 2023-10-06 11:37:08.230112 => 2023-10-06 11:37:08.577132
[0m11:37:08.579141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E151450>]}
[0m11:37:08.580143 [info ] [Thread-1 (]: 5 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_screenview  [[32mOK[0m in 0.36s]
[0m11:37:08.582130 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_screenview
[0m11:37:08.583140 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:37:08.584141 [info ] [Thread-1 (]: 6 of 33 START sql view model travelata.normalized_sheets_appmetrica_sessionstart  [RUN]
[0m11:37:08.586130 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_appmetrica_sessionstart'
[0m11:37:08.586130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_appmetrica_sessionstart)
[0m11:37:08.587131 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:37:08.592140 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:37:08.594143 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:37:08.588152 => 2023-10-06 11:37:08.594143
[0m11:37:08.595132 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:37:08.603367 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_appmetrica_sessionstart"
[0m11:37:08.605072 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */


  create view travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(_airbyte_data, 'session_id') AS session_id,
JSONExtractString(_airbyte_data, 'session_start_datetime') AS __datetime,
JSONExtractString(_airbyte_data, 'appmetrica_device_id') AS appmetrica_device_id,
JSONExtractString(_airbyte_data, 'appmetricaDeviceId') AS appmetricaDeviceId,
JSONExtractString(_airbyte_data, 'city') AS city,
JSONExtractString(_airbyte_data, 'google_aid') AS google_aid,
JSONExtractString(_airbyte_data, 'os_name') AS os_name,
JSONExtractString(_airbyte_data, 'profile_id') AS profile_id,
JSONExtractString(_airbyte_data, 'installation_id') AS installation_id,
JSONExtractString(_airbyte_data, 'ios_ifa') AS ios_ifa,
toLowCardinality(__table_name) AS __table_name,
NOW() as __normalized_at
FROM 
(
select *, 'travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts' as __table_name
from travelata._airbyte_raw_sheets_appmetrica_travelata_sessions_starts
)
  )...
[0m11:37:08.661190 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:08.666197 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:37:08.712439 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.715442 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart to travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  
  ...
[0m11:37:08.773381 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:08.779379 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    drop table if exists travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:37:08.833176 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.835185 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */

    rename table travelata.normalized_sheets_appmetrica_sessionstart__dbt_tmp to travelata.normalized_sheets_appmetrica_sessionstart 
  
  ...
[0m11:37:08.882681 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.890660 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_appmetrica_sessionstart"} */
drop table if exists travelata.normalized_sheets_appmetrica_sessionstart__dbt_backup 
  ...
[0m11:37:08.943569 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:08.945568 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:37:08.596137 => 2023-10-06 11:37:08.945568
[0m11:37:08.947577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DEEC290>]}
[0m11:37:08.948569 [info ] [Thread-1 (]: 6 of 33 OK created sql view model travelata.normalized_sheets_appmetrica_sessionstart  [[32mOK[0m in 0.36s]
[0m11:37:08.949568 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_appmetrica_sessionstart
[0m11:37:08.950549 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:37:08.951571 [info ] [Thread-1 (]: 7 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_new .. [RUN]
[0m11:37:08.953568 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_new'
[0m11:37:08.954568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_new)
[0m11:37:08.954568 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:37:08.957577 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:37:08.958549 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (compile): 2023-10-06 11:37:08.955570 => 2023-10-06 11:37:08.958549
[0m11:37:08.959577 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:37:08.964574 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_new
[0m11:37:08.966568 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_new"
[0m11:37:08.967553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )...
[0m11:37:09.019953 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_new"} */


  create view travelata.normalized_sheets_mytarget_banners_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'campaign_id') as campagin_id,
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'textblocks') as textblocks,
JSONExtractString(`_airbyte_data`,'urls') as urls,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners`)
  )
[0m11:37:09.020955 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_new (execute): 2023-10-06 11:37:08.960564 => 2023-10-06 11:37:09.020955
[0m11:37:09.029980 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:37:09.030976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E25F310>]}
[0m11:37:09.031981 [error] [Thread-1 (]: 7 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_new  [[31mERROR[0m in 0.08s]
[0m11:37:09.033972 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_new
[0m11:37:09.034981 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:37:09.035981 [info ] [Thread-1 (]: 8 of 33 START sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [RUN]
[0m11:37:09.037975 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_banners_statjstics_new'
[0m11:37:09.037975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_banners_statjstics_new)
[0m11:37:09.038972 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:37:09.041981 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:37:09.043981 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (compile): 2023-10-06 11:37:09.039981 => 2023-10-06 11:37:09.043981
[0m11:37:09.044983 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:37:09.049977 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_banners_statjstics_new
[0m11:37:09.051976 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"
[0m11:37:09.053979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_banners_statjstics_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )...
[0m11:37:09.104973 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_banners_statjstics_new"} */


  create view travelata.normalized_sheets_mytarget_banners_statjstics_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'date') as _date,
JSONExtractString(`_airbyte_data`,'shows') as shows,
JSONExtractString(`_airbyte_data`,'clicks') as clics,
JSONExtractString(`_airbyte_data`,'goals') as goals,
JSONExtractString(`_airbyte_data`,'spent') as spent,
JSONExtractString(`_airbyte_data`,'_banner_id') as banner_id,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics`)
  )
[0m11:37:09.106024 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_banners_statjstics_new (execute): 2023-10-06 11:37:09.044983 => 2023-10-06 11:37:09.106024
[0m11:37:09.109981 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:37:09.110981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E1A4950>]}
[0m11:37:09.111981 [error] [Thread-1 (]: 8 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_banners_statjstics_new  [[31mERROR[0m in 0.07s]
[0m11:37:09.113973 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_banners_statjstics_new
[0m11:37:09.114981 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:37:09.116981 [info ] [Thread-1 (]: 9 of 33 START sql view model travelata.normalized_sheets_mytarget_compagins_new  [RUN]
[0m11:37:09.118974 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_mytarget_compagins_new'
[0m11:37:09.118974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_mytarget_compagins_new)
[0m11:37:09.119976 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:37:09.122967 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:37:09.124965 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (compile): 2023-10-06 11:37:09.120978 => 2023-10-06 11:37:09.124965
[0m11:37:09.125965 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:37:09.130980 [debug] [Thread-1 (]: Creating new relation normalized_sheets_mytarget_compagins_new
[0m11:37:09.132975 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_mytarget_compagins_new"
[0m11:37:09.134982 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_mytarget_compagins_new: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )...
[0m11:37:09.185395 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_mytarget_compagins_new"} */


  create view travelata.normalized_sheets_mytarget_compagins_new 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'id') as id,
JSONExtractString(`_airbyte_data`,'name') as name,
JSONExtractString(`_airbyte_data`,'_airbyte_ab_id') as airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(select *,'travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns' as table_name
from travelata.`_airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns`)
  )
[0m11:37:09.186395 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_mytarget_compagins_new (execute): 2023-10-06 11:37:09.126976 => 2023-10-06 11:37:09.185395
[0m11:37:09.190404 [debug] [Thread-1 (]: Database Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)
  :HTTPDriver for http://localhost:8123 returned response code 404)
   Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:37:09.191405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D432510>]}
[0m11:37:09.192389 [error] [Thread-1 (]: 9 of 33 ERROR creating sql view model travelata.normalized_sheets_mytarget_compagins_new  [[31mERROR[0m in 0.07s]
[0m11:37:09.194395 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_mytarget_compagins_new
[0m11:37:09.195396 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:37:09.196376 [info ] [Thread-1 (]: 10 of 33 START sql view model travelata.normalized_sheets_utmcraft_utmresult ... [RUN]
[0m11:37:09.198398 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_utmcraft_utmresult'
[0m11:37:09.198398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_utmcraft_utmresult)
[0m11:37:09.199384 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:37:09.202395 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:37:09.203389 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (compile): 2023-10-06 11:37:09.199384 => 2023-10-06 11:37:09.203389
[0m11:37:09.204404 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:37:09.212396 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_utmcraft_utmresult"
[0m11:37:09.214396 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */


  create view travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'id') as id,
	JSONExtractString(_airbyte_data, 'created_at') as created_at,
	JSONExtractString(_airbyte_data, 'updated_at') as updated_at,
	JSONExtractString(_airbyte_data, 'utm_hashcode') as utm_hashcode,
	JSONExtractString(_airbyte_data, 'data') as data,
	JSONExtractString(_airbyte_data, 'created_by_id') as created_by_id,
	JSONExtractString(_airbyte_data, 'form_id') as form_id,
	JSONExtractString(_airbyte_data, 'updated_by_id') as updated_by_id,
	JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata._airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult' as __table_name 
	from travelata.`_airbyte_raw_sheets_utmcraft_travelata_normalize_utmcraft_utmresult`) x
  )...
[0m11:37:09.271395 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:09.276400 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:37:09.322257 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:09.325257 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult to travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  
  ...
[0m11:37:09.382934 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:09.391097 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    drop table if exists travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:37:09.442952 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.445195 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */

    rename table travelata.normalized_sheets_utmcraft_utmresult__dbt_tmp to travelata.normalized_sheets_utmcraft_utmresult 
  
  ...
[0m11:37:09.493266 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.566115 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_utmcraft_utmresult"} */
drop table if exists travelata.normalized_sheets_utmcraft_utmresult__dbt_backup 
  ...
[0m11:37:09.612073 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:09.615072 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_utmcraft_utmresult (execute): 2023-10-06 11:37:09.204404 => 2023-10-06 11:37:09.615072
[0m11:37:09.616074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DE74E10>]}
[0m11:37:09.618072 [info ] [Thread-1 (]: 10 of 33 OK created sql view model travelata.normalized_sheets_utmcraft_utmresult  [[32mOK[0m in 0.42s]
[0m11:37:09.620075 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_utmcraft_utmresult
[0m11:37:09.621076 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:37:09.622071 [info ] [Thread-1 (]: 11 of 33 START sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:37:09.625078 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adgroupsstatistics'
[0m11:37:09.626075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adgroupsstatistics)
[0m11:37:09.628073 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:37:09.632068 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:37:09.633070 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:37:09.629078 => 2023-10-06 11:37:09.633070
[0m11:37:09.634069 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:37:09.643074 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adgroupsstatistics"
[0m11:37:09.646068 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */


  create view travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp 
  
  as (
    select
    JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_groups_statistics`) x
  )...
[0m11:37:09.711069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:09.717069 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:37:09.762074 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.764072 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics to travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  
  ...
[0m11:37:09.812241 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.817898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:37:09.872455 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.874454 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */

    rename table travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adgroupsstatistics 
  
  ...
[0m11:37:09.923022 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.930034 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adgroupsstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adgroupsstatistics__dbt_backup 
  ...
[0m11:37:09.983076 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:09.986089 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:37:09.634069 => 2023-10-06 11:37:09.986089
[0m11:37:09.988095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4C363BD0>]}
[0m11:37:09.989098 [info ] [Thread-1 (]: 11 of 33 OK created sql view model travelata.normalized_sheets_vkads_adgroupsstatistics  [[32mOK[0m in 0.36s]
[0m11:37:09.992083 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adgroupsstatistics
[0m11:37:09.993089 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:37:09.994090 [info ] [Thread-1 (]: 12 of 33 START sql view model travelata.normalized_sheets_vkads_adplansstatistics  [RUN]
[0m11:37:09.996076 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_adplansstatistics'
[0m11:37:09.997084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_adplansstatistics)
[0m11:37:09.998090 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:37:10.001881 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:37:10.003847 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:37:09.999328 => 2023-10-06 11:37:10.003747
[0m11:37:10.004453 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:37:10.012156 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_adplansstatistics"
[0m11:37:10.014085 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */


  create view travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_ad_plans_statistics`) x
  )...
[0m11:37:10.072356 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:10.077355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:37:10.123192 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:10.125189 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics to travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  
  ...
[0m11:37:10.172795 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.178795 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:37:10.232839 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.234838 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */

    rename table travelata.normalized_sheets_vkads_adplansstatistics__dbt_tmp to travelata.normalized_sheets_vkads_adplansstatistics 
  
  ...
[0m11:37:10.282476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.290494 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_adplansstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_adplansstatistics__dbt_backup 
  ...
[0m11:37:10.342302 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.345298 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:37:10.005084 => 2023-10-06 11:37:10.345298
[0m11:37:10.346298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E2F2CD0>]}
[0m11:37:10.347301 [info ] [Thread-1 (]: 12 of 33 OK created sql view model travelata.normalized_sheets_vkads_adplansstatistics  [[32mOK[0m in 0.35s]
[0m11:37:10.349292 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_adplansstatistics
[0m11:37:10.350293 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:37:10.351292 [info ] [Thread-1 (]: 13 of 33 START sql view model travelata.normalized_sheets_vkads_bannersstatistics  [RUN]
[0m11:37:10.353293 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_vkads_bannersstatistics'
[0m11:37:10.353293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_vkads_bannersstatistics)
[0m11:37:10.354292 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:37:10.356301 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:37:10.358279 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (compile): 2023-10-06 11:37:10.354292 => 2023-10-06 11:37:10.358279
[0m11:37:10.359301 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:37:10.367273 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_vkads_bannersstatistics"
[0m11:37:10.368554 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */


  create view travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp 
  
  as (
    select
	JSONExtractString(_airbyte_data, 'date') AS __datetime,
	JSONExtractString(_airbyte_data, 'tps') as tps,
	JSONExtractString(_airbyte_data, 'spent') as spent,
	JSONExtractString(_airbyte_data, 'shows') as shows,
	JSONExtractString(_airbyte_data, 'clicks') as clicks,
	JSONExtractString(_airbyte_data, 'base') as base,
	JSONExtractString(_airbyte_data, 'date') as date,
	JSONExtractString(_airbyte_data, 'moat') as moat,
	JSONExtractString(_airbyte_data, 'romi') as romi,
	JSONExtractString(_airbyte_data, 'video') as video,
	JSONExtractString(_airbyte_data, 'events') as events,
	JSONExtractString(_airbyte_data, 'uniques') as uniques,
	JSONExtractString(_airbyte_data, 'carousel') as carousel,
	JSONExtractString(_airbyte_data, 'playable') as playable,
	JSONExtractString(_airbyte_data, 'ad_group_id') as ad_group_id,
	JSONExtractString(_airbyte_data, 'custom_event') as custom_event,
	JSONExtractString(_airbyte_data, 'uniques_video') as uniques_video,
    JSONExtractString(_airbyte_data, '_airbyte_ab_id') as _airbyte_ab_id,
	JSONExtractString(_airbyte_data, 'load_date') as load_date,
	JSONExtractString(_airbyte_data, '_normalized_at') as _normalized_at,
	toLowCardinality(__table_name) as __table_name,
	toDateTime32(_airbyte_emitted_at) as __emitted_at,
	now() as __normalized_at
from
	(select *,
	'travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`' as __table_name 
	from travelata.`_airbyte_raw_sheets_vkads_travelata_banners_statistics`) x
  )...
[0m11:37:10.432490 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:10.442507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:37:10.492943 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.494948 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics to travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  
  ...
[0m11:37:10.543234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.549239 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    drop table if exists travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:37:10.612536 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:10.615045 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */

    rename table travelata.normalized_sheets_vkads_bannersstatistics__dbt_tmp to travelata.normalized_sheets_vkads_bannersstatistics 
  
  ...
[0m11:37:10.662991 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.671995 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_vkads_bannersstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_vkads_bannersstatistics"} */
drop table if exists travelata.normalized_sheets_vkads_bannersstatistics__dbt_backup 
  ...
[0m11:37:10.723045 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.726044 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_vkads_bannersstatistics (execute): 2023-10-06 11:37:10.359301 => 2023-10-06 11:37:10.726044
[0m11:37:10.727160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DE9DE50>]}
[0m11:37:10.728052 [info ] [Thread-1 (]: 13 of 33 OK created sql view model travelata.normalized_sheets_vkads_bannersstatistics  [[32mOK[0m in 0.37s]
[0m11:37:10.730026 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_vkads_bannersstatistics
[0m11:37:10.731024 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:37:10.733053 [info ] [Thread-1 (]: 14 of 33 START sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [RUN]
[0m11:37:10.735044 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_mediaplans'
[0m11:37:10.735044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_mediaplans)
[0m11:37:10.736044 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:37:10.739022 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:37:10.740751 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:37:10.736044 => 2023-10-06 11:37:10.740751
[0m11:37:10.741931 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:37:10.749518 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_mediaplans"
[0m11:37:10.751394 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */


  create view travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Geo') as Geo,
JSONExtractString(_airbyte_data, 'Period_start') as Period_start,
JSONExtractString(_airbyte_data, 'Period_end') as Period_end,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '__airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new' as __table_name
from travelata._airbyte_raw_sheets_mediaplans_travelata_yandexdisk_mediaplans_new)
  )...
[0m11:37:10.810554 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:10.816020 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:37:10.863036 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.865040 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans to travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  
  ...
[0m11:37:10.913126 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.918128 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:37:10.973058 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:10.975060 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */

    rename table travelata.normalized_sheets_yandexdisk_mediaplans__dbt_tmp to travelata.normalized_sheets_yandexdisk_mediaplans 
  
  ...
[0m11:37:11.022440 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.030440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_mediaplans"} */
drop table if exists travelata.normalized_sheets_yandexdisk_mediaplans__dbt_backup 
  ...
[0m11:37:11.083075 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.085075 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:37:10.742524 => 2023-10-06 11:37:11.085075
[0m11:37:11.087076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E101690>]}
[0m11:37:11.088083 [info ] [Thread-1 (]: 14 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.35s]
[0m11:37:11.089082 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_mediaplans
[0m11:37:11.090079 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:37:11.091082 [info ] [Thread-1 (]: 15 of 33 START sql view model travelata.normalized_sheets_yandexdisk_othercosts  [RUN]
[0m11:37:11.093082 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yandexdisk_othercosts'
[0m11:37:11.094094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yandexdisk_othercosts)
[0m11:37:11.094094 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:37:11.097092 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:37:11.099071 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:37:11.095093 => 2023-10-06 11:37:11.099071
[0m11:37:11.100067 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:37:11.108239 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yandexdisk_othercosts"
[0m11:37:11.109535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */


  create view travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'Source') as Source,
JSONExtractString(_airbyte_data, 'Medium') as Medium,
JSONExtractString(_airbyte_data, 'Campaign') as Campaign,
JSONExtractString(_airbyte_data, 'ProductName') as ProductName,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new' as __table_name
from travelata._airbyte_raw_sheets_ydothercosts_travelata_yandexdisk_othercosts_new)
  )...
[0m11:37:11.168967 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.174989 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:37:11.232976 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.234979 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts to travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  
  ...
[0m11:37:11.291961 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.296981 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    drop table if exists travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:37:11.343021 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m11:37:11.344898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */

    rename table travelata.normalized_sheets_yandexdisk_othercosts__dbt_tmp to travelata.normalized_sheets_yandexdisk_othercosts 
  
  ...
[0m11:37:11.403008 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.410007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yandexdisk_othercosts"} */
drop table if exists travelata.normalized_sheets_yandexdisk_othercosts__dbt_backup 
  ...
[0m11:37:11.462875 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.465880 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:37:11.100067 => 2023-10-06 11:37:11.465880
[0m11:37:11.467880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E1346D0>]}
[0m11:37:11.468874 [info ] [Thread-1 (]: 15 of 33 OK created sql view model travelata.normalized_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.37s]
[0m11:37:11.470857 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yandexdisk_othercosts
[0m11:37:11.470857 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_yd_customreport
[0m11:37:11.471884 [info ] [Thread-1 (]: 16 of 33 START sql view model travelata.normalized_sheets_yd_customreport ...... [RUN]
[0m11:37:11.473877 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_yd_customreport'
[0m11:37:11.474874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_yd_customreport)
[0m11:37:11.474874 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_yd_customreport
[0m11:37:11.480879 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:37:11.482880 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (compile): 2023-10-06 11:37:11.475883 => 2023-10-06 11:37:11.481885
[0m11:37:11.482880 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_yd_customreport
[0m11:37:11.491178 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_yd_customreport"
[0m11:37:11.492483 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */


  create view travelata.normalized_sheets_yd_customreport__dbt_tmp 
  
  as (
    select
JSONExtractString(_airbyte_data, 'Date') as __datetime,
JSONExtractString(_airbyte_data, 'reportType') as reportType,
JSONExtractString(_airbyte_data, 'CampaignId') as CampaignId,
JSONExtractString(_airbyte_data, 'CampaignName') as CampaignName,
JSONExtractString(_airbyte_data, 'CampaignType') as CampaignType,
JSONExtractString(_airbyte_data, 'AdGroupId') as AdGroupId,
JSONExtractString(_airbyte_data, 'AdGroupName') as AdGroupName,
JSONExtractString(_airbyte_data, 'AdId') as AdId,
JSONExtractString(_airbyte_data, 'CriterionId') as CriterionId,
JSONExtractString(_airbyte_data, 'Criterion') as Criterion,
JSONExtractString(_airbyte_data, 'Cost') as Cost,
JSONExtractString(_airbyte_data, 'Impressions') as Impressions,
JSONExtractString(_airbyte_data, 'Clicks') as Clicks,
toLowCardinality(__table_name) as __table_name,
toDateTime32(_airbyte_emitted_at) as __emitted_at,
NOW() as __normalized_at
from 
(select *, '_travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new' as __table_name
from travelata._airbyte_raw_sheets_customreport_travelata_yd_custom_report_new)
  )...
[0m11:37:11.550692 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.555704 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:37:11.602766 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.604771 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport to travelata.normalized_sheets_yd_customreport__dbt_backup 
  
  ...
[0m11:37:11.652746 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.657751 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    drop table if exists travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:37:11.713164 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.716169 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */

    rename table travelata.normalized_sheets_yd_customreport__dbt_tmp to travelata.normalized_sheets_yd_customreport 
  
  ...
[0m11:37:11.764844 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.772848 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_yd_customreport"} */
drop table if exists travelata.normalized_sheets_yd_customreport__dbt_backup 
  ...
[0m11:37:11.832995 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.836000 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_yd_customreport (execute): 2023-10-06 11:37:11.483883 => 2023-10-06 11:37:11.836000
[0m11:37:11.837000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D667E10>]}
[0m11:37:11.837995 [info ] [Thread-1 (]: 16 of 33 OK created sql view model travelata.normalized_sheets_yd_customreport . [[32mOK[0m in 0.36s]
[0m11:37:11.840003 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_yd_customreport
[0m11:37:11.840995 [debug] [Thread-1 (]: Began running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:37:11.841995 [info ] [Thread-1 (]: 17 of 33 START sql view model travelata.normalized_sheets_ymvisits_visits ...... [RUN]
[0m11:37:11.843995 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.normalized_sheets_ymvisits_visits'
[0m11:37:11.844974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.normalized_sheets_ymvisits_visits)
[0m11:37:11.845996 [debug] [Thread-1 (]: Began compiling node model.travelata.normalized_sheets_ymvisits_visits
[0m11:37:11.848741 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:37:11.850022 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (compile): 2023-10-06 11:37:11.845996 => 2023-10-06 11:37:11.850022
[0m11:37:11.850671 [debug] [Thread-1 (]: Began executing node model.travelata.normalized_sheets_ymvisits_visits
[0m11:37:11.858683 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.normalized_sheets_ymvisits_visits"
[0m11:37:11.860524 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */


  create view travelata.normalized_sheets_ymvisits_visits__dbt_tmp 
  
  as (
    SELECT 
JSONExtractString(`_airbyte_data`,'dateTime') as _datatime,
JSONExtractString(`_airbyte_data`,'visitID') as visit_id,
JSONExtractString(`_airbyte_data`,'goalsID') as goals_id,
JSONExtractString(`_airbyte_data`,'lastTrafficSource') as last_traffic_source,
JSONExtractString(`_airbyte_data`,'lastReferalSource') as last_referal_source,
JSONExtractString(`_airbyte_data`,'regionCity') as region_city,
JSONExtractString(`_airbyte_data`,'clientID') as client_id,
JSONExtractString(`_airbyte_data`,'purchaseCoupon') as purchase_coupon,
JSONExtractString(`_airbyte_data`,'purchaseRevenue') as purchase_revenue,
JSONExtractString(`_airbyte_data`,'purchaseID') as purchase_id,
JSONExtractString(`_airbyte_data`,'goalsOrder') as goals_order,
JSONExtractString(`_airbyte_data`,'lastAdvEngine') as last_adv_engine,
JSONExtractString(`_airbyte_data`,'pageViews') as page_views,
JSONExtractString(`_airbyte_data`,'parsedParamsKey1') as parsed_params_key1,
JSONExtractString(`_airbyte_data`,'parsedParamsKey2') as parsed_params_key2,
JSONExtractString(_airbyte_data,'_airbyte_ab_id') as _airbyte_ab_id,
toLowCardinality(table_name) as table_name,
toDateTime32(_airbyte_emitted_at) as _emitted_at,
now() as _normalized_at 
from
(SELECT *,'travelata._airbyte_raw_sheets_ymvisits_travelata_ym_visits' as table_name
FROM travelata.`_airbyte_raw_sheets_ymvisits_travelata_ym_visits`)
  )...
[0m11:37:11.923151 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:11.929159 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:37:11.983424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:11.985429 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits to travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  
  ...
[0m11:37:12.033244 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.038252 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    drop table if exists travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:37:12.092651 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.094651 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */

    rename table travelata.normalized_sheets_ymvisits_visits__dbt_tmp to travelata.normalized_sheets_ymvisits_visits 
  
  ...
[0m11:37:12.145572 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.152580 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.normalized_sheets_ymvisits_visits: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.normalized_sheets_ymvisits_visits"} */
drop table if exists travelata.normalized_sheets_ymvisits_visits__dbt_backup 
  ...
[0m11:37:12.203610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.205610 [debug] [Thread-1 (]: Timing info for model.travelata.normalized_sheets_ymvisits_visits (execute): 2023-10-06 11:37:11.851320 => 2023-10-06 11:37:12.205610
[0m11:37:12.206779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E25AD50>]}
[0m11:37:12.207615 [info ] [Thread-1 (]: 17 of 33 OK created sql view model travelata.normalized_sheets_ymvisits_visits . [[32mOK[0m in 0.36s]
[0m11:37:12.209605 [debug] [Thread-1 (]: Finished running node model.travelata.normalized_sheets_ymvisits_visits
[0m11:37:12.210614 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:37:12.210614 [info ] [Thread-1 (]: 18 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [RUN]
[0m11:37:12.212605 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_deeplinks'
[0m11:37:12.213605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_deeplinks)
[0m11:37:12.214617 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:37:12.220605 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:37:12.221605 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (compile): 2023-10-06 11:37:12.214617 => 2023-10-06 11:37:12.221605
[0m11:37:12.222614 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:37:12.341667 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

            

    
        create table travelata.incremental_sheets_appmetrica_deeplinks
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
    )
        ...
[0m11:37:12.408335 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:12.425339 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_deeplinks'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:12.474689 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.482692 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_deeplinks"
[0m11:37:12.483683 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_deeplinks: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
    ...
[0m11:37:12.541385 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_deeplinks"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_deeplinks ("deeplink_url_parameters", "__datetime", "profile_id", "appmetrica_device_id", "city", "ios_ifa", "google_aid", "os_name", "publisher_name", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_deeplinks
  
    
[0m11:37:12.542393 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_deeplinks (execute): 2023-10-06 11:37:12.222614 => 2023-10-06 11:37:12.542393
[0m11:37:12.547384 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:37:12.547384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DDDE190>]}
[0m11:37:12.548395 [error] [Thread-1 (]: 18 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_deeplinks  [[31mERROR[0m in 0.33s]
[0m11:37:12.550394 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_deeplinks
[0m11:37:12.551388 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_events
[0m11:37:12.552392 [info ] [Thread-1 (]: 19 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_events  [RUN]
[0m11:37:12.554390 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_events'
[0m11:37:12.555386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_events)
[0m11:37:12.555386 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_events
[0m11:37:12.561384 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:37:12.563394 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (compile): 2023-10-06 11:37:12.556393 => 2023-10-06 11:37:12.563394
[0m11:37:12.564394 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_events
[0m11:37:12.573960 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

            

    
        create table travelata.incremental_sheets_appmetrica_events
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
    )
        ...
[0m11:37:12.636524 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:12.641520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_events'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:12.695267 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.699275 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_events"
[0m11:37:12.701272 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_events: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_events"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_events ("__datetime", "event_datetime", "event_json", "event_name", "installation_id", "appmetrica_device_id", "city", "google_aid", "os_name", "profile_id", "session_id", "app_version_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_events
  
    ...
[0m11:37:12.765556 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:12.777561 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_events (execute): 2023-10-06 11:37:12.564394 => 2023-10-06 11:37:12.777561
[0m11:37:12.779548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DDF8050>]}
[0m11:37:12.780556 [info ] [Thread-1 (]: 19 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_events  [[32mOK[0m in 0.23s]
[0m11:37:12.782548 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_events
[0m11:37:12.782548 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_install
[0m11:37:12.783561 [info ] [Thread-1 (]: 20 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_install  [RUN]
[0m11:37:12.785556 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_install'
[0m11:37:12.786556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_install)
[0m11:37:12.786556 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_install
[0m11:37:12.793561 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:37:12.794561 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (compile): 2023-10-06 11:37:12.787561 => 2023-10-06 11:37:12.794561
[0m11:37:12.795552 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_install
[0m11:37:12.804694 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

            

    
        create table travelata.incremental_sheets_appmetrica_install
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
    )
        ...
[0m11:37:12.868000 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:12.873008 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_install'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:12.925167 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:12.928866 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_install"
[0m11:37:12.930876 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_install: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_install"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_install ("__datetime", "city", "os_name", "google_aid", "profile_id", "click_datetime", "install_datetime", "appmetrica_device_id", "click_url_parameters", "is_reinstallation", "publisher_name", "ios_ifa", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_install
  
    ...
[0m11:37:12.993578 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:12.998569 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_install (execute): 2023-10-06 11:37:12.795552 => 2023-10-06 11:37:12.998569
[0m11:37:13.000560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E2F29D0>]}
[0m11:37:13.001577 [info ] [Thread-1 (]: 20 of 33 OK created sql incremental model travelata.incremental_sheets_appmetrica_install  [[32mOK[0m in 0.22s]
[0m11:37:13.003558 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_install
[0m11:37:13.004569 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:37:13.004569 [info ] [Thread-1 (]: 21 of 33 START sql table model travelata.incremental_sheets_appmetrica_profiles  [RUN]
[0m11:37:13.006550 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_profiles'
[0m11:37:13.007573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_profiles)
[0m11:37:13.007573 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:37:13.013568 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:37:13.014573 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (compile): 2023-10-06 11:37:13.008569 => 2023-10-06 11:37:13.014573
[0m11:37:13.015568 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:37:13.042556 [debug] [Thread-1 (]: Creating new relation incremental_sheets_appmetrica_profiles
[0m11:37:13.045735 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

            

    
        create table travelata.incremental_sheets_appmetrica_profiles
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
    )
        ...
[0m11:37:13.107241 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:13.112249 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_profiles'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:13.165353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:13.169353 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_profiles"
[0m11:37:13.171352 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_profiles: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_profiles"} */

  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_profiles ("profile_id", "appmetrica_device_id", "mp_card_number", "city_code", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_appmetrica_profiles
  ...
[0m11:37:13.238726 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:13.243731 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_profiles (execute): 2023-10-06 11:37:13.016574 => 2023-10-06 11:37:13.243731
[0m11:37:13.245731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DDF8B90>]}
[0m11:37:13.246746 [info ] [Thread-1 (]: 21 of 33 OK created sql table model travelata.incremental_sheets_appmetrica_profiles  [[32mOK[0m in 0.24s]
[0m11:37:13.248726 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_profiles
[0m11:37:13.249727 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:37:13.250726 [info ] [Thread-1 (]: 22 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_screenview  [RUN]
[0m11:37:13.252711 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_screenview'
[0m11:37:13.253734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_screenview)
[0m11:37:13.253734 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:37:13.261954 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:37:13.263864 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (compile): 2023-10-06 11:37:13.254704 => 2023-10-06 11:37:13.263864
[0m11:37:13.265053 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:37:13.278221 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

            

    
        create table travelata.incremental_sheets_appmetrica_screenview
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
    )
        ...
[0m11:37:13.346382 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:13.351374 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_screenview'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:13.404865 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:13.408856 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_screenview"
[0m11:37:13.409861 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_screenview: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
    ...
[0m11:37:13.472020 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_screenview"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_screenview ("__datetime", "appmetricamobileAdsId_device_id", "accountName", "appmetricaDeviceId", "cityName", "osName", "crmUserId", "session_id", "screen_view", "__emitted_at", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_screenview
  
    
[0m11:37:13.472020 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_screenview (execute): 2023-10-06 11:37:13.265801 => 2023-10-06 11:37:13.472020
[0m11:37:13.477031 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:37:13.478020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E13C310>]}
[0m11:37:13.479025 [error] [Thread-1 (]: 22 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_screenview  [[31mERROR[0m in 0.23s]
[0m11:37:13.481029 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_screenview
[0m11:37:13.482006 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:37:13.482006 [info ] [Thread-1 (]: 23 of 33 START sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [RUN]
[0m11:37:13.485021 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_appmetrica_sessionstart'
[0m11:37:13.485021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_appmetrica_sessionstart)
[0m11:37:13.486029 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:37:13.492005 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:37:13.493002 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (compile): 2023-10-06 11:37:13.486029 => 2023-10-06 11:37:13.493002
[0m11:37:13.494030 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:37:13.505011 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

            

    
        create table travelata.incremental_sheets_appmetrica_sessionstart
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
    )
        ...
[0m11:37:13.567638 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:13.572629 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

    select name, type from system.columns where table = 'incremental_sheets_appmetrica_sessionstart'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:13.624375 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:13.628397 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_appmetrica_sessionstart"
[0m11:37:13.630432 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_appmetrica_sessionstart: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
    ...
[0m11:37:13.690098 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_appmetrica_sessionstart"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_appmetrica_sessionstart ("session_id", "__datetime", "appmetrica_device_id", "appmetricaDeviceId", "city", "google_aid", "os_name", "profile_id", "installation_id", "ios_ifa", "__table_name", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%d.%m.%Y') AS __datetime)
FROM travelata.normalized_sheets_appmetrica_sessionstart
  
    
[0m11:37:13.691101 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_appmetrica_sessionstart (execute): 2023-10-06 11:37:13.495021 => 2023-10-06 11:37:13.691101
[0m11:37:13.696100 [debug] [Thread-1 (]: Database Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:37:13.697099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E22A450>]}
[0m11:37:13.698100 [error] [Thread-1 (]: 23 of 33 ERROR creating sql incremental model travelata.incremental_sheets_appmetrica_sessionstart  [[31mERROR[0m in 0.21s]
[0m11:37:13.700021 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_appmetrica_sessionstart
[0m11:37:13.700021 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners
[0m11:37:13.701032 [info ] [Thread-1 (]: 24 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners ........... [[33mSKIP[0m]
[0m11:37:13.703018 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners
[0m11:37:13.704033 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:37:13.704033 [info ] [Thread-1 (]: 25 of 33 SKIP relation travelata.incremental_sheets_mytarget_banners_statistics  [[33mSKIP[0m]
[0m11:37:13.706035 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_banners_statistics
[0m11:37:13.706035 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:37:13.707023 [info ] [Thread-1 (]: 26 of 33 SKIP relation travelata.incremental_sheets_mytarget_compagins ......... [[33mSKIP[0m]
[0m11:37:13.709008 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_mytarget_compagins
[0m11:37:13.710037 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:37:13.710677 [info ] [Thread-1 (]: 27 of 33 START sql table model travelata.incremental_sheets_utmcraft_utmresult . [RUN]
[0m11:37:13.712657 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_utmcraft_utmresult'
[0m11:37:13.713949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_utmcraft_utmresult)
[0m11:37:13.714496 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:37:13.719663 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:37:13.720933 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (compile): 2023-10-06 11:37:13.714617 => 2023-10-06 11:37:13.720933
[0m11:37:13.722055 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:37:13.726535 [debug] [Thread-1 (]: Creating new relation incremental_sheets_utmcraft_utmresult
[0m11:37:13.729432 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

            

    
        create table travelata.incremental_sheets_utmcraft_utmresult
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

select * 
from travelata.normalized_sheets_utmcraft_utmresult
    )
        ...
[0m11:37:13.797917 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:13.803922 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

    select name, type from system.columns where table = 'incremental_sheets_utmcraft_utmresult'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:13.855135 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:13.859223 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_utmcraft_utmresult"
[0m11:37:13.861136 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_utmcraft_utmresult: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_utmcraft_utmresult"} */

  
    
    
        
        insert into travelata.incremental_sheets_utmcraft_utmresult ("id", "created_at", "updated_at", "utm_hashcode", "data", "created_by_id", "form_id", "updated_by_id", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

select * 
from travelata.normalized_sheets_utmcraft_utmresult
  ...
[0m11:37:13.924669 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:13.928644 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_utmcraft_utmresult (execute): 2023-10-06 11:37:13.722717 => 2023-10-06 11:37:13.928644
[0m11:37:13.929648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D81F110>]}
[0m11:37:13.930643 [info ] [Thread-1 (]: 27 of 33 OK created sql table model travelata.incremental_sheets_utmcraft_utmresult  [[32mOK[0m in 0.22s]
[0m11:37:13.932648 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_utmcraft_utmresult
[0m11:37:13.933647 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:37:13.934648 [info ] [Thread-1 (]: 28 of 33 START sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [RUN]
[0m11:37:13.936649 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adgroupsstatistics'
[0m11:37:13.936649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adgroupsstatistics)
[0m11:37:13.937661 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:37:13.943641 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:37:13.945876 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (compile): 2023-10-06 11:37:13.937661 => 2023-10-06 11:37:13.945876
[0m11:37:13.947166 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:37:13.958589 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adgroupsstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
    )
        ...
[0m11:37:14.028448 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m11:37:14.033438 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adgroupsstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:14.085730 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:14.090748 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adgroupsstatistics"
[0m11:37:14.092725 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adgroupsstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
    ...
[0m11:37:14.182219 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adgroupsstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adgroupsstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adgroupsstatistics
  
    
[0m11:37:14.183219 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adgroupsstatistics (execute): 2023-10-06 11:37:13.947810 => 2023-10-06 11:37:14.183219
[0m11:37:14.188219 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:37:14.189219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E264310>]}
[0m11:37:15.456679 [error] [Thread-1 (]: 28 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adgroupsstatistics  [[31mERROR[0m in 0.25s]
[0m11:37:15.458685 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adgroupsstatistics
[0m11:37:15.459663 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:37:15.460666 [info ] [Thread-1 (]: 29 of 33 START sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [RUN]
[0m11:37:15.462680 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_adplansstatistics'
[0m11:37:15.463685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_adplansstatistics)
[0m11:37:15.463685 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:37:15.469688 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:37:15.470664 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (compile): 2023-10-06 11:37:15.464688 => 2023-10-06 11:37:15.470664
[0m11:37:15.471661 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:37:15.486994 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_adplansstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
    )
        ...
[0m11:37:15.548553 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:15.553552 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_adplansstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:15.604856 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:15.609865 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_adplansstatistics"
[0m11:37:15.611836 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_adplansstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
    ...
[0m11:37:15.692528 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_adplansstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_adplansstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_adplansstatistics
  
    
[0m11:37:15.694519 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_adplansstatistics (execute): 2023-10-06 11:37:15.472685 => 2023-10-06 11:37:15.693520
[0m11:37:15.699518 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:37:15.700528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DE0CAD0>]}
[0m11:37:15.701520 [error] [Thread-1 (]: 29 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_adplansstatistics  [[31mERROR[0m in 0.24s]
[0m11:37:15.702527 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_adplansstatistics
[0m11:37:15.703521 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:37:15.704520 [info ] [Thread-1 (]: 30 of 33 START sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [RUN]
[0m11:37:15.707520 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_vkads_bannerssstatistics'
[0m11:37:15.707520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_vkads_bannerssstatistics)
[0m11:37:15.708518 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:37:15.713518 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:37:15.715515 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (compile): 2023-10-06 11:37:15.708518 => 2023-10-06 11:37:15.715515
[0m11:37:15.716522 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:37:15.727519 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

            

    
        create table travelata.incremental_sheets_vkads_bannerssstatistics
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
    )
        ...
[0m11:37:15.788377 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:15.793380 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

    select name, type from system.columns where table = 'incremental_sheets_vkads_bannerssstatistics'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:15.855052 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:15.859053 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_vkads_bannerssstatistics"
[0m11:37:15.861057 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_vkads_bannerssstatistics: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
    ...
[0m11:37:15.939045 [debug] [Thread-1 (]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_vkads_bannerssstatistics"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_vkads_bannerssstatistics ("__datetime", "tps", "spent", "shows", "clicks", "base", "date", "moat", "romi", "video", "events", "uniques", "carousel", "playable", "ad_group_id", "custom_event", "uniques_video", "_airbyte_ab_id", "load_date", "_normalized_at", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') AS __datetime)
FROM travelata.normalized_sheets_vkads_bannersstatistics
  
    
[0m11:37:15.940054 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_vkads_bannerssstatistics (execute): 2023-10-06 11:37:15.717528 => 2023-10-06 11:37:15.940054
[0m11:37:15.946053 [debug] [Thread-1 (]: Database Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)
  :HTTPDriver for http://localhost:8123 returned response code 400)
   Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
  compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:37:15.947054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E1459D0>]}
[0m11:37:15.948051 [error] [Thread-1 (]: 30 of 33 ERROR creating sql incremental model travelata.incremental_sheets_vkads_bannerssstatistics  [[31mERROR[0m in 0.24s]
[0m11:37:15.950051 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_vkads_bannerssstatistics
[0m11:37:15.951054 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:37:15.952054 [info ] [Thread-1 (]: 31 of 33 START sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [RUN]
[0m11:37:15.954046 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_mediaplans'
[0m11:37:15.955054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_mediaplans)
[0m11:37:15.955054 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:37:15.961045 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:37:15.963147 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (compile): 2023-10-06 11:37:15.956036 => 2023-10-06 11:37:15.963147
[0m11:37:15.963747 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:37:15.968815 [debug] [Thread-1 (]: Creating new relation incremental_sheets_yandexdisk_mediaplans
[0m11:37:15.972015 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_mediaplans
        
  
        
  engine = MergeTree()
        order by (__table_name)
        
        
        
        empty
    as (
        

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
    )
        ...
[0m11:37:16.034822 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.039854 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_mediaplans'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:16.094822 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:16.098837 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_mediaplans"
[0m11:37:16.100843 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_mediaplans: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_mediaplans"} */

  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_mediaplans ("Source", "Medium", "Campaign", "ProductName", "Geo", "Period_start", "Period_end", "Cost", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * 
FROM travelata.normalized_sheets_yandexdisk_mediaplans
  ...
[0m11:37:16.161994 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.165984 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_mediaplans (execute): 2023-10-06 11:37:15.964367 => 2023-10-06 11:37:16.165984
[0m11:37:16.166990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E2E7E50>]}
[0m11:37:16.167993 [info ] [Thread-1 (]: 31 of 33 OK created sql table model travelata.incremental_sheets_yandexdisk_mediaplans  [[32mOK[0m in 0.21s]
[0m11:37:16.169993 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_mediaplans
[0m11:37:16.170985 [debug] [Thread-1 (]: Began running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:37:16.171967 [info ] [Thread-1 (]: 32 of 33 START sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [RUN]
[0m11:37:16.174002 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental_sheets_yandexdisk_othercosts'
[0m11:37:16.175014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental_sheets_yandexdisk_othercosts)
[0m11:37:16.175014 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:37:16.183150 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:37:16.184660 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (compile): 2023-10-06 11:37:16.176017 => 2023-10-06 11:37:16.184660
[0m11:37:16.185275 [debug] [Thread-1 (]: Began executing node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:37:16.195414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

            

    
        create table travelata.incremental_sheets_yandexdisk_othercosts
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
    )
        ...
[0m11:37:16.257008 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.262017 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

    select name, type from system.columns where table = 'incremental_sheets_yandexdisk_othercosts'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:16.314467 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:16.318495 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental_sheets_yandexdisk_othercosts"
[0m11:37:16.320487 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental_sheets_yandexdisk_othercosts: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental_sheets_yandexdisk_othercosts"} */

        
  
    
    
        
        insert into travelata.incremental_sheets_yandexdisk_othercosts ("__datetime", "Source", "Medium", "Campaign", "ProductName", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yandexdisk_othercosts
  
    ...
[0m11:37:16.381070 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.387060 [debug] [Thread-1 (]: Timing info for model.travelata.incremental_sheets_yandexdisk_othercosts (execute): 2023-10-06 11:37:16.185890 => 2023-10-06 11:37:16.386061
[0m11:37:16.388060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E2231D0>]}
[0m11:37:16.389069 [info ] [Thread-1 (]: 32 of 33 OK created sql incremental model travelata.incremental_sheets_yandexdisk_othercosts  [[32mOK[0m in 0.22s]
[0m11:37:16.391061 [debug] [Thread-1 (]: Finished running node model.travelata.incremental_sheets_yandexdisk_othercosts
[0m11:37:16.392061 [debug] [Thread-1 (]: Began running node model.travelata.incremental__sheets_yd_customreport
[0m11:37:16.392061 [info ] [Thread-1 (]: 33 of 33 START sql incremental model travelata.incremental__sheets_yd_customreport  [RUN]
[0m11:37:16.394061 [debug] [Thread-1 (]: Acquiring new clickhouse connection 'model.travelata.incremental__sheets_yd_customreport'
[0m11:37:16.395060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.travelata.incremental__sheets_yd_customreport)
[0m11:37:16.395060 [debug] [Thread-1 (]: Began compiling node model.travelata.incremental__sheets_yd_customreport
[0m11:37:16.401040 [debug] [Thread-1 (]: Writing injected SQL for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:37:16.403071 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (compile): 2023-10-06 11:37:16.396061 => 2023-10-06 11:37:16.402925
[0m11:37:16.403696 [debug] [Thread-1 (]: Began executing node model.travelata.incremental__sheets_yd_customreport
[0m11:37:16.415308 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

            

    
        create table travelata.incremental__sheets_yd_customreport
        
  
        
  engine = MergeTree()
        order by (toDate(__datetime),__table_name)
        
        
        
        empty
    as (
        

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
    )
        ...
[0m11:37:16.478538 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.483536 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

    select name, type from system.columns where table = 'incremental__sheets_yd_customreport'
    
      and database = 'travelata'
    
    order by position
  ...
[0m11:37:16.535354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m11:37:16.539359 [debug] [Thread-1 (]: Writing runtime sql for node "model.travelata.incremental__sheets_yd_customreport"
[0m11:37:16.540360 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.travelata.incremental__sheets_yd_customreport: /* {"app": "dbt", "dbt_version": "1.4.8", "profile_name": "travelata", "target_name": "dev", "node_id": "model.travelata.incremental__sheets_yd_customreport"} */

        
  
    
    
        
        insert into travelata.incremental__sheets_yd_customreport ("__datetime", "reportType", "CampaignId", "CampaignName", "CampaignType", "AdGroupId", "AdGroupName", "AdId", "CriterionId", "Criterion", "Cost", "Impressions", "Clicks", "__table_name", "__emitted_at", "__normalized_at")
  

SELECT * REPLACE(parseDateTime(__datetime, '%Y-%m-%d') AS __datetime)
FROM travelata.normalized_sheets_yd_customreport
  
    ...
[0m11:37:16.603759 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m11:37:16.607753 [debug] [Thread-1 (]: Timing info for model.travelata.incremental__sheets_yd_customreport (execute): 2023-10-06 11:37:16.404232 => 2023-10-06 11:37:16.607753
[0m11:37:16.608759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4d81c7-931e-4eb6-ae77-5872ff82ec2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4DEAC290>]}
[0m11:37:16.609753 [info ] [Thread-1 (]: 33 of 33 OK created sql incremental model travelata.incremental__sheets_yd_customreport  [[32mOK[0m in 0.21s]
[0m11:37:16.612534 [debug] [Thread-1 (]: Finished running node model.travelata.incremental__sheets_yd_customreport
[0m11:37:16.615519 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:37:16.617517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:16.618514 [debug] [MainThread]: Connection 'list_schemas' was left open.
[0m11:37:16.619513 [debug] [MainThread]: On list_schemas: Close
[0m11:37:16.620518 [debug] [MainThread]: Connection 'list_None_travelata' was left open.
[0m11:37:16.621232 [debug] [MainThread]: On list_None_travelata: Close
[0m11:37:16.621872 [debug] [MainThread]: Connection 'model.travelata.incremental__sheets_yd_customreport' was left open.
[0m11:37:16.623138 [debug] [MainThread]: On model.travelata.incremental__sheets_yd_customreport: Close
[0m11:37:16.624379 [info ] [MainThread]: 
[0m11:37:16.626189 [info ] [MainThread]: Finished running 17 view models, 11 incremental models, 5 table models in 0 hours 0 minutes and 11.98 seconds (11.98s).
[0m11:37:16.630431 [debug] [MainThread]: Command end result
[0m11:37:16.646778 [info ] [MainThread]: 
[0m11:37:16.647765 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m11:37:16.649779 [info ] [MainThread]: 
[0m11:37:16.650784 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_new (models\1_normalize\normalized_sheets_mytarget_banners_new.sql)[0m
[0m11:37:16.652766 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:37:16.653772 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:37:16.655763 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_new.sql
[0m11:37:16.657774 [info ] [MainThread]: 
[0m11:37:16.659772 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_banners_statjstics_new (models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql)[0m
[0m11:37:16.661764 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:37:16.662763 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_banners_statistics does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_banners_statistics?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:37:16.665769 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_banners_statjstics_new.sql
[0m11:37:16.667769 [info ] [MainThread]: 
[0m11:37:16.669762 [error] [MainThread]: [33mDatabase Error in model normalized_sheets_mytarget_compagins_new (models\1_normalize\normalized_sheets_mytarget_compagins_new.sql)[0m
[0m11:37:16.670764 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 404)
[0m11:37:16.672772 [error] [MainThread]:    Code: 60. DB::Exception: Table travelata._airbyte_raw_sheets_mytarget_travelata_normalize_mt_compaigns does not exist. Maybe you meant _airbyte_raw_sheets_mytarget_travelatanormalize_mt_compaigns?. (UNKNOWN_TABLE) (version 23.9.1.1854 (official build))
[0m11:37:16.674766 [error] [MainThread]:   compiled Code at target\run\travelata\models\1_normalize\normalized_sheets_mytarget_compagins_new.sql
[0m11:37:16.676772 [info ] [MainThread]: 
[0m11:37:16.677764 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_deeplinks (models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql)[0m
[0m11:37:16.679769 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.680768 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-02 02:26:22 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 14, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.682769 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_deeplinks.sql
[0m11:37:16.684774 [info ] [MainThread]: 
[0m11:37:16.685769 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_screenview (models\2_incremental\incremental_sheets_appmetrica_screenview.sql)[0m
[0m11:37:16.686762 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.688774 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-03 07:22:53 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 11'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.689770 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_screenview.sql
[0m11:37:16.691768 [info ] [MainThread]: 
[0m11:37:16.692771 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_appmetrica_sessionstart (models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql)[0m
[0m11:37:16.694778 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.695774 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse fragment LITERAL from 23-10-04 13:52:52 because literal . is expected but 2 provided: while executing 'FUNCTION parseDateTime(__datetime :: 12, '%d.%m.%Y' :: 13) -> parseDateTime(__datetime, '%d.%m.%Y') DateTime('UTC') : 9'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.697762 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_appmetrica_sessionstart.sql
[0m11:37:16.699772 [info ] [MainThread]: 
[0m11:37:16.700767 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adgroupsstatistics (models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql)[0m
[0m11:37:16.702774 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.703771 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.705772 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adgroupsstatistics.sql
[0m11:37:16.707774 [info ] [MainThread]: 
[0m11:37:16.708775 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_adplansstatistics (models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql)[0m
[0m11:37:16.709774 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.711767 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.712764 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_adplansstatistics.sql
[0m11:37:16.714774 [info ] [MainThread]: 
[0m11:37:16.715777 [error] [MainThread]: [33mDatabase Error in model incremental_sheets_vkads_bannerssstatistics (models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql)[0m
[0m11:37:16.717767 [error] [MainThread]:   :HTTPDriver for http://localhost:8123 returned response code 400)
[0m11:37:16.718771 [error] [MainThread]:    Code: 41. DB::Exception: Unable to parse first part of fragment %M from 00:10 because of unknown month of year text: 00:: while executing 'FUNCTION parseDateTime(__datetime :: 22, '%Y-%m-%d %H:%M:%S' :: 23) -> parseDateTime(__datetime, '%Y-%m-%d %H:%M:%S') DateTime('UTC') : 21'. (CANNOT_PARSE_DATETIME) (version 23.9.1.1854 (official build))
[0m11:37:16.720769 [error] [MainThread]:   compiled Code at target\run\travelata\models\2_incremental\incremental_sheets_vkads_bannerssstatistics.sql
[0m11:37:16.722776 [info ] [MainThread]: 
[0m11:37:16.723768 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=9 SKIP=3 TOTAL=33
[0m11:37:16.724763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E05AE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4E233150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4D746850>]}
[0m11:37:16.725766 [debug] [MainThread]: Flushing usage events
